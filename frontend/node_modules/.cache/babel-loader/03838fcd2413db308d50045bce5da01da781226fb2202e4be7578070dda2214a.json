{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/slicedToArray.js\").default;\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _reactI18next = require(\"react-i18next\");\nvar _outlineItem = _interopRequireDefault(require(\"./outline-item\"));\nvar _useScrollContext = require(\"../../hooks/use-scroll-context\");\nvar _constants = require(\"../../constants\");\nrequire(\"./style.css\");\nvar getHeaderList = function getHeaderList(children) {\n  var headerList = [];\n  children.forEach(function (node) {\n    if (node.type === 'header2' || node.type === 'header3') {\n      headerList.push(node);\n    }\n  });\n  return headerList;\n};\nvar Outline = function Outline(_ref) {\n  var editor = _ref.editor;\n  var _ref2 = (0, _reactI18next.useTranslation)(_constants.TRANSLATE_NAMESPACE),\n    t = _ref2.t;\n  var scrollRef = (0, _useScrollContext.useScrollContext)();\n  var _ref3 = (0, _react.useState)([]),\n    _ref4 = _slicedToArray(_ref3, 2),\n    headerList = _ref4[0],\n    setHeaderList = _ref4[1];\n  var _ref5 = (0, _react.useState)(''),\n    _ref6 = _slicedToArray(_ref5, 2),\n    activeId = _ref6[0],\n    setActiveId = _ref6[1];\n  (0, _react.useEffect)(function () {\n    var headerList = getHeaderList(editor.children);\n    setHeaderList(headerList);\n  }, [editor.children]);\n  var handleScroll = (0, _react.useCallback)(function (e) {\n    var scrollTop = scrollRef.current.scrollTop;\n    var styles = getComputedStyle(scrollRef === null || scrollRef === void 0 ? void 0 : scrollRef.current);\n    var paddingTop = parseInt(styles.paddingTop);\n    for (var i = 0; i < headerList.length; i++) {\n      var headerItem = headerList[i];\n      var dom = document.getElementById(headerItem.id);\n      var offsetTop = dom.offsetTop,\n        offsetHeight = dom.offsetHeight;\n      var _styles = getComputedStyle(dom);\n      var marginTop = parseInt(_styles.marginTop);\n      if (offsetTop + offsetHeight + marginTop > scrollTop - paddingTop) {\n        setActiveId(headerItem.id);\n        break;\n      }\n    }\n  }, [headerList, scrollRef]);\n  (0, _react.useEffect)(function () {\n    var observerRefValue = null;\n    if (scrollRef.current) {\n      scrollRef.current.addEventListener('scroll', handleScroll);\n      observerRefValue = scrollRef.current;\n    }\n    return function () {\n      observerRefValue.removeEventListener('scroll', handleScroll);\n    };\n  }, [handleScroll, scrollRef]);\n  return /*#__PURE__*/_react.default.createElement(\"div\", {\n    className: \"sf-editor-outline\"\n  }, headerList.length === 0 && /*#__PURE__*/_react.default.createElement(\"div\", {\n    className: \"empty-container\"\n  }, t('No_outline')), headerList.length > 0 && headerList.map(function (node, index) {\n    return /*#__PURE__*/_react.default.createElement(_outlineItem.default, {\n      key: index,\n      node: node,\n      activeId: activeId\n    });\n  }));\n};\nvar _default = exports.default = Outline;","map":{"version":3,"names":["_slicedToArray","require","default","_interopRequireDefault","_interopRequireWildcard","Object","defineProperty","exports","value","_react","_reactI18next","_outlineItem","_useScrollContext","_constants","getHeaderList","children","headerList","forEach","node","type","push","Outline","_ref","editor","_ref2","useTranslation","TRANSLATE_NAMESPACE","t","scrollRef","useScrollContext","_ref3","useState","_ref4","setHeaderList","_ref5","_ref6","activeId","setActiveId","useEffect","handleScroll","useCallback","e","scrollTop","current","styles","getComputedStyle","paddingTop","parseInt","i","length","headerItem","dom","document","getElementById","id","offsetTop","offsetHeight","marginTop","observerRefValue","addEventListener","removeEventListener","createElement","className","map","index","key","_default"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/seafile-editor/dist/containers/outline/index.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _reactI18next = require(\"react-i18next\");\nvar _outlineItem = _interopRequireDefault(require(\"./outline-item\"));\nvar _useScrollContext = require(\"../../hooks/use-scroll-context\");\nvar _constants = require(\"../../constants\");\nrequire(\"./style.css\");\nconst getHeaderList = children => {\n  const headerList = [];\n  children.forEach(node => {\n    if (node.type === 'header2' || node.type === 'header3') {\n      headerList.push(node);\n    }\n  });\n  return headerList;\n};\nconst Outline = _ref => {\n  let {\n    editor\n  } = _ref;\n  const {\n    t\n  } = (0, _reactI18next.useTranslation)(_constants.TRANSLATE_NAMESPACE);\n  const scrollRef = (0, _useScrollContext.useScrollContext)();\n  const [headerList, setHeaderList] = (0, _react.useState)([]);\n  const [activeId, setActiveId] = (0, _react.useState)('');\n  (0, _react.useEffect)(() => {\n    const headerList = getHeaderList(editor.children);\n    setHeaderList(headerList);\n  }, [editor.children]);\n  const handleScroll = (0, _react.useCallback)(e => {\n    const scrollTop = scrollRef.current.scrollTop;\n    const styles = getComputedStyle(scrollRef === null || scrollRef === void 0 ? void 0 : scrollRef.current);\n    const paddingTop = parseInt(styles.paddingTop);\n    for (let i = 0; i < headerList.length; i++) {\n      const headerItem = headerList[i];\n      const dom = document.getElementById(headerItem.id);\n      const {\n        offsetTop,\n        offsetHeight\n      } = dom;\n      const styles = getComputedStyle(dom);\n      const marginTop = parseInt(styles.marginTop);\n      if (offsetTop + offsetHeight + marginTop > scrollTop - paddingTop) {\n        setActiveId(headerItem.id);\n        break;\n      }\n    }\n  }, [headerList, scrollRef]);\n  (0, _react.useEffect)(() => {\n    let observerRefValue = null;\n    if (scrollRef.current) {\n      scrollRef.current.addEventListener('scroll', handleScroll);\n      observerRefValue = scrollRef.current;\n    }\n    return () => {\n      observerRefValue.removeEventListener('scroll', handleScroll);\n    };\n  }, [handleScroll, scrollRef]);\n  return /*#__PURE__*/_react.default.createElement(\"div\", {\n    className: \"sf-editor-outline\"\n  }, headerList.length === 0 && /*#__PURE__*/_react.default.createElement(\"div\", {\n    className: \"empty-container\"\n  }, t('No_outline')), headerList.length > 0 && headerList.map((node, index) => {\n    return /*#__PURE__*/_react.default.createElement(_outlineItem.default, {\n      key: index,\n      node: node,\n      activeId: activeId\n    });\n  }));\n};\nvar _default = exports.default = Outline;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}