{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/slicedToArray.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.setListType = exports.isMenuDisabled = exports.getBeforeText = exports.getActiveListType = void 0;\nvar _slate = require(\"slate\");\nvar _elementTypes = require(\"../../constants/element-types\");\nvar _constant = require(\"./constant\");\nvar _transforms = require(\"./transforms\");\nvar isMenuDisabled = function isMenuDisabled(editor, readonly) {\n  if (readonly || !editor.selection) return true;\n  // Match disable node\n  var _slate$Editor$nodes = _slate.Editor.nodes(editor, {\n      match: function match(node) {\n        if (!_slate.Element.isElement(node)) return false;\n        var isVoidOrBlock = _slate.Editor.isVoid(editor, node) && _slate.Editor.isBlock(editor, node);\n        if (isVoidOrBlock) return true;\n        var disabledNodeTypes = [_elementTypes.CODE_LINE, _elementTypes.CODE_BLOCK, _elementTypes.TABLE, _elementTypes.CHECK_LIST_ITEM];\n        var isDisabledNode = disabledNodeTypes.includes(node.type);\n        if (isDisabledNode) return true;\n        return false;\n      }\n    }),\n    _slate$Editor$nodes2 = _slicedToArray(_slate$Editor$nodes, 1),\n    matchedDisabledNode = _slate$Editor$nodes2[0];\n  if (matchedDisabledNode) return true;\n  return false;\n};\n\n/**\n * @returns {ORDERED_LIST | UNORDERED_LIST | undefined} Return the list type of the selected list\n */\nexports.isMenuDisabled = isMenuDisabled;\nvar getActiveListType = function getActiveListType(editor) {\n  var selection = editor.selection;\n  if (!selection) return;\n  var selectedListNodeEntry;\n  if (_slate.Range.isCollapsed(selection)) {\n    var _slate$Editor$nodes3 = _slate.Editor.nodes(editor, {\n        match: function match(node) {\n          return _constant.LIST_TYPES.includes(node.type);\n        },\n        mode: 'lowest'\n      }),\n      _slate$Editor$nodes4 = _slicedToArray(_slate$Editor$nodes3, 1),\n      nodeEntry = _slate$Editor$nodes4[0];\n    selectedListNodeEntry = nodeEntry;\n  } else {\n    var anchor = selection.anchor,\n      focus = selection.focus;\n    var commonNodeEntry = _slate.Node.common(editor, anchor.path, focus.path);\n    //  Select condition:\n    // 1. Select in one list\n    // 2. Select in one list item\n    // 3. Select in one line\n    if (_constant.LIST_TYPES.includes(commonNodeEntry[0].type)) {\n      // Select in one list\n      selectedListNodeEntry = commonNodeEntry;\n    } else if (commonNodeEntry[0].type === _elementTypes.LIST_ITEM) {\n      // Select in one list item\n      selectedListNodeEntry = _slate.Editor.parent(editor, commonNodeEntry[1]);\n    } else if (_slate.Text.isText(commonNodeEntry[0])) {\n      // Select in one line\n      var _slate$Editor$nodes5 = _slate.Editor.nodes(editor, {\n          at: commonNodeEntry[1],\n          match: function match(node) {\n            return _constant.LIST_TYPES.includes(node.type);\n          },\n          mode: 'lowest'\n        }),\n        _slate$Editor$nodes6 = _slicedToArray(_slate$Editor$nodes5, 1),\n        _nodeEntry = _slate$Editor$nodes6[0];\n      selectedListNodeEntry = _nodeEntry;\n    }\n  }\n  return selectedListNodeEntry && selectedListNodeEntry[0].type;\n};\nexports.getActiveListType = getActiveListType;\nvar setListType = function setListType(editor, type) {\n  (0, _transforms.transformsToList)(editor, type);\n};\nexports.setListType = setListType;\nvar getBeforeText = function getBeforeText(editor) {\n  var selection = editor.selection;\n  if (selection == null) return {\n    beforeText: '',\n    range: null\n  };\n  var anchor = selection.anchor;\n  // Find the near text node above the current text\n  var _slate$Editor$above = _slate.Editor.above(editor),\n    _slate$Editor$above2 = _slicedToArray(_slate$Editor$above, 2),\n    aboveNodePath = _slate$Editor$above2[1];\n  var aboveNodeStartPoint = _slate.Editor.start(editor, aboveNodePath); // The starting position of the text node\n  var range = {\n    anchor: anchor,\n    focus: aboveNodeStartPoint\n  };\n  var beforeText = _slate.Editor.string(editor, range) || '';\n  return {\n    beforeText: beforeText,\n    range: range\n  };\n};\nexports.getBeforeText = getBeforeText;","map":{"version":3,"names":["_slicedToArray","require","default","Object","defineProperty","exports","value","setListType","isMenuDisabled","getBeforeText","getActiveListType","_slate","_elementTypes","_constant","_transforms","editor","readonly","selection","_slate$Editor$nodes","Editor","nodes","match","node","Element","isElement","isVoidOrBlock","isVoid","isBlock","disabledNodeTypes","CODE_LINE","CODE_BLOCK","TABLE","CHECK_LIST_ITEM","isDisabledNode","includes","type","_slate$Editor$nodes2","matchedDisabledNode","selectedListNodeEntry","Range","isCollapsed","_slate$Editor$nodes3","LIST_TYPES","mode","_slate$Editor$nodes4","nodeEntry","anchor","focus","commonNodeEntry","Node","common","path","LIST_ITEM","parent","Text","isText","_slate$Editor$nodes5","at","_slate$Editor$nodes6","transformsToList","beforeText","range","_slate$Editor$above","above","_slate$Editor$above2","aboveNodePath","aboveNodeStartPoint","start","string"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/seafile-editor/dist/extension/plugins/list/helpers.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.setListType = exports.isMenuDisabled = exports.getBeforeText = exports.getActiveListType = void 0;\nvar _slate = require(\"slate\");\nvar _elementTypes = require(\"../../constants/element-types\");\nvar _constant = require(\"./constant\");\nvar _transforms = require(\"./transforms\");\nconst isMenuDisabled = (editor, readonly) => {\n  if (readonly || !editor.selection) return true;\n  // Match disable node\n  const [matchedDisabledNode] = _slate.Editor.nodes(editor, {\n    match: node => {\n      if (!_slate.Element.isElement(node)) return false;\n      const isVoidOrBlock = _slate.Editor.isVoid(editor, node) && _slate.Editor.isBlock(editor, node);\n      if (isVoidOrBlock) return true;\n      const disabledNodeTypes = [_elementTypes.CODE_LINE, _elementTypes.CODE_BLOCK, _elementTypes.TABLE, _elementTypes.CHECK_LIST_ITEM];\n      const isDisabledNode = disabledNodeTypes.includes(node.type);\n      if (isDisabledNode) return true;\n      return false;\n    }\n  });\n  if (matchedDisabledNode) return true;\n  return false;\n};\n\n/**\n * @returns {ORDERED_LIST | UNORDERED_LIST | undefined} Return the list type of the selected list\n */\nexports.isMenuDisabled = isMenuDisabled;\nconst getActiveListType = editor => {\n  const {\n    selection\n  } = editor;\n  if (!selection) return;\n  let selectedListNodeEntry;\n  if (_slate.Range.isCollapsed(selection)) {\n    const [nodeEntry] = _slate.Editor.nodes(editor, {\n      match: node => _constant.LIST_TYPES.includes(node.type),\n      mode: 'lowest'\n    });\n    selectedListNodeEntry = nodeEntry;\n  } else {\n    const {\n      anchor,\n      focus\n    } = selection;\n    const commonNodeEntry = _slate.Node.common(editor, anchor.path, focus.path);\n    //  Select condition:\n    // 1. Select in one list\n    // 2. Select in one list item\n    // 3. Select in one line\n    if (_constant.LIST_TYPES.includes(commonNodeEntry[0].type)) {\n      // Select in one list\n      selectedListNodeEntry = commonNodeEntry;\n    } else if (commonNodeEntry[0].type === _elementTypes.LIST_ITEM) {\n      // Select in one list item\n      selectedListNodeEntry = _slate.Editor.parent(editor, commonNodeEntry[1]);\n    } else if (_slate.Text.isText(commonNodeEntry[0])) {\n      // Select in one line\n      const [nodeEntry] = _slate.Editor.nodes(editor, {\n        at: commonNodeEntry[1],\n        match: node => _constant.LIST_TYPES.includes(node.type),\n        mode: 'lowest'\n      });\n      selectedListNodeEntry = nodeEntry;\n    }\n  }\n  return selectedListNodeEntry && selectedListNodeEntry[0].type;\n};\nexports.getActiveListType = getActiveListType;\nconst setListType = (editor, type) => {\n  (0, _transforms.transformsToList)(editor, type);\n};\nexports.setListType = setListType;\nconst getBeforeText = editor => {\n  const {\n    selection\n  } = editor;\n  if (selection == null) return {\n    beforeText: '',\n    range: null\n  };\n  const {\n    anchor\n  } = selection;\n  // Find the near text node above the current text\n  const [, aboveNodePath] = _slate.Editor.above(editor);\n  const aboveNodeStartPoint = _slate.Editor.start(editor, aboveNodePath); // The starting position of the text node\n  const range = {\n    anchor,\n    focus: aboveNodeStartPoint\n  };\n  const beforeText = _slate.Editor.string(editor, range) || '';\n  return {\n    beforeText,\n    range\n  };\n};\nexports.getBeforeText = getBeforeText;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}