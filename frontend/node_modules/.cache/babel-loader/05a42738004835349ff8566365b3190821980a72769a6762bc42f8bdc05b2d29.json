{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import moment from'moment';import{siteRoot,gettext,enableVideoThumbnail}from'../../utils/constants';import{seafileAPI}from'../../utils/seafile-api';import{Utils}from'../../utils/utils';import toaster from'../toast';import FileTag from'../../models/file-tag';import FileTagList from'../file-tag-list';import'../../css/dirent-detail.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FileDetails=/*#__PURE__*/function(_React$Component){_inherits(FileDetails,_React$Component);var _super=_createSuper(FileDetails);function FileDetails(props){var _this;_classCallCheck(this,FileDetails);_this=_super.call(this,props);_this.renderHeader=function(smallIconUrl,direntName){return/*#__PURE__*/_jsxs(\"div\",{className:\"detail-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"detail-control sf2-icon-x1\",onClick:_this.props.togglePanel}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-title dirent-title\",children:[/*#__PURE__*/_jsx(\"img\",{src:smallIconUrl,width:\"24\",height:\"24\",alt:\"\"}),' ',/*#__PURE__*/_jsx(\"span\",{className:\"name ellipsis\",title:direntName,children:direntName})]})]});};_this.renderDetailBody=function(bigIconUrl){var direntDetail=_this.state.direntDetail;var _this$props=_this.props,repoName=_this$props.repoName,path=_this$props.path;return/*#__PURE__*/_jsxs(\"div\",{className:\"detail-body dirent-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"img\",children:/*#__PURE__*/_jsx(\"img\",{src:bigIconUrl,className:\"thumbnail\",alt:\"\"})}),_this.state.direntDetail&&/*#__PURE__*/_jsx(\"div\",{className:\"dirent-table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table-thead-hidden\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{width:\"35%\"}),/*#__PURE__*/_jsx(\"th\",{width:\"65%\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:gettext('Size')}),/*#__PURE__*/_jsx(\"td\",{children:Utils.bytesToSize(direntDetail.size)})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:gettext('Location')}),/*#__PURE__*/_jsx(\"td\",{children:repoName+path})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:gettext('Last Update')}),/*#__PURE__*/_jsx(\"td\",{children:moment(direntDetail.last_modified).fromNow()})]}),/*#__PURE__*/_jsxs(\"tr\",{className:\"file-tag-container\",children:[/*#__PURE__*/_jsx(\"th\",{children:gettext('Tags')}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(FileTagList,{fileTagList:_this.state.fileTagList})})]})]})]})})]});};_this.state={direntType:'',direntDetail:'',fileTagList:[]};return _this;}_createClass(FileDetails,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var _this$props2=this.props,dirent=_this$props2.dirent,path=_this$props2.path,repoID=_this$props2.repoID;var direntPath=Utils.joinPath(path,dirent.name);seafileAPI.getFileInfo(repoID,direntPath).then(function(res){_this2.setState({direntType:'file',direntDetail:res.data});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});seafileAPI.listFileTags(repoID,direntPath).then(function(res){var fileTagList=[];res.data.file_tags.forEach(function(item){var file_tag=new FileTag(item);fileTagList.push(file_tag);});_this2.setState({fileTagList:fileTagList});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});}},{key:\"render\",value:function render(){var _this$props3=this.props,dirent=_this$props3.dirent,repoID=_this$props3.repoID,path=_this$props3.path;var smallIconUrl=Utils.getFileIconUrl(dirent.name);var bigIconUrl=Utils.getFileIconUrl(dirent.name,192);var isImg=Utils.imageCheck(dirent.name);var isVideo=Utils.videoCheck(dirent.name);if(isImg||enableVideoThumbnail&&isVideo){bigIconUrl=\"\".concat(siteRoot,\"thumbnail/\").concat(repoID,\"/1024\")+Utils.encodePath(\"\".concat(path==='/'?'':path,\"/\").concat(dirent.name));}return/*#__PURE__*/_jsxs(\"div\",{className:\"detail-container file-details-container\",children:[this.renderHeader(smallIconUrl,dirent.name),this.renderDetailBody(bigIconUrl)]});}}]);return FileDetails;}(React.Component);export default FileDetails;","map":{"version":3,"names":["React","moment","siteRoot","gettext","enableVideoThumbnail","seafileAPI","Utils","toaster","FileTag","FileTagList","jsx","_jsx","jsxs","_jsxs","FileDetails","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","renderHeader","smallIconUrl","direntName","className","children","onClick","togglePanel","src","width","height","alt","title","renderDetailBody","bigIconUrl","direntDetail","state","_this$props","repoName","path","bytesToSize","size","last_modified","fromNow","fileTagList","direntType","_createClass","key","value","componentDidMount","_this2","_this$props2","dirent","repoID","direntPath","joinPath","name","getFileInfo","then","res","setState","data","catch","error","errMessage","getErrorMsg","danger","listFileTags","file_tags","forEach","item","file_tag","push","render","_this$props3","getFileIconUrl","isImg","imageCheck","isVideo","videoCheck","concat","encodePath","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dirent-detail/file-details.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { siteRoot, gettext, enableVideoThumbnail } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport FileTag from '../../models/file-tag';\nimport FileTagList from '../file-tag-list';\n\nimport '../../css/dirent-detail.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  dirent: PropTypes.object.isRequired,\n  path: PropTypes.string.isRequired,\n  togglePanel: PropTypes.func.isRequired\n};\n\nclass FileDetails extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      direntType: '',\n      direntDetail: '',\n      fileTagList: []\n    };\n  }\n\n  componentDidMount() {\n    let { dirent, path, repoID } = this.props;\n    let direntPath = Utils.joinPath(path, dirent.name);\n    seafileAPI.getFileInfo(repoID, direntPath).then(res => {\n      this.setState({\n        direntType: 'file',\n        direntDetail: res.data\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n    seafileAPI.listFileTags(repoID, direntPath).then(res => {\n      let fileTagList = [];\n      res.data.file_tags.forEach(item => {\n        let file_tag = new FileTag(item);\n        fileTagList.push(file_tag);\n      });\n      this.setState({fileTagList: fileTagList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  renderHeader = (smallIconUrl, direntName) => {\n    return (\n      <div className=\"detail-header\">\n        <div className=\"detail-control sf2-icon-x1\" onClick={this.props.togglePanel}></div>\n        <div className=\"detail-title dirent-title\">\n          <img src={smallIconUrl} width=\"24\" height=\"24\" alt=\"\" />{' '}\n          <span className=\"name ellipsis\" title={direntName}>{direntName}</span>\n        </div>\n      </div>\n    );\n  };\n\n  renderDetailBody = (bigIconUrl) => {\n    const { direntDetail } = this.state;\n    const { repoName, path } = this.props;\n    return (\n      <div className=\"detail-body dirent-info\">\n        <div className=\"img\"><img src={bigIconUrl} className=\"thumbnail\" alt=\"\" /></div>\n        {this.state.direntDetail &&\n        <div className=\"dirent-table-container\">\n          <table className=\"table-thead-hidden\">\n            <thead>\n              <tr>\n                <th width=\"35%\"></th>\n                <th width=\"65%\"></th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr><th>{gettext('Size')}</th><td>{Utils.bytesToSize(direntDetail.size)}</td></tr>\n              <tr><th>{gettext('Location')}</th><td>{repoName + path}</td></tr>\n              <tr><th>{gettext('Last Update')}</th><td>{moment(direntDetail.last_modified).fromNow()}</td></tr>\n              <tr className=\"file-tag-container\">\n                <th>{gettext('Tags')}</th>\n                <td>\n                  <FileTagList fileTagList={this.state.fileTagList} />\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n        }\n      </div>\n    );\n  };\n\n  render() {\n    let { dirent, repoID, path } = this.props;\n\n    const smallIconUrl = Utils.getFileIconUrl(dirent.name);\n    let bigIconUrl = Utils.getFileIconUrl(dirent.name, 192);\n    const isImg = Utils.imageCheck(dirent.name);\n    const isVideo = Utils.videoCheck(dirent.name);\n    if (isImg || (enableVideoThumbnail && isVideo)) {\n      bigIconUrl = `${siteRoot}thumbnail/${repoID}/1024` + Utils.encodePath(`${path === '/' ? '' : path}/${dirent.name}`);\n    }\n    return (\n      <div className=\"detail-container file-details-container\">\n        {this.renderHeader(smallIconUrl, dirent.name)}\n        {this.renderDetailBody(bigIconUrl)}\n      </div>\n    );\n  }\n}\n\nFileDetails.propTypes = propTypes;\n\nexport default FileDetails;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}