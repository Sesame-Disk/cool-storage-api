{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _slate = require(\"slate\");\nvar _seafileEditor = require(\"@seafile/seafile-editor\");\nvar getPreviewContent = function getPreviewContent(content) {\n  var isMarkdown = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  var slateNodes = isMarkdown ? (0, _seafileEditor.mdStringToSlate)(content) : content;\n  var previewContent = {\n    previewText: '',\n    images: [],\n    links: [],\n    checklist: {\n      total: 0,\n      completed: 0\n    }\n  };\n  getPreviewInfo(slateNodes, previewContent);\n  getPreviewText(slateNodes, previewContent);\n  return previewContent;\n};\nvar getPreviewInfo = function getPreviewInfo(nodes, previewContent) {\n  var nodeIndex = 0;\n  while (nodes && nodeIndex <= nodes.length - 1) {\n    var currentNode = nodes[nodeIndex];\n    if (currentNode.type === 'link') {\n      previewContent.links.push(currentNode.url);\n    } else if (currentNode.type === 'image') {\n      previewContent.images.push(currentNode.data.src);\n    } else if (currentNode.type === 'check_list_item') {\n      previewContent.checklist.total += 1;\n      if (currentNode.checked) {\n        previewContent.checklist.completed++;\n      }\n      // recalculate child elements\n      getPreviewInfo(currentNode.children, previewContent);\n    } else {\n      getPreviewInfo(currentNode.children, previewContent);\n    }\n    nodeIndex++;\n  }\n};\nvar getPreviewText = function getPreviewText(content, previewContent) {\n  var previewText = '';\n  for (var index = 0; index < content.length; index++) {\n    previewText += getTextOfNode(content[index]) + ' ';\n    var textLength = previewText.length;\n    if (textLength >= 150) {\n      break;\n    }\n  }\n  previewContent.previewText = previewText;\n};\nvar getTextOfNode = function getTextOfNode(node) {\n  var text = '';\n  if (node.type === 'check_list_item') {\n    text += '';\n    return text;\n  }\n  for (var index = 0; index < node.children.length; index++) {\n    var currentNode = node.children[index];\n    var type = currentNode.type;\n    if (type === 'link') {\n      text += '';\n    } else {\n      text += _slate.Node.string(currentNode) + ' ';\n    }\n  }\n  return text;\n};\nvar _default = exports.default = getPreviewContent;","map":{"version":3,"names":["Object","defineProperty","exports","value","default","_slate","require","_seafileEditor","getPreviewContent","content","isMarkdown","arguments","length","undefined","slateNodes","mdStringToSlate","previewContent","previewText","images","links","checklist","total","completed","getPreviewInfo","getPreviewText","nodes","nodeIndex","currentNode","type","push","url","data","src","checked","children","index","getTextOfNode","textLength","node","text","Node","string","_default"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/seafile-editor/dist/utils/get-preview-content.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _slate = require(\"slate\");\nvar _seafileEditor = require(\"@seafile/seafile-editor\");\nconst getPreviewContent = function (content) {\n  let isMarkdown = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  const slateNodes = isMarkdown ? (0, _seafileEditor.mdStringToSlate)(content) : content;\n  let previewContent = {\n    previewText: '',\n    images: [],\n    links: [],\n    checklist: {\n      total: 0,\n      completed: 0\n    }\n  };\n  getPreviewInfo(slateNodes, previewContent);\n  getPreviewText(slateNodes, previewContent);\n  return previewContent;\n};\nconst getPreviewInfo = (nodes, previewContent) => {\n  let nodeIndex = 0;\n  while (nodes && nodeIndex <= nodes.length - 1) {\n    const currentNode = nodes[nodeIndex];\n    if (currentNode.type === 'link') {\n      previewContent.links.push(currentNode.url);\n    } else if (currentNode.type === 'image') {\n      previewContent.images.push(currentNode.data.src);\n    } else if (currentNode.type === 'check_list_item') {\n      previewContent.checklist.total += 1;\n      if (currentNode.checked) {\n        previewContent.checklist.completed++;\n      }\n      // recalculate child elements\n      getPreviewInfo(currentNode.children, previewContent);\n    } else {\n      getPreviewInfo(currentNode.children, previewContent);\n    }\n    nodeIndex++;\n  }\n};\nconst getPreviewText = (content, previewContent) => {\n  let previewText = '';\n  for (let index = 0; index < content.length; index++) {\n    previewText += getTextOfNode(content[index]) + ' ';\n    let textLength = previewText.length;\n    if (textLength >= 150) {\n      break;\n    }\n  }\n  previewContent.previewText = previewText;\n};\nconst getTextOfNode = node => {\n  let text = '';\n  if (node.type === 'check_list_item') {\n    text += '';\n    return text;\n  }\n  for (let index = 0; index < node.children.length; index++) {\n    const currentNode = node.children[index];\n    const {\n      type\n    } = currentNode;\n    if (type === 'link') {\n      text += '';\n    } else {\n      text += _slate.Node.string(currentNode) + ' ';\n    }\n  }\n  return text;\n};\nvar _default = exports.default = getPreviewContent;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}