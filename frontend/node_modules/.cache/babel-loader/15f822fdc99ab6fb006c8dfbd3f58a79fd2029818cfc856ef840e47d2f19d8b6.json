{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from'react';import{seafileAPI}from'../../utils/seafile-api';import{Modal,ModalHeader,ModalBody,ModalFooter,Button}from'reactstrap';import{gettext}from'../../utils/constants';import{Utils}from'../../utils/utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var DeleteRepoDialog=/*#__PURE__*/function(_Component){_inherits(DeleteRepoDialog,_Component);var _super=_createSuper(DeleteRepoDialog);function DeleteRepoDialog(props){var _this;_classCallCheck(this,DeleteRepoDialog);_this=_super.call(this,props);_this.onDeleteRepo=function(){_this.setState({isRequestSended:true},function(){_this.props.onDeleteRepo(_this.props.repo);});};_this.state={isRequestSended:false,sharedToUserCount:0,sharedToGroupCount:0};return _this;}_createClass(DeleteRepoDialog,[{key:\"UNSAFE_componentWillReceiveProps\",value:function UNSAFE_componentWillReceiveProps(nextProps){if(!nextProps.isRepoDeleted){this.setState({isRequestSended:false});}}},{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;seafileAPI.getRepoFolderShareInfo(this.props.repo.repo_id).then(function(res){_this2.setState({sharedToUserCount:res.data['shared_user_emails'].length,sharedToGroupCount:res.data['shared_group_ids'].length});});}},{key:\"render\",value:function render(){var isRequestSended=this.state.isRequestSended;var repo=this.props.repo;var repoName='<span class=\"op-target\">'+Utils.HTMLescape(repo.repo_name||repo.name)+'</span>';var message=gettext('Are you sure you want to delete %s ?');message=message.replace('%s',repoName);var alert_message='';if(this.state.sharedToUserCount>0||this.state.sharedToGroupCount>0){alert_message=gettext('This library has been shared to {user_amount} user(s) and {group_amount} group(s).');alert_message=alert_message.replace('{user_amount}',this.state.sharedToUserCount);alert_message=alert_message.replace('{group_amount}',this.state.sharedToGroupCount);}var toggleDialog=this.props.toggle;return/*#__PURE__*/_jsxs(Modal,{isOpen:true,toggle:toggleDialog,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:toggleDialog,children:gettext('Delete Library')}),/*#__PURE__*/_jsxs(ModalBody,{children:[/*#__PURE__*/_jsx(\"p\",{dangerouslySetInnerHTML:{__html:message}}),alert_message!=''&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",dangerouslySetInnerHTML:{__html:alert_message}})]}),/*#__PURE__*/_jsxs(ModalFooter,{children:[/*#__PURE__*/_jsx(Button,{color:\"secondary\",onClick:toggleDialog,children:gettext('Cancel')}),/*#__PURE__*/_jsx(Button,{color:\"primary\",disabled:isRequestSended,onClick:this.onDeleteRepo,children:gettext('Delete')})]})]});}}]);return DeleteRepoDialog;}(Component);export default DeleteRepoDialog;","map":{"version":3,"names":["React","Component","seafileAPI","Modal","ModalHeader","ModalBody","ModalFooter","Button","gettext","Utils","jsx","_jsx","jsxs","_jsxs","DeleteRepoDialog","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","onDeleteRepo","setState","isRequestSended","repo","state","sharedToUserCount","sharedToGroupCount","_createClass","key","value","UNSAFE_componentWillReceiveProps","nextProps","isRepoDeleted","componentDidMount","_this2","getRepoFolderShareInfo","repo_id","then","res","data","length","render","repoName","HTMLescape","repo_name","name","message","replace","alert_message","toggleDialog","toggle","isOpen","children","dangerouslySetInnerHTML","__html","className","color","onClick","disabled"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/delete-repo-dialog.js"],"sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  repo: PropTypes.object.isRequired,\n  isRepoDeleted: PropTypes.bool.isRequired,\n  toggle: PropTypes.func.isRequired,\n  onDeleteRepo: PropTypes.func.isRequired,\n};\n\nclass DeleteRepoDialog extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isRequestSended: false,\n      sharedToUserCount: 0,\n      sharedToGroupCount: 0,\n    };\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (!nextProps.isRepoDeleted) {\n      this.setState({isRequestSended: false});\n    }\n  }\n\n  componentDidMount() {\n    seafileAPI.getRepoFolderShareInfo(this.props.repo.repo_id).then((res) => {\n      this.setState({\n        sharedToUserCount: res.data['shared_user_emails'].length,\n        sharedToGroupCount: res.data['shared_group_ids'].length,\n      });\n    });\n  }\n\n  onDeleteRepo = () => {\n    this.setState({isRequestSended: true}, () => {\n      this.props.onDeleteRepo(this.props.repo);\n    });\n  };\n\n  render() {\n\n    const { isRequestSended } = this.state;\n    const repo = this.props.repo;\n    const repoName = '<span class=\"op-target\">' + Utils.HTMLescape(repo.repo_name || repo.name) + '</span>';\n    let message = gettext('Are you sure you want to delete %s ?');\n    message = message.replace('%s', repoName);\n\n    let alert_message = '';\n    if (this.state.sharedToUserCount > 0 || this.state.sharedToGroupCount > 0) {\n      alert_message = gettext('This library has been shared to {user_amount} user(s) and {group_amount} group(s).');\n      alert_message = alert_message.replace('{user_amount}', this.state.sharedToUserCount);\n      alert_message = alert_message.replace('{group_amount}', this.state.sharedToGroupCount);\n    }\n\n    const { toggle: toggleDialog } = this.props;\n\n    return (\n      <Modal isOpen={true} toggle={toggleDialog}>\n        <ModalHeader toggle={toggleDialog}>{gettext('Delete Library')}</ModalHeader>\n        <ModalBody>\n          <p dangerouslySetInnerHTML={{__html: message}}></p>\n          { alert_message != '' && <p className=\"error\" dangerouslySetInnerHTML={{__html: alert_message}}></p>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={toggleDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" disabled={isRequestSended} onClick={this.onDeleteRepo}>{gettext('Delete')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nDeleteRepoDialog.propTypes = propTypes;\n\nexport default DeleteRepoDialog;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}