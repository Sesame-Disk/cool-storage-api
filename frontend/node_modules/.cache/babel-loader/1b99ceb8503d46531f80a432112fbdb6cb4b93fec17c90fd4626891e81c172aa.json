{"ast":null,"code":"import _regeneratorRuntime from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Fragment}from'react';import io from'socket.io-client';import{EXTERNAL_EVENTS,EventBus,MarkdownEditor as SeafileMarkdownEditor,MarkdownViewer as SeafileMarkdownViewer}from'@seafile/seafile-editor';import{Utils}from'../../utils/utils';import{seafileAPI}from'../../utils/seafile-api';import{gettext,mediaUrl}from'../../utils/constants';import toaster from'../../components/toast';import ShareDialog from'../../components/dialog/share-dialog';import InsertFileDialog from'../../components/dialog/insert-file-dialog';import HeaderToolbar from'./header-toolbar';import editorApi from'./editor-api';import DetailListView from'./detail-list-view';import'./css/markdown-editor.css';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var CryptoJS=require('crypto-js');var URL=require('url-parse');var _window$app$pageOptio=window.app.pageOptions,repoID=_window$app$pageOptio.repoID,filePath=_window$app$pageOptio.filePath,fileName=_window$app$pageOptio.fileName,isLocked=_window$app$pageOptio.isLocked,lockedByMe=_window$app$pageOptio.lockedByMe;var _window$app$config=window.app.config,siteRoot=_window$app$config.siteRoot,serviceUrl=_window$app$config.serviceUrl,seafileCollabServer=_window$app$config.seafileCollabServer;var userInfo=window.app.userInfo;var IMAGE_SUFFIXES=['png','PNG','jpg','JPG','jpeg','JPEG','gif','GIF'];var MarkdownEditor=/*#__PURE__*/function(_React$Component){_inherits(MarkdownEditor,_React$Component);var _super=_createSuper(MarkdownEditor);function MarkdownEditor(props){var _this;_classCallCheck(this,MarkdownEditor);_this=_super.call(this,props);_this.toggleLockFile=function(){var _this$state$fileInfo=_this.state.fileInfo,repoID=_this$state$fileInfo.repoID,path=_this$state$fileInfo.path;if(_this.state.isLocked){seafileAPI.unlockfile(repoID,path).then(function(res){_this.setState({isLocked:false,lockedByMe:false});});}else{seafileAPI.lockfile(repoID,path).then(function(res){_this.setState({isLocked:true,lockedByMe:true});});}};_this.emitSwitchEditor=function(){var is_editing=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(userInfo&&_this.state.collabServer){var _this$state$fileInfo2=_this.state.fileInfo,_repoID=_this$state$fileInfo2.repoID,path=_this$state$fileInfo2.path;_this.socket.emit('presence',{request:'editing',doc_id:CryptoJS.MD5(_repoID+path).toString(),user:userInfo,is_editing:is_editing});}};_this.toggleCancel=function(){_this.setState({showMarkdownEditorDialog:false,showShareLinkDialog:false,showInsertFileDialog:false});};_this.setEditorMode=function(editorMode){// rich | plain\nvar _window$location=window.location,origin=_window$location.origin,pathname=_window$location.pathname;window.location.href=origin+pathname+'?mode=plain';};_this.clearTimer=function(){clearTimeout(_this.timer);_this.timer=null;};_this.openDialogs=function(option){switch(option){case'share_link':_this.setState({showMarkdownEditorDialog:true,showShareLinkDialog:true});break;case'insert_file':_this.setState({showMarkdownEditorDialog:true,showInsertFileDialog:true});break;default:return;}};_this.onUnload=function(event){var contentChanged=_this.state.contentChanged;if(!contentChanged)return;_this.clearTimer();var confirmationMessage=gettext('Leave this page? The system may not save your changes.');event.returnValue=confirmationMessage;return confirmationMessage;};_this.listFileTags=function(){seafileAPI.listFileTags(repoID,filePath).then(function(res){var fileTagList=res.data.file_tags;for(var i=0;i<fileTagList.length;i++){fileTagList[i].id=fileTagList[i].file_tag_id;}_this.setState({fileTagList:fileTagList});});};_this.onFileTagChanged=function(){_this.listFileTags();};_this.listFileParticipants=function(){editorApi.listFileParticipant().then(function(res){_this.setState({participants:res.data.participant_list});});};_this.onParticipantsChange=function(){_this.listFileParticipants();};_this.setFileInfoMtime=function(fileInfo){var oldFileInfo=_this.state.fileInfo;var newFileInfo=Object.assign({},oldFileInfo,{mtime:fileInfo.mtime,id:fileInfo.id,lastModifier:fileInfo.last_modifier_name});_this.setState({fileInfo:newFileInfo});};_this.toggleStar=function(){var fileInfo=_this.state.fileInfo;var starred=fileInfo.starred;var newFileInfo=Object.assign({},fileInfo,{starred:!starred});if(starred){editorApi.unstarItem().then(function(response){_this.setState({fileInfo:newFileInfo});});return;}editorApi.starItem().then(function(response){_this.setState({fileInfo:newFileInfo});});};_this.toggleShareLinkDialog=function(){_this.openDialogs('share_link');};_this.onInsertImageToggle=function(selection){_this.editorSelection=selection;_this.openDialogs('insert_file');};_this.toggleHistory=function(){window.location.href=siteRoot+'repo/file_revisions/'+repoID+'/?p='+Utils.encodePath(filePath);};_this.getInsertLink=function(repoID,filePath){var selection=_this.editorSelection;var fileName=Utils.getFileName(filePath);var suffix=fileName.slice(fileName.indexOf('.')+1);var eventBus=EventBus.getInstance();if(IMAGE_SUFFIXES.includes(suffix)){var _innerURL=serviceUrl+'/lib/'+repoID+'/file'+Utils.encodePath(filePath)+'?raw=1';eventBus.dispatch(EXTERNAL_EVENTS.INSERT_IMAGE,{title:fileName,url:_innerURL,isImage:true,selection:selection});return;}var innerURL=serviceUrl+'/lib/'+repoID+'/file'+Utils.encodePath(filePath);eventBus.dispatch(EXTERNAL_EVENTS.INSERT_IMAGE,{title:fileName,url:innerURL,selection:selection});};_this.addParticipants=function(){if(_this.isParticipant||!window.showParticipants)return;var userName=editorApi.userName;var participants=_this.state.participants;if(participants&&participants.length!==0){var isParticipant=participants.some(function(participant){return participant.email===userName;});if(isParticipant)return;}var emails=[userName];editorApi.addFileParticipants(emails).then(function(res){_this.isParticipant=true;_this.listFileParticipants();});};_this.onContentChanged=function(){_this.setState({contentChanged:true});};_this.onSaveEditorContent=function(){_this.setState({saving:true});var content=_this.editorRef.current.getValue();editorApi.saveContent(content).then(function(){_this.setState({saving:false,contentChanged:false});_this.lastModifyTime=new Date();var message=gettext('Successfully saved');toaster.success(message,{duration:2});editorApi.getFileInfo().then(function(res){_this.setFileInfoMtime(res.data);});_this.addParticipants();},function(){_this.setState({saving:false});var message=gettext('Failed to save');toaster.danger(message,{duration:2});});};_this.getFileName=function(fileName){return fileName.substring(0,fileName.lastIndexOf('.'));};_this.state={markdownContent:'',loading:true,mode:'editor',fileInfo:{repoID:repoID,name:fileName,path:filePath,mtime:null,size:0,starred:false,permission:'',lastModifier:'',id:''},editorMode:'rich',collabServer:seafileCollabServer?seafileCollabServer:null,showMarkdownEditorDialog:false,showShareLinkDialog:false,showInsertFileDialog:false,collabUsers:userInfo?[{user:userInfo,is_editing:false}]:[],value:null,isShowHistory:false,readOnly:true,contentChanged:false,saving:false,isLocked:isLocked,lockedByMe:lockedByMe,fileTagList:[],participants:[]};_this.timer=null;if(_this.state.collabServer){var socket=io(_this.state.collabServer);_this.socket=socket;socket.on('presence',function(data){return _this.receivePresenceData(data);});socket.on('repo_update',function(data){return _this.receiveUpdateData(data);});socket.on('connect',function(){_this.socket_id=socket.id;});}_this.editorRef=/*#__PURE__*/React.createRef();_this.isParticipant=false;_this.editorSelection=null;return _this;}_createClass(MarkdownEditor,[{key:\"receiveUpdateData\",value:function receiveUpdateData(data){var _this2=this;var currentTime=new Date();if(parseFloat(currentTime-this.lastModifyTime)/1000<=5){return;}editorApi.fileMetaData().then(function(res){if(res.data.id!==_this2.state.fileInfo.id){toaster.notify(/*#__PURE__*/_jsxs(\"span\",{children:[gettext('This file has been updated.'),/*#__PURE__*/_jsxs(\"a\",{href:\"\",children:[' ',gettext('Refresh')]})]}),{id:'repo_updated',duration:3600});}});}},{key:\"receivePresenceData\",value:function receivePresenceData(data){var collabUsers=[];var editingUsers=[];switch(data.response){case'user_join':toaster.notify(\"user \".concat(data.user.name,\" joined\"),{duration:3});return;case'user_left':toaster.notify(\"user \".concat(data.user.name,\" left\"),{duration:3});return;case'update_users':for(var prop in data.users){if(Object.prototype.hasOwnProperty.call(data.users,prop)){if(prop===this.socket_id){data.users[prop]['myself']=true;break;}}}collabUsers=Object.values(data.users);editingUsers=collabUsers.filter(function(ele){return ele.is_editing===true&&ele.myself===undefined;});if(editingUsers.length>0){var message=gettext('Another user is editing this file!');toaster.danger(message,{duration:3});}this.setState({collabUsers:collabUsers});return;case'user_editing':toaster.danger(\"user \".concat(data.user.name,\" is editing this file!\"),{duration:3});return;default:// eslint-disable-next-line\nconsole.log('unknown response type: '+data.response);return;}}},{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var fileIcon,fileInfoRes,_fileInfoRes$data,mtime,size,starred,permission,last_modifier_name,id,lastModifier,fileDownloadUrlRes,downloadUrl,fileContentRes,markdownContent,hasPermission,permissionID,customPermissionRes,customPermission,canModify,fileInfo,_this$state$fileInfo3,_repoID2,path,eventBus;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:fileIcon=Utils.getFileIconUrl(fileName,192);document.getElementById('favicon').href=fileIcon;// get file info\n_context.next=4;return seafileAPI.getFileInfo(repoID,filePath);case 4:fileInfoRes=_context.sent;_fileInfoRes$data=fileInfoRes.data,mtime=_fileInfoRes$data.mtime,size=_fileInfoRes$data.size,starred=_fileInfoRes$data.starred,permission=_fileInfoRes$data.permission,last_modifier_name=_fileInfoRes$data.last_modifier_name,id=_fileInfoRes$data.id;lastModifier=last_modifier_name;// get file download url\n_context.next=9;return seafileAPI.getFileDownloadLink(repoID,filePath);case 9:fileDownloadUrlRes=_context.sent;downloadUrl=fileDownloadUrlRes.data;// get file content\n_context.next=13;return seafileAPI.getFileContent(downloadUrl);case 13:fileContentRes=_context.sent;markdownContent=fileContentRes.data;// init permission\nhasPermission=permission==='rw'||permission==='cloud-edit';// get custom permission\nif(!permission.startsWith('custom-')){_context.next=24;break;}permissionID=permission.split('-')[1];_context.next=20;return seafileAPI.getCustomPermission(repoID,permissionID);case 20:customPermissionRes=_context.sent;customPermission=customPermissionRes.data.permission;canModify=customPermission.permission.modify;hasPermission=canModify?true:hasPermission;case 24:// Goto rich edit page\n// First, the user has the relevant permissions, otherwise he can only enter the viewer interface or cannot access\nfileInfo=this.state.fileInfo;this.setState({loading:false,fileInfo:_objectSpread(_objectSpread({},fileInfo),{},{mtime:mtime,size:size,starred:starred,permission:permission,lastModifier:lastModifier,id:id}),markdownContent:markdownContent,value:'',readOnly:!hasPermission});if(userInfo&&this.socket){_this$state$fileInfo3=this.state.fileInfo,_repoID2=_this$state$fileInfo3.repoID,path=_this$state$fileInfo3.path;this.socket.emit('presence',{request:'join_room',doc_id:CryptoJS.MD5(_repoID2+path).toString(),user:userInfo});this.socket.emit('repo_update',{request:'watch_update',repo_id:editorApi.repoID,user:{name:editorApi.name,username:editorApi.username,contact_email:editorApi.contact_email}});}this.listFileTags();this.listFileParticipants();window.showParticipants=true;setTimeout(function(){var url=new URL(window.location.href);if(url.hash){window.location.href=url;}},100);window.addEventListener('beforeunload',this.onUnload);eventBus=EventBus.getInstance();this.unsubscribeInsertSeafileImage=eventBus.subscribe(EXTERNAL_EVENTS.ON_INSERT_IMAGE,this.onInsertImageToggle);case 34:case\"end\":return _context.stop();}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"componentWillUnmount\",value:function componentWillUnmount(){window.removeEventListener('beforeunload',this.onUnload);this.unsubscribeInsertSeafileImage();if(!this.socket)return;this.socket.emit('repo_update',{request:'unwatch_update',repo_id:editorApi.repoID,user:{name:editorApi.name,username:editorApi.username,contact_email:editorApi.contact_email}});}},{key:\"render\",value:function render(){var _this$state=this.state,loading=_this$state.loading,markdownContent=_this$state.markdownContent,fileInfo=_this$state.fileInfo,fileTagList=_this$state.fileTagList,isLocked=_this$state.isLocked;return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(HeaderToolbar,{editorApi:editorApi,collabUsers:this.state.collabUsers,fileInfo:this.state.fileInfo,toggleStar:this.toggleStar,openDialogs:this.openDialogs,toggleShareLinkDialog:this.toggleShareLinkDialog,onEdit:this.setEditorMode,showFileHistory:this.state.isShowHistory?false:true,toggleHistory:this.toggleHistory,readOnly:this.state.readOnly,editorMode:this.state.editorMode,contentChanged:this.state.contentChanged,saving:this.state.saving,onSaveEditorContent:this.onSaveEditorContent,isLocked:this.state.isLocked,lockedByMe:this.state.lockedByMe,toggleLockFile:this.toggleLockFile}),/*#__PURE__*/_jsxs(\"div\",{className:\"sf-md-viewer-content\",children:[!isLocked&&/*#__PURE__*/_jsx(SeafileMarkdownEditor,{ref:this.editorRef,isFetching:loading,initValue:this.getFileName(fileName),value:markdownContent,editorApi:editorApi,onSave:this.onSaveEditorContent,onContentChanged:this.onContentChanged,mathJaxSource:mediaUrl+'js/mathjax/tex-svg.js',isSupportInsertSeafileImage:true,children:/*#__PURE__*/_jsx(DetailListView,{fileInfo:fileInfo,fileTagList:fileTagList,onFileTagChanged:this.onFileTagChanged})}),isLocked&&/*#__PURE__*/_jsx(SeafileMarkdownViewer,{isFetching:loading,value:markdownContent,mathJaxSource:mediaUrl+'js/mathjax/tex-svg.js',isSupportInsertSeafileImage:true,isShowOutline:true})]}),this.state.showMarkdownEditorDialog&&/*#__PURE__*/_jsxs(React.Fragment,{children:[this.state.showInsertFileDialog&&/*#__PURE__*/_jsx(InsertFileDialog,{repoID:repoID,filePath:filePath,toggleCancel:this.toggleCancel,getInsertLink:this.getInsertLink}),this.state.showShareLinkDialog&&/*#__PURE__*/_jsx(ShareDialog,{itemType:\"file\",itemName:this.state.fileInfo.name,itemPath:filePath,repoID:repoID,toggleDialog:this.toggleCancel,isGroupOwnedRepo:false,repoEncrypted:false})]})]});}}]);return MarkdownEditor;}(React.Component);export default MarkdownEditor;","map":{"version":3,"names":["React","Fragment","io","EXTERNAL_EVENTS","EventBus","MarkdownEditor","SeafileMarkdownEditor","MarkdownViewer","SeafileMarkdownViewer","Utils","seafileAPI","gettext","mediaUrl","toaster","ShareDialog","InsertFileDialog","HeaderToolbar","editorApi","DetailListView","jsxs","_jsxs","jsx","_jsx","CryptoJS","require","URL","_window$app$pageOptio","window","app","pageOptions","repoID","filePath","fileName","isLocked","lockedByMe","_window$app$config","config","siteRoot","serviceUrl","seafileCollabServer","userInfo","IMAGE_SUFFIXES","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","toggleLockFile","_this$state$fileInfo","state","fileInfo","path","unlockfile","then","res","setState","lockfile","emitSwitchEditor","is_editing","arguments","length","undefined","collabServer","_this$state$fileInfo2","socket","emit","request","doc_id","MD5","toString","user","toggleCancel","showMarkdownEditorDialog","showShareLinkDialog","showInsertFileDialog","setEditorMode","editorMode","_window$location","location","origin","pathname","href","clearTimer","clearTimeout","timer","openDialogs","option","onUnload","event","contentChanged","confirmationMessage","returnValue","listFileTags","fileTagList","data","file_tags","i","id","file_tag_id","onFileTagChanged","listFileParticipants","listFileParticipant","participants","participant_list","onParticipantsChange","setFileInfoMtime","oldFileInfo","newFileInfo","Object","assign","mtime","lastModifier","last_modifier_name","toggleStar","starred","unstarItem","response","starItem","toggleShareLinkDialog","onInsertImageToggle","selection","editorSelection","toggleHistory","encodePath","getInsertLink","getFileName","suffix","slice","indexOf","eventBus","getInstance","includes","innerURL","dispatch","INSERT_IMAGE","title","url","isImage","addParticipants","isParticipant","showParticipants","userName","some","participant","email","emails","addFileParticipants","onContentChanged","onSaveEditorContent","saving","content","editorRef","current","getValue","saveContent","lastModifyTime","Date","message","success","duration","getFileInfo","danger","substring","lastIndexOf","markdownContent","loading","mode","name","size","permission","collabUsers","value","isShowHistory","readOnly","on","receivePresenceData","receiveUpdateData","socket_id","createRef","_createClass","key","_this2","currentTime","parseFloat","fileMetaData","notify","children","editingUsers","concat","prop","users","prototype","hasOwnProperty","values","filter","ele","myself","console","log","_componentDidMount","_asyncToGenerator","_regeneratorRuntime","mark","_callee","fileIcon","fileInfoRes","_fileInfoRes$data","fileDownloadUrlRes","downloadUrl","fileContentRes","hasPermission","permissionID","customPermissionRes","customPermission","canModify","_this$state$fileInfo3","_repoID2","wrap","_callee$","_context","prev","next","getFileIconUrl","document","getElementById","sent","getFileDownloadLink","getFileContent","startsWith","split","getCustomPermission","modify","_objectSpread","repo_id","username","contact_email","setTimeout","hash","addEventListener","unsubscribeInsertSeafileImage","subscribe","ON_INSERT_IMAGE","stop","componentDidMount","apply","componentWillUnmount","removeEventListener","render","_this$state","onEdit","showFileHistory","className","ref","isFetching","initValue","onSave","mathJaxSource","isSupportInsertSeafileImage","isShowOutline","itemType","itemName","itemPath","toggleDialog","isGroupOwnedRepo","repoEncrypted","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/pages/markdown-editor/index.js"],"sourcesContent":["import React, { Fragment } from 'react';\nimport io from 'socket.io-client';\nimport {\n  EXTERNAL_EVENTS,\n  EventBus,\n  MarkdownEditor as SeafileMarkdownEditor,\n  MarkdownViewer as SeafileMarkdownViewer,\n} from '@seafile/seafile-editor';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, mediaUrl } from '../../utils/constants';\nimport toaster from '../../components/toast';\nimport ShareDialog from '../../components/dialog/share-dialog';\nimport InsertFileDialog from '../../components/dialog/insert-file-dialog';\nimport HeaderToolbar from './header-toolbar';\nimport editorApi from './editor-api';\nimport DetailListView from './detail-list-view';\n\nimport './css/markdown-editor.css';\n\nconst CryptoJS = require('crypto-js');\nconst URL = require('url-parse');\n\nconst { repoID, filePath, fileName, isLocked, lockedByMe } = window.app.pageOptions;\nconst { siteRoot, serviceUrl, seafileCollabServer } = window.app.config;\nconst userInfo = window.app.userInfo;\nconst IMAGE_SUFFIXES = ['png', 'PNG', 'jpg', 'JPG', 'jpeg', 'JPEG', 'gif', 'GIF'];\n\nclass MarkdownEditor extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      markdownContent: '',\n      loading: true,\n      mode: 'editor',\n      fileInfo: {\n        repoID: repoID,\n        name: fileName,\n        path: filePath,\n        mtime: null,\n        size: 0,\n        starred: false,\n        permission: '',\n        lastModifier: '',\n        id: '',\n      },\n      editorMode: 'rich',\n      collabServer: seafileCollabServer ? seafileCollabServer : null,\n      showMarkdownEditorDialog: false,\n      showShareLinkDialog: false,\n      showInsertFileDialog: false,\n      collabUsers: userInfo ?\n        [{user: userInfo, is_editing: false}] : [],\n      value: null,\n      isShowHistory: false,\n      readOnly: true,\n      contentChanged: false,\n      saving: false,\n      isLocked: isLocked,\n      lockedByMe: lockedByMe,\n      fileTagList: [],\n      participants: [],\n    };\n\n    this.timer = null;\n\n    if (this.state.collabServer) {\n      const socket = io(this.state.collabServer);\n      this.socket = socket;\n      socket.on('presence', (data) => this.receivePresenceData(data));\n      socket.on('repo_update', (data) => this.receiveUpdateData(data));\n      socket.on('connect', () => {\n        this.socket_id = socket.id;\n      });\n    }\n    this.editorRef = React.createRef();\n    this.isParticipant = false;\n    this.editorSelection = null;\n  }\n\n  toggleLockFile = () => {\n    const { repoID, path } = this.state.fileInfo;\n    if (this.state.isLocked) {\n      seafileAPI.unlockfile(repoID, path).then((res) => {\n        this.setState({ isLocked: false, lockedByMe: false });\n      });\n    } else {\n      seafileAPI.lockfile(repoID, path).then((res) => {\n        this.setState({ isLocked: true, lockedByMe: true });\n      });\n    }\n  };\n\n  emitSwitchEditor = (is_editing=false) => {\n    if (userInfo && this.state.collabServer) {\n      const { repoID, path } = this.state.fileInfo;\n      this.socket.emit('presence', {\n        request: 'editing',\n        doc_id: CryptoJS.MD5(repoID+path).toString(),\n        user: userInfo,\n        is_editing,\n      });\n    }\n  };\n\n  receiveUpdateData (data) {\n    let currentTime = new Date();\n    if ((parseFloat(currentTime - this.lastModifyTime)/1000) <= 5) {\n      return;\n    }\n    editorApi.fileMetaData().then((res) => {\n      if (res.data.id !== this.state.fileInfo.id) {\n        toaster.notify(\n          <span>\n            {gettext('This file has been updated.')}\n            <a href='' >{' '}{gettext('Refresh')}</a>\n          </span>,\n          {id: 'repo_updated', duration: 3600});\n      }\n    });\n  }\n\n\n  receivePresenceData(data) {\n    let collabUsers = [];\n    let editingUsers = [];\n    switch(data.response) {\n      case 'user_join':\n        toaster.notify(`user ${data.user.name} joined`, {\n          duration: 3\n        });\n        return;\n\n      case 'user_left':\n        toaster.notify(`user ${data.user.name} left`, {\n          duration: 3\n        });\n        return;\n      case 'update_users':\n        for (var prop in data.users) {\n          if (Object.prototype.hasOwnProperty.call(data.users, prop)) {\n            if (prop === this.socket_id) {\n              data.users[prop]['myself'] = true;\n              break;\n            }\n          }\n        }\n        collabUsers = Object.values(data.users);\n        editingUsers = collabUsers.filter(ele => ele.is_editing === true && ele.myself === undefined);\n        if (editingUsers.length > 0) {\n          const message = gettext('Another user is editing this file!');\n          toaster.danger(message, {duration: 3});\n        }\n        this.setState({ collabUsers });\n        return;\n      case 'user_editing':\n        toaster.danger(`user ${data.user.name} is editing this file!`, {\n          duration: 3\n        });\n        return;\n      default:\n        // eslint-disable-next-line\n        console.log('unknown response type: ' + data.response);\n        return;\n    }\n  }\n\n  toggleCancel = () => {\n    this.setState({\n      showMarkdownEditorDialog: false,\n      showShareLinkDialog: false,\n      showInsertFileDialog: false,\n    });\n  };\n\n  setEditorMode = (editorMode) => { // rich | plain\n    const { origin, pathname } = window.location;\n    window.location.href = origin + pathname + '?mode=plain';\n  };\n\n  clearTimer = () => {\n    clearTimeout(this.timer);\n    this.timer = null;\n  };\n\n  openDialogs = (option) => {\n    switch (option) {\n      case 'share_link':\n        this.setState({\n          showMarkdownEditorDialog: true,\n          showShareLinkDialog: true,\n        });\n        break;\n      case 'insert_file':\n        this.setState({\n          showMarkdownEditorDialog: true,\n          showInsertFileDialog: true,\n        });\n        break;\n      default:\n        return;\n    }\n  };\n\n  async componentDidMount() {\n\n    const fileIcon = Utils.getFileIconUrl(fileName, 192);\n    document.getElementById('favicon').href = fileIcon;\n\n    // get file info\n    const fileInfoRes = await seafileAPI.getFileInfo(repoID, filePath);\n    const { mtime, size, starred, permission, last_modifier_name, id } = fileInfoRes.data;\n    const lastModifier = last_modifier_name;\n\n    // get file download url\n    const fileDownloadUrlRes = await seafileAPI.getFileDownloadLink(repoID, filePath);\n    const downloadUrl = fileDownloadUrlRes.data;\n\n    // get file content\n    const fileContentRes = await seafileAPI.getFileContent(downloadUrl);\n    const markdownContent = fileContentRes.data;\n\n    // init permission\n    let hasPermission = permission === 'rw' || permission === 'cloud-edit';\n\n    // get custom permission\n    if (permission.startsWith('custom-')) {\n      const permissionID = permission.split('-')[1];\n      const customPermissionRes = await seafileAPI.getCustomPermission(repoID, permissionID);\n      const customPermission = customPermissionRes.data.permission;\n      const { modify: canModify } = customPermission.permission;\n      hasPermission = canModify ? true : hasPermission;\n    }\n\n    // Goto rich edit page\n    // First, the user has the relevant permissions, otherwise he can only enter the viewer interface or cannot access\n    const { fileInfo } = this.state;\n    this.setState({\n      loading: false,\n      fileInfo: {...fileInfo, mtime, size, starred, permission, lastModifier, id},\n      markdownContent,\n      value: '',\n      readOnly: !hasPermission,\n    });\n\n    if (userInfo && this.socket) {\n      const { repoID, path } = this.state.fileInfo;\n      this.socket.emit('presence', {\n        request: 'join_room',\n        doc_id: CryptoJS.MD5(repoID+path).toString(),\n        user: userInfo\n      });\n\n      this.socket.emit('repo_update', {\n        request: 'watch_update',\n        repo_id: editorApi.repoID,\n        user: {\n          name: editorApi.name,\n          username: editorApi.username,\n          contact_email: editorApi.contact_email,\n        },\n      });\n    }\n    this.listFileTags();\n\n    this.listFileParticipants();\n    window.showParticipants = true;\n    setTimeout(() => {\n      let url = new URL(window.location.href);\n      if (url.hash) {\n        window.location.href = url;\n      }\n    }, 100);\n    window.addEventListener('beforeunload', this.onUnload);\n    const eventBus = EventBus.getInstance();\n    this.unsubscribeInsertSeafileImage = eventBus.subscribe(EXTERNAL_EVENTS.ON_INSERT_IMAGE, this.onInsertImageToggle);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('beforeunload', this.onUnload);\n    this.unsubscribeInsertSeafileImage();\n    if (!this.socket) return;\n    this.socket.emit('repo_update', {\n      request: 'unwatch_update',\n      repo_id: editorApi.repoID,\n      user: {\n        name: editorApi.name,\n        username: editorApi.username,\n        contact_email: editorApi.contact_email,\n      },\n    });\n  }\n\n  onUnload = (event) => {\n    const { contentChanged } = this.state;\n    if (!contentChanged) return;\n    this.clearTimer();\n\n    const confirmationMessage = gettext('Leave this page? The system may not save your changes.');\n    event.returnValue = confirmationMessage;\n    return confirmationMessage;\n  };\n\n  listFileTags = () => {\n    seafileAPI.listFileTags(repoID, filePath).then(res => {\n      let fileTagList = res.data.file_tags;\n      for (let i = 0; i < fileTagList.length; i++) {\n        fileTagList[i].id = fileTagList[i].file_tag_id;\n      }\n      this.setState({ fileTagList: fileTagList });\n    });\n  };\n\n  onFileTagChanged = () => {\n    this.listFileTags();\n  };\n\n  listFileParticipants = () => {\n    editorApi.listFileParticipant().then((res) => {\n      this.setState({ participants: res.data.participant_list });\n    });\n  };\n\n  onParticipantsChange = () => {\n    this.listFileParticipants();\n  };\n\n  setFileInfoMtime = (fileInfo) => {\n    const { fileInfo: oldFileInfo } = this.state;\n    const newFileInfo = Object.assign({}, oldFileInfo, { mtime: fileInfo.mtime, id: fileInfo.id, lastModifier: fileInfo.last_modifier_name });\n    this.setState({fileInfo: newFileInfo});\n  };\n\n  toggleStar = () => {\n    const { fileInfo } = this.state;\n    const { starred } = fileInfo;\n    const newFileInfo = Object.assign({}, fileInfo, {starred: !starred});\n    if (starred) {\n      editorApi.unstarItem().then((response) => {\n        this.setState({fileInfo: newFileInfo});\n      });\n      return;\n    }\n\n    editorApi.starItem().then((response) => {\n      this.setState({fileInfo: newFileInfo});\n    });\n  };\n\n  toggleShareLinkDialog = () => {\n    this.openDialogs('share_link');\n  };\n\n  onInsertImageToggle = (selection) => {\n    this.editorSelection = selection;\n    this.openDialogs('insert_file');\n  };\n\n  toggleHistory = () => {\n    window.location.href = siteRoot + 'repo/file_revisions/' + repoID + '/?p=' + Utils.encodePath(filePath);\n  };\n\n  getInsertLink = (repoID, filePath) => {\n    const selection = this.editorSelection;\n    const fileName = Utils.getFileName(filePath);\n    const suffix = fileName.slice(fileName.indexOf('.') + 1);\n    const eventBus = EventBus.getInstance();\n    if (IMAGE_SUFFIXES.includes(suffix)) {\n      let innerURL = serviceUrl + '/lib/' + repoID + '/file' + Utils.encodePath(filePath) + '?raw=1';\n      eventBus.dispatch(EXTERNAL_EVENTS.INSERT_IMAGE, { title: fileName, url: innerURL, isImage: true, selection });\n      return;\n    }\n    let innerURL = serviceUrl + '/lib/' + repoID + '/file' + Utils.encodePath(filePath);\n    eventBus.dispatch(EXTERNAL_EVENTS.INSERT_IMAGE, { title: fileName, url: innerURL, selection});\n  };\n\n  addParticipants = () => {\n    if (this.isParticipant || !window.showParticipants) return;\n    const { userName } = editorApi;\n    const { participants } = this.state;\n    if (participants && participants.length !== 0) {\n      const isParticipant = participants.some((participant) => {\n        return participant.email === userName;\n      });\n      if (isParticipant) return;\n    }\n\n    const emails = [userName];\n    editorApi.addFileParticipants(emails).then((res) => {\n      this.isParticipant = true;\n      this.listFileParticipants();\n    });\n  };\n\n  onContentChanged = () => {\n    this.setState({ contentChanged: true });\n  };\n\n  onSaveEditorContent = () => {\n    this.setState({ saving: true });\n    const content = this.editorRef.current.getValue();\n    editorApi.saveContent(content).then(() => {\n      this.setState({\n        saving: false,\n        contentChanged: false,\n      });\n\n      this.lastModifyTime = new Date();\n      const message = gettext('Successfully saved');\n      toaster.success(message, {duration: 2,});\n\n      editorApi.getFileInfo().then((res) => {\n        this.setFileInfoMtime(res.data);\n      });\n\n      this.addParticipants();\n    }, () => {\n      this.setState({ saving: false });\n      const message = gettext('Failed to save');\n      toaster.danger(message, {duration: 2});\n    });\n  };\n\n  getFileName = (fileName) => {\n    return fileName.substring(0, fileName.lastIndexOf('.'));\n  };\n\n  render() {\n    const { loading, markdownContent, fileInfo, fileTagList, isLocked } = this.state;\n\n    return (\n      <Fragment>\n        <HeaderToolbar\n          editorApi={editorApi}\n          collabUsers={this.state.collabUsers}\n          fileInfo={this.state.fileInfo}\n          toggleStar={this.toggleStar}\n          openDialogs={this.openDialogs}\n          toggleShareLinkDialog={this.toggleShareLinkDialog}\n          onEdit={this.setEditorMode}\n          showFileHistory={this.state.isShowHistory ? false : true }\n          toggleHistory={this.toggleHistory}\n          readOnly={this.state.readOnly}\n          editorMode={this.state.editorMode}\n          contentChanged={this.state.contentChanged}\n          saving={this.state.saving}\n          onSaveEditorContent={this.onSaveEditorContent}\n          isLocked={this.state.isLocked}\n          lockedByMe={this.state.lockedByMe}\n          toggleLockFile={this.toggleLockFile}\n        />\n        <div className='sf-md-viewer-content'>\n          {!isLocked && (\n            <SeafileMarkdownEditor\n              ref={this.editorRef}\n              isFetching={loading}\n              initValue={this.getFileName(fileName)}\n              value={markdownContent}\n              editorApi={editorApi}\n              onSave={this.onSaveEditorContent}\n              onContentChanged={this.onContentChanged}\n              mathJaxSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n              isSupportInsertSeafileImage={true}\n            >\n              <DetailListView fileInfo={fileInfo} fileTagList={fileTagList} onFileTagChanged={this.onFileTagChanged}/>\n            </SeafileMarkdownEditor>\n          )}\n          {isLocked && (\n            <SeafileMarkdownViewer\n              isFetching={loading}\n              value={markdownContent}\n              mathJaxSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n              isSupportInsertSeafileImage={true}\n              isShowOutline={true}\n            >\n            </SeafileMarkdownViewer>\n          )}\n        </div>\n        {this.state.showMarkdownEditorDialog && (\n          <React.Fragment>\n            {this.state.showInsertFileDialog &&\n              <InsertFileDialog\n                repoID={repoID}\n                filePath={filePath}\n                toggleCancel={this.toggleCancel}\n                getInsertLink={this.getInsertLink}\n              />\n            }\n            {this.state.showShareLinkDialog &&\n              <ShareDialog\n                itemType=\"file\"\n                itemName={this.state.fileInfo.name}\n                itemPath={filePath}\n                repoID={repoID}\n                toggleDialog={this.toggleCancel}\n                isGroupOwnedRepo={false}\n                repoEncrypted={false}\n              />\n            }\n          </React.Fragment>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nexport default  MarkdownEditor;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}