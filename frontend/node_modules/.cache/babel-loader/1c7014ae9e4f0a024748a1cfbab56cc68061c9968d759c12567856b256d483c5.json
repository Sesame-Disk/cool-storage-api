{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Fragment}from'react';import{SimpleEditor}from'@seafile/sdoc-editor';import ExternalOperations from'./external-operations';import{seafileAPI}from'../../../utils/seafile-api';import Dirent from'../../../models/dirent';import{Utils}from'../../../utils/utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SdocEditor=/*#__PURE__*/function(_React$Component){_inherits(SdocEditor,_React$Component);var _super=_createSuper(SdocEditor);function SdocEditor(props){var _this;_classCallCheck(this,SdocEditor);_this=_super.call(this,props);_this.toggleStar=function(isStarred){_this.setState({isStarred:isStarred});};_this.onSetFavicon=function(suffix){var docName=window.seafile.docName;if(suffix){docName=docName+suffix;}var fileIcon=Utils.getFileIconUrl(docName,192);document.getElementById('favicon').href=fileIcon;};_this.onNewNotification=function(){_this.onSetFavicon('_notification');};_this.onClearNotification=function(){_this.onSetFavicon();};_this.getDirPath=function(){var docPath=window.seafile.docPath;var index=docPath.lastIndexOf('/');if(index){return docPath.slice(0,index);}return'/';};_this.getDirentList=function(){var repoID=window.seafile.repoID;var path=_this.getDirPath();seafileAPI.listDir(repoID,path,{'with_thumbnail':true}).then(function(res){var direntList=[];res.data.dirent_list.forEach(function(item){var dirent=new Dirent(item);direntList.push(dirent);});_this.setState({direntList:direntList});}).catch(function(err){Utils.getErrorMsg(err,true);});};var _window$app$pageOptio=window.app.pageOptions,_isStarred=_window$app$pageOptio.isStarred,isSdocDraft=_window$app$pageOptio.isSdocDraft;_this.state={isStarred:_isStarred,isDraft:isSdocDraft,direntList:[]};return _this;}_createClass(SdocEditor,[{key:\"componentDidMount\",value:function componentDidMount(){this.onSetFavicon();this.getDirentList();}},{key:\"render\",value:function render(){var _window$seafile=window.seafile,repoID=_window$seafile.repoID,docPath=_window$seafile.docPath,docName=_window$seafile.docName,docPerm=_window$seafile.docPerm;var _this$state=this.state,isStarred=_this$state.isStarred,isDraft=_this$state.isDraft,direntList=_this$state.direntList;var dirPath=this.getDirPath();return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(SimpleEditor,{isStarred:isStarred,isDraft:isDraft}),/*#__PURE__*/_jsx(ExternalOperations,{repoID:repoID,docPath:docPath,docName:docName,docPerm:docPerm,isStarred:isStarred,direntList:direntList,dirPath:dirPath,toggleStar:this.toggleStar,onNewNotification:this.onNewNotification,onClearNotification:this.onClearNotification})]});}}]);return SdocEditor;}(React.Component);export{SdocEditor as default};","map":{"version":3,"names":["React","Fragment","SimpleEditor","ExternalOperations","seafileAPI","Dirent","Utils","jsx","_jsx","jsxs","_jsxs","SdocEditor","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","toggleStar","isStarred","setState","onSetFavicon","suffix","docName","window","seafile","fileIcon","getFileIconUrl","document","getElementById","href","onNewNotification","onClearNotification","getDirPath","docPath","index","lastIndexOf","slice","getDirentList","repoID","path","listDir","then","res","direntList","data","dirent_list","forEach","item","dirent","push","catch","err","getErrorMsg","_window$app$pageOptio","app","pageOptions","isSdocDraft","state","isDraft","_createClass","key","value","componentDidMount","render","_window$seafile","docPerm","_this$state","dirPath","children","Component","default"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/pages/sdoc/sdoc-editor/index.js"],"sourcesContent":["import React, { Fragment } from 'react';\nimport { SimpleEditor } from '@seafile/sdoc-editor';\nimport ExternalOperations from './external-operations';\nimport { seafileAPI } from '../../../utils/seafile-api';\nimport Dirent from '../../../models/dirent';\nimport { Utils } from '../../../utils/utils';\n\nexport default class SdocEditor extends React.Component {\n\n  constructor(props) {\n    super(props);\n    const { isStarred, isSdocDraft } = window.app.pageOptions;\n    this.state = {\n      isStarred: isStarred,\n      isDraft: isSdocDraft,\n      direntList: []\n    };\n  }\n\n  componentDidMount() {\n    this.onSetFavicon();\n    this.getDirentList();\n  }\n\n  toggleStar = (isStarred) => {\n    this.setState({ isStarred: isStarred });\n  };\n\n  onSetFavicon = (suffix) => {\n    let { docName } = window.seafile;\n    if (suffix) {\n      docName = docName + suffix;\n    }\n    const fileIcon = Utils.getFileIconUrl(docName, 192);\n    document.getElementById('favicon').href = fileIcon;\n  };\n\n  onNewNotification = () => {\n    this.onSetFavicon('_notification');\n  };\n\n  onClearNotification = () => {\n    this.onSetFavicon();\n  };\n\n  getDirPath = () => {\n    const { docPath } = window.seafile;\n    const index = docPath.lastIndexOf('/');\n    if (index) {\n      return docPath.slice(0, index);\n    }\n    return '/';\n  };\n\n  getDirentList = () => {\n    const { repoID } = window.seafile;\n    const path = this.getDirPath();\n    seafileAPI.listDir(repoID, path, { 'with_thumbnail': true }).then(res => {\n      let direntList = [];\n      res.data.dirent_list.forEach(item => {\n        let dirent = new Dirent(item);\n        direntList.push(dirent);\n      });\n      this.setState({\n        direntList: direntList\n      });\n    }).catch((err) => {\n      Utils.getErrorMsg(err, true);\n    });\n  };\n\n  render() {\n    const { repoID, docPath, docName, docPerm } = window.seafile;\n    const { isStarred, isDraft, direntList } = this.state;\n    const dirPath = this.getDirPath();\n    return (\n      <Fragment>\n        <SimpleEditor isStarred={isStarred} isDraft={isDraft} />\n        <ExternalOperations\n          repoID={repoID}\n          docPath={docPath}\n          docName={docName}\n          docPerm={docPerm}\n          isStarred={isStarred}\n          direntList={direntList}\n          dirPath={dirPath}\n          toggleStar={this.toggleStar}\n          onNewNotification={this.onNewNotification}\n          onClearNotification={this.onClearNotification}\n        />\n      </Fragment>\n    );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}