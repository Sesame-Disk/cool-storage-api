{"ast":null,"code":"import _defineProperty from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport { DOC_NOTIFICATION_REDUCER_TYPE } from '../constants';\nimport { Notification } from '../../../model';\nimport { EventBus } from '../../';\nimport { INTERNAL_EVENT } from '../../constants';\nexport var initNotificationsInfo = {\n  isFetching: true,\n  notifications_map: {},\n  error: false\n};\nexport var notificationReducer = function notificationReducer(state, action) {\n  switch (action.type) {\n    case DOC_NOTIFICATION_REDUCER_TYPE.FETCHING:\n      {\n        return initNotificationsInfo;\n      }\n    case DOC_NOTIFICATION_REDUCER_TYPE.FETCHED:\n      {\n        var notifications = action.payload;\n        var notificationsMap = {};\n        notifications.forEach(function (n) {\n          var newNotification = new Notification(n);\n          notificationsMap[newNotification.key] = newNotification;\n        });\n        return {\n          isFetching: false,\n          notifications_map: notificationsMap,\n          error: false\n        };\n      }\n    case DOC_NOTIFICATION_REDUCER_TYPE.FETCH_ERROR:\n      {\n        return {\n          isFetching: false,\n          notifications_map: {},\n          error: true\n        };\n      }\n    case DOC_NOTIFICATION_REDUCER_TYPE.ADD:\n      {\n        var notification = action.payload.notification;\n        var newNotification = new Notification(notification);\n        return _objectSpread(_objectSpread({}, state), {}, {\n          notifications_map: _objectSpread(_objectSpread({}, state.notifications_map), {}, _defineProperty({}, newNotification.key, newNotification))\n        });\n      }\n    case DOC_NOTIFICATION_REDUCER_TYPE.DEL:\n      {\n        var notificationKeys = action.payload;\n        var notifications_map = state.notifications_map;\n        if (Array.isArray(notificationKeys) && notificationKeys.length > 0) {\n          notificationKeys.forEach(function (notificationKey) {\n            if (notifications_map[notificationKey]) {\n              delete notifications_map[notificationKey];\n            }\n          });\n        }\n        var eventBus = EventBus.getInstance();\n        eventBus.dispatch(INTERNAL_EVENT.UNSEEN_NOTIFICATIONS_COUNT, Object.keys(notifications_map).length);\n        return _objectSpread(_objectSpread({}, state), {}, {\n          notifications_map: notifications_map\n        });\n      }\n    default:\n      {\n        return state;\n      }\n  }\n};","map":{"version":3,"names":["_objectSpread","DOC_NOTIFICATION_REDUCER_TYPE","Notification","EventBus","INTERNAL_EVENT","initNotificationsInfo","isFetching","notifications_map","error","notificationReducer","state","action","type","FETCHING","FETCHED","notifications","payload","notificationsMap","forEach","n","newNotification","key","FETCH_ERROR","ADD","notification","_defineProperty","DEL","notificationKeys","Array","isArray","length","notificationKey","eventBus","getInstance","dispatch","UNSEEN_NOTIFICATIONS_COUNT","Object","keys"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/comment/reducer/notification-reducer.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport { DOC_NOTIFICATION_REDUCER_TYPE } from '../constants';\nimport { Notification } from '../../../model';\nimport { EventBus } from '../../';\nimport { INTERNAL_EVENT } from '../../constants';\nexport const initNotificationsInfo = {\n  isFetching: true,\n  notifications_map: {},\n  error: false\n};\nexport const notificationReducer = (state, action) => {\n  switch (action.type) {\n    case DOC_NOTIFICATION_REDUCER_TYPE.FETCHING:\n      {\n        return initNotificationsInfo;\n      }\n    case DOC_NOTIFICATION_REDUCER_TYPE.FETCHED:\n      {\n        const notifications = action.payload;\n        let notificationsMap = {};\n        notifications.forEach(n => {\n          const newNotification = new Notification(n);\n          notificationsMap[newNotification.key] = newNotification;\n        });\n        return {\n          isFetching: false,\n          notifications_map: notificationsMap,\n          error: false\n        };\n      }\n    case DOC_NOTIFICATION_REDUCER_TYPE.FETCH_ERROR:\n      {\n        return {\n          isFetching: false,\n          notifications_map: {},\n          error: true\n        };\n      }\n    case DOC_NOTIFICATION_REDUCER_TYPE.ADD:\n      {\n        const {\n          notification\n        } = action.payload;\n        const newNotification = new Notification(notification);\n        return _objectSpread(_objectSpread({}, state), {}, {\n          notifications_map: _objectSpread(_objectSpread({}, state.notifications_map), {}, {\n            [newNotification.key]: newNotification\n          })\n        });\n      }\n    case DOC_NOTIFICATION_REDUCER_TYPE.DEL:\n      {\n        const notificationKeys = action.payload;\n        const {\n          notifications_map\n        } = state;\n        if (Array.isArray(notificationKeys) && notificationKeys.length > 0) {\n          notificationKeys.forEach(notificationKey => {\n            if (notifications_map[notificationKey]) {\n              delete notifications_map[notificationKey];\n            }\n          });\n        }\n        const eventBus = EventBus.getInstance();\n        eventBus.dispatch(INTERNAL_EVENT.UNSEEN_NOTIFICATIONS_COUNT, Object.keys(notifications_map).length);\n        return _objectSpread(_objectSpread({}, state), {}, {\n          notifications_map\n        });\n      }\n    default:\n      {\n        return state;\n      }\n  }\n};"],"mappings":";AAAA,OAAOA,aAAa,MAAM,0CAA0C;AACpE,SAASC,6BAA6B,QAAQ,cAAc;AAC5D,SAASC,YAAY,QAAQ,gBAAgB;AAC7C,SAASC,QAAQ,QAAQ,QAAQ;AACjC,SAASC,cAAc,QAAQ,iBAAiB;AAChD,OAAO,IAAMC,qBAAqB,GAAG;EACnCC,UAAU,EAAE,IAAI;EAChBC,iBAAiB,EAAE,CAAC,CAAC;EACrBC,KAAK,EAAE;AACT,CAAC;AACD,OAAO,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAmBA,CAAIC,KAAK,EAAEC,MAAM,EAAK;EACpD,QAAQA,MAAM,CAACC,IAAI;IACjB,KAAKX,6BAA6B,CAACY,QAAQ;MACzC;QACE,OAAOR,qBAAqB;MAC9B;IACF,KAAKJ,6BAA6B,CAACa,OAAO;MACxC;QACE,IAAMC,aAAa,GAAGJ,MAAM,CAACK,OAAO;QACpC,IAAIC,gBAAgB,GAAG,CAAC,CAAC;QACzBF,aAAa,CAACG,OAAO,CAAC,UAAAC,CAAC,EAAI;UACzB,IAAMC,eAAe,GAAG,IAAIlB,YAAY,CAACiB,CAAC,CAAC;UAC3CF,gBAAgB,CAACG,eAAe,CAACC,GAAG,CAAC,GAAGD,eAAe;QACzD,CAAC,CAAC;QACF,OAAO;UACLd,UAAU,EAAE,KAAK;UACjBC,iBAAiB,EAAEU,gBAAgB;UACnCT,KAAK,EAAE;QACT,CAAC;MACH;IACF,KAAKP,6BAA6B,CAACqB,WAAW;MAC5C;QACE,OAAO;UACLhB,UAAU,EAAE,KAAK;UACjBC,iBAAiB,EAAE,CAAC,CAAC;UACrBC,KAAK,EAAE;QACT,CAAC;MACH;IACF,KAAKP,6BAA6B,CAACsB,GAAG;MACpC;QACE,IACEC,YAAY,GACVb,MAAM,CAACK,OAAO,CADhBQ,YAAY;QAEd,IAAMJ,eAAe,GAAG,IAAIlB,YAAY,CAACsB,YAAY,CAAC;QACtD,OAAOxB,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,EAAEU,KAAK,CAAC,EAAE,CAAC,CAAC,EAAE;UACjDH,iBAAiB,EAAEP,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,EAAEU,KAAK,CAACH,iBAAiB,CAAC,EAAE,CAAC,CAAC,EAAAkB,eAAA,KAC5EL,eAAe,CAACC,GAAG,EAAGD,eAAe,CACvC;QACH,CAAC,CAAC;MACJ;IACF,KAAKnB,6BAA6B,CAACyB,GAAG;MACpC;QACE,IAAMC,gBAAgB,GAAGhB,MAAM,CAACK,OAAO;QACvC,IACET,iBAAiB,GACfG,KAAK,CADPH,iBAAiB;QAEnB,IAAIqB,KAAK,CAACC,OAAO,CAACF,gBAAgB,CAAC,IAAIA,gBAAgB,CAACG,MAAM,GAAG,CAAC,EAAE;UAClEH,gBAAgB,CAACT,OAAO,CAAC,UAAAa,eAAe,EAAI;YAC1C,IAAIxB,iBAAiB,CAACwB,eAAe,CAAC,EAAE;cACtC,OAAOxB,iBAAiB,CAACwB,eAAe,CAAC;YAC3C;UACF,CAAC,CAAC;QACJ;QACA,IAAMC,QAAQ,GAAG7B,QAAQ,CAAC8B,WAAW,CAAC,CAAC;QACvCD,QAAQ,CAACE,QAAQ,CAAC9B,cAAc,CAAC+B,0BAA0B,EAAEC,MAAM,CAACC,IAAI,CAAC9B,iBAAiB,CAAC,CAACuB,MAAM,CAAC;QACnG,OAAO9B,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,EAAEU,KAAK,CAAC,EAAE,CAAC,CAAC,EAAE;UACjDH,iBAAiB,EAAjBA;QACF,CAAC,CAAC;MACJ;IACF;MACE;QACE,OAAOG,KAAK;MACd;EACJ;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}