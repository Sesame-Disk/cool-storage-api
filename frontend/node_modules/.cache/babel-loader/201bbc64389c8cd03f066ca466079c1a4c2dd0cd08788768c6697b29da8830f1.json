{"ast":null,"code":"import{mediaUrl,gettext,serviceURL,siteRoot,isPro,fileAuditEnabled,canGenerateShareLink,canGenerateUploadLink,shareLinkPasswordMinLength,username,folderPermEnabled,onlyofficeConverterExtensions,enableOnlyoffice,enableSeadoc}from'./constants';import TextTranslation from'./text-translation';import React from'react';import toaster from'../components/toast';import PermissionDeniedTip from'../components/permission-denied-tip';import{compareTwoString}from'./compare-two-string';import{jsx as _jsx}from\"react/jsx-runtime\";export var Utils={keyCodes:{enter:13,esc:27,space:32,tab:9,up:38,down:40},bytesToSize:function bytesToSize(bytes){if(typeof bytes=='undefined')return' ';if(bytes<0)return'--';var sizes=['bytes','KB','MB','GB','TB','PB'];if(bytes===0)return bytes+' '+sizes[0];var i=parseInt(Math.floor(Math.log(bytes)/Math.log(1000)),10);if(i===0)return bytes+' '+sizes[i];return(bytes/Math.pow(1000,i)).toFixed(1)+' '+sizes[i];},isHiDPI:function isHiDPI(){var pixelRatio=window.devicePixelRatio?window.devicePixelRatio:1;if(pixelRatio>1){return true;}else{return false;}},isDesktop:function isDesktop(){return window.innerWidth>=768;},isWeChat:function isWeChat(){var ua=window.navigator.userAgent.toLowerCase();var isWeChat=ua.match(/MicroMessenger/i)=='micromessenger';var isEnterpriseWeChat=ua.match(/MicroMessenger/i)=='micromessenger'&&ua.match(/wxwork/i)=='wxwork';return isEnterpriseWeChat||isWeChat;},FILEEXT_ICON_MAP:{// text file\n'md':'txt.png','txt':'txt.png',// pdf file\n'pdf':'pdf.png',// document file\n'doc':'word.png','docx':'word.png','odt':'word.png','fodt':'word.png','ppt':'ppt.png','pptx':'ppt.png','odp':'ppt.png','fodp':'ppt.png','xls':'excel.png','xlsx':'excel.png','ods':'excel.png','fods':'excel.png',// video\n'mp4':'video.png','ogv':'video.png','webm':'video.png','mov':'video.png','flv':'video.png','wmv':'video.png','rmvb':'video.png',// music file\n'mp3':'music.png','oga':'music.png','ogg':'music.png','wav':'music.png','flac':'music.png','opus':'music.png','aac':'music.png','ac3':'music.png','wma':'music.png',// image file\n'jpg':'pic.png','jpeg':'pic.png','png':'pic.png','svg':'pic.png','gif':'pic.png','bmp':'pic.png','ico':'pic.png',// default\n'default':'file.png','sdoc':'sdoc.png','sdoc_notification':'sdoc_notification.ico'},// check if a file is an image\nimageCheck:function imageCheck(filename){// no file ext\nif(filename.lastIndexOf('.')==-1){return false;}var file_ext=filename.substr(filename.lastIndexOf('.')+1).toLowerCase();var image_exts=['gif','jpeg','jpg','png','ico','bmp','tif','tiff','jfif'];if(image_exts.indexOf(file_ext)!=-1){return true;}else{return false;}},getShareLinkPermissionList:function getShareLinkPermissionList(itemType,permission,path,canEdit){// itemType: library, dir, file\n// permission: rw, r, admin, cloud-edit, preview, custom-*\nvar permissionOptions=[];var _Utils$getUserPermiss=Utils.getUserPermission(permission),isCustomPermission=_Utils$getUserPermiss.isCustomPermission;if(isCustomPermission){permissionOptions.push('preview_download');permissionOptions.push('preview_only');return permissionOptions;}if(permission=='rw'||permission=='admin'||permission=='r'){permissionOptions.push('preview_download');}permissionOptions.push('preview_only');if(itemType=='library'||itemType=='dir'){if(permission=='rw'||permission=='admin'){permissionOptions.push('download_upload');}}else{if(this.isEditableOfficeFile(path)&&(permission=='rw'||permission=='admin')&&canEdit){permissionOptions.push('edit_download');}// not support\n// if (this.isEditableOfficeFile(path) && (permission == 'cloud-edit')) {\n//   permissionOptions.push('cloud_edit');\n// }\n}return permissionOptions;},getShareLinkPermissionStr:function getShareLinkPermissionStr(permissions){var can_edit=permissions.can_edit,can_download=permissions.can_download,can_upload=permissions.can_upload;switch(\"\".concat(can_edit,\" \").concat(can_download,\" \").concat(can_upload)){case'false true false':return'preview_download';case'false false false':return'preview_only';case'false true true':return'download_upload';case'true true false':return'edit_download';case'true false false':return'cloud_edit';}},isEditableOfficeFile:function isEditableOfficeFile(filename){// no file ext\nif(filename.lastIndexOf('.')==-1){return false;}var file_ext=filename.substr(filename.lastIndexOf('.')+1).toLowerCase();var exts=['docx','pptx','xlsx'];if(exts.indexOf(file_ext)!=-1){return true;}else{return false;}},// check if a file is a video\nvideoCheck:function videoCheck(filename){// no file ext\nif(filename.lastIndexOf('.')==-1){return false;}var file_ext=filename.substr(filename.lastIndexOf('.')+1).toLowerCase();var exts=['mp4','ogv','webm','mov'];if(exts.indexOf(file_ext)!=-1){return true;}else{return false;}},checkDuplicatedNameInList:function checkDuplicatedNameInList(list,targetName){return list.some(function(object){return object.name===targetName;});},encodePath:function encodePath(path){// IE8 does not support 'map()'\n/*\n       return path.split('/').map(function(e) {\n       return encodeURIComponent(e);\n       }).join('/');\n       */if(!path){return'';}var path_arr=path.split('/');var path_arr_=[];for(var i=0,len=path_arr.length;i<len;i++){path_arr_.push(encodeURIComponent(path_arr[i]));}return path_arr_.join('/');},HTMLescape:function HTMLescape(html){return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;},generateDialogTitle:function generateDialogTitle(title,operationTarget){/*\n     * @param title: gettext('...{placeholder}...')\n     */ /*\n    const targetStr = this.HTMLescape(operationTarget);\n    const str = `<span class=\"op-target ellipsis ellipsis-op-target\" title=${targetStr}>${targetStr}</span>`;\n    return title.replace('{placeholder}', str);\n    */return title.replace('{placeholder}',operationTarget);},getFileName:function getFileName(filePath){var lastIndex=filePath.lastIndexOf('/');return filePath.slice(lastIndex+1);},/**\n   * input: '/abc/bc/cb'\n   * output: ['/abc', '/abc/bc', '/abc/bc/cb'];\n   */getPaths:function getPaths(path){var paths=path.split('/').slice(1);var result=[];while(paths.length){result.push('/'+paths.join('/'));paths.pop();}return result.reverse();},/**\n   * input:\n   *  eg: /\n   *      ../abc/abc/\n   *      ../abc/bc\n   * output(return):\n   *  eg: /\n   *      abc\n   *      bc\n   */getFolderName:function getFolderName(path){if(path==='/'){return path;}path=path[path.length-1]!=='/'?path:path.slice(0,path.length-1);return path.slice(path.lastIndexOf('/')+1);},/*\n    return dirname of a path.\n    if path is '/', return '/'.\n  */getDirName:function getDirName(path){var dir=path.slice(0,path.lastIndexOf('/'));if(dir===''){return'/';}else{return dir;}},isChildPath:function isChildPath(child,parent){var p=this.getDirName(child);return p===parent;},isAncestorPath:function isAncestorPath(ancestor,path){return path.indexOf(ancestor)>-1;},renameAncestorPath:function renameAncestorPath(path,ancestor,newAncestor){return path.replace(ancestor,newAncestor);},joinPath:function joinPath(pathA,pathB){if(pathA[pathA.length-1]==='/'){return pathA+pathB;}else{return pathA+'/'+pathB;}},isSupportUploadFolder:function isSupportUploadFolder(){return navigator.userAgent.indexOf('Firefox')!=-1||navigator.userAgent.indexOf('Chrome')>-1||navigator.userAgent.indexOf('Safari')>-1;},isIEBrower:function isIEBrower(){// is ie <= ie11 not include Edge\nvar userAgent=navigator.userAgent;var isIE=userAgent.indexOf('compatible')>-1&&userAgent.indexOf('MSIE')>-1;var isIE11=userAgent.indexOf('Trident')>-1&&userAgent.indexOf('rv:11.0')>-1;return isIE||isIE11;},getDefaultLibIconUrl:function getDefaultLibIconUrl(isBig){var size=Utils.isHiDPI()?48:24;size=isBig?256:size;var icon_name='lib.png';return mediaUrl+'img/lib/'+size+'/'+icon_name;},getLibIconUrl:function getLibIconUrl(repo,isBig){var permission=repo.permission||repo.share_permission;//Compatible with regular repo and repo shared\nvar size=Utils.isHiDPI()?48:24;size=isBig?256:size;var icon_name='lib.png';if(repo.encrypted){icon_name='lib-encrypted.png';}switch(permission){case'r':icon_name='lib-readonly.png';break;case'preview':icon_name='lib-cloud-preview.png';break;case'cloud-edit':icon_name='lib-cloud-preview-edit.png';break;}// must be the last\nif(repo.status=='read-only'){icon_name='lib-readonly.png';}return mediaUrl+'img/lib/'+size+'/'+icon_name;},getDirentIcon:function getDirentIcon(dirent,isBig){var size=this.isHiDPI()?48:24;size=isBig?192:size;if(dirent.isDir()){var readonly=false;if(dirent.permission&&(dirent.permission==='r'||dirent.permission==='preview')){readonly=true;}return this.getFolderIconUrl(readonly,size,dirent.has_been_shared_out);}else{return this.getFileIconUrl(dirent.name,size);}},getAdminTemplateDirentIcon:function getAdminTemplateDirentIcon(dirent,isBig){var size=this.isHiDPI()?48:24;size=isBig?192:size;if(dirent.is_file){return this.getFileIconUrl(dirent.obj_name,size);}else{return this.getFolderIconUrl();}},getFolderIconUrl:function getFolderIconUrl(){var readonly=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var size=arguments.length>1?arguments[1]:undefined;var sharedOut=arguments.length>2?arguments[2]:undefined;if(!size){size=Utils.isHiDPI()?48:24;}size=size>24?192:24;return\"\".concat(mediaUrl,\"img/folder\").concat(readonly?'-read-only':'').concat(sharedOut?'-shared-out':'',\"-\").concat(size,\".png\");},getFileIconUrl:function getFileIconUrl(filename,size){if(!size){size=Utils.isHiDPI()?48:24;}size=size>24?192:24;var file_ext='';if(filename.lastIndexOf('.')==-1){return mediaUrl+'img/file/'+size+'/'+this.FILEEXT_ICON_MAP['default'];}else{file_ext=filename.substr(filename.lastIndexOf('.')+1).toLowerCase();}if(this.FILEEXT_ICON_MAP[file_ext]){return mediaUrl+'img/file/'+size+'/'+this.FILEEXT_ICON_MAP[file_ext];}else{return mediaUrl+'img/file/'+size+'/'+this.FILEEXT_ICON_MAP['default'];}},getLibIconTitle:function getLibIconTitle(repo){var title;var permission=repo.permission||repo.share_permission;//Compatible with regular repo and repo shared\nif(repo.encrypted){title=gettext('Encrypted library');}else if(repo.is_admin){// shared with 'admin' permission\ntitle=gettext('Admin access');}else{switch(permission){case'rw':title=gettext('Read-Write library');break;case'r':title=gettext('Read-Only library');break;case'cloud-edit':title=gettext('Online Read-Write library');break;case'preview':title=gettext('Online Read-Only library');break;}}return title;},getFolderIconTitle:function getFolderIconTitle(options){var title;switch(options.permission){case'rw':title=gettext('Read-Write folder');break;case'r':title=gettext('Read-Only folder');break;case'cloud-edit':title=gettext('Online Read-Write folder');break;case'preview':title=gettext('Online Read-Only folder');break;}return title;},getFolderOperationList:function getFolderOperationList(isRepoOwner,currentRepoInfo,dirent,isContextmenu){var list=[];var SHARE=TextTranslation.SHARE,DOWNLOAD=TextTranslation.DOWNLOAD,DELETE=TextTranslation.DELETE,RENAME=TextTranslation.RENAME,MOVE=TextTranslation.MOVE,COPY=TextTranslation.COPY,PERMISSION=TextTranslation.PERMISSION,OPEN_VIA_CLIENT=TextTranslation.OPEN_VIA_CLIENT;var permission=dirent.permission;var _Utils$getUserPermiss2=Utils.getUserPermission(permission),isCustomPermission=_Utils$getUserPermiss2.isCustomPermission,customPermission=_Utils$getUserPermiss2.customPermission;if(isContextmenu){if(permission=='rw'||permission=='r'){list.push(DOWNLOAD);}if(isCustomPermission&&customPermission.permission.download){list.push(DOWNLOAD);}if(Utils.isHasPermissionToShare(currentRepoInfo,permission,dirent)){list.push(SHARE);}if(permission=='rw'||permission=='cloud-edit'){list.push(DELETE,'Divider');}if(isCustomPermission&&customPermission.permission.delete){list.push(DELETE,'Divider');}}if(permission=='rw'||permission=='cloud-edit'){list.push(RENAME,MOVE);}if(isCustomPermission&&customPermission.permission.modify){list.push(RENAME,MOVE);}if(permission=='rw'||permission=='cloud-edit'){list.push(COPY);}if(isCustomPermission&&customPermission.permission.copy){list.push(COPY);}if(permission=='rw'){if(folderPermEnabled&&(isRepoOwner&&currentRepoInfo.has_been_shared_out||currentRepoInfo.is_admin)){list.push('Divider',PERMISSION);}list.push('Divider',OPEN_VIA_CLIENT);}if(permission=='r'&&!currentRepoInfo.encrypted){list.push(COPY);}// if the last item of menuList is ‘Divider’, delete the last item\nif(list[list.length-1]==='Divider'){list.pop();}return list;},getFileOperationList:function getFileOperationList(isRepoOwner,currentRepoInfo,dirent,isContextmenu){var list=[];var SHARE=TextTranslation.SHARE,DOWNLOAD=TextTranslation.DOWNLOAD,DELETE=TextTranslation.DELETE,RENAME=TextTranslation.RENAME,MOVE=TextTranslation.MOVE,COPY=TextTranslation.COPY,TAGS=TextTranslation.TAGS,UNLOCK=TextTranslation.UNLOCK,LOCK=TextTranslation.LOCK,UNFREEZE_DOCUMENT=TextTranslation.UNFREEZE_DOCUMENT,FREEZE_DOCUMENT=TextTranslation.FREEZE_DOCUMENT,HISTORY=TextTranslation.HISTORY,ACCESS_LOG=TextTranslation.ACCESS_LOG,PROPERTIES=TextTranslation.PROPERTIES,OPEN_VIA_CLIENT=TextTranslation.OPEN_VIA_CLIENT,ONLYOFFICE_CONVERT=TextTranslation.ONLYOFFICE_CONVERT,CONVERT_TO_MARKDOWN=TextTranslation.CONVERT_TO_MARKDOWN,CONVERT_TO_DOCX=TextTranslation.CONVERT_TO_DOCX,EXPORT_DOCX=TextTranslation.EXPORT_DOCX,CONVERT_TO_SDOC=TextTranslation.CONVERT_TO_SDOC;var permission=dirent.permission;var _Utils$getUserPermiss3=Utils.getUserPermission(permission),isCustomPermission=_Utils$getUserPermiss3.isCustomPermission,customPermission=_Utils$getUserPermiss3.customPermission;if(isContextmenu){if(permission=='rw'||permission=='r'){list.push(DOWNLOAD);}if(isCustomPermission&&customPermission.permission.download){list.push(DOWNLOAD);}if(Utils.isHasPermissionToShare(currentRepoInfo,permission,dirent)){list.push(SHARE);}if(permission=='rw'||permission=='cloud-edit'){if(!dirent.is_locked||dirent.is_locked&&dirent.locked_by_me){list.push(DELETE);}list.push('Divider');}if(isCustomPermission&&customPermission.permission.delete){if(!dirent.is_locked||dirent.is_locked&&dirent.locked_by_me){list.push(DELETE);}list.push('Divider');}}if(permission=='rw'||permission=='cloud-edit'){if(!dirent.is_locked||dirent.is_locked&&dirent.locked_by_me){list.push(RENAME,MOVE);}}if(isCustomPermission&&customPermission.permission.modify){if(!dirent.is_locked||dirent.is_locked&&dirent.locked_by_me){list.push(RENAME,MOVE);}}if(permission=='rw'||permission=='cloud-edit'){list.push(COPY);}if(isCustomPermission){if(customPermission.permission.copy){list.push(COPY);}}if(permission=='rw'){list.push(TAGS);if(isPro){if(dirent.is_locked){if(dirent.locked_by_me||dirent.lock_owner=='OnlineOffice'||isRepoOwner||currentRepoInfo.is_admin){if(!dirent.name.endsWith('.sdoc')){list.push(UNLOCK);}}}else{if(!dirent.name.endsWith('.sdoc')){list.push(LOCK);}}}list.push('Divider');if(isPro&&!dirent.is_locked&&dirent.name.endsWith('.sdoc')){list.push(FREEZE_DOCUMENT);}if(isPro&&dirent.is_locked&&dirent.name.endsWith('.sdoc')){list.push(UNFREEZE_DOCUMENT);}}if((permission=='rw'||permission=='cloud-edit')&&enableSeadoc&&!currentRepoInfo.encrypted){if(dirent.name.endsWith('.md')||dirent.name.endsWith('.docx')){list.push(CONVERT_TO_SDOC);}if(dirent.name.endsWith('.sdoc')){list.push(CONVERT_TO_MARKDOWN);list.push(CONVERT_TO_DOCX);list.push(EXPORT_DOCX);}}if(permission=='rw'){list.push('Divider');list.push(PROPERTIES,HISTORY);if(isPro&&fileAuditEnabled){list.push(ACCESS_LOG);}list.push('Divider',OPEN_VIA_CLIENT);}if(permission=='r'){if(!currentRepoInfo.encrypted){list.push(COPY);}list.push(HISTORY);}if(permission=='rw'&&enableOnlyoffice&&onlyofficeConverterExtensions.includes(this.getFileExtension(dirent.name,false))){list.push(ONLYOFFICE_CONVERT);}// if the last item of menuList is ‘Divider’, delete the last item\nif(list[list.length-1]==='Divider'){list.pop();}// Remove adjacent excess 'Divider'\nfor(var i=0;i<list.length;i++){if(list[i]==='Divider'&&list[i+1]==='Divider'){list.splice(i,1);i--;}}return list;},getFileExtension:function getFileExtension(fileName,withoutDot){var parts=fileName.toLowerCase().split('.');return withoutDot?parts.pop():'.'+parts.pop();},getDirentOperationList:function getDirentOperationList(isRepoOwner,currentRepoInfo,dirent,isContextmenu){return dirent.type=='dir'?Utils.getFolderOperationList(isRepoOwner,currentRepoInfo,dirent,isContextmenu):Utils.getFileOperationList(isRepoOwner,currentRepoInfo,dirent,isContextmenu);},sharePerms:function sharePerms(permission){var title;switch(permission){case'rw':title=gettext('Read-Write');break;case'r':title=gettext('Read-Only');break;case'admin':title=gettext('Admin');break;case'cloud-edit':title=gettext('Online Read-Write');break;case'preview':title=gettext('Online Read-Only');break;case'invisible':title=gettext('Invisible');break;}return title;},sharePermsExplanation:function sharePermsExplanation(permission){var title;switch(permission){case'rw':title=gettext('User can read, write, upload, download and sync files.');break;case'r':title=gettext('User can read, download and sync files.');break;case'admin':title=gettext('Besides Write permission, user can also share the library.');break;case'cloud-edit':title=gettext('User can view and edit file online via browser. Files can\\'t be downloaded.');break;case'preview':title=gettext('User can only view files online via browser. Files can\\'t be downloaded.');break;case'invisible':title=gettext('User can not see this folder.');break;}return title;},getShareLinkPermissionObject:function getShareLinkPermissionObject(permission){switch(permission){case'preview_download':return{value:permission,text:gettext('Preview and download'),permissionDetails:{'can_edit':false,'can_download':true,'can_upload':false}};case'preview_only':return{value:permission,text:gettext('Preview only'),permissionDetails:{'can_edit':false,'can_download':false,'can_upload':false}};case'download_upload':return{value:permission,text:gettext('Download and upload'),permissionDetails:{'can_edit':false,'can_download':true,'can_upload':true}};case'edit_download':return{value:permission,text:gettext('Edit on cloud and download'),permissionDetails:{'can_edit':true,'can_download':true,'can_upload':false}};case'cloud_edit':return{value:permission,text:gettext('Edit on cloud only'),permissionDetails:{'can_edit':true,'can_download':false,'can_upload':false}};}return{text:''};},formatSize:function formatSize(options){/*\n     * param: {bytes, precision}\n     */var bytes=options.bytes;var precision=options.precision||0;var kilobyte=1000;var megabyte=kilobyte*1000;var gigabyte=megabyte*1000;var terabyte=gigabyte*1000;if(bytes>=0&&bytes<kilobyte){return bytes+' B';}else if(bytes>=kilobyte&&bytes<megabyte){return(bytes/kilobyte).toFixed(precision)+' KB';}else if(bytes>=megabyte&&bytes<gigabyte){return(bytes/megabyte).toFixed(precision)+' MB';}else if(bytes>=gigabyte&&bytes<terabyte){return(bytes/gigabyte).toFixed(precision)+' GB';}else if(bytes>=terabyte){return(bytes/terabyte).toFixed(precision)+' TB';}else{return bytes+' B';}},formatBitRate:function formatBitRate(bits){var Bs;if(typeof bits!=='number'){return'';}Bs=bits/8;if(Bs>=1000000000){return(Bs/1000000000).toFixed(2)+' GB/s';}if(Bs>=1000000){return(Bs/1000000).toFixed(2)+' MB/s';}if(Bs>=1000){return(Bs/1000).toFixed(2)+' kB/s';}return Bs.toFixed(2)+' B/s';},isMarkdownFile:function isMarkdownFile(filePath){var index=filePath.lastIndexOf('.');if(index===-1){return false;}else{var type=filePath.substring(index).toLowerCase();if(type==='.md'||type==='.markdown'){return true;}else{return false;}}},isSdocFile:function isSdocFile(filePath){var index=filePath.lastIndexOf('.');if(index===-1){return false;}else{var type=filePath.substring(index).toLowerCase();if(type==='.sdoc'){return true;}else{return false;}}},isInternalFileLink:function isInternalFileLink(url,repoID){var re=new RegExp(serviceURL+'/lib/'+repoID+'/file.*');return re.test(url);},isInternalMarkdownLink:function isInternalMarkdownLink(url,repoID){// eslint-disable-next-line\nvar re=new RegExp(serviceURL+'/lib/'+repoID+'.*\\.md$');return re.test(url);},isInternalDirLink:function isInternalDirLink(url,repoID){var re=new RegExp(serviceURL+'/library/'+repoID+'.*');return re.test(url);},getPathFromInternalMarkdownLink:function getPathFromInternalMarkdownLink(url,repoID){// eslint-disable-next-line\nvar re=new RegExp(serviceURL+'/lib/'+repoID+'/file'+'(.*\\.md)');var array=re.exec(url);var path=decodeURIComponent(array[1]);return path;},getPathFromInternalDirLink:function getPathFromInternalDirLink(url,repoID){var re=new RegExp(serviceURL+'/library/'+repoID+'(/.*)');var array=re.exec(url);var path=decodeURIComponent(array[1]);path=path.slice(1);path=path.slice(path.indexOf('/'));return path;},isWikiInternalMarkdownLink:function isWikiInternalMarkdownLink(url,slug){slug=encodeURIComponent(slug);// eslint-disable-next-line\nvar re=new RegExp(serviceURL+'/published/'+slug+'.*\\.md$');return re.test(url);},isWikiInternalDirLink:function isWikiInternalDirLink(url,slug){slug=encodeURIComponent(slug);var re=new RegExp(serviceURL+'/published/'+slug+'.*');return re.test(url);},getPathFromWikiInternalMarkdownLink:function getPathFromWikiInternalMarkdownLink(url,slug){slug=encodeURIComponent(slug);// eslint-disable-next-line\nvar re=new RegExp(serviceURL+'/published/'+slug+'(.*\\.md)');var array=re.exec(url);var path=array[1];try{path=decodeURIComponent(path);}catch(err){path=path.replace(/%/g,'%25');path=decodeURIComponent(path);}return path;},getPathFromWikiInternalDirLink:function getPathFromWikiInternalDirLink(url,slug){slug=encodeURIComponent(slug);var re=new RegExp(serviceURL+'/published/'+slug+'(/.*)');var array=re.exec(url);var path=array[1];try{path=decodeURIComponent(path);}catch(err){path=path.replace(/%/g,'%25');path=decodeURIComponent(path);}return path;},compareTwoWord:function compareTwoWord(wordA,wordB){// compare wordA and wordB at lower case\n// if wordA >= wordB, return 1\n// if wordA < wordB, return -1\nreturn compareTwoString(wordA,wordB);},// compare two strings which may have digits in them\n// and compare those digits as number instead of string\ncompareStrWithNumbersIn:function compareStrWithNumbersIn(a,b){var reParts=/\\d+|\\D+/g;var reDigit=/\\d/;var aParts=a.match(reParts);var bParts=b.match(reParts);var isDigitPart;var len=Math.min(aParts.length,bParts.length);var aPart,bPart;if(aParts&&bParts&&(isDigitPart=reDigit.test(aParts[0]))==reDigit.test(bParts[0])){// Loop through each substring part to compare the overall strings.\nfor(var i=0;i<len;i++){aPart=aParts[i];bPart=bParts[i];if(isDigitPart){aPart=parseInt(aPart,10);bPart=parseInt(bPart,10);}if(aPart!=bPart){return aPart<bPart?-1:1;}// Toggle the value of isDigitPart since the parts will alternate.\nisDigitPart=!isDigitPart;}}// Use normal comparison.\nreturn(a>=b)-(a<=b);},sortRepos:function sortRepos(repos,sortBy,sortOrder){var _this=this;var comparator;switch(\"\".concat(sortBy,\"-\").concat(sortOrder)){case'name-asc':comparator=function comparator(a,b){if(!a.repo_name){return 1;}if(!b.repo_name){return-1;}var result=_this.compareTwoWord(a.repo_name,b.repo_name);return result;};break;case'name-desc':comparator=function comparator(a,b){if(!a.repo_name){return-1;}if(!b.repo_name){return 1;}var result=_this.compareTwoWord(a.repo_name,b.repo_name);return-result;};break;case'time-asc':comparator=function comparator(a,b){return a.last_modified<b.last_modified?-1:1;};break;case'time-desc':comparator=function comparator(a,b){return a.last_modified<b.last_modified?1:-1;};break;case'size-asc':comparator=function comparator(a,b){if(a.size===b.size){var result=_this.compareTwoWord(a.repo_name,b.repo_name);return result;}return a.size_original<b.size_original?-1:1;};break;case'size-desc':comparator=function comparator(a,b){if(a.size===b.size){var result=_this.compareTwoWord(a.repo_name,b.repo_name);return-result;}return a.size_original<b.size_original?1:-1;};break;}repos.sort(comparator);return repos;},sortDirents:function sortDirents(items,sortBy,sortOrder){var _this=this;var comparator;switch(\"\".concat(sortBy,\"-\").concat(sortOrder)){case'name-asc':comparator=function comparator(a,b){var result=_this.compareTwoWord(a.name,b.name);return result;};break;case'name-desc':comparator=function comparator(a,b){var result=_this.compareTwoWord(a.name,b.name);return-result;};break;case'time-asc':comparator=function comparator(a,b){return a.mtime<b.mtime?-1:1;};break;case'time-desc':comparator=function comparator(a,b){return a.mtime<b.mtime?1:-1;};break;case'size-asc':comparator=function comparator(a,b){if(a.type=='dir'&&b.type=='dir'){return 0;}return a.size_original<b.size_original?-1:1;};break;case'size-desc':comparator=function comparator(a,b){if(a.type=='dir'&&b.type=='dir'){return 0;}return a.size_original<b.size_original?1:-1;};break;}items.sort(function(a,b){if(a.type=='dir'&&b.type=='file'){return-1;}else if(a.type=='file'&&b.type=='dir'){return 1;}else{return comparator(a,b);}});return items;},// sort dirents in shared folder\nsortDirentsInSharedDir:function sortDirentsInSharedDir(items,sortBy,sortOrder){var _this=this;var comparator;switch(\"\".concat(sortBy,\"-\").concat(sortOrder)){case'name-asc':comparator=function comparator(a,b){var result;if(a.is_dir){result=_this.compareTwoWord(a.folder_name,b.folder_name);}else{result=_this.compareTwoWord(a.file_name,b.file_name);}return result;};break;case'name-desc':comparator=function comparator(a,b){var result;if(a.is_dir){result=_this.compareTwoWord(a.folder_name,b.folder_name);}else{result=_this.compareTwoWord(a.file_name,b.file_name);}return-result;};break;case'time-asc':comparator=function comparator(a,b){return a.last_modified<b.last_modified?-1:1;};break;case'time-desc':comparator=function comparator(a,b){return a.last_modified<b.last_modified?1:-1;};break;case'size-asc':comparator=function comparator(a,b){if(a.is_dir){return 0;}else{return a.size<b.size?-1:1;}};break;case'size-desc':comparator=function comparator(a,b){if(a.is_dir){return 0;}else{return a.size<b.size?1:-1;}};break;}items.sort(function(a,b){if(a.is_dir&&!b.is_dir){return-1;}else if(!a.is_dir&&b.is_dir){return 1;}else{return comparator(a,b);}});return items;},/*\n   * only used in the 'catch' part of a seafileAPI request\n   */getErrorMsg:function getErrorMsg(error,showPermissionDeniedTip){var errorMsg='';if(error.response){if(error.response.status==403){if(showPermissionDeniedTip){toaster.danger(/*#__PURE__*/_jsx(PermissionDeniedTip,{}),{id:'permission_denied',duration:3600});}errorMsg=gettext('Permission denied');}else if(error.response.status==429){errorMsg=gettext('Too many requests');}else if(error.response.data&&error.response.data['error_msg']){errorMsg=error.response.data['error_msg'];}else{errorMsg=gettext('Error');}}else{errorMsg=gettext('Please check the network.');}return errorMsg;},changeMarkdownNodes:function changeMarkdownNodes(nodes,fn){nodes.forEach(function(item){fn(item);if(item.children&&item.children.length>0){Utils.changeMarkdownNodes(item.children,fn);}});return nodes;},chooseLanguage:function chooseLanguage(suffix){var mode;switch(suffix){case'py':mode='python';break;case'js':mode='javascript';break;case'c':mode='c';break;case'cpp':mode='cpp';break;case'cs':mode='csharp';break;case'java':mode='java';break;case'mdf':mode='text/x-sql';break;case'html':mode='html';break;case'sh':mode='shell';break;default:mode=suffix;}return mode;},DARK_COLOR_MAP:{// old color\n'red':'#D11507','orange':'#FF8C00','yellow':'#EDEF00','green':'#006400','cyan':'#00E0E1','blue':'#2510A3','indigo':'#350C56','purple':'#551054','pink':'#E3A5B0','azure':'#C4D0D0','lime':'#00E100','teal':'#006A6B','gray':'#545454',// new color\n'#FFA8A8':'#E49090','#FFA94D':'#E39136','#FFD43B':'#E0B815','#A0EC50':'#83CF32','#A9E34B':'#8DC72E','#63E6BE':'#43CAA4','#4FD2C9':'#2DB9B0','#72C3FC':'#57ABE3','#91A7FF':'#7A91E7','#E599F7':'#CC82DE','#B197FC':'#9B82E5','#F783AC':'#DF6D97','#CED4DA':'#A8ADB2'},getDarkColor:function getDarkColor(color){var darkColor;darkColor=this.DARK_COLOR_MAP[color];return darkColor;},getCopySuccessfulMessage:function getCopySuccessfulMessage(dirNames){var message;var dirNamesLength=dirNames.length;if(dirNamesLength===1){message=gettext('Successfully copied %(name)s.');}else if(dirNamesLength===2){message=gettext('Successfully copied %(name)s and 1 other item.');}else{message=gettext('Successfully copied %(name)s and %(amount)s other items.');message=message.replace('%(amount)s',dirNamesLength-1);}message=message.replace('%(name)s',dirNames[0]);return message;},getMoveSuccessMessage:function getMoveSuccessMessage(dirNames){var message;var dirNamesLength=dirNames.length;if(dirNamesLength===1){message=gettext('Successfully moved %(name)s.');}else if(dirNamesLength===2){message=gettext('Successfully moved %(name)s and 1 other item.');}else{message=gettext('Successfully moved %(name)s and %(amount)s other items.');message=message.replace('%(amount)s',dirNamesLength-1);}message=message.replace('%(name)s',dirNames[0]);return message;},getCopyFailedMessage:function getCopyFailedMessage(dirNames){var message;var dirNamesLength=dirNames.length;if(dirNamesLength>1){message=gettext('Failed to copy %(name)s and %(amount)s other item(s).');message=message.replace('%(amount)s',dirNamesLength-1);}else{message=gettext('Failed to copy %(name)s.');}message=message.replace('%(name)s',dirNames[0]);return message;},getMoveFailedMessage:function getMoveFailedMessage(dirNames){var message;var dirNamesLength=dirNames.length;if(dirNamesLength>1){message=gettext('Failed to move %(name)s and %(amount)s other item(s).');message=message.replace('%(amount)s',dirNamesLength-1);}else{message=gettext('Failed to move %(name)s.');}message=message.replace('%(name)s',dirNames[0]);return message;},handleSearchedItemClick:function handleSearchedItemClick(searchedItem){if(searchedItem.is_dir===true){var url=siteRoot+'library/'+searchedItem.repo_id+'/'+searchedItem.repo_name+searchedItem.path;var newWindow=window.open('about:blank');newWindow.location.href=url;}else{var _url=siteRoot+'lib/'+searchedItem.repo_id+'/file'+Utils.encodePath(searchedItem.path);var _newWindow=window.open('about:blank');_newWindow.location.href=_url;}},generatePassword:function generatePassword(length){var hasNum=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var hasChar=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var hasSymbol=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1;var password='';// 65~90：A~Z\npassword+=String.fromCharCode(Math.floor(Math.random()*(90-65)+65));// 97~122：a~z\npassword+=String.fromCharCode(Math.floor(Math.random()*(122-97)+97));// 48~57：0~9\npassword+=String.fromCharCode(Math.floor(Math.random()*(57-48)+48));// 33~47：!~/\npassword+=String.fromCharCode(Math.floor(Math.random()*(47-33)+33));// 33~47：!~/\n// 48~57：0~9\n// 58~64：:~@\n// 65~90：A~Z\n// 91~96：[~`\n// 97~122：a~z\n// 123~127：{~\nfor(var i=0;i<length-4;i++){var num=Math.floor(Math.random()*(127-33)+33);password+=String.fromCharCode(num);}return password;},pathNormalize:function pathNormalize(originalPath){var oldPath=originalPath.split('/');var newPath=[];for(var i=0;i<oldPath.length;i++){if(oldPath[i]==='.'||oldPath[i]===''){continue;}else if(oldPath[i]==='..'){newPath.pop();}else{newPath.push(oldPath[i]);}}return newPath.join('/');},getEventData:function getEventData(event,data){if(event.target.dataset){return event.target.dataset[data];}return event.target.getAttribute('data-'+data);},/**\n   * Check whether user has permission to share a dirent.\n   * If dirent is none, then check whether the user can share the repo\n   * scene 1: root path or folder path, control the share button in the toolbar\n   * scene 2: selected a dirent, control the share button in the toolbar dropdown-menu\n   * scene 3: dirent list(grid list), control the share button in the dirent-item or righe-menu\n   *\n   * @param {*} repoInfo\n   * @param {*} userDirPermission\n   * @param {*} dirent\n   */isHasPermissionToShare:function isHasPermissionToShare(repoInfo,userDirPermission,dirent){var _Utils$getUserPermiss4=Utils.getUserPermission(userDirPermission),isCustomPermission=_Utils$getUserPermiss4.isCustomPermission,customPermission=_Utils$getUserPermiss4.customPermission;if(isCustomPermission){var download_external_link=customPermission.permission.download_external_link;return download_external_link;}var isAdmin=repoInfo.is_admin,isVirtual=repoInfo.is_virtual,repoEncrypted=repoInfo.encrypted,ownerEmail=repoInfo.owner_email;var isRepoOwner=ownerEmail===username;if(repoEncrypted){return true;}// for 'file' & 'dir'\nif(dirent){if(userDirPermission=='rw'||userDirPermission=='r'){// can generate internal link\nreturn true;}}// the root path or the dirent type is dir\nvar hasGenerateShareLinkPermission=false;if(canGenerateShareLink&&(userDirPermission=='rw'||userDirPermission=='r')){hasGenerateShareLinkPermission=true;return hasGenerateShareLinkPermission;}var hasGenerateUploadLinkPermission=false;if(canGenerateUploadLink&&userDirPermission=='rw'){hasGenerateUploadLinkPermission=true;return hasGenerateUploadLinkPermission;}var hasDirPrivateSharePermission=false;if(!isVirtual&&(isRepoOwner||isAdmin)){hasDirPrivateSharePermission=true;return hasDirPrivateSharePermission;}return false;},registerGlobalVariable:function registerGlobalVariable(namespace,key,value){if(!window[namespace]){window[namespace]={};}window[namespace][key]=value;},formatTime:function formatTime(seconds){var ss=parseInt(seconds);var mm=0;var hh=0;if(ss>60){mm=parseInt(ss/60);ss=parseInt(ss%60);}if(mm>60){hh=parseInt(mm/60);mm=parseInt(mm%60);}var result=('00'+parseInt(ss)).slice(-2);if(mm>0){result=('00'+parseInt(mm)).slice(-2)+':'+result;}else{result='00:'+result;}if(hh>0){result=('00'+parseInt(hh)).slice(-2)+':'+result;}else{result='00:'+result;}return result;},hasNextPage:function hasNextPage(curPage,perPage,totalCount){return curPage*perPage<totalCount;},getStrengthLevel:function getStrengthLevel(pwd){var _this=this;var num=0;if(pwd.length<shareLinkPasswordMinLength){return 0;}else{for(var i=0;i<pwd.length;i++){// return the unicode\n// bitwise OR\nnum|=_this.getCharMode(pwd.charCodeAt(i));}return _this.calculateBitwise(num);}},getCharMode:function getCharMode(n){if(n>=48&&n<=57)// nums\nreturn 1;if(n>=65&&n<=90)// uppers\nreturn 2;if(n>=97&&n<=122)// lowers\nreturn 4;else return 8;},calculateBitwise:function calculateBitwise(num){var level=0;for(var i=0;i<4;i++){// bitwise AND\nif(num&1)level++;// Right logical shift\nnum>>>=1;}return level;},getSharedPermission:function getSharedPermission(item){var permission=item.permission;if(item.is_admin){permission='admin';}if(item.permission.startsWith('custom-')){permission=item.permission.slice(7);}return permission;},getUserPermission:function getUserPermission(userPerm){var _window=window,custom_permission=_window.custom_permission;var common_permissions=['rw','r','admin','cloud-edit','preview'];// visit the shared repo(virtual repo) by custom permission\nif(!custom_permission||common_permissions.indexOf(userPerm)>-1){return{isCustomPermission:false};}// userPerm is startsWith 'custom-'\nif(custom_permission){var permissionId=custom_permission.id;var userPermId=parseInt(userPerm.split('-')[1]);if(permissionId===userPermId){return{isCustomPermission:true,customPermission:custom_permission};}// TODO user set custom permission on folder\n}return{isCustomPermission:false};},// for a11y\nonKeyDown:function onKeyDown(e){if(e.key=='Enter'||e.key=='Space'){e.target.click();}},updateTabTitle:function updateTabTitle(content){var title=document.getElementsByTagName('title')[0];title.innerText=content;},generateHistoryURL:function generateHistoryURL(siteRoot,repoID,path){if(!siteRoot||!repoID||!path)return'';return siteRoot+'repo/file_revisions/'+repoID+'/?p='+this.encodePath(path);},generateRevisionURL:function generateRevisionURL(siteRoot,repoID,path){if(!siteRoot||!repoID||!path)return'';return siteRoot+'repo/sdoc_revision/'+repoID+'/?p='+this.encodePath(path);},generateRevisionsURL:function generateRevisionsURL(siteRoot,repoID,path){if(!siteRoot||!repoID||!path)return'';return siteRoot+'repo/sdoc_revisions/'+repoID+'/?p='+this.encodePath(path);},isFunction:function isFunction(functionToCheck){var getType={};return functionToCheck&&getType.toString.call(functionToCheck)==='[object Function]';},getUrlSearches:function getUrlSearches(){var search=location.search;var searchParams={};if(search.length===0){return searchParams;}var allSearches=search.split('?')[1];var allSearchesArr=allSearches.split('&');allSearchesArr.forEach(function(item){var itemArr=item.split('=');searchParams[itemArr[0]]=decodeURI(itemArr[1]);});return searchParams;},// If value is null, delete the search parameter; else, add or update the search parameter.\nupdateSearchParameter:function updateSearchParameter(key,value){var _location=location,origin=_location.origin,pathname=_location.pathname;var searchParams=this.getUrlSearches();searchParams[key]=value;var newSearch='?';for(var _key in searchParams){var _value=searchParams[_key];if(_value){newSearch=newSearch==='?'?\"?\".concat(_key,\"=\").concat(_value):\"\".concat(newSearch,\"&\").concat(_key,\"=\").concat(_value);}}history.replaceState(null,'',origin+pathname+newSearch);},isRelativePath:function isRelativePath(url){var RgExp=new RegExp('^(?:[a-z]+:)?//','i');return!RgExp.test(url);}};export var isMobile=typeof window!=='undefined'&&(window.innerWidth<768||navigator.userAgent.toLowerCase().match(/(ipod|ipad|iphone|android|coolpad|mmp|smartphone|midp|wap|xoom|symbian|j2me|blackberry|wince)/i)!=null);export var validateName=function validateName(newName){var isValid=true;var errMessage='';if(!newName||!newName.trim()){isValid=false;errMessage=gettext('Name is required');return{isValid:isValid,errMessage:errMessage};}if(newName.includes('/')){isValid=false;errMessage=gettext('Name cannot contain slash');return{isValid:isValid,errMessage:errMessage};}if(newName.includes('`')){isValid=false;errMessage=gettext('Name cannot contain backtick');return{isValid:isValid,errMessage:errMessage};}if(newName.includes('\\\\')){isValid=false;errMessage=gettext('Name cannot contain backslash');return{isValid:isValid,errMessage:errMessage};}if(newName==='..'){isValid=false;errMessage=gettext('Name cannot be double dots');return{isValid:isValid,errMessage:errMessage};}return{isValid:isValid,errMessage:errMessage};};","map":{"version":3,"names":["mediaUrl","gettext","serviceURL","siteRoot","isPro","fileAuditEnabled","canGenerateShareLink","canGenerateUploadLink","shareLinkPasswordMinLength","username","folderPermEnabled","onlyofficeConverterExtensions","enableOnlyoffice","enableSeadoc","TextTranslation","React","toaster","PermissionDeniedTip","compareTwoString","jsx","_jsx","Utils","keyCodes","enter","esc","space","tab","up","down","bytesToSize","bytes","sizes","i","parseInt","Math","floor","log","pow","toFixed","isHiDPI","pixelRatio","window","devicePixelRatio","isDesktop","innerWidth","isWeChat","ua","navigator","userAgent","toLowerCase","match","isEnterpriseWeChat","FILEEXT_ICON_MAP","imageCheck","filename","lastIndexOf","file_ext","substr","image_exts","indexOf","getShareLinkPermissionList","itemType","permission","path","canEdit","permissionOptions","_Utils$getUserPermiss","getUserPermission","isCustomPermission","push","isEditableOfficeFile","getShareLinkPermissionStr","permissions","can_edit","can_download","can_upload","concat","exts","videoCheck","checkDuplicatedNameInList","list","targetName","some","object","name","encodePath","path_arr","split","path_arr_","len","length","encodeURIComponent","join","HTMLescape","html","document","createElement","appendChild","createTextNode","parentNode","innerHTML","generateDialogTitle","title","operationTarget","replace","getFileName","filePath","lastIndex","slice","getPaths","paths","result","pop","reverse","getFolderName","getDirName","dir","isChildPath","child","parent","p","isAncestorPath","ancestor","renameAncestorPath","newAncestor","joinPath","pathA","pathB","isSupportUploadFolder","isIEBrower","isIE","isIE11","getDefaultLibIconUrl","isBig","size","icon_name","getLibIconUrl","repo","share_permission","encrypted","status","getDirentIcon","dirent","isDir","readonly","getFolderIconUrl","has_been_shared_out","getFileIconUrl","getAdminTemplateDirentIcon","is_file","obj_name","arguments","undefined","sharedOut","getLibIconTitle","is_admin","getFolderIconTitle","options","getFolderOperationList","isRepoOwner","currentRepoInfo","isContextmenu","SHARE","DOWNLOAD","DELETE","RENAME","MOVE","COPY","PERMISSION","OPEN_VIA_CLIENT","_Utils$getUserPermiss2","customPermission","download","isHasPermissionToShare","delete","modify","copy","getFileOperationList","TAGS","UNLOCK","LOCK","UNFREEZE_DOCUMENT","FREEZE_DOCUMENT","HISTORY","ACCESS_LOG","PROPERTIES","ONLYOFFICE_CONVERT","CONVERT_TO_MARKDOWN","CONVERT_TO_DOCX","EXPORT_DOCX","CONVERT_TO_SDOC","_Utils$getUserPermiss3","is_locked","locked_by_me","lock_owner","endsWith","includes","getFileExtension","splice","fileName","withoutDot","parts","getDirentOperationList","type","sharePerms","sharePermsExplanation","getShareLinkPermissionObject","value","text","permissionDetails","formatSize","precision","kilobyte","megabyte","gigabyte","terabyte","formatBitRate","bits","Bs","isMarkdownFile","index","substring","isSdocFile","isInternalFileLink","url","repoID","re","RegExp","test","isInternalMarkdownLink","isInternalDirLink","getPathFromInternalMarkdownLink","array","exec","decodeURIComponent","getPathFromInternalDirLink","isWikiInternalMarkdownLink","slug","isWikiInternalDirLink","getPathFromWikiInternalMarkdownLink","err","getPathFromWikiInternalDirLink","compareTwoWord","wordA","wordB","compareStrWithNumbersIn","a","b","reParts","reDigit","aParts","bParts","isDigitPart","min","aPart","bPart","sortRepos","repos","sortBy","sortOrder","_this","comparator","repo_name","last_modified","size_original","sort","sortDirents","items","mtime","sortDirentsInSharedDir","is_dir","folder_name","file_name","getErrorMsg","error","showPermissionDeniedTip","errorMsg","response","danger","id","duration","data","changeMarkdownNodes","nodes","fn","forEach","item","children","chooseLanguage","suffix","mode","DARK_COLOR_MAP","getDarkColor","color","darkColor","getCopySuccessfulMessage","dirNames","message","dirNamesLength","getMoveSuccessMessage","getCopyFailedMessage","getMoveFailedMessage","handleSearchedItemClick","searchedItem","repo_id","newWindow","open","location","href","generatePassword","hasNum","hasChar","hasSymbol","password","String","fromCharCode","random","num","pathNormalize","originalPath","oldPath","newPath","getEventData","event","target","dataset","getAttribute","repoInfo","userDirPermission","_Utils$getUserPermiss4","download_external_link","isAdmin","isVirtual","is_virtual","repoEncrypted","ownerEmail","owner_email","hasGenerateShareLinkPermission","hasGenerateUploadLinkPermission","hasDirPrivateSharePermission","registerGlobalVariable","namespace","key","formatTime","seconds","ss","mm","hh","hasNextPage","curPage","perPage","totalCount","getStrengthLevel","pwd","getCharMode","charCodeAt","calculateBitwise","n","level","getSharedPermission","startsWith","userPerm","_window","custom_permission","common_permissions","permissionId","userPermId","onKeyDown","e","click","updateTabTitle","content","getElementsByTagName","innerText","generateHistoryURL","generateRevisionURL","generateRevisionsURL","isFunction","functionToCheck","getType","toString","call","getUrlSearches","search","searchParams","allSearches","allSearchesArr","itemArr","decodeURI","updateSearchParameter","_location","origin","pathname","newSearch","history","replaceState","isRelativePath","RgExp","isMobile","validateName","newName","isValid","errMessage","trim"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/utils/utils.js"],"sourcesContent":["import { mediaUrl, gettext, serviceURL, siteRoot, isPro, fileAuditEnabled, canGenerateShareLink, canGenerateUploadLink, shareLinkPasswordMinLength, username, folderPermEnabled, onlyofficeConverterExtensions, enableOnlyoffice, enableSeadoc } from './constants';\nimport TextTranslation from './text-translation';\nimport React from 'react';\nimport toaster from '../components/toast';\nimport PermissionDeniedTip from '../components/permission-denied-tip';\nimport { compareTwoString } from './compare-two-string';\n\nexport const Utils = {\n\n  keyCodes:  {\n    enter: 13,\n    esc:   27,\n    space: 32,\n    tab:   9,\n    up:    38,\n    down:  40\n  },\n\n  bytesToSize: function(bytes) {\n    if (typeof(bytes) == 'undefined') return ' ';\n\n    if(bytes < 0) return '--';\n    const sizes = ['bytes', 'KB', 'MB', 'GB', 'TB', 'PB'];\n\n    if (bytes === 0) return bytes + ' ' + sizes[0];\n\n    const i = parseInt(Math.floor(Math.log(bytes) / Math.log(1000)), 10);\n    if (i === 0) return bytes + ' ' + sizes[i];\n    return (bytes / (1000 ** i)).toFixed(1) + ' ' + sizes[i];\n  },\n\n  isHiDPI: function() {\n    var pixelRatio = window.devicePixelRatio ? window.devicePixelRatio : 1;\n    if (pixelRatio > 1) {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  isDesktop: function() {\n    return window.innerWidth >= 768;\n  },\n\n  isWeChat: function() {\n    let ua = window.navigator.userAgent.toLowerCase();\n    let isWeChat = ua.match(/MicroMessenger/i) == 'micromessenger';\n    let isEnterpriseWeChat = ua.match(/MicroMessenger/i) == 'micromessenger' && ua.match(/wxwork/i) == 'wxwork';\n    return isEnterpriseWeChat || isWeChat;\n  },\n\n  FILEEXT_ICON_MAP: {\n\n    // text file\n    'md': 'txt.png',\n    'txt': 'txt.png',\n\n    // pdf file\n    'pdf' : 'pdf.png',\n\n    // document file\n    'doc' : 'word.png',\n    'docx' : 'word.png',\n    'odt' : 'word.png',\n    'fodt' : 'word.png',\n\n    'ppt' : 'ppt.png',\n    'pptx' : 'ppt.png',\n    'odp' : 'ppt.png',\n    'fodp' : 'ppt.png',\n\n    'xls' : 'excel.png',\n    'xlsx' : 'excel.png',\n    'ods' : 'excel.png',\n    'fods' : 'excel.png',\n\n    // video\n    'mp4': 'video.png',\n    'ogv': 'video.png',\n    'webm': 'video.png',\n    'mov': 'video.png',\n    'flv': 'video.png',\n    'wmv': 'video.png',\n    'rmvb': 'video.png',\n\n    // music file\n    'mp3' : 'music.png',\n    'oga' : 'music.png',\n    'ogg' : 'music.png',\n    'wav' : 'music.png',\n    'flac' : 'music.png',\n    'opus' : 'music.png',\n    'aac' : 'music.png',\n    'ac3' : 'music.png',\n    'wma' : 'music.png',\n\n    // image file\n    'jpg' : 'pic.png',\n    'jpeg' : 'pic.png',\n    'png' : 'pic.png',\n    'svg' : 'pic.png',\n    'gif' : 'pic.png',\n    'bmp' : 'pic.png',\n    'ico' : 'pic.png',\n\n    // default\n    'default' : 'file.png',\n    'sdoc': 'sdoc.png',\n    'sdoc_notification': 'sdoc_notification.ico'\n  },\n\n  // check if a file is an image\n  imageCheck: function(filename) {\n    // no file ext\n    if (filename.lastIndexOf('.') == -1) {\n      return false;\n    }\n    var file_ext = filename.substr(filename.lastIndexOf('.') + 1).toLowerCase();\n    var image_exts = ['gif', 'jpeg', 'jpg', 'png', 'ico', 'bmp', 'tif', 'tiff', 'jfif'];\n    if (image_exts.indexOf(file_ext) != -1) {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  getShareLinkPermissionList: function(itemType, permission, path, canEdit) {\n    // itemType: library, dir, file\n    // permission: rw, r, admin, cloud-edit, preview, custom-*\n\n    let permissionOptions = [];\n\n    const { isCustomPermission } = Utils.getUserPermission(permission);\n    if (isCustomPermission) {\n      permissionOptions.push('preview_download');\n      permissionOptions.push('preview_only');\n      return permissionOptions;\n    }\n\n    if (permission == 'rw' || permission == 'admin' || permission == 'r') {\n      permissionOptions.push('preview_download');\n    }\n    permissionOptions.push('preview_only');\n\n    if (itemType == 'library' || itemType == 'dir') {\n      if (permission == 'rw' || permission == 'admin') {\n        permissionOptions.push('download_upload');\n      }\n    } else {\n      if (this.isEditableOfficeFile(path) && (permission == 'rw' || permission == 'admin') && canEdit) {\n        permissionOptions.push('edit_download');\n      }\n\n      // not support\n      // if (this.isEditableOfficeFile(path) && (permission == 'cloud-edit')) {\n      //   permissionOptions.push('cloud_edit');\n      // }\n\n    }\n    return permissionOptions;\n  },\n\n  getShareLinkPermissionStr: function(permissions) {\n    const { can_edit, can_download, can_upload } = permissions;\n    switch (`${can_edit} ${can_download} ${can_upload}`) {\n      case 'false true false':\n        return 'preview_download';\n      case 'false false false':\n        return 'preview_only';\n      case 'false true true':\n        return 'download_upload';\n      case 'true true false':\n        return 'edit_download';\n      case 'true false false':\n        return 'cloud_edit';\n    }\n  },\n\n  isEditableOfficeFile: function(filename) {\n    // no file ext\n    if (filename.lastIndexOf('.') == -1) {\n      return false;\n    }\n    var file_ext = filename.substr(filename.lastIndexOf('.') + 1).toLowerCase();\n    var exts = ['docx', 'pptx', 'xlsx'];\n    if (exts.indexOf(file_ext) != -1) {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  // check if a file is a video\n  videoCheck: function(filename) {\n    // no file ext\n    if (filename.lastIndexOf('.') == -1) {\n      return false;\n    }\n    var file_ext = filename.substr(filename.lastIndexOf('.') + 1).toLowerCase();\n    var exts = ['mp4', 'ogv', 'webm', 'mov'];\n    if (exts.indexOf(file_ext) != -1) {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  checkDuplicatedNameInList: function(list, targetName) {\n    return list.some(object => {\n      return object.name === targetName;\n    });\n  },\n\n  encodePath: function(path) {\n    // IE8 does not support 'map()'\n    /*\n       return path.split('/').map(function(e) {\n       return encodeURIComponent(e);\n       }).join('/');\n       */\n    if (!path) {\n      return '';\n    }\n    var path_arr = path.split('/');\n    var path_arr_ = [];\n    for (var i = 0, len = path_arr.length; i < len; i++) {\n      path_arr_.push(encodeURIComponent(path_arr[i]));\n    }\n    return path_arr_.join('/');\n  },\n\n  HTMLescape: function(html) {\n    return document.createElement('div')\n      .appendChild(document.createTextNode(html))\n      .parentNode\n      .innerHTML;\n  },\n\n  generateDialogTitle: function(title, operationTarget) {\n    /*\n     * @param title: gettext('...{placeholder}...')\n     */\n    /*\n    const targetStr = this.HTMLescape(operationTarget);\n    const str = `<span class=\"op-target ellipsis ellipsis-op-target\" title=${targetStr}>${targetStr}</span>`;\n    return title.replace('{placeholder}', str);\n    */\n    return title.replace('{placeholder}', operationTarget);\n  },\n\n  getFileName: function(filePath) {\n    let lastIndex = filePath.lastIndexOf('/');\n    return filePath.slice(lastIndex+1);\n  },\n\n  /**\n   * input: '/abc/bc/cb'\n   * output: ['/abc', '/abc/bc', '/abc/bc/cb'];\n   */\n  getPaths: function(path) {\n    let paths = path.split('/').slice(1);\n    let result = [];\n    while(paths.length) {\n      result.push('/' + paths.join('/'));\n      paths.pop();\n    }\n    return result.reverse();\n  },\n\n  /**\n   * input:\n   *  eg: /\n   *      ../abc/abc/\n   *      ../abc/bc\n   * output(return):\n   *  eg: /\n   *      abc\n   *      bc\n   */\n  getFolderName: function(path) {\n    if (path === '/') {\n      return path;\n    }\n    path = path[path.length - 1] !== '/' ? path : path.slice(0, path.length - 1);\n    return path.slice(path.lastIndexOf('/') + 1);\n  },\n\n  /*\n    return dirname of a path.\n    if path is '/', return '/'.\n  */\n  getDirName: function(path) {\n    let dir = path.slice(0, path.lastIndexOf('/'));\n    if (dir === '') {\n      return '/';\n    } else {\n      return dir;\n    }\n  },\n\n  isChildPath: function(child, parent) {\n    let p = this.getDirName(child);\n    return p === parent;\n  },\n\n  isAncestorPath: function(ancestor, path) {\n    return path.indexOf(ancestor) > -1;\n  },\n\n  renameAncestorPath: function(path, ancestor, newAncestor) {\n    return path.replace(ancestor, newAncestor);\n  },\n\n  joinPath: function(pathA, pathB) {\n    if (pathA[pathA.length-1] === '/') {\n      return pathA + pathB;\n    } else {\n      return pathA + '/' + pathB;\n    }\n  },\n\n  isSupportUploadFolder: function() {\n    return navigator.userAgent.indexOf('Firefox')!=-1 ||\n      navigator.userAgent.indexOf('Chrome') > -1 ||\n      navigator.userAgent.indexOf('Safari') > -1;\n  },\n\n  isIEBrower: function() { // is ie <= ie11 not include Edge\n    var userAgent = navigator.userAgent;\n    var isIE = userAgent.indexOf('compatible') > -1 && userAgent.indexOf('MSIE') > -1;\n    var isIE11 = userAgent.indexOf('Trident') > -1 && userAgent.indexOf('rv:11.0') > -1;\n    return isIE || isIE11;\n  },\n\n  getDefaultLibIconUrl: function(isBig) {\n    let size = Utils.isHiDPI() ? 48 : 24;\n    size = isBig ? 256 : size;\n    let icon_name = 'lib.png';\n    return mediaUrl + 'img/lib/' + size + '/' + icon_name;\n  },\n\n  getLibIconUrl: function(repo, isBig) {\n    let permission = repo.permission || repo.share_permission; //Compatible with regular repo and repo shared\n    let size = Utils.isHiDPI() ? 48 : 24;\n    size = isBig ? 256 : size;\n\n    let icon_name = 'lib.png';\n    if (repo.encrypted) {\n      icon_name = 'lib-encrypted.png';\n    }\n    switch (permission) {\n      case 'r':\n        icon_name = 'lib-readonly.png';\n        break;\n      case 'preview':\n        icon_name = 'lib-cloud-preview.png';\n        break;\n      case 'cloud-edit':\n        icon_name = 'lib-cloud-preview-edit.png';\n        break;\n    }\n\n    // must be the last\n    if (repo.status == 'read-only') {\n      icon_name = 'lib-readonly.png';\n    }\n\n    return mediaUrl + 'img/lib/' + size + '/' + icon_name;\n  },\n\n  getDirentIcon: function (dirent, isBig) {\n    let size = this.isHiDPI() ? 48 : 24;\n    size = isBig ? 192 : size;\n    if (dirent.isDir()) {\n      let readonly = false;\n      if (dirent.permission && (dirent.permission === 'r' || dirent.permission === 'preview')) {\n        readonly = true;\n      }\n      return this.getFolderIconUrl(readonly, size, dirent.has_been_shared_out);\n    } else {\n      return this.getFileIconUrl(dirent.name, size);\n    }\n  },\n\n  getAdminTemplateDirentIcon: function (dirent, isBig) {\n    let size = this.isHiDPI() ? 48 : 24;\n    size = isBig ? 192 : size;\n    if (dirent.is_file) {\n      return this.getFileIconUrl(dirent.obj_name, size);\n    } else {\n      return this.getFolderIconUrl();\n    }\n  },\n\n  getFolderIconUrl: function(readonly = false, size, sharedOut) {\n    if (!size) {\n      size = Utils.isHiDPI() ? 48 : 24;\n    }\n    size = size > 24 ? 192 : 24;\n    return `${mediaUrl}img/folder${readonly ? '-read-only' : ''}${sharedOut ? '-shared-out' : ''}-${size}.png`;\n  },\n\n  getFileIconUrl: function(filename, size) {\n    if (!size) {\n      size = Utils.isHiDPI() ? 48 : 24;\n    }\n    size = size > 24 ? 192 : 24;\n    let file_ext = '';\n    if (filename.lastIndexOf('.') == -1) {\n      return mediaUrl + 'img/file/' + size + '/' + this.FILEEXT_ICON_MAP['default'];\n    } else {\n      file_ext = filename.substr(filename.lastIndexOf('.') + 1).toLowerCase();\n    }\n\n    if (this.FILEEXT_ICON_MAP[file_ext]) {\n      return mediaUrl + 'img/file/' + size + '/' + this.FILEEXT_ICON_MAP[file_ext];\n    } else {\n      return mediaUrl + 'img/file/' + size + '/' + this.FILEEXT_ICON_MAP['default'];\n    }\n  },\n\n  getLibIconTitle: function(repo) {\n    var title;\n    let permission = repo.permission || repo.share_permission; //Compatible with regular repo and repo shared\n    if (repo.encrypted) {\n      title = gettext('Encrypted library');\n    } else if (repo.is_admin) { // shared with 'admin' permission\n      title = gettext('Admin access');\n    } else {\n      switch(permission) {\n        case 'rw':\n          title = gettext('Read-Write library');\n          break;\n        case 'r':\n          title = gettext('Read-Only library');\n          break;\n        case 'cloud-edit':\n          title = gettext('Online Read-Write library');\n          break;\n        case 'preview':\n          title = gettext('Online Read-Only library');\n          break;\n      }\n    }\n    return title;\n  },\n\n  getFolderIconTitle: function(options) {\n    var title;\n    switch(options.permission) {\n      case 'rw':\n        title = gettext('Read-Write folder');\n        break;\n      case 'r':\n        title = gettext('Read-Only folder');\n        break;\n      case 'cloud-edit':\n        title = gettext('Online Read-Write folder');\n        break;\n      case 'preview':\n        title = gettext('Online Read-Only folder');\n        break;\n    }\n    return title;\n  },\n\n  getFolderOperationList: function(isRepoOwner, currentRepoInfo, dirent, isContextmenu) {\n\n    let list = [];\n    const { SHARE, DOWNLOAD, DELETE, RENAME, MOVE, COPY, PERMISSION, OPEN_VIA_CLIENT } = TextTranslation;\n    const permission = dirent.permission;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(permission);\n\n    if (isContextmenu) {\n      if (permission == 'rw' || permission == 'r') {\n        list.push(DOWNLOAD);\n      }\n\n      if (isCustomPermission && customPermission.permission.download) {\n        list.push(DOWNLOAD);\n      }\n\n      if (Utils.isHasPermissionToShare(currentRepoInfo, permission, dirent)) {\n        list.push(SHARE);\n      }\n\n      if (permission == 'rw' || permission == 'cloud-edit') {\n        list.push(DELETE, 'Divider');\n      }\n\n      if (isCustomPermission && customPermission.permission.delete) {\n        list.push(DELETE, 'Divider');\n      }\n    }\n\n    if (permission == 'rw' || permission == 'cloud-edit') {\n      list.push(RENAME, MOVE);\n    }\n\n    if (isCustomPermission && customPermission.permission.modify) {\n      list.push(RENAME, MOVE);\n    }\n\n    if (permission == 'rw' || permission == 'cloud-edit') {\n      list.push(COPY);\n    }\n\n    if (isCustomPermission && customPermission.permission.copy) {\n      list.push(COPY);\n    }\n\n    if (permission == 'rw') {\n      if (folderPermEnabled  && ((isRepoOwner && currentRepoInfo.has_been_shared_out) || currentRepoInfo.is_admin)) {\n        list.push('Divider', PERMISSION);\n      }\n      list.push('Divider', OPEN_VIA_CLIENT);\n    }\n\n    if (permission == 'r' && !currentRepoInfo.encrypted) {\n      list.push(COPY);\n    }\n\n    // if the last item of menuList is ‘Divider’, delete the last item\n    if (list[list.length - 1] === 'Divider') {\n      list.pop();\n    }\n\n    return list;\n  },\n\n  getFileOperationList: function(isRepoOwner, currentRepoInfo, dirent, isContextmenu) {\n    let list = [];\n    const { SHARE, DOWNLOAD, DELETE, RENAME, MOVE, COPY, TAGS, UNLOCK, LOCK, UNFREEZE_DOCUMENT, FREEZE_DOCUMENT,\n      HISTORY, ACCESS_LOG, PROPERTIES, OPEN_VIA_CLIENT, ONLYOFFICE_CONVERT, CONVERT_TO_MARKDOWN, CONVERT_TO_DOCX, EXPORT_DOCX, CONVERT_TO_SDOC } = TextTranslation;\n    const permission = dirent.permission;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(permission);\n\n    if (isContextmenu) {\n      if (permission == 'rw' || permission == 'r') {\n        list.push(DOWNLOAD);\n      }\n\n      if (isCustomPermission && customPermission.permission.download) {\n        list.push(DOWNLOAD);\n      }\n\n      if (Utils.isHasPermissionToShare(currentRepoInfo, permission, dirent)) {\n        list.push(SHARE);\n      }\n\n      if (permission == 'rw' || permission == 'cloud-edit') {\n        if (!dirent.is_locked || (dirent.is_locked && dirent.locked_by_me)) {\n          list.push(DELETE);\n        }\n        list.push('Divider');\n      }\n\n      if (isCustomPermission && customPermission.permission.delete) {\n        if (!dirent.is_locked || (dirent.is_locked && dirent.locked_by_me)) {\n          list.push(DELETE);\n        }\n        list.push('Divider');\n      }\n    }\n\n    if (permission == 'rw' || permission == 'cloud-edit') {\n      if (!dirent.is_locked || (dirent.is_locked && dirent.locked_by_me)) {\n        list.push(RENAME, MOVE);\n      }\n    }\n\n    if (isCustomPermission && customPermission.permission.modify) {\n      if (!dirent.is_locked || (dirent.is_locked && dirent.locked_by_me)) {\n        list.push(RENAME, MOVE);\n      }\n    }\n\n    if (permission == 'rw' || permission == 'cloud-edit') {\n      list.push(COPY);\n    }\n\n    if (isCustomPermission) {\n      if (customPermission.permission.copy) {\n        list.push(COPY);\n      }\n    }\n\n    if (permission == 'rw') {\n      list.push(TAGS);\n      if (isPro) {\n        if (dirent.is_locked) {\n          if (dirent.locked_by_me || dirent.lock_owner == 'OnlineOffice' || isRepoOwner || currentRepoInfo.is_admin) {\n            if (!dirent.name.endsWith('.sdoc')) {\n              list.push(UNLOCK);\n            }\n          }\n        } else {\n          if (!dirent.name.endsWith('.sdoc')) {\n            list.push(LOCK);\n          }\n        }\n      }\n\n      list.push('Divider');\n\n      if (isPro && !dirent.is_locked && dirent.name.endsWith('.sdoc')) {\n        list.push(FREEZE_DOCUMENT);\n      }\n      if (isPro && dirent.is_locked && dirent.name.endsWith('.sdoc')) {\n        list.push(UNFREEZE_DOCUMENT);\n      }\n\n    }\n\n    if ((permission == 'rw' || permission == 'cloud-edit') && enableSeadoc && !currentRepoInfo.encrypted) {\n      if (dirent.name.endsWith('.md') || dirent.name.endsWith('.docx')) {\n        list.push(CONVERT_TO_SDOC);\n      }\n\n      if (dirent.name.endsWith('.sdoc')) {\n        list.push(CONVERT_TO_MARKDOWN);\n        list.push(CONVERT_TO_DOCX);\n        list.push(EXPORT_DOCX);\n      }\n    }\n\n    if (permission == 'rw') {\n      list.push('Divider');\n      list.push(PROPERTIES, HISTORY);\n      if (isPro && fileAuditEnabled) {\n        list.push(ACCESS_LOG);\n      }\n      list.push('Divider', OPEN_VIA_CLIENT);\n    }\n\n    if (permission == 'r') {\n      if (!currentRepoInfo.encrypted) {\n        list.push(COPY);\n      }\n      list.push(HISTORY);\n    }\n\n    if (permission == 'rw' && enableOnlyoffice &&\n      onlyofficeConverterExtensions.includes(this.getFileExtension(dirent.name, false))) {\n      list.push(ONLYOFFICE_CONVERT);\n    }\n\n    // if the last item of menuList is ‘Divider’, delete the last item\n    if (list[list.length - 1] === 'Divider') {\n      list.pop();\n    }\n\n    // Remove adjacent excess 'Divider'\n    for (let i = 0; i < list.length; i++) {\n      if (list[i] === 'Divider' && list[i + 1] === 'Divider') {\n        list.splice(i, 1);\n        i--;\n      }\n    }\n\n    return list;\n  },\n\n  getFileExtension: function (fileName, withoutDot) {\n    let parts = fileName.toLowerCase().split('.');\n\n    return withoutDot ? parts.pop() : '.' + parts.pop();\n  },\n\n  getDirentOperationList: function(isRepoOwner, currentRepoInfo, dirent, isContextmenu) {\n    return dirent.type == 'dir' ?\n      Utils.getFolderOperationList(isRepoOwner, currentRepoInfo, dirent, isContextmenu) :\n      Utils.getFileOperationList(isRepoOwner, currentRepoInfo, dirent, isContextmenu);\n  },\n\n  sharePerms: function(permission) {\n    var title;\n    switch(permission) {\n      case 'rw':\n        title = gettext('Read-Write');\n        break;\n      case 'r':\n        title = gettext('Read-Only');\n        break;\n      case 'admin':\n        title = gettext('Admin');\n        break;\n      case 'cloud-edit':\n        title = gettext('Online Read-Write');\n        break;\n      case 'preview':\n        title = gettext('Online Read-Only');\n        break;\n      case 'invisible':\n        title = gettext('Invisible');\n        break;\n    }\n    return title;\n  },\n\n  sharePermsExplanation: function(permission) {\n    var title;\n    switch(permission) {\n      case 'rw':\n        title = gettext('User can read, write, upload, download and sync files.');\n        break;\n      case 'r':\n        title = gettext('User can read, download and sync files.');\n        break;\n      case 'admin':\n        title = gettext('Besides Write permission, user can also share the library.');\n        break;\n      case 'cloud-edit':\n        title = gettext('User can view and edit file online via browser. Files can\\'t be downloaded.');\n        break;\n      case 'preview':\n        title = gettext('User can only view files online via browser. Files can\\'t be downloaded.');\n        break;\n      case 'invisible':\n        title = gettext('User can not see this folder.');\n        break;\n    }\n    return title;\n  },\n\n  getShareLinkPermissionObject: function(permission) {\n    switch (permission) {\n      case 'preview_download':\n        return {\n          value: permission,\n          text: gettext('Preview and download'),\n          permissionDetails: {\n            'can_edit': false,\n            'can_download': true,\n            'can_upload': false\n          }\n        };\n      case 'preview_only':\n        return {\n          value: permission,\n          text: gettext('Preview only'),\n          permissionDetails: {\n            'can_edit': false,\n            'can_download': false,\n            'can_upload': false\n          }\n        };\n      case 'download_upload':\n        return {\n          value: permission,\n          text: gettext('Download and upload'),\n          permissionDetails: {\n            'can_edit': false,\n            'can_download': true,\n            'can_upload': true\n          }\n        };\n      case 'edit_download':\n        return {\n          value: permission,\n          text: gettext('Edit on cloud and download'),\n          permissionDetails: {\n            'can_edit': true,\n            'can_download': true,\n            'can_upload': false\n          }\n        };\n      case 'cloud_edit':\n        return {\n          value: permission,\n          text: gettext('Edit on cloud only'),\n          permissionDetails: {\n            'can_edit': true,\n            'can_download': false,\n            'can_upload': false\n          }\n        };\n    }\n    return {\n      text: '',\n    };\n  },\n\n  formatSize: function(options) {\n    /*\n     * param: {bytes, precision}\n     */\n    var bytes = options.bytes;\n    var precision = options.precision || 0;\n\n    var kilobyte = 1000;\n    var megabyte = kilobyte * 1000;\n    var gigabyte = megabyte * 1000;\n    var terabyte = gigabyte * 1000;\n\n    if ((bytes >= 0) && (bytes < kilobyte)) {\n      return bytes + ' B';\n\n    } else if ((bytes >= kilobyte) && (bytes < megabyte)) {\n      return (bytes / kilobyte).toFixed(precision) + ' KB';\n\n    } else if ((bytes >= megabyte) && (bytes < gigabyte)) {\n      return (bytes / megabyte).toFixed(precision) + ' MB';\n\n    } else if ((bytes >= gigabyte) && (bytes < terabyte)) {\n      return (bytes / gigabyte).toFixed(precision) + ' GB';\n\n    } else if (bytes >= terabyte) {\n      return (bytes / terabyte).toFixed(precision) + ' TB';\n\n    } else {\n      return bytes + ' B';\n    }\n  },\n\n  formatBitRate: function(bits) {\n    var Bs;\n    if (typeof bits !== 'number') {\n      return '';\n    }\n    Bs = bits / 8;\n    if (Bs >= 1000000000) {\n      return (Bs / 1000000000).toFixed(2) + ' GB/s';\n    }\n    if (Bs >= 1000000) {\n      return (Bs / 1000000).toFixed(2) + ' MB/s';\n    }\n    if (Bs >= 1000) {\n      return (Bs / 1000).toFixed(2) + ' kB/s';\n    }\n    return Bs.toFixed(2) + ' B/s';\n  },\n\n  isMarkdownFile: function(filePath) {\n    let index = filePath.lastIndexOf('.');\n    if (index === -1) {\n      return false;\n    } else {\n      let type = filePath.substring(index).toLowerCase();\n      if (type === '.md' || type === '.markdown') {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  },\n\n  isSdocFile: function(filePath) {\n    let index = filePath.lastIndexOf('.');\n    if (index === -1) {\n      return false;\n    } else {\n      let type = filePath.substring(index).toLowerCase();\n      if (type === '.sdoc') {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  },\n\n  isInternalFileLink: function(url, repoID) {\n    var re = new RegExp(serviceURL + '/lib/' + repoID + '/file.*');\n    return re.test(url);\n  },\n\n  isInternalMarkdownLink: function(url, repoID) {\n    // eslint-disable-next-line\n    var re = new RegExp(serviceURL + '/lib/' + repoID + '.*\\.md$');\n    return re.test(url);\n  },\n\n  isInternalDirLink: function(url, repoID) {\n    var re = new RegExp(serviceURL + '/library/' + repoID + '.*');\n    return re.test(url);\n  },\n\n  getPathFromInternalMarkdownLink: function(url, repoID) {\n    // eslint-disable-next-line\n    var re = new RegExp(serviceURL + '/lib/' + repoID + '/file' + '(.*\\.md)');\n    var array = re.exec(url);\n    var path = decodeURIComponent(array[1]);\n    return path;\n  },\n\n  getPathFromInternalDirLink: function(url, repoID) {\n    var re = new RegExp(serviceURL + '/library/' + repoID + '(/.*)');\n    var array = re.exec(url);\n    var path = decodeURIComponent(array[1]);\n    path = path.slice(1);\n    path = path.slice(path.indexOf('/'));\n    return path;\n  },\n\n  isWikiInternalMarkdownLink: function(url, slug) {\n    slug = encodeURIComponent(slug);\n    // eslint-disable-next-line\n    var re = new RegExp(serviceURL + '/published/' + slug + '.*\\.md$');\n    return re.test(url);\n  },\n\n  isWikiInternalDirLink: function(url, slug) {\n    slug = encodeURIComponent(slug);\n    var re = new RegExp(serviceURL + '/published/' + slug + '.*');\n    return re.test(url);\n  },\n\n  getPathFromWikiInternalMarkdownLink: function(url, slug) {\n    slug = encodeURIComponent(slug);\n    // eslint-disable-next-line\n    var re = new RegExp(serviceURL + '/published/' + slug + '(.*\\.md)');\n    var array = re.exec(url);\n    var path = array[1];\n    try {\n      path = decodeURIComponent(path);\n    } catch(err) {\n      path = path.replace(/%/g, '%25');\n      path = decodeURIComponent(path);\n    }\n    return path;\n  },\n\n  getPathFromWikiInternalDirLink: function(url, slug) {\n    slug = encodeURIComponent(slug);\n    var re = new RegExp(serviceURL + '/published/' + slug + '(/.*)');\n    var array = re.exec(url);\n    var path = array[1];\n    try {\n      path = decodeURIComponent(path);\n    } catch(err) {\n      path = path.replace(/%/g, '%25');\n      path = decodeURIComponent(path);\n    }\n    return path;\n  },\n\n  compareTwoWord: function(wordA, wordB) {\n    // compare wordA and wordB at lower case\n    // if wordA >= wordB, return 1\n    // if wordA < wordB, return -1\n\n    return compareTwoString(wordA, wordB);\n  },\n\n  // compare two strings which may have digits in them\n  // and compare those digits as number instead of string\n  compareStrWithNumbersIn: function(a, b) {\n    var reParts = /\\d+|\\D+/g;\n    var reDigit = /\\d/;\n    var aParts = a.match(reParts);\n    var bParts = b.match(reParts);\n    var isDigitPart;\n    var len = Math.min(aParts.length, bParts.length);\n    var aPart, bPart;\n\n    if (aParts && bParts &&\n      (isDigitPart = reDigit.test(aParts[0])) == reDigit.test(bParts[0])) {\n      // Loop through each substring part to compare the overall strings.\n      for (var i = 0; i < len; i++) {\n        aPart = aParts[i];\n        bPart = bParts[i];\n\n        if (isDigitPart) {\n          aPart = parseInt(aPart, 10);\n          bPart = parseInt(bPart, 10);\n        }\n\n        if (aPart != bPart) {\n          return aPart < bPart ? -1 : 1;\n        }\n\n        // Toggle the value of isDigitPart since the parts will alternate.\n        isDigitPart = !isDigitPart;\n      }\n    }\n\n    // Use normal comparison.\n    return (a >= b) - (a <= b);\n  },\n\n  sortRepos: function(repos, sortBy, sortOrder) {\n    const _this = this;\n    let comparator;\n\n    switch (`${sortBy}-${sortOrder}`) {\n      case 'name-asc':\n        comparator = function(a, b) {\n          if (!a.repo_name) {\n            return 1;\n          }\n          if (!b.repo_name) {\n            return -1;\n          }\n          var result = _this.compareTwoWord(a.repo_name, b.repo_name);\n          return result;\n        };\n        break;\n      case 'name-desc':\n        comparator = function(a, b) {\n          if (!a.repo_name) {\n            return -1;\n          }\n          if (!b.repo_name) {\n            return 1;\n          }\n          var result = _this.compareTwoWord(a.repo_name, b.repo_name);\n          return -result;\n        };\n        break;\n      case 'time-asc':\n        comparator = function(a, b) {\n          return a.last_modified < b.last_modified ? -1 : 1;\n        };\n        break;\n      case 'time-desc':\n        comparator = function(a, b) {\n          return a.last_modified < b.last_modified ? 1 : -1;\n        };\n        break;\n      case 'size-asc':\n        comparator = function(a, b) {\n          if (a.size === b.size) {\n            let result = _this.compareTwoWord(a.repo_name, b.repo_name);\n            return result;\n          }\n          return a.size_original < b.size_original ? -1 : 1;\n        };\n        break;\n      case 'size-desc':\n        comparator = function(a, b) {\n          if (a.size === b.size) {\n            let result = _this.compareTwoWord(a.repo_name, b.repo_name);\n            return -result;\n          }\n\n          return a.size_original < b.size_original ? 1 : -1;\n        };\n        break;\n    }\n\n    repos.sort(comparator);\n    return repos;\n  },\n\n  sortDirents: function(items, sortBy, sortOrder) {\n    const _this = this;\n    let comparator;\n\n    switch (`${sortBy}-${sortOrder}`) {\n      case 'name-asc':\n        comparator = function(a, b) {\n          var result = _this.compareTwoWord(a.name, b.name);\n          return result;\n        };\n        break;\n      case 'name-desc':\n        comparator = function(a, b) {\n          var result = _this.compareTwoWord(a.name, b.name);\n          return -result;\n        };\n        break;\n      case 'time-asc':\n        comparator = function(a, b) {\n          return a.mtime < b.mtime ? -1 : 1;\n        };\n        break;\n      case 'time-desc':\n        comparator = function(a, b) {\n          return a.mtime < b.mtime ? 1 : -1;\n        };\n        break;\n      case 'size-asc':\n        comparator = function(a, b) {\n          if (a.type == 'dir' && b.type == 'dir') {\n            return 0;\n          }\n          return a.size_original < b.size_original ? -1 : 1;\n        };\n        break;\n      case 'size-desc':\n        comparator = function(a, b) {\n          if (a.type == 'dir' && b.type == 'dir') {\n            return 0;\n          }\n          return a.size_original < b.size_original ? 1 : -1;\n        };\n        break;\n    }\n\n    items.sort((a, b) => {\n      if (a.type == 'dir' && b.type == 'file') {\n        return -1;\n      } else if (a.type == 'file' && b.type == 'dir') {\n        return 1;\n      } else {\n        return comparator(a, b);\n      }\n    });\n    return items;\n  },\n\n  // sort dirents in shared folder\n  sortDirentsInSharedDir: function(items, sortBy, sortOrder) {\n    const _this = this;\n    let comparator;\n\n    switch (`${sortBy}-${sortOrder}`) {\n      case 'name-asc':\n        comparator = function(a, b) {\n          let result;\n          if (a.is_dir) {\n            result = _this.compareTwoWord(a.folder_name, b.folder_name);\n          } else {\n            result = _this.compareTwoWord(a.file_name, b.file_name);\n          }\n          return result;\n        };\n        break;\n      case 'name-desc':\n        comparator = function(a, b) {\n          let result;\n          if (a.is_dir) {\n            result = _this.compareTwoWord(a.folder_name, b.folder_name);\n          } else {\n            result = _this.compareTwoWord(a.file_name, b.file_name);\n          }\n          return -result;\n        };\n        break;\n      case 'time-asc':\n        comparator = function(a, b) {\n          return a.last_modified < b.last_modified ? -1 : 1;\n        };\n        break;\n      case 'time-desc':\n        comparator = function(a, b) {\n          return a.last_modified < b.last_modified ? 1 : -1;\n        };\n        break;\n      case 'size-asc':\n        comparator = function(a, b) {\n          if (a.is_dir) {\n            return 0;\n          } else {\n            return a.size < b.size ? -1 : 1;\n          }\n        };\n        break;\n      case 'size-desc':\n        comparator = function(a, b) {\n          if (a.is_dir) {\n            return 0;\n          } else {\n            return a.size < b.size ? 1 : -1;\n          }\n        };\n        break;\n    }\n\n    items.sort((a, b) => {\n      if (a.is_dir && !b.is_dir) {\n        return -1;\n      } else if (!a.is_dir && b.is_dir) {\n        return 1;\n      } else {\n        return comparator(a, b);\n      }\n    });\n    return items;\n  },\n\n  /*\n   * only used in the 'catch' part of a seafileAPI request\n   */\n  getErrorMsg: function(error, showPermissionDeniedTip) {\n    let errorMsg = '';\n    if (error.response) {\n      if (error.response.status == 403) {\n        if (showPermissionDeniedTip) {\n          toaster.danger(\n            <PermissionDeniedTip />,\n            {id: 'permission_denied', duration: 3600}\n          );\n        }\n        errorMsg = gettext('Permission denied');\n      } else if (error.response.status == 429) {\n        errorMsg = gettext('Too many requests');\n      } else if (error.response.data &&\n        error.response.data['error_msg']) {\n        errorMsg = error.response.data['error_msg'];\n      } else {\n        errorMsg = gettext('Error');\n      }\n    } else {\n      errorMsg = gettext('Please check the network.');\n    }\n    return errorMsg;\n  },\n\n  changeMarkdownNodes: function(nodes, fn) {\n    nodes.forEach((item) => {\n      fn(item);\n      if (item.children && item.children.length > 0){\n        Utils.changeMarkdownNodes(item.children, fn);\n      }\n    });\n    return nodes;\n  },\n\n  chooseLanguage: function(suffix) {\n    let mode;\n    switch(suffix) {\n      case 'py':\n        mode = 'python';\n        break;\n      case 'js':\n        mode = 'javascript';\n        break;\n      case 'c':\n        mode = 'c';\n        break;\n      case 'cpp':\n        mode = 'cpp';\n        break;\n      case 'cs':\n        mode = 'csharp';\n        break;\n      case 'java':\n        mode = 'java';\n        break;\n      case 'mdf':\n        mode = 'text/x-sql';\n        break;\n      case 'html':\n        mode = 'html';\n        break;\n      case 'sh':\n        mode = 'shell';\n        break;\n      default:\n        mode = suffix;\n    }\n    return mode;\n  },\n\n  DARK_COLOR_MAP: {\n    // old color\n    'red': '#D11507',\n    'orange': '#FF8C00',\n    'yellow': '#EDEF00',\n    'green': '#006400',\n    'cyan': '#00E0E1',\n    'blue': '#2510A3',\n    'indigo': '#350C56',\n    'purple': '#551054',\n    'pink': '#E3A5B0',\n    'azure': '#C4D0D0',\n    'lime': '#00E100',\n    'teal': '#006A6B',\n    'gray': '#545454',\n\n    // new color\n    '#FFA8A8': '#E49090',\n    '#FFA94D': '#E39136',\n    '#FFD43B': '#E0B815',\n    '#A0EC50': '#83CF32',\n    '#A9E34B': '#8DC72E',\n    '#63E6BE': '#43CAA4',\n    '#4FD2C9': '#2DB9B0',\n    '#72C3FC': '#57ABE3',\n    '#91A7FF': '#7A91E7',\n    '#E599F7': '#CC82DE',\n    '#B197FC': '#9B82E5',\n    '#F783AC': '#DF6D97',\n    '#CED4DA': '#A8ADB2',\n  },\n\n  getDarkColor: function(color) {\n    let darkColor;\n    darkColor = this.DARK_COLOR_MAP[color];\n    return darkColor;\n  },\n\n  getCopySuccessfulMessage: function(dirNames) {\n    let message;\n    let dirNamesLength = dirNames.length;\n    if (dirNamesLength === 1) {\n      message = gettext('Successfully copied %(name)s.');\n    } else if (dirNamesLength === 2) {\n      message = gettext('Successfully copied %(name)s and 1 other item.');\n    } else {\n      message = gettext('Successfully copied %(name)s and %(amount)s other items.');\n      message = message.replace('%(amount)s', dirNamesLength - 1);\n    }\n    message = message.replace('%(name)s', dirNames[0]);\n    return message;\n  },\n\n  getMoveSuccessMessage: function(dirNames) {\n    let message;\n    let dirNamesLength = dirNames.length;\n    if (dirNamesLength === 1) {\n      message = gettext('Successfully moved %(name)s.');\n    } else if (dirNamesLength === 2) {\n      message = gettext('Successfully moved %(name)s and 1 other item.');\n    } else {\n      message = gettext('Successfully moved %(name)s and %(amount)s other items.');\n      message = message.replace('%(amount)s', dirNamesLength - 1);\n    }\n    message = message.replace('%(name)s', dirNames[0]);\n    return message;\n  },\n\n  getCopyFailedMessage: function(dirNames) {\n    let message;\n    let dirNamesLength = dirNames.length;\n\n    if (dirNamesLength > 1) {\n      message = gettext('Failed to copy %(name)s and %(amount)s other item(s).');\n      message = message.replace('%(amount)s', dirNamesLength - 1);\n    } else {\n      message = gettext('Failed to copy %(name)s.');\n    }\n    message = message.replace('%(name)s', dirNames[0]);\n    return message;\n  },\n\n  getMoveFailedMessage: function(dirNames) {\n    let message;\n    let dirNamesLength = dirNames.length;\n    if (dirNamesLength > 1) {\n      message = gettext('Failed to move %(name)s and %(amount)s other item(s).');\n      message = message.replace('%(amount)s', dirNamesLength - 1);\n    } else {\n      message = gettext('Failed to move %(name)s.');\n    }\n    message = message.replace('%(name)s', dirNames[0]);\n    return message;\n  },\n\n  handleSearchedItemClick: function(searchedItem) {\n    if (searchedItem.is_dir === true) {\n      let url = siteRoot + 'library/' + searchedItem.repo_id + '/' + searchedItem.repo_name + searchedItem.path;\n      let newWindow = window.open('about:blank');\n      newWindow.location.href = url;\n    } else {\n      let url = siteRoot + 'lib/' + searchedItem.repo_id + '/file' + Utils.encodePath(searchedItem.path);\n      let newWindow = window.open('about:blank');\n      newWindow.location.href = url;\n    }\n  },\n\n  generatePassword: function(length, hasNum=1, hasChar=1, hasSymbol=1) {\n\n    var password = '';\n\n    // 65~90：A~Z\n    password += String.fromCharCode(Math.floor((Math.random() * (90-65)) + 65));\n\n    // 97~122：a~z\n    password += String.fromCharCode(Math.floor((Math.random() * (122-97)) + 97));\n\n    // 48~57：0~9\n    password += String.fromCharCode(Math.floor((Math.random() * (57-48)) + 48));\n\n    // 33~47：!~/\n    password += String.fromCharCode(Math.floor((Math.random() * (47-33)) + 33));\n\n    // 33~47：!~/\n    // 48~57：0~9\n    // 58~64：:~@\n    // 65~90：A~Z\n    // 91~96：[~`\n    // 97~122：a~z\n    // 123~127：{~\n    for (var i = 0; i < length-4; i++) {\n      var num = Math.floor((Math.random() * (127-33)) + 33);\n      password += String.fromCharCode(num);\n    }\n\n    return password;\n  },\n\n  pathNormalize: function(originalPath) {\n    let oldPath = originalPath.split('/');\n    let newPath = [];\n    for (let i = 0; i < oldPath.length; i++) {\n      if (oldPath[i] === '.' || oldPath[i] === '') {\n        continue;\n      } else if (oldPath[i] === '..') {\n        newPath.pop();\n      } else {\n        newPath.push(oldPath[i]);\n      }\n    }\n    return newPath.join('/');\n  },\n\n  getEventData: function(event, data) {\n    if (event.target.dataset) {\n      return event.target.dataset[data];\n    }\n    return event.target.getAttribute('data-' + data);\n\n  },\n\n  /**\n   * Check whether user has permission to share a dirent.\n   * If dirent is none, then check whether the user can share the repo\n   * scene 1: root path or folder path, control the share button in the toolbar\n   * scene 2: selected a dirent, control the share button in the toolbar dropdown-menu\n   * scene 3: dirent list(grid list), control the share button in the dirent-item or righe-menu\n   *\n   * @param {*} repoInfo\n   * @param {*} userDirPermission\n   * @param {*} dirent\n   */\n  isHasPermissionToShare: function(repoInfo, userDirPermission, dirent) {\n\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userDirPermission);\n    if (isCustomPermission) {\n      const { download_external_link } = customPermission.permission;\n      return download_external_link;\n    }\n\n    let { is_admin: isAdmin, is_virtual: isVirtual, encrypted: repoEncrypted, owner_email: ownerEmail } = repoInfo;\n    let isRepoOwner = ownerEmail === username;\n\n    if (repoEncrypted) {\n      return true;\n    }\n\n    // for 'file' & 'dir'\n    if (dirent) {\n      if (userDirPermission == 'rw' || userDirPermission == 'r') {\n        // can generate internal link\n        return true;\n      }\n    }\n\n    // the root path or the dirent type is dir\n    let hasGenerateShareLinkPermission = false;\n    if (canGenerateShareLink && (userDirPermission == 'rw' || userDirPermission == 'r')) {\n      hasGenerateShareLinkPermission = true;\n      return hasGenerateShareLinkPermission;\n    }\n\n    let hasGenerateUploadLinkPermission = false;\n    if (canGenerateUploadLink && (userDirPermission == 'rw')) {\n      hasGenerateUploadLinkPermission = true;\n      return hasGenerateUploadLinkPermission;\n    }\n\n    let hasDirPrivateSharePermission = false;\n    if (!isVirtual && (isRepoOwner || isAdmin)) {\n      hasDirPrivateSharePermission = true;\n      return hasDirPrivateSharePermission;\n    }\n\n    return false;\n  },\n\n  registerGlobalVariable: function(namespace, key, value) {\n    if (!window[namespace]) {\n      window[namespace] = {};\n    }\n    window[namespace][key] = value;\n  },\n\n  formatTime: function(seconds) {\n    var ss = parseInt(seconds);\n    var mm = 0;\n    var hh = 0;\n    if (ss > 60) {\n      mm = parseInt(ss / 60);\n      ss = parseInt(ss % 60);\n    }\n    if (mm > 60) {\n      hh = parseInt(mm / 60);\n      mm = parseInt(mm % 60);\n    }\n\n    var result = ('00' + parseInt(ss)).slice(-2);\n    if (mm > 0) {\n      result = ('00' + parseInt(mm)).slice(-2) + ':' + result;\n    } else {\n      result = '00:' + result;\n    }\n    if (hh > 0) {\n      result = ('00' + parseInt(hh)).slice(-2) + ':' + result;\n    } else {\n      result = '00:' + result;\n    }\n    return result;\n  },\n\n  hasNextPage(curPage, perPage, totalCount) {\n    return curPage * perPage < totalCount;\n  },\n\n  getStrengthLevel: function(pwd) {\n    const _this = this;\n    var num = 0;\n\n    if (pwd.length < shareLinkPasswordMinLength) {\n      return 0;\n    } else {\n      for (var i = 0; i < pwd.length; i++) {\n        // return the unicode\n        // bitwise OR\n        num |= _this.getCharMode(pwd.charCodeAt(i));\n      }\n      return _this.calculateBitwise(num);\n    }\n  },\n\n  getCharMode: function(n) {\n    if (n >= 48 && n <= 57) // nums\n      return 1;\n    if (n >= 65 && n <= 90) // uppers\n      return 2;\n    if (n >= 97 && n <= 122) // lowers\n      return 4;\n    else\n      return 8;\n  },\n\n  calculateBitwise: function(num) {\n    var level = 0;\n    for (var i = 0; i < 4; i++){\n      // bitwise AND\n      if (num&1) level++;\n      // Right logical shift\n      num>>>=1;\n    }\n    return level;\n  },\n\n  getSharedPermission: function(item) {\n    let permission = item.permission;\n    if (item.is_admin) {\n      permission = 'admin';\n    }\n    if (item.permission.startsWith('custom-')) {\n      permission = item.permission.slice(7);\n    }\n    return permission;\n  },\n\n  getUserPermission: function(userPerm) {\n    const { custom_permission } = window;\n    const common_permissions = ['rw', 'r', 'admin', 'cloud-edit', 'preview'];\n    // visit the shared repo(virtual repo) by custom permission\n    if (!custom_permission || common_permissions.indexOf(userPerm) > -1) {\n      return { isCustomPermission: false };\n    }\n    // userPerm is startsWith 'custom-'\n    if (custom_permission) {\n      const permissionId = custom_permission.id;\n      const userPermId = parseInt(userPerm.split('-')[1]);\n      if (permissionId === userPermId) {\n        return { isCustomPermission: true, customPermission: custom_permission };\n      }\n      // TODO user set custom permission on folder\n    }\n    return { isCustomPermission: false };\n  },\n\n  // for a11y\n  onKeyDown: function(e) {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      e.target.click();\n    }\n  },\n\n  updateTabTitle: function(content) {\n    const title = document.getElementsByTagName('title')[0];\n    title.innerText = content;\n  },\n\n  generateHistoryURL: function(siteRoot, repoID, path) {\n    if (!siteRoot || !repoID || !path) return '';\n    return siteRoot + 'repo/file_revisions/' + repoID + '/?p=' + this.encodePath(path);\n  },\n\n  generateRevisionURL: function(siteRoot, repoID, path) {\n    if (!siteRoot || !repoID || !path) return '';\n    return siteRoot + 'repo/sdoc_revision/' + repoID + '/?p=' + this.encodePath(path);\n  },\n\n  generateRevisionsURL: function(siteRoot, repoID, path) {\n    if (!siteRoot || !repoID || !path) return '';\n    return siteRoot + 'repo/sdoc_revisions/' + repoID + '/?p=' + this.encodePath(path);\n  },\n\n  isFunction: function(functionToCheck) {\n    const getType = {};\n    return functionToCheck && getType.toString.call(functionToCheck) === '[object Function]';\n  },\n\n  getUrlSearches() {\n    const search = location.search;\n    let searchParams = {};\n    if (search.length === 0) {\n      return searchParams;\n    }\n    let allSearches = search.split('?')[1];\n    let allSearchesArr = allSearches.split('&');\n    allSearchesArr.forEach(item => {\n      let itemArr = item.split('=');\n      searchParams[itemArr[0]] = decodeURI(itemArr[1]);\n    });\n    return searchParams;\n  },\n\n  // If value is null, delete the search parameter; else, add or update the search parameter.\n  updateSearchParameter(key, value) {\n    const { origin, pathname } = location;\n    const searchParams = this.getUrlSearches();\n    searchParams[key] = value;\n    let newSearch = '?';\n    for (let key in searchParams) {\n      let value = searchParams[key];\n      if (value) {\n        newSearch = newSearch === '?' ? `?${key}=${value}` : `${newSearch}&${key}=${value}`;\n      }\n    }\n    history.replaceState(null, '', origin + pathname + newSearch);\n  },\n\n  isRelativePath(url) {\n    let RgExp = new RegExp('^(?:[a-z]+:)?//', 'i');\n    return !RgExp.test(url);\n  }\n\n};\n\nexport const isMobile = (typeof (window) !== 'undefined') && (window.innerWidth < 768 || navigator.userAgent.toLowerCase().match(/(ipod|ipad|iphone|android|coolpad|mmp|smartphone|midp|wap|xoom|symbian|j2me|blackberry|wince)/i) != null);\n\nexport const validateName = (newName) => {\n  let isValid = true;\n  let errMessage = '';\n  if (!newName || !newName.trim()) {\n    isValid = false;\n    errMessage = gettext('Name is required');\n    return { isValid, errMessage };\n  }\n  if (newName.includes('/')) {\n    isValid = false;\n    errMessage = gettext('Name cannot contain slash');\n    return { isValid, errMessage };\n  }\n  if (newName.includes('`')) {\n    isValid = false;\n    errMessage = gettext('Name cannot contain backtick');\n    return { isValid, errMessage };\n  }\n  if (newName.includes('\\\\')) {\n    isValid = false;\n    errMessage = gettext('Name cannot contain backslash');\n    return { isValid, errMessage };\n  }\n  if (newName === '..') {\n    isValid = false;\n    errMessage = gettext('Name cannot be double dots');\n    return { isValid, errMessage };\n  }\n  return { isValid, errMessage };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}