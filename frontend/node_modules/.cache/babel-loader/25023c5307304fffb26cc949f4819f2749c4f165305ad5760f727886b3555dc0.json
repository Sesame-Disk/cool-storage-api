{"ast":null,"code":"import _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useEffect, useState } from 'react';\nimport context from '../../context';\nimport { getDiff } from '../utils/diff';\nimport SDocViewer from './sdoc-viewer';\nimport Loading from '../../components/loading';\nimport { CollaboratorsProvider } from '../../hooks';\nimport '../../assets/css/diff-viewer.css';\nvar RevisionDiffViewer = function RevisionDiffViewer(_ref) {\n  var editor = _ref.editor,\n    revisionContent = _ref.revisionContent,\n    didMountCallback = _ref.didMountCallback;\n  var _useState = useState(true),\n    _useState2 = _slicedToArray(_useState, 2),\n    isLoading = _useState2[0],\n    setIsLoading = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    diff = _useState4[0],\n    setDiff = _useState4[1];\n  useEffect(function () {\n    setIsLoading(true);\n    context.getSeadocOriginFileContent().then(function (res) {\n      var originContentString = res.data.content;\n      var originContent = JSON.parse(originContentString);\n      var diff = getDiff(revisionContent, originContent);\n      setDiff(diff);\n      didMountCallback && didMountCallback(diff);\n      setIsLoading(false);\n    }).catch(function (error) {\n      console.log('error');\n      setIsLoading(false);\n    });\n  }, [revisionContent, didMountCallback]);\n  useEffect(function () {\n    if (!editor) return;\n    editor.readonly = true;\n    return function () {\n      editor.selection = null;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  if (isLoading) {\n    return /*#__PURE__*/React.createElement(Loading, null);\n  }\n  return /*#__PURE__*/React.createElement(CollaboratorsProvider, null, /*#__PURE__*/React.createElement(SDocViewer, {\n    editor: editor,\n    document: {\n      children: diff.value\n    },\n    showToolbar: true,\n    showOutline: true,\n    showComment: true\n  }));\n};\nexport default RevisionDiffViewer;","map":{"version":3,"names":["React","useEffect","useState","context","getDiff","SDocViewer","Loading","CollaboratorsProvider","RevisionDiffViewer","_ref","editor","revisionContent","didMountCallback","_useState","_useState2","_slicedToArray","isLoading","setIsLoading","_useState3","_useState4","diff","setDiff","getSeadocOriginFileContent","then","res","originContentString","data","content","originContent","JSON","parse","catch","error","console","log","readonly","selection","createElement","document","children","value","showToolbar","showOutline","showComment"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/views/revision-diff-viewer.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport context from '../../context';\nimport { getDiff } from '../utils/diff';\nimport SDocViewer from './sdoc-viewer';\nimport Loading from '../../components/loading';\nimport { CollaboratorsProvider } from '../../hooks';\nimport '../../assets/css/diff-viewer.css';\nconst RevisionDiffViewer = _ref => {\n  let {\n    editor,\n    revisionContent,\n    didMountCallback\n  } = _ref;\n  const [isLoading, setIsLoading] = useState(true);\n  const [diff, setDiff] = useState(null);\n  useEffect(() => {\n    setIsLoading(true);\n    context.getSeadocOriginFileContent().then(res => {\n      const {\n        content: originContentString\n      } = res.data;\n      const originContent = JSON.parse(originContentString);\n      const diff = getDiff(revisionContent, originContent);\n      setDiff(diff);\n      didMountCallback && didMountCallback(diff);\n      setIsLoading(false);\n    }).catch(error => {\n      console.log('error');\n      setIsLoading(false);\n    });\n  }, [revisionContent, didMountCallback]);\n  useEffect(() => {\n    if (!editor) return;\n    editor.readonly = true;\n    return () => {\n      editor.selection = null;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  if (isLoading) {\n    return /*#__PURE__*/React.createElement(Loading, null);\n  }\n  return /*#__PURE__*/React.createElement(CollaboratorsProvider, null, /*#__PURE__*/React.createElement(SDocViewer, {\n    editor: editor,\n    document: {\n      children: diff.value\n    },\n    showToolbar: true,\n    showOutline: true,\n    showComment: true\n  }));\n};\nexport default RevisionDiffViewer;"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,OAAOC,OAAO,MAAM,eAAe;AACnC,SAASC,OAAO,QAAQ,eAAe;AACvC,OAAOC,UAAU,MAAM,eAAe;AACtC,OAAOC,OAAO,MAAM,0BAA0B;AAC9C,SAASC,qBAAqB,QAAQ,aAAa;AACnD,OAAO,kCAAkC;AACzC,IAAMC,kBAAkB,GAAG,SAArBA,kBAAkBA,CAAGC,IAAI,EAAI;EACjC,IACEC,MAAM,GAGJD,IAAI,CAHNC,MAAM;IACNC,eAAe,GAEbF,IAAI,CAFNE,eAAe;IACfC,gBAAgB,GACdH,IAAI,CADNG,gBAAgB;EAElB,IAAAC,SAAA,GAAkCX,QAAQ,CAAC,IAAI,CAAC;IAAAY,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAAzCG,SAAS,GAAAF,UAAA;IAAEG,YAAY,GAAAH,UAAA;EAC9B,IAAAI,UAAA,GAAwBhB,QAAQ,CAAC,IAAI,CAAC;IAAAiB,UAAA,GAAAJ,cAAA,CAAAG,UAAA;IAA/BE,IAAI,GAAAD,UAAA;IAAEE,OAAO,GAAAF,UAAA;EACpBlB,SAAS,CAAC,YAAM;IACdgB,YAAY,CAAC,IAAI,CAAC;IAClBd,OAAO,CAACmB,0BAA0B,CAAC,CAAC,CAACC,IAAI,CAAC,UAAAC,GAAG,EAAI;MAC/C,IACWC,mBAAmB,GAC1BD,GAAG,CAACE,IAAI,CADVC,OAAO;MAET,IAAMC,aAAa,GAAGC,IAAI,CAACC,KAAK,CAACL,mBAAmB,CAAC;MACrD,IAAML,IAAI,GAAGhB,OAAO,CAACO,eAAe,EAAEiB,aAAa,CAAC;MACpDP,OAAO,CAACD,IAAI,CAAC;MACbR,gBAAgB,IAAIA,gBAAgB,CAACQ,IAAI,CAAC;MAC1CH,YAAY,CAAC,KAAK,CAAC;IACrB,CAAC,CAAC,CAACc,KAAK,CAAC,UAAAC,KAAK,EAAI;MAChBC,OAAO,CAACC,GAAG,CAAC,OAAO,CAAC;MACpBjB,YAAY,CAAC,KAAK,CAAC;IACrB,CAAC,CAAC;EACJ,CAAC,EAAE,CAACN,eAAe,EAAEC,gBAAgB,CAAC,CAAC;EACvCX,SAAS,CAAC,YAAM;IACd,IAAI,CAACS,MAAM,EAAE;IACbA,MAAM,CAACyB,QAAQ,GAAG,IAAI;IACtB,OAAO,YAAM;MACXzB,MAAM,CAAC0B,SAAS,GAAG,IAAI;IACzB,CAAC;IACD;EACF,CAAC,EAAE,EAAE,CAAC;EACN,IAAIpB,SAAS,EAAE;IACb,OAAO,aAAahB,KAAK,CAACqC,aAAa,CAAC/B,OAAO,EAAE,IAAI,CAAC;EACxD;EACA,OAAO,aAAaN,KAAK,CAACqC,aAAa,CAAC9B,qBAAqB,EAAE,IAAI,EAAE,aAAaP,KAAK,CAACqC,aAAa,CAAChC,UAAU,EAAE;IAChHK,MAAM,EAAEA,MAAM;IACd4B,QAAQ,EAAE;MACRC,QAAQ,EAAEnB,IAAI,CAACoB;IACjB,CAAC;IACDC,WAAW,EAAE,IAAI;IACjBC,WAAW,EAAE,IAAI;IACjBC,WAAW,EAAE;EACf,CAAC,CAAC,CAAC;AACL,CAAC;AACD,eAAenC,kBAAkB"},"metadata":{},"sourceType":"module","externalDependencies":[]}