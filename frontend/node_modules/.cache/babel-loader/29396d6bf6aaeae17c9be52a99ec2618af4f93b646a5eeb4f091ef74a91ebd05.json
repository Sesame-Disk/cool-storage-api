{"ast":null,"code":"import _objectSpread from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Fragment}from'react';import MainPanelTopbar from'../main-panel-topbar';import moment from'moment';import StatisticNav from'./statistic-nav';import{Button,Input}from'reactstrap';import{siteRoot,gettext}from'../../../utils/constants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var StatisticReports=/*#__PURE__*/function(_React$Component){_inherits(StatisticReports,_React$Component);var _super=_createSuper(StatisticReports);function StatisticReports(props){var _this;_classCallCheck(this,StatisticReports);_this=_super.call(this,props);_this.handleChange=function(e){var month=e.target.value;_this.setState({month:month});};_this.onGenerateReports=function(type){var url=siteRoot+'api/v2.1/admin/statistics/';var month=_this.state.month;if(!month){var errorMessage=gettext('It is required.');_this.setState({errorMessage:errorMessage});return;}if(type==='month'){var pattern=/^([012]\\d{3})(0[1-9]|1[012])$/;if(!pattern.test(month)){var _errorMessage=gettext('Invalid month, should be yyyymm.');_this.setState({errorMessage:_errorMessage});return;}}switch(type){case'month':url+='system-user-traffic/excel/?month='+month;break;case'storage':url+='system-user-storage/excel/?';break;}_this.setState({errorMessage:''});window.location.href=url;};_this.state={month:moment().format('YYYYMM'),errorMessage:''};return _this;}_createClass(StatisticReports,[{key:\"render\",value:function render(){var errorMessage=this.state.errorMessage;return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(MainPanelTopbar,_objectSpread({},this.props)),/*#__PURE__*/_jsxs(\"div\",{className:\"cur-view-container\",children:[/*#__PURE__*/_jsx(StatisticNav,{currentItem:\"reportsStatistic\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cur-view-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"statistic-reports\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"statistic-reports-title\",children:gettext('Monthly User Traffic')}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center mt-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"statistic-reports-tip\",children:gettext('Month:')}),/*#__PURE__*/_jsx(Input,{className:\"statistic-reports-input\",defaultValue:moment().format('YYYYMM'),onChange:this.handleChange}),/*#__PURE__*/_jsx(Button,{className:\"statistic-reports-submit operation-item\",onClick:this.onGenerateReports.bind(this,'month'),children:gettext('Create Report')})]}),errorMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:errorMessage})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"statistic-reports\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"statistic-reports-title\",children:gettext('User Storage')}),/*#__PURE__*/_jsx(Button,{className:\"mt-4 operation-item\",onClick:this.onGenerateReports.bind(this,'storage'),children:gettext('Create Report')})]})]})]})]});}}]);return StatisticReports;}(React.Component);export default StatisticReports;","map":{"version":3,"names":["React","Fragment","MainPanelTopbar","moment","StatisticNav","Button","Input","siteRoot","gettext","jsx","_jsx","jsxs","_jsxs","StatisticReports","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","handleChange","e","month","target","value","setState","onGenerateReports","type","url","state","errorMessage","pattern","test","window","location","href","format","_createClass","key","render","children","_objectSpread","className","currentItem","defaultValue","onChange","onClick","bind","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/pages/sys-admin/statistic/statistic-reports.js"],"sourcesContent":["import React, { Fragment } from 'react';\nimport MainPanelTopbar from '../main-panel-topbar';\nimport moment from 'moment';\nimport StatisticNav from './statistic-nav';\nimport { Button, Input } from 'reactstrap';\nimport { siteRoot, gettext } from '../../../utils/constants';\n\nclass StatisticReports extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      month: moment().format('YYYYMM'),\n      errorMessage: ''\n    };\n  }\n\n  handleChange = (e) => {\n    let month = e.target.value;\n    this.setState({\n      month: month\n    });\n  };\n\n  onGenerateReports = (type) => {\n    let url = siteRoot + 'api/v2.1/admin/statistics/';\n    let { month } = this.state;\n    if (!month) {\n      let errorMessage = gettext('It is required.');\n      this.setState({\n        errorMessage: errorMessage\n      });\n      return;\n    }\n    if (type === 'month') {\n      let pattern = /^([012]\\d{3})(0[1-9]|1[012])$/;\n      if (!pattern.test(month)) {\n        let errorMessage = gettext('Invalid month, should be yyyymm.');\n        this.setState({\n          errorMessage: errorMessage\n        });\n        return;\n      }\n    }\n    switch(type) {\n      case 'month':\n        url += 'system-user-traffic/excel/?month=' + month;\n        break;\n      case 'storage':\n        url += 'system-user-storage/excel/?';\n        break;\n    }\n    this.setState({\n      errorMessage: ''\n    });\n    window.location.href = url;\n  };\n\n  render() {\n\n    let { errorMessage } = this.state;\n    return(\n      <Fragment>\n        <MainPanelTopbar {...this.props} />\n        <div className=\"cur-view-container\">\n          <StatisticNav currentItem=\"reportsStatistic\" />\n          <div className=\"cur-view-content\">\n            <div className=\"statistic-reports\">\n              <div className=\"statistic-reports-title\">{gettext('Monthly User Traffic')}</div>\n              <div className=\"d-flex align-items-center mt-4\">\n                <span className=\"statistic-reports-tip\">{gettext('Month:')}</span>\n                <Input className=\"statistic-reports-input\" defaultValue={moment().format('YYYYMM')} onChange={this.handleChange} />\n                <Button className=\"statistic-reports-submit operation-item\" onClick={this.onGenerateReports.bind(this, 'month')}>{gettext('Create Report')}</Button>\n              </div>\n              {errorMessage && <div className=\"error\">{errorMessage}</div>}\n            </div>\n            <div className=\"statistic-reports\">\n              <div className=\"statistic-reports-title\">{gettext('User Storage')}</div>\n              <Button className=\"mt-4 operation-item\" onClick={this.onGenerateReports.bind(this, 'storage')}>{gettext('Create Report')}</Button>\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nexport default StatisticReports;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}