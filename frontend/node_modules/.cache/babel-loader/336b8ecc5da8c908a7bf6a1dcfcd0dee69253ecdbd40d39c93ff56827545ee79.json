{"ast":null,"code":"import _classCallCheck from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport React from 'react';\nimport { Range } from '@seafile/slate';\nimport { unWrapLinkNode } from './helpers';\nimport LinkHover from './hover';\nimport EventBus from '../../../utils/event-bus';\nimport { INTERNAL_EVENT } from '../../../constants';\nimport { ELEMENT_TYPE } from '../../constants';\nimport InlineBugFixer from '../../commons/Inline-bug-fix-wrapper';\nvar LinkHoverMenuComponent = /*#__PURE__*/function (_React$Component) {\n  _inherits(LinkHoverMenuComponent, _React$Component);\n  var _super = _createSuper(LinkHoverMenuComponent);\n  function LinkHoverMenuComponent(props) {\n    var _this;\n    _classCallCheck(this, LinkHoverMenuComponent);\n    _this = _super.call(this, props);\n    _defineProperty(_assertThisInitialized(_this), \"registerEventHandle\", function () {\n      document.addEventListener('click', _this.onHideLinkMenu);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"unregisterEventHandle\", function () {\n      document.removeEventListener('click', _this.onHideLinkMenu);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onHideLinkMenu\", function () {\n      _this.setState({\n        isShowLinkMenu: false\n      }, function () {\n        _this.unregisterEventHandle();\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onLinkClick\", function (e) {\n      var _e$target$getBounding = e.target.getBoundingClientRect(),\n        top = _e$target$getBounding.top,\n        left = _e$target$getBounding.left,\n        width = _e$target$getBounding.width;\n      // top = top distance - menu height\n      var menuTop = top - 42;\n      // left = left distance - (menu width / 2) + (link with / 2)\n      var menuLeft = left - 140 / 2 + width / 2;\n      _this.setState({\n        isShowLinkMenu: true,\n        menuPosition: {\n          top: menuTop,\n          left: menuLeft\n        }\n      });\n      setTimeout(function () {\n        _this.registerEventHandle();\n      }, 0);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"deleteLink\", function () {\n      var editor = _this.props.editor;\n      unWrapLinkNode(editor);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"openDialog\", function () {\n      var element = _this.props.element;\n      _this.eventBus.dispatch(INTERNAL_EVENT.INSERT_ELEMENT, {\n        type: ELEMENT_TYPE.LINK,\n        element: element\n      });\n    });\n    _this.state = {\n      isShowLinkMenu: false,\n      menuPosition: null\n    };\n    _this.eventBus = EventBus.getInstance();\n    return _this;\n  }\n  _createClass(LinkHoverMenuComponent, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.unregisterEventHandle();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n        attributes = _this$props.attributes,\n        children = _this$props.children,\n        element = _this$props.element,\n        editor = _this$props.editor,\n        readonly = _this$props.readonly;\n      var _this$state = this.state,\n        isShowLinkMenu = _this$state.isShowLinkMenu,\n        menuPosition = _this$state.menuPosition;\n      var className = isShowLinkMenu ? 'seafile-ed-hovermenu-mouseclick' : null;\n      if (readonly) {\n        return /*#__PURE__*/React.createElement(\"span\", Object.assign({\n          className: className\n        }, attributes), /*#__PURE__*/React.createElement(\"a\", {\n          href: element.href,\n          title: element.title\n        }, children));\n      }\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"span\", Object.assign({\n        className: className\n      }, attributes, {\n        onClick: this.onLinkClick\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"virtual-link\",\n        title: element.title\n      }, /*#__PURE__*/React.createElement(InlineBugFixer, null), children, /*#__PURE__*/React.createElement(InlineBugFixer, null))), isShowLinkMenu && (this.props.readonly || Range.isCollapsed(editor.selection)) && /*#__PURE__*/React.createElement(LinkHover, {\n        editor: editor,\n        menuPosition: menuPosition,\n        element: element,\n        onDeleteLink: this.deleteLink,\n        onEditLink: this.openDialog\n      }));\n    }\n  }]);\n  return LinkHoverMenuComponent;\n}(React.Component);\nvar renderLink = function renderLink(props, editor, readonly) {\n  return /*#__PURE__*/React.createElement(LinkHoverMenuComponent, Object.assign({}, props, {\n    editor: editor,\n    readonly: readonly\n  }));\n};\nexport default renderLink;","map":{"version":3,"names":["_defineProperty","React","Range","unWrapLinkNode","LinkHover","EventBus","INTERNAL_EVENT","ELEMENT_TYPE","InlineBugFixer","LinkHoverMenuComponent","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","_assertThisInitialized","document","addEventListener","onHideLinkMenu","removeEventListener","setState","isShowLinkMenu","unregisterEventHandle","e","_e$target$getBounding","target","getBoundingClientRect","top","left","width","menuTop","menuLeft","menuPosition","setTimeout","registerEventHandle","editor","element","eventBus","dispatch","INSERT_ELEMENT","type","LINK","state","getInstance","_createClass","key","value","componentWillUnmount","render","_this$props","attributes","children","readonly","_this$state","className","createElement","Object","assign","href","title","Fragment","onClick","onLinkClick","isCollapsed","selection","onDeleteLink","deleteLink","onEditLink","openDialog","Component","renderLink"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/plugins/link/render-elem.js"],"sourcesContent":["import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport React from 'react';\nimport { Range } from '@seafile/slate';\nimport { unWrapLinkNode } from './helpers';\nimport LinkHover from './hover';\nimport EventBus from '../../../utils/event-bus';\nimport { INTERNAL_EVENT } from '../../../constants';\nimport { ELEMENT_TYPE } from '../../constants';\nimport InlineBugFixer from '../../commons/Inline-bug-fix-wrapper';\nclass LinkHoverMenuComponent extends React.Component {\n  constructor(props) {\n    super(props);\n    _defineProperty(this, \"registerEventHandle\", () => {\n      document.addEventListener('click', this.onHideLinkMenu);\n    });\n    _defineProperty(this, \"unregisterEventHandle\", () => {\n      document.removeEventListener('click', this.onHideLinkMenu);\n    });\n    _defineProperty(this, \"onHideLinkMenu\", () => {\n      this.setState({\n        isShowLinkMenu: false\n      }, () => {\n        this.unregisterEventHandle();\n      });\n    });\n    _defineProperty(this, \"onLinkClick\", e => {\n      const {\n        top,\n        left,\n        width\n      } = e.target.getBoundingClientRect();\n      // top = top distance - menu height\n      const menuTop = top - 42;\n      // left = left distance - (menu width / 2) + (link with / 2)\n      const menuLeft = left - 140 / 2 + width / 2;\n      this.setState({\n        isShowLinkMenu: true,\n        menuPosition: {\n          top: menuTop,\n          left: menuLeft\n        }\n      });\n      setTimeout(() => {\n        this.registerEventHandle();\n      }, 0);\n    });\n    _defineProperty(this, \"deleteLink\", () => {\n      const {\n        editor\n      } = this.props;\n      unWrapLinkNode(editor);\n    });\n    _defineProperty(this, \"openDialog\", () => {\n      const {\n        element\n      } = this.props;\n      this.eventBus.dispatch(INTERNAL_EVENT.INSERT_ELEMENT, {\n        type: ELEMENT_TYPE.LINK,\n        element\n      });\n    });\n    this.state = {\n      isShowLinkMenu: false,\n      menuPosition: null\n    };\n    this.eventBus = EventBus.getInstance();\n  }\n  componentWillUnmount() {\n    this.unregisterEventHandle();\n  }\n  render() {\n    const {\n      attributes,\n      children,\n      element,\n      editor,\n      readonly\n    } = this.props;\n    const {\n      isShowLinkMenu,\n      menuPosition\n    } = this.state;\n    const className = isShowLinkMenu ? 'seafile-ed-hovermenu-mouseclick' : null;\n    if (readonly) {\n      return /*#__PURE__*/React.createElement(\"span\", Object.assign({\n        className: className\n      }, attributes), /*#__PURE__*/React.createElement(\"a\", {\n        href: element.href,\n        title: element.title\n      }, children));\n    }\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"span\", Object.assign({\n      className: className\n    }, attributes, {\n      onClick: this.onLinkClick\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"virtual-link\",\n      title: element.title\n    }, /*#__PURE__*/React.createElement(InlineBugFixer, null), children, /*#__PURE__*/React.createElement(InlineBugFixer, null))), isShowLinkMenu && (this.props.readonly || Range.isCollapsed(editor.selection)) && /*#__PURE__*/React.createElement(LinkHover, {\n      editor: editor,\n      menuPosition: menuPosition,\n      element: element,\n      onDeleteLink: this.deleteLink,\n      onEditLink: this.openDialog\n    }));\n  }\n}\nconst renderLink = (props, editor, readonly) => {\n  return /*#__PURE__*/React.createElement(LinkHoverMenuComponent, Object.assign({}, props, {\n    editor: editor,\n    readonly: readonly\n  }));\n};\nexport default renderLink;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}