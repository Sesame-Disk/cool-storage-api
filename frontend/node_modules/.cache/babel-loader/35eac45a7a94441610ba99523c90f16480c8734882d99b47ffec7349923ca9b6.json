{"ast":null,"code":"import _regeneratorRuntime from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { eventStopPropagation } from '../../../utils/mouse-event';\nimport context from '../../../../context';\nimport { INTERNAL_EVENT } from '../../../constants';\nimport EventBus from '../../../utils/event-bus';\nimport { EXTERNAL_EVENT } from '../../../../constants';\nimport Tooltip from '../../../../components/tooltip';\nvar GlobalCommentHeader = function GlobalCommentHeader(_ref) {\n  var toggle = _ref.toggle,\n    toggleGlobalCommentEditor = _ref.toggleGlobalCommentEditor;\n  var _useTranslation = useTranslation(),\n    t = _useTranslation.t;\n  var panelHeaderRef = useRef(null);\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    isMounted = _useState2[0],\n    setIsMounted = _useState2[1];\n  useEffect(function () {\n    if (panelHeaderRef.current) {\n      setIsMounted(true);\n    }\n  }, []);\n  var toggleADDComment = useCallback(function (event) {\n    eventStopPropagation(event);\n    toggleGlobalCommentEditor();\n  }, [toggleGlobalCommentEditor]);\n  var toggleReadAll = useCallback( /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(event) {\n      var res, notifications, eventBus;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            eventStopPropagation(event);\n            _context.prev = 1;\n            _context.next = 4;\n            return context.readAllNotifications();\n          case 4:\n            _context.next = 6;\n            return context.listUnseenNotifications();\n          case 6:\n            res = _context.sent;\n            notifications = res.data.notifications;\n            eventBus = EventBus.getInstance();\n            eventBus.dispatch(INTERNAL_EVENT.UNSEEN_NOTIFICATIONS_COUNT, notifications === null || notifications === void 0 ? void 0 : notifications.length);\n            eventBus.dispatch(EXTERNAL_EVENT.NEW_NOTIFICATION);\n            eventBus.dispatch(EXTERNAL_EVENT.CLEAR_NOTIFICATION);\n            _context.next = 16;\n            break;\n          case 14:\n            _context.prev = 14;\n            _context.t0 = _context[\"catch\"](1);\n          case 16:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[1, 14]]);\n    }));\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"comments-panel-header\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"title\"\n  }, t('Comments')), /*#__PURE__*/React.createElement(\"div\", {\n    ref: panelHeaderRef,\n    className: \"comments-panel-header-right\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"sdoc-read-all-btn\",\n    className: \"sdoc-icon-btn\",\n    onClick: toggleReadAll\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-all-read\"\n  }), isMounted && /*#__PURE__*/React.createElement(Tooltip, {\n    target: \"sdoc-read-all-btn\"\n  }, t('Mark_all_as_read'))), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"sdoc-add-comment-btn\",\n    className: \"sdoc-icon-btn\",\n    onClick: toggleADDComment\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-add-comment\"\n  }), isMounted && /*#__PURE__*/React.createElement(Tooltip, {\n    target: \"sdoc-add-comment-btn\"\n  }, t('Add_comment'))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-icon-btn\",\n    onClick: toggle\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-sm-close\"\n  }))));\n};\nexport default GlobalCommentHeader;","map":{"version":3,"names":["React","useCallback","useEffect","useRef","useState","useTranslation","eventStopPropagation","context","INTERNAL_EVENT","EventBus","EXTERNAL_EVENT","Tooltip","GlobalCommentHeader","_ref","toggle","toggleGlobalCommentEditor","_useTranslation","t","panelHeaderRef","_useState","_useState2","_slicedToArray","isMounted","setIsMounted","current","toggleADDComment","event","toggleReadAll","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","notifications","eventBus","wrap","_callee$","_context","prev","next","readAllNotifications","listUnseenNotifications","sent","data","getInstance","dispatch","UNSEEN_NOTIFICATIONS_COUNT","length","NEW_NOTIFICATION","CLEAR_NOTIFICATION","t0","stop","_x","apply","arguments","createElement","className","ref","id","onClick","target"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/comment/components/global-comment/global-comment-header.js"],"sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { eventStopPropagation } from '../../../utils/mouse-event';\nimport context from '../../../../context';\nimport { INTERNAL_EVENT } from '../../../constants';\nimport EventBus from '../../../utils/event-bus';\nimport { EXTERNAL_EVENT } from '../../../../constants';\nimport Tooltip from '../../../../components/tooltip';\nconst GlobalCommentHeader = _ref => {\n  let {\n    toggle,\n    toggleGlobalCommentEditor\n  } = _ref;\n  const {\n    t\n  } = useTranslation();\n  const panelHeaderRef = useRef(null);\n  const [isMounted, setIsMounted] = useState(false);\n  useEffect(() => {\n    if (panelHeaderRef.current) {\n      setIsMounted(true);\n    }\n  }, []);\n  const toggleADDComment = useCallback(event => {\n    eventStopPropagation(event);\n    toggleGlobalCommentEditor();\n  }, [toggleGlobalCommentEditor]);\n  const toggleReadAll = useCallback(async event => {\n    eventStopPropagation(event);\n    try {\n      await context.readAllNotifications();\n      const res = await context.listUnseenNotifications();\n      const notifications = res.data.notifications;\n      const eventBus = EventBus.getInstance();\n      eventBus.dispatch(INTERNAL_EVENT.UNSEEN_NOTIFICATIONS_COUNT, notifications === null || notifications === void 0 ? void 0 : notifications.length);\n      eventBus.dispatch(EXTERNAL_EVENT.NEW_NOTIFICATION);\n      eventBus.dispatch(EXTERNAL_EVENT.CLEAR_NOTIFICATION);\n    } catch (error) {\n      //\n    }\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"comments-panel-header\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"title\"\n  }, t('Comments')), /*#__PURE__*/React.createElement(\"div\", {\n    ref: panelHeaderRef,\n    className: \"comments-panel-header-right\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"sdoc-read-all-btn\",\n    className: \"sdoc-icon-btn\",\n    onClick: toggleReadAll\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-all-read\"\n  }), isMounted && /*#__PURE__*/React.createElement(Tooltip, {\n    target: \"sdoc-read-all-btn\"\n  }, t('Mark_all_as_read'))), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"sdoc-add-comment-btn\",\n    className: \"sdoc-icon-btn\",\n    onClick: toggleADDComment\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-add-comment\"\n  }), isMounted && /*#__PURE__*/React.createElement(Tooltip, {\n    target: \"sdoc-add-comment-btn\"\n  }, t('Add_comment'))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-icon-btn\",\n    onClick: toggle\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-sm-close\"\n  }))));\n};\nexport default GlobalCommentHeader;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}