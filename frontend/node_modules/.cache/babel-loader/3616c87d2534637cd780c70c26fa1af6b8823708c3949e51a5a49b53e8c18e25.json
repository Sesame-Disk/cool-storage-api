{"ast":null,"code":"import _toConsumableArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport React, { useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport deepCopy from 'deep-copy';\nimport { Transforms } from '@seafile/slate';\nimport { useSlateStatic } from '@seafile/slate-react';\nimport { ELEMENT_TYPE } from '../../../constants';\nimport { REBASE_MARKS, REBASE_MARK_KEY, REBASE_ORIGIN } from '../../../../constants';\nimport { findPath, getNode, deleteNodeMark, updateRebaseParentNodeByPath } from '../../../core';\nvar RebaseModifyModifyDecorate = function RebaseModifyModifyDecorate(_ref) {\n  var element = _ref.element,\n    children = _ref.children;\n  var _useTranslation = useTranslation(),\n    t = _useTranslation.t;\n  var editor = useSlateStatic();\n  var useMasterChanges = useCallback(function () {\n    var path = findPath(editor, element);\n    deleteNodeMark(editor, path, element[REBASE_MARK_KEY.OLD_ELEMENT], REBASE_MARKS);\n    var nextElementPath = _toConsumableArray(path);\n    nextElementPath[path.length - 1] = path[path.length - 1] + 1;\n    Transforms.removeNodes(editor, {\n      at: nextElementPath\n    });\n    if (element.type === ELEMENT_TYPE.LIST_ITEM) {\n      updateRebaseParentNodeByPath(editor, path);\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [editor, element]);\n  var useCurrentChanges = useCallback(function () {\n    var path = findPath(editor, element);\n    var currentElementPath = _toConsumableArray(path);\n    currentElementPath[path.length - 1] = path[path.length - 1] + 1;\n    var currentElement = getNode(editor, currentElementPath);\n    var newCurrentElement = deepCopy(currentElement);\n    deleteNodeMark(editor, currentElementPath, newCurrentElement, REBASE_MARKS);\n    Transforms.removeNodes(editor, {\n      at: path\n    });\n    if (element.type === ELEMENT_TYPE.LIST_ITEM) {\n      updateRebaseParentNodeByPath(editor, path);\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [editor, element]);\n  var useBothChanges = useCallback(function () {\n    // delete element marks\n    var path = findPath(editor, element);\n    deleteNodeMark(editor, path, element, REBASE_MARKS);\n\n    // delete next element marks\n    var nextElementPath = [].concat(_toConsumableArray(path.slice(0, -1)), [path[path.length - 1] + 1]);\n    var nextElement = getNode(editor, nextElementPath);\n    deleteNodeMark(editor, nextElementPath, nextElement, REBASE_MARKS);\n    if (element.type === ELEMENT_TYPE.LIST_ITEM) {\n      updateRebaseParentNodeByPath(editor, path);\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [editor, element]);\n  if (element[REBASE_MARK_KEY.ORIGIN] === REBASE_ORIGIN.OTHER) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sdoc-rebase-btn-group\",\n      contentEditable: false\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sdoc-rebase-btn\",\n      onClick: useMasterChanges\n    }, t('Keep_other_modification')), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mr-2 ml-2\"\n    }, '|'), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sdoc-rebase-btn\",\n      onClick: useCurrentChanges\n    }, t('Keep_my_modification')), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mr-2 ml-2\"\n    }, '|'), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sdoc-rebase-btn\",\n      onClick: useBothChanges\n    }, t('Keep_both_modification'))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sdoc-rebase-other-changes-title\",\n      contentEditable: false\n    }, t('Other_modification')), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sdoc-rebase-other-changes\",\n      contentEditable: false\n    }, children));\n  }\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-rebase-my-changes-title\",\n    contentEditable: false\n  }, t('My_modification')), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-rebase-my-changes\",\n    contentEditable: false\n  }, children));\n};\nexport default RebaseModifyModifyDecorate;","map":{"version":3,"names":["React","useCallback","useTranslation","deepCopy","Transforms","useSlateStatic","ELEMENT_TYPE","REBASE_MARKS","REBASE_MARK_KEY","REBASE_ORIGIN","findPath","getNode","deleteNodeMark","updateRebaseParentNodeByPath","RebaseModifyModifyDecorate","_ref","element","children","_useTranslation","t","editor","useMasterChanges","path","OLD_ELEMENT","nextElementPath","_toConsumableArray","length","removeNodes","at","type","LIST_ITEM","useCurrentChanges","currentElementPath","currentElement","newCurrentElement","useBothChanges","concat","slice","nextElement","ORIGIN","OTHER","createElement","Fragment","className","contentEditable","onClick"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/render/element-decorate/rebase-decorate/rebase-modify-modify-decorate.js"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport deepCopy from 'deep-copy';\nimport { Transforms } from '@seafile/slate';\nimport { useSlateStatic } from '@seafile/slate-react';\nimport { ELEMENT_TYPE } from '../../../constants';\nimport { REBASE_MARKS, REBASE_MARK_KEY, REBASE_ORIGIN } from '../../../../constants';\nimport { findPath, getNode, deleteNodeMark, updateRebaseParentNodeByPath } from '../../../core';\nconst RebaseModifyModifyDecorate = _ref => {\n  let {\n    element,\n    children\n  } = _ref;\n  const {\n    t\n  } = useTranslation();\n  const editor = useSlateStatic();\n  const useMasterChanges = useCallback(() => {\n    const path = findPath(editor, element);\n    deleteNodeMark(editor, path, element[REBASE_MARK_KEY.OLD_ELEMENT], REBASE_MARKS);\n    const nextElementPath = [...path];\n    nextElementPath[path.length - 1] = path[path.length - 1] + 1;\n    Transforms.removeNodes(editor, {\n      at: nextElementPath\n    });\n    if (element.type === ELEMENT_TYPE.LIST_ITEM) {\n      updateRebaseParentNodeByPath(editor, path);\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [editor, element]);\n  const useCurrentChanges = useCallback(() => {\n    const path = findPath(editor, element);\n    const currentElementPath = [...path];\n    currentElementPath[path.length - 1] = path[path.length - 1] + 1;\n    const currentElement = getNode(editor, currentElementPath);\n    const newCurrentElement = deepCopy(currentElement);\n    deleteNodeMark(editor, currentElementPath, newCurrentElement, REBASE_MARKS);\n    Transforms.removeNodes(editor, {\n      at: path\n    });\n    if (element.type === ELEMENT_TYPE.LIST_ITEM) {\n      updateRebaseParentNodeByPath(editor, path);\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [editor, element]);\n  const useBothChanges = useCallback(() => {\n    // delete element marks\n    const path = findPath(editor, element);\n    deleteNodeMark(editor, path, element, REBASE_MARKS);\n\n    // delete next element marks\n    const nextElementPath = [...path.slice(0, -1), path[path.length - 1] + 1];\n    const nextElement = getNode(editor, nextElementPath);\n    deleteNodeMark(editor, nextElementPath, nextElement, REBASE_MARKS);\n    if (element.type === ELEMENT_TYPE.LIST_ITEM) {\n      updateRebaseParentNodeByPath(editor, path);\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [editor, element]);\n  if (element[REBASE_MARK_KEY.ORIGIN] === REBASE_ORIGIN.OTHER) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sdoc-rebase-btn-group\",\n      contentEditable: false\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sdoc-rebase-btn\",\n      onClick: useMasterChanges\n    }, t('Keep_other_modification')), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mr-2 ml-2\"\n    }, '|'), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sdoc-rebase-btn\",\n      onClick: useCurrentChanges\n    }, t('Keep_my_modification')), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mr-2 ml-2\"\n    }, '|'), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sdoc-rebase-btn\",\n      onClick: useBothChanges\n    }, t('Keep_both_modification'))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sdoc-rebase-other-changes-title\",\n      contentEditable: false\n    }, t('Other_modification')), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sdoc-rebase-other-changes\",\n      contentEditable: false\n    }, children));\n  }\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-rebase-my-changes-title\",\n    contentEditable: false\n  }, t('My_modification')), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-rebase-my-changes\",\n    contentEditable: false\n  }, children));\n};\nexport default RebaseModifyModifyDecorate;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}