{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Fragment}from'react';import moment from'moment';import{seafileAPI}from'../../../utils/seafile-api';import{Utils}from'../../../utils/utils';import toaster from'../../../components/toast';import ModalPortal from'../../../components/modal-portal';import DeleteRepoDialog from'../../../components/dialog/sysadmin-dialog/sysadmin-delete-repo-dialog';import{gettext,lang}from'../../../utils/constants';import RepoItem from'./repo-item';import Department from'./department';import'../../../css/org-department-item.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";moment.locale(lang);var DepartmentDetail=/*#__PURE__*/function(_React$Component){_inherits(DepartmentDetail,_React$Component);var _super=_createSuper(DepartmentDetail);function DepartmentDetail(props){var _this;_classCallCheck(this,DepartmentDetail);_this=_super.call(this,props);_this.listGroupRepo=function(groupID){seafileAPI.sysAdminListGroupRepos(groupID).then(function(res){_this.setState({repos:res.data.libraries});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.toggleCancel=function(){_this.setState({showDeleteRepoDialog:false});};_this.onRepoChanged=function(){_this.listGroupRepo(_this.props.groupID);};_this.showDeleteRepoDialog=function(repo){_this.setState({showDeleteRepoDialog:true,deletedRepo:repo});};_this.onAddNewRepo=function(newRepo){var repos=_this.state.repos;repos.unshift(newRepo);_this.setState({repos:repos});};_this.state={repos:[],deletedRepo:{},showDeleteRepoDialog:false};return _this;}_createClass(DepartmentDetail,[{key:\"componentDidMount\",value:function componentDidMount(){var groupID=this.props.groupID;this.listGroupRepo(groupID);}},{key:\"UNSAFE_componentWillReceiveProps\",value:function UNSAFE_componentWillReceiveProps(nextProps){if(this.props.groupID!==nextProps.groupID){this.listGroupRepo(nextProps.groupID);}}},{key:\"render\",value:function render(){var _this2=this;var repos=this.state.repos;var groupID=this.props.groupID;return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(Department,{groupID:groupID,currentItem:\"repos\",onAddNewRepo:this.onAddNewRepo,children:repos.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"cur-view-content\",children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{width:\"5%\"}),/*#__PURE__*/_jsx(\"th\",{width:\"50%\",children:gettext('Name')}),/*#__PURE__*/_jsx(\"th\",{width:\"30%\",children:gettext('Size')}),/*#__PURE__*/_jsx(\"th\",{width:\"15%\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:repos.map(function(repo,index){return/*#__PURE__*/_jsx(RepoItem,{repo:repo,showDeleteRepoDialog:_this2.showDeleteRepoDialog},index);})})]})}):/*#__PURE__*/_jsx(\"p\",{className:\"no-libraty\",children:gettext('No libraries')})}),this.state.showDeleteRepoDialog&&/*#__PURE__*/_jsx(ModalPortal,{children:/*#__PURE__*/_jsx(DeleteRepoDialog,{toggle:this.toggleCancel,onRepoChanged:this.onRepoChanged,repo:this.state.deletedRepo,groupID:groupID})})]});}}]);return DepartmentDetail;}(React.Component);export default DepartmentDetail;","map":{"version":3,"names":["React","Fragment","moment","seafileAPI","Utils","toaster","ModalPortal","DeleteRepoDialog","gettext","lang","RepoItem","Department","jsx","_jsx","jsxs","_jsxs","locale","DepartmentDetail","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","listGroupRepo","groupID","sysAdminListGroupRepos","then","res","setState","repos","data","libraries","catch","error","errMessage","getErrorMsg","danger","toggleCancel","showDeleteRepoDialog","onRepoChanged","repo","deletedRepo","onAddNewRepo","newRepo","state","unshift","_createClass","key","value","componentDidMount","UNSAFE_componentWillReceiveProps","nextProps","render","_this2","children","currentItem","length","className","width","map","index","toggle","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/pages/sys-admin/departments/department-libraries.js"],"sourcesContent":["import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { seafileAPI } from '../../../utils/seafile-api';\nimport { Utils } from '../../../utils/utils';\nimport toaster from '../../../components/toast';\nimport ModalPortal from '../../../components/modal-portal';\nimport DeleteRepoDialog from '../../../components/dialog/sysadmin-dialog/sysadmin-delete-repo-dialog';\nimport { gettext, lang } from '../../../utils/constants';\nimport RepoItem from './repo-item';\nimport Department from './department';\nimport '../../../css/org-department-item.css';\n\nmoment.locale(lang);\n\nconst DepartmentDetailPropTypes = {\n  groupID: PropTypes.string,\n};\n\nclass DepartmentDetail extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repos: [],\n      deletedRepo: {},\n      showDeleteRepoDialog: false\n    };\n  }\n\n  componentDidMount() {\n    const { groupID } = this.props;\n    this.listGroupRepo(groupID);\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (this.props.groupID !== nextProps.groupID) {\n      this.listGroupRepo(nextProps.groupID);\n    }\n  }\n\n  listGroupRepo = (groupID) => {\n    seafileAPI.sysAdminListGroupRepos(groupID).then(res => {\n      this.setState({ repos: res.data.libraries });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  toggleCancel = () => {\n    this.setState({\n      showDeleteRepoDialog: false\n    });\n  };\n\n  onRepoChanged = () => {\n    this.listGroupRepo(this.props.groupID);\n  };\n\n  showDeleteRepoDialog = (repo) => {\n    this.setState({ showDeleteRepoDialog: true, deletedRepo: repo });\n  };\n\n  onAddNewRepo = (newRepo) => {\n    const { repos } = this.state;\n    repos.unshift(newRepo);\n    this.setState({ repos });\n  };\n\n  render() {\n    const { repos } = this.state;\n    const { groupID } = this.props;\n\n    return (\n      <Fragment>\n        <Department groupID={groupID} currentItem=\"repos\" onAddNewRepo={this.onAddNewRepo}>\n          {repos.length > 0 ?\n            <div className=\"cur-view-content\">\n              <table>\n                <thead>\n                  <tr>\n                    <th width=\"5%\"></th>\n                    <th width=\"50%\">{gettext('Name')}</th>\n                    <th width=\"30%\">{gettext('Size')}</th>\n                    <th width=\"15%\"></th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {repos.map((repo, index) => {\n                    return (\n                      <RepoItem key={index} repo={repo} showDeleteRepoDialog={this.showDeleteRepoDialog} />\n                    );\n                  })}\n                </tbody>\n              </table>\n            </div>\n            : <p className=\"no-libraty\">{gettext('No libraries')}</p>\n          }\n        </Department>\n        {this.state.showDeleteRepoDialog && (\n          <ModalPortal>\n            <DeleteRepoDialog\n              toggle={this.toggleCancel}\n              onRepoChanged={this.onRepoChanged}\n              repo={this.state.deletedRepo}\n              groupID={groupID}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nDepartmentDetail.propTypes = DepartmentDetailPropTypes;\n\nexport default DepartmentDetail;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}