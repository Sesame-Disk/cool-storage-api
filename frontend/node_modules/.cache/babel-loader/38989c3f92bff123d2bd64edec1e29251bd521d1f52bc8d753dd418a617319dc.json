{"ast":null,"code":"import _createForOfIteratorHelper from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport React, { useCallback, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport Switch from '../../../switch';\nimport Tooltip from '../../../tooltip';\nimport { REVISION_DIFF_KEY, REVISION_DIFF_VALUE } from '../../../../basic-sdk/constants';\nimport './index.css';\nvar ViewChanges = function ViewChanges(_ref) {\n  var isShowChanges = _ref.isShowChanges,\n    propsOnViewChangesToggle = _ref.onViewChangesToggle;\n  var _useTranslation = useTranslation(),\n    t = _useTranslation.t;\n  useEffect(function () {\n    var url = new URL(window.location.href);\n    var searchParams = new URLSearchParams(url.search);\n    if (!searchParams.has(REVISION_DIFF_KEY)) return;\n    var firstLoadValue = searchParams.get(REVISION_DIFF_KEY);\n    if (firstLoadValue === REVISION_DIFF_VALUE) {\n      propsOnViewChangesToggle(true);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  var onViewChangesToggle = useCallback(function () {\n    var nextIsShowChanges = !isShowChanges;\n    var url = new URL(window.location.href);\n    var searchParams = new URLSearchParams(url.search);\n    var newParamsString = '';\n    var _iterator = _createForOfIteratorHelper(searchParams.entries()),\n      _step;\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var item = _step.value;\n        if (item[0] !== REVISION_DIFF_KEY) {\n          if (newParamsString) {\n            newParamsString = newParamsString + \"&\".concat(item[0], \"=\").concat(item[1]);\n          } else {\n            newParamsString = \"\".concat(item[0], \"=\").concat(item[1]);\n          }\n        }\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n    if (!searchParams.has(REVISION_DIFF_KEY) && nextIsShowChanges) {\n      if (newParamsString) {\n        newParamsString = newParamsString + \"&\".concat(REVISION_DIFF_KEY, \"=\").concat(REVISION_DIFF_VALUE);\n      } else {\n        newParamsString = \"\".concat(REVISION_DIFF_KEY, \"=\").concat(REVISION_DIFF_VALUE);\n      }\n    }\n    var validPathName = url.pathname.endsWith('/') ? url.pathname : url.pathname + '/';\n    var newURL = \"\".concat(url.origin).concat(validPathName).concat(newParamsString ? '?' + newParamsString : '');\n    window.history.replaceState(null, null, newURL);\n    propsOnViewChangesToggle(nextIsShowChanges);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isShowChanges, propsOnViewChangesToggle]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"sdoc-toggle-revision-changes-container\",\n    className: \"h-100 ml-4 d-flex align-items-center \"\n  }, /*#__PURE__*/React.createElement(Switch, {\n    checked: isShowChanges,\n    onChange: onViewChangesToggle,\n    className: \"sdoc-toggle-revision-changes d-flex align-items-center\"\n  })), /*#__PURE__*/React.createElement(Tooltip, {\n    target: \"sdoc-toggle-revision-changes-container\"\n  }, t('View_changes')));\n};\nexport default ViewChanges;","map":{"version":3,"names":["React","useCallback","useEffect","useTranslation","Switch","Tooltip","REVISION_DIFF_KEY","REVISION_DIFF_VALUE","ViewChanges","_ref","isShowChanges","propsOnViewChangesToggle","onViewChangesToggle","_useTranslation","t","url","URL","window","location","href","searchParams","URLSearchParams","search","has","firstLoadValue","get","nextIsShowChanges","newParamsString","_iterator","_createForOfIteratorHelper","entries","_step","s","n","done","item","value","concat","err","e","f","validPathName","pathname","endsWith","newURL","origin","history","replaceState","createElement","Fragment","id","className","checked","onChange","target"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/components/doc-operations/revision-operations/view-changes/index.js"],"sourcesContent":["import React, { useCallback, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport Switch from '../../../switch';\nimport Tooltip from '../../../tooltip';\nimport { REVISION_DIFF_KEY, REVISION_DIFF_VALUE } from '../../../../basic-sdk/constants';\nimport './index.css';\nconst ViewChanges = _ref => {\n  let {\n    isShowChanges,\n    onViewChangesToggle: propsOnViewChangesToggle\n  } = _ref;\n  const {\n    t\n  } = useTranslation();\n  useEffect(() => {\n    const url = new URL(window.location.href);\n    const searchParams = new URLSearchParams(url.search);\n    if (!searchParams.has(REVISION_DIFF_KEY)) return;\n    const firstLoadValue = searchParams.get(REVISION_DIFF_KEY);\n    if (firstLoadValue === REVISION_DIFF_VALUE) {\n      propsOnViewChangesToggle(true);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const onViewChangesToggle = useCallback(() => {\n    const nextIsShowChanges = !isShowChanges;\n    const url = new URL(window.location.href);\n    const searchParams = new URLSearchParams(url.search);\n    let newParamsString = '';\n    for (const item of searchParams.entries()) {\n      if (item[0] !== REVISION_DIFF_KEY) {\n        if (newParamsString) {\n          newParamsString = newParamsString + \"&\".concat(item[0], \"=\").concat(item[1]);\n        } else {\n          newParamsString = \"\".concat(item[0], \"=\").concat(item[1]);\n        }\n      }\n    }\n    if (!searchParams.has(REVISION_DIFF_KEY) && nextIsShowChanges) {\n      if (newParamsString) {\n        newParamsString = newParamsString + \"&\".concat(REVISION_DIFF_KEY, \"=\").concat(REVISION_DIFF_VALUE);\n      } else {\n        newParamsString = \"\".concat(REVISION_DIFF_KEY, \"=\").concat(REVISION_DIFF_VALUE);\n      }\n    }\n    const validPathName = url.pathname.endsWith('/') ? url.pathname : url.pathname + '/';\n    const newURL = \"\".concat(url.origin).concat(validPathName).concat(newParamsString ? '?' + newParamsString : '');\n    window.history.replaceState(null, null, newURL);\n    propsOnViewChangesToggle(nextIsShowChanges);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isShowChanges, propsOnViewChangesToggle]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"sdoc-toggle-revision-changes-container\",\n    className: \"h-100 ml-4 d-flex align-items-center \"\n  }, /*#__PURE__*/React.createElement(Switch, {\n    checked: isShowChanges,\n    onChange: onViewChangesToggle,\n    className: \"sdoc-toggle-revision-changes d-flex align-items-center\"\n  })), /*#__PURE__*/React.createElement(Tooltip, {\n    target: \"sdoc-toggle-revision-changes-container\"\n  }, t('View_changes')));\n};\nexport default ViewChanges;"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,WAAW,EAAEC,SAAS,QAAQ,OAAO;AACrD,SAASC,cAAc,QAAQ,eAAe;AAC9C,OAAOC,MAAM,MAAM,iBAAiB;AACpC,OAAOC,OAAO,MAAM,kBAAkB;AACtC,SAASC,iBAAiB,EAAEC,mBAAmB,QAAQ,iCAAiC;AACxF,OAAO,aAAa;AACpB,IAAMC,WAAW,GAAG,SAAdA,WAAWA,CAAGC,IAAI,EAAI;EAC1B,IACEC,aAAa,GAEXD,IAAI,CAFNC,aAAa;IACQC,wBAAwB,GAC3CF,IAAI,CADNG,mBAAmB;EAErB,IAAAC,eAAA,GAEIV,cAAc,CAAC,CAAC;IADlBW,CAAC,GAAAD,eAAA,CAADC,CAAC;EAEHZ,SAAS,CAAC,YAAM;IACd,IAAMa,GAAG,GAAG,IAAIC,GAAG,CAACC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAC;IACzC,IAAMC,YAAY,GAAG,IAAIC,eAAe,CAACN,GAAG,CAACO,MAAM,CAAC;IACpD,IAAI,CAACF,YAAY,CAACG,GAAG,CAACjB,iBAAiB,CAAC,EAAE;IAC1C,IAAMkB,cAAc,GAAGJ,YAAY,CAACK,GAAG,CAACnB,iBAAiB,CAAC;IAC1D,IAAIkB,cAAc,KAAKjB,mBAAmB,EAAE;MAC1CI,wBAAwB,CAAC,IAAI,CAAC;IAChC;IACA;EACF,CAAC,EAAE,EAAE,CAAC;EACN,IAAMC,mBAAmB,GAAGX,WAAW,CAAC,YAAM;IAC5C,IAAMyB,iBAAiB,GAAG,CAAChB,aAAa;IACxC,IAAMK,GAAG,GAAG,IAAIC,GAAG,CAACC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAC;IACzC,IAAMC,YAAY,GAAG,IAAIC,eAAe,CAACN,GAAG,CAACO,MAAM,CAAC;IACpD,IAAIK,eAAe,GAAG,EAAE;IAAC,IAAAC,SAAA,GAAAC,0BAAA,CACNT,YAAY,CAACU,OAAO,CAAC,CAAC;MAAAC,KAAA;IAAA;MAAzC,KAAAH,SAAA,CAAAI,CAAA,MAAAD,KAAA,GAAAH,SAAA,CAAAK,CAAA,IAAAC,IAAA,GAA2C;QAAA,IAAhCC,IAAI,GAAAJ,KAAA,CAAAK,KAAA;QACb,IAAID,IAAI,CAAC,CAAC,CAAC,KAAK7B,iBAAiB,EAAE;UACjC,IAAIqB,eAAe,EAAE;YACnBA,eAAe,GAAGA,eAAe,GAAG,GAAG,CAACU,MAAM,CAACF,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAACE,MAAM,CAACF,IAAI,CAAC,CAAC,CAAC,CAAC;UAC9E,CAAC,MAAM;YACLR,eAAe,GAAG,EAAE,CAACU,MAAM,CAACF,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAACE,MAAM,CAACF,IAAI,CAAC,CAAC,CAAC,CAAC;UAC3D;QACF;MACF;IAAC,SAAAG,GAAA;MAAAV,SAAA,CAAAW,CAAA,CAAAD,GAAA;IAAA;MAAAV,SAAA,CAAAY,CAAA;IAAA;IACD,IAAI,CAACpB,YAAY,CAACG,GAAG,CAACjB,iBAAiB,CAAC,IAAIoB,iBAAiB,EAAE;MAC7D,IAAIC,eAAe,EAAE;QACnBA,eAAe,GAAGA,eAAe,GAAG,GAAG,CAACU,MAAM,CAAC/B,iBAAiB,EAAE,GAAG,CAAC,CAAC+B,MAAM,CAAC9B,mBAAmB,CAAC;MACpG,CAAC,MAAM;QACLoB,eAAe,GAAG,EAAE,CAACU,MAAM,CAAC/B,iBAAiB,EAAE,GAAG,CAAC,CAAC+B,MAAM,CAAC9B,mBAAmB,CAAC;MACjF;IACF;IACA,IAAMkC,aAAa,GAAG1B,GAAG,CAAC2B,QAAQ,CAACC,QAAQ,CAAC,GAAG,CAAC,GAAG5B,GAAG,CAAC2B,QAAQ,GAAG3B,GAAG,CAAC2B,QAAQ,GAAG,GAAG;IACpF,IAAME,MAAM,GAAG,EAAE,CAACP,MAAM,CAACtB,GAAG,CAAC8B,MAAM,CAAC,CAACR,MAAM,CAACI,aAAa,CAAC,CAACJ,MAAM,CAACV,eAAe,GAAG,GAAG,GAAGA,eAAe,GAAG,EAAE,CAAC;IAC/GV,MAAM,CAAC6B,OAAO,CAACC,YAAY,CAAC,IAAI,EAAE,IAAI,EAAEH,MAAM,CAAC;IAC/CjC,wBAAwB,CAACe,iBAAiB,CAAC;IAC3C;EACF,CAAC,EAAE,CAAChB,aAAa,EAAEC,wBAAwB,CAAC,CAAC;EAC7C,OAAO,aAAaX,KAAK,CAACgD,aAAa,CAAChD,KAAK,CAACiD,QAAQ,EAAE,IAAI,EAAE,aAAajD,KAAK,CAACgD,aAAa,CAAC,KAAK,EAAE;IACpGE,EAAE,EAAE,wCAAwC;IAC5CC,SAAS,EAAE;EACb,CAAC,EAAE,aAAanD,KAAK,CAACgD,aAAa,CAAC5C,MAAM,EAAE;IAC1CgD,OAAO,EAAE1C,aAAa;IACtB2C,QAAQ,EAAEzC,mBAAmB;IAC7BuC,SAAS,EAAE;EACb,CAAC,CAAC,CAAC,EAAE,aAAanD,KAAK,CAACgD,aAAa,CAAC3C,OAAO,EAAE;IAC7CiD,MAAM,EAAE;EACV,CAAC,EAAExC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;AACxB,CAAC;AACD,eAAeN,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}