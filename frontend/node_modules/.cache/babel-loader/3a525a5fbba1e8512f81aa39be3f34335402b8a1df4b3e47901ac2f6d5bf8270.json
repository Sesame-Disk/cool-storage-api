{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _slugid = _interopRequireDefault(require(\"slugid\"));\nvar _constants = require(\"../constants\");\nvar _helper = require(\"../helper\");\nvar codeBlockRule = function codeBlockRule(element, parseChild) {\n  var nodeName = element.nodeName,\n    childNodes = element.childNodes;\n  if (nodeName === 'PRE') {\n    var children = Array.from(childNodes).filter(function (item) {\n      return item.nodeName === 'CODE';\n    });\n    var codeChild = children[0];\n    if (codeChild) {\n      var lang = codeChild.getAttribute('lang');\n      lang = (0, _helper.genCodeLangs)().find(function (item) {\n        return item.value === lang;\n      }) || 'plaintext';\n      return {\n        id: _slugid.default.nice(),\n        language: lang,\n        type: _constants.CODE_BLOCK,\n        children: parseChild(children)\n      };\n    } else {\n      var _lang = 'plaintext';\n      var content = childNodes[0].textContent;\n      var textArr = content.split('\\n').filter(Boolean);\n      var _children = textArr.map(function (text) {\n        return {\n          id: _slugid.default.nice(),\n          type: _constants.CODE_LINE,\n          children: [{\n            id: _slugid.default.nice(),\n            text: text\n          }]\n        };\n      });\n      return {\n        id: _slugid.default.nice(),\n        language: _lang,\n        type: _constants.CODE_BLOCK,\n        children: _children\n      };\n    }\n  }\n  if (nodeName === 'CODE' && element.parentElement.nodeName === 'PRE') {\n    var childIsP = Array.from(childNodes).every(function (n) {\n      return n.nodeName === 'P';\n    });\n    if (childIsP) {\n      return Array.from(childNodes).map(function (n) {\n        return {\n          id: _slugid.default.nice(),\n          type: _constants.CODE_LINE,\n          children: [{\n            id: _slugid.default.nice(),\n            text: n.textContent\n          }]\n        };\n      });\n    }\n    var _content = element.textContent;\n    var hasNewLine = _content.indexOf('\\n') > -1;\n    if (!hasNewLine) {\n      return {\n        id: _slugid.default.nice(),\n        type: _constants.CODE_LINE,\n        children: [{\n          id: _slugid.default.nice(),\n          text: element.textContent\n        }]\n      };\n    }\n    var codes = _content.split('\\n').filter(Boolean);\n    return codes.map(function (item) {\n      return {\n        id: _slugid.default.nice(),\n        type: _constants.CODE_LINE,\n        children: [{\n          id: _slugid.default.nice(),\n          text: item\n        }]\n      };\n    });\n  }\n  return;\n};\nvar _default = exports.default = codeBlockRule;","map":{"version":3,"names":["_interopRequireDefault","require","default","Object","defineProperty","exports","value","_slugid","_constants","_helper","codeBlockRule","element","parseChild","nodeName","childNodes","children","Array","from","filter","item","codeChild","lang","getAttribute","genCodeLangs","find","id","nice","language","type","CODE_BLOCK","content","textContent","textArr","split","Boolean","map","text","CODE_LINE","parentElement","childIsP","every","n","hasNewLine","indexOf","codes","_default"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/seafile-editor/dist/slate-convert/html-to-slate/rules/code-block.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _slugid = _interopRequireDefault(require(\"slugid\"));\nvar _constants = require(\"../constants\");\nvar _helper = require(\"../helper\");\nconst codeBlockRule = (element, parseChild) => {\n  const {\n    nodeName,\n    childNodes\n  } = element;\n  if (nodeName === 'PRE') {\n    const children = Array.from(childNodes).filter(item => item.nodeName === 'CODE');\n    let codeChild = children[0];\n    if (codeChild) {\n      let lang = codeChild.getAttribute('lang');\n      lang = (0, _helper.genCodeLangs)().find(item => item.value === lang) || 'plaintext';\n      return {\n        id: _slugid.default.nice(),\n        language: lang,\n        type: _constants.CODE_BLOCK,\n        children: parseChild(children)\n      };\n    } else {\n      const lang = 'plaintext';\n      const content = childNodes[0].textContent;\n      const textArr = content.split('\\n').filter(Boolean);\n      const children = textArr.map(text => {\n        return {\n          id: _slugid.default.nice(),\n          type: _constants.CODE_LINE,\n          children: [{\n            id: _slugid.default.nice(),\n            text: text\n          }]\n        };\n      });\n      return {\n        id: _slugid.default.nice(),\n        language: lang,\n        type: _constants.CODE_BLOCK,\n        children: children\n      };\n    }\n  }\n  if (nodeName === 'CODE' && element.parentElement.nodeName === 'PRE') {\n    const childIsP = Array.from(childNodes).every(n => n.nodeName === 'P');\n    if (childIsP) {\n      return Array.from(childNodes).map(n => {\n        return {\n          id: _slugid.default.nice(),\n          type: _constants.CODE_LINE,\n          children: [{\n            id: _slugid.default.nice(),\n            text: n.textContent\n          }]\n        };\n      });\n    }\n    const content = element.textContent;\n    const hasNewLine = content.indexOf('\\n') > -1;\n    if (!hasNewLine) {\n      return {\n        id: _slugid.default.nice(),\n        type: _constants.CODE_LINE,\n        children: [{\n          id: _slugid.default.nice(),\n          text: element.textContent\n        }]\n      };\n    }\n    const codes = content.split('\\n').filter(Boolean);\n    return codes.map(item => {\n      return {\n        id: _slugid.default.nice(),\n        type: _constants.CODE_LINE,\n        children: [{\n          id: _slugid.default.nice(),\n          text: item\n        }]\n      };\n    });\n  }\n  return;\n};\nvar _default = exports.default = codeBlockRule;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}