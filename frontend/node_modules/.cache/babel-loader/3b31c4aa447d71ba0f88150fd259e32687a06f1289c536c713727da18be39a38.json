{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import moment from'moment';import{seafileAPI}from'../../../utils/seafile-api';import{Utils}from'../../../utils/utils';import toaster from'../../../components/toast';import{gettext,lang}from'../../../utils/constants';import GroupItem from'./group-item';import Department from'./department';import'../../../css/org-department-item.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";moment.locale(lang);var SubDepartments=/*#__PURE__*/function(_React$Component){_inherits(SubDepartments,_React$Component);var _super=_createSuper(SubDepartments);function SubDepartments(props){var _this;_classCallCheck(this,SubDepartments);_this=_super.call(this,props);_this.listSubDepartments=function(groupID){seafileAPI.sysAdminGetDepartmentInfo(groupID,true).then(function(res){_this.setState({groups:res.data.groups});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.onSubDepartmentNameChanged=function(dept){_this.setState({groups:_this.state.groups.map(function(item){if(item.id==dept.id){item.name=dept.name;}return item;})});};_this.onFreezedItem=function(){_this.setState({isItemFreezed:true});};_this.onUnfreezedItem=function(){_this.setState({isItemFreezed:false});};_this.onAddNewDepartment=function(newDepartment){var groups=_this.state.groups;groups.unshift(newDepartment);_this.setState({groups:groups});};_this.onDeleteDepartment=function(id){var groups=_this.state.groups;_this.setState({groups:groups.filter(function(item){return item.id!=id;})});};_this.onSetDepartmentQuota=function(target){var groups=_this.state.groups;_this.setState({groups:groups.map(function(item){if(item.id==target.id){item.quota=target.quota;}return item;})});};_this.state={isItemFreezed:false,groups:[]};return _this;}_createClass(SubDepartments,[{key:\"componentDidMount\",value:function componentDidMount(){this.listSubDepartments(this.props.groupID);}},{key:\"UNSAFE_componentWillReceiveProps\",value:function UNSAFE_componentWillReceiveProps(nextProps){if(this.props.groupID!==nextProps.groupID){this.listSubDepartments(nextProps.groupID);}}},{key:\"render\",value:function render(){var _this2=this;var groups=this.state.groups;var groupID=this.props.groupID;return/*#__PURE__*/_jsx(Department,{groupID:groupID,currentItem:\"subDepartments\",onAddNewDepartment:this.onAddNewDepartment,children:/*#__PURE__*/_jsx(\"div\",{className:\"cur-view-content\",children:groups&&groups.length>0?/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{width:\"40%\",children:gettext('Name')}),/*#__PURE__*/_jsx(\"th\",{width:\"25%\",children:gettext('Created At')}),/*#__PURE__*/_jsx(\"th\",{width:\"20%\",children:gettext('Quota')}),/*#__PURE__*/_jsx(\"th\",{width:\"15%\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:groups.map(function(group,index){return/*#__PURE__*/_jsx(GroupItem,{isItemFreezed:_this2.state.isItemFreezed,onFreezedItem:_this2.onFreezedItem,onUnfreezedItem:_this2.onUnfreezedItem,onDepartmentNameChanged:_this2.onSubDepartmentNameChanged,group:group,onDeleteDepartment:_this2.onDeleteDepartment,onSetDepartmentQuota:_this2.onSetDepartmentQuota},group.id);})})]}):/*#__PURE__*/_jsx(\"p\",{className:\"no-group\",children:gettext('No sub-departments')})})});}}]);return SubDepartments;}(React.Component);export default SubDepartments;","map":{"version":3,"names":["React","moment","seafileAPI","Utils","toaster","gettext","lang","GroupItem","Department","jsx","_jsx","jsxs","_jsxs","locale","SubDepartments","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","listSubDepartments","groupID","sysAdminGetDepartmentInfo","then","res","setState","groups","data","catch","error","errMessage","getErrorMsg","danger","onSubDepartmentNameChanged","dept","state","map","item","id","name","onFreezedItem","isItemFreezed","onUnfreezedItem","onAddNewDepartment","newDepartment","unshift","onDeleteDepartment","filter","onSetDepartmentQuota","target","quota","_createClass","key","value","componentDidMount","UNSAFE_componentWillReceiveProps","nextProps","render","_this2","currentItem","children","className","length","width","group","index","onDepartmentNameChanged","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/pages/sys-admin/departments/sub-departments.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { seafileAPI } from '../../../utils/seafile-api';\nimport { Utils } from '../../../utils/utils';\nimport toaster from '../../../components/toast';\nimport { gettext, lang } from '../../../utils/constants';\nimport GroupItem from './group-item';\nimport Department from './department';\n\nimport '../../../css/org-department-item.css';\n\nmoment.locale(lang);\n\nconst SubDepartmentsPropTypes = {\n  groupID: PropTypes.string\n};\n\nclass SubDepartments extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n      groups: []\n    };\n  }\n\n  componentDidMount() {\n    this.listSubDepartments(this.props.groupID);\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (this.props.groupID !== nextProps.groupID) {\n      this.listSubDepartments(nextProps.groupID);\n    }\n  }\n\n  listSubDepartments = (groupID) => {\n    seafileAPI.sysAdminGetDepartmentInfo(groupID, true).then(res => {\n      this.setState({groups: res.data.groups});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  onSubDepartmentNameChanged = (dept) => {\n    this.setState({\n      groups: this.state.groups.map(item => {\n        if (item.id == dept.id) {\n          item.name = dept.name;\n        }\n        return item;\n      })\n    });\n  };\n\n  onFreezedItem = () => {\n    this.setState({isItemFreezed: true});\n  };\n\n  onUnfreezedItem = () => {\n    this.setState({isItemFreezed: false});\n  };\n\n  onAddNewDepartment = (newDepartment) => {\n    const { groups } = this.state;\n    groups.unshift(newDepartment);\n    this.setState({\n      groups: groups\n    });\n  };\n\n  onDeleteDepartment = (id) => {\n    const { groups } = this.state;\n    this.setState({\n      groups: groups.filter(item => item.id != id)\n    });\n  };\n\n  onSetDepartmentQuota = (target) => {\n    const { groups } = this.state;\n    this.setState({\n      groups: groups.map((item) => {\n        if (item.id == target.id) {\n          item.quota = target.quota;\n        }\n        return item;\n      })\n    });\n  };\n\n  render() {\n    const { groups } = this.state;\n    const { groupID } = this.props;\n\n    return (\n      <Department\n        groupID={groupID}\n        currentItem=\"subDepartments\"\n        onAddNewDepartment={this.onAddNewDepartment}\n      >\n        <div className=\"cur-view-content\">\n          {groups && groups.length > 0 ?\n            <table>\n              <thead>\n                <tr>\n                  <th width=\"40%\">{gettext('Name')}</th>\n                  <th width=\"25%\">{gettext('Created At')}</th>\n                  <th width=\"20%\">{gettext('Quota')}</th>\n                  <th width=\"15%\"></th>\n                </tr>\n              </thead>\n              <tbody>\n                {groups.map((group, index) => {\n                  return(\n                    <GroupItem\n                      key={group.id}\n                      isItemFreezed={this.state.isItemFreezed}\n                      onFreezedItem={this.onFreezedItem}\n                      onUnfreezedItem={this.onUnfreezedItem}\n                      onDepartmentNameChanged={this.onSubDepartmentNameChanged}\n                      group={group}\n                      onDeleteDepartment={this.onDeleteDepartment}\n                      onSetDepartmentQuota={this.onSetDepartmentQuota}\n                    />\n                  );\n                })}\n              </tbody>\n            </table>\n            : <p className=\"no-group\">{gettext('No sub-departments')}</p>\n          }\n        </div>\n      </Department>\n    );\n  }\n}\n\nSubDepartments.propTypes = SubDepartmentsPropTypes;\n\nexport default SubDepartments;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}