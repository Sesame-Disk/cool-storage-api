{"ast":null,"code":"import _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _toArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/toArray.js\";\nimport _toConsumableArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport slugid from 'slugid';\nimport isHotkey from 'is-hotkey';\nimport { Transforms, Node, Range, Editor } from '@seafile/slate';\nimport { ReactEditor } from '@seafile/slate-react';\nimport { getNodeType, isLastNode, getSelectedNodeByType, generateEmptyElement, isSelectionAtBlockStart, getSelectedElems } from '../../core';\nimport { deleteBackwardByLength } from './helpers';\nimport { CODE_BLOCK, PARAGRAPH, CODE_LINE, BLOCKQUOTE } from '../../constants';\nvar withCodeBlock = function withCodeBlock(editor) {\n  var normalizeNode = editor.normalizeNode,\n    insertFragment = editor.insertFragment,\n    insertText = editor.insertText,\n    insertBreak = editor.insertBreak,\n    insertData = editor.insertData,\n    deleteBackward = editor.deleteBackward;\n  var newEditor = editor;\n\n  // If you enter two Spaces in quick succession, a period and a space appear （Default Settings for mac）\n  newEditor.insertText = function (data) {\n    if (data === '. ') {\n      return insertText('  ');\n    }\n    return insertText(data);\n  };\n  newEditor.deleteBackward = function (unit) {\n    var node = getSelectedNodeByType(editor, CODE_BLOCK);\n    if (node) {\n      if (isSelectionAtBlockStart(editor)) return;\n    }\n    deleteBackward(unit);\n  };\n  newEditor.insertData = function (data) {\n    // Paste a single code block element somewhere other than a code block\n    if (data.types.includes('text/code-block') && !getSelectedNodeByType(editor, CODE_BLOCK)) {\n      var options = {};\n      // Paste into quote block\n      if (getSelectedNodeByType(newEditor, BLOCKQUOTE)) {\n        var path = Editor.path(newEditor, newEditor.selection);\n        options['at'] = [path[0]];\n      }\n      var codeBlockNode = JSON.parse(data.getData('text/code-block'));\n      return Transforms.insertNodes(newEditor, codeBlockNode, _objectSpread({}, options));\n    }\n    insertData(data);\n  };\n  newEditor.insertFragment = function (data) {\n    // Only selected code block content\n    if (data.length === 1 && data[0].type === CODE_BLOCK && !getSelectedNodeByType(editor, CODE_BLOCK)) {\n      data.forEach(function (node, index) {\n        if (node.type === CODE_BLOCK) {\n          var newBlock = node.children.map(function (line) {\n            var text = Node.string(line);\n            var p = generateEmptyElement(PARAGRAPH);\n            p.children[0].text = text;\n            return p;\n          });\n          data.splice.apply(data, [index, 1].concat(_toConsumableArray(newBlock)));\n        }\n      });\n      return insertFragment(data);\n    } else {\n      // Paste into code block\n      if (getSelectedNodeByType(editor, CODE_BLOCK)) {\n        // Pasted data is code block split with code-line\n        data.forEach(function (node, index) {\n          if (node.type === CODE_BLOCK) {\n            var codeLineArr = node.children.map(function (line) {\n              return line;\n            });\n            data.splice.apply(data, [index, 1].concat(_toConsumableArray(codeLineArr)));\n          }\n        });\n        var newData = data.map(function (node) {\n          var text = Node.string(node);\n          var codeLine = {\n            id: slugid.nice(),\n            type: CODE_LINE,\n            children: [{\n              text: text,\n              id: slugid.nice()\n            }]\n          };\n          return codeLine;\n        });\n\n        // current focus code-line string not empty\n        var string = Editor.string(newEditor, newEditor.selection.focus.path);\n        if (string.length !== 0 && Range.isCollapsed(newEditor.selection)) {\n          var _newData = _toArray(newData),\n            node = _newData[0],\n            restNode = _newData.slice(1);\n          var text = Node.string(node);\n          insertText(text);\n          if (restNode.length !== 0) {\n            insertBreak();\n            insertFragment(restNode);\n          }\n          return;\n        }\n        return insertFragment(newData);\n      } else {\n        // Paste into not a code block\n        return insertFragment(data);\n      }\n    }\n  };\n\n  // Rewrite normalizeNode\n  newEditor.normalizeNode = function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n      node = _ref2[0],\n      path = _ref2[1];\n    var type = getNodeType(node);\n    if (type === CODE_LINE && path.length <= 1) {\n      Transforms.setNodes(newEditor, {\n        type: PARAGRAPH\n      }, {\n        at: path\n      });\n      return;\n    }\n    if (type === CODE_BLOCK) {\n      if (node.children.length === 0) {\n        Transforms.delete(newEditor, {\n          at: path\n        });\n        return;\n      }\n\n      // code-block is the last node in the editor and needs to be followed by a p node\n      var isLast = isLastNode(newEditor, node);\n      if (isLast) {\n        var paragraph = generateEmptyElement(PARAGRAPH);\n        Transforms.insertNodes(newEditor, paragraph, {\n          at: [path[0] + 1]\n        });\n      }\n\n      // There must be a code node below code-block\n      if (getNodeType(node.children[0]) !== CODE_LINE) {\n        Transforms.unwrapNodes(newEditor);\n        Transforms.setNodes(newEditor, {\n          type: PARAGRAPH\n        }, {\n          mode: 'highest'\n        });\n      }\n      if (node.children.length > 1) {\n        node.children.forEach(function (child, index) {\n          if (child.type !== CODE_LINE) {\n            Transforms.setNodes(newEditor, {\n              type: CODE_LINE\n            }, {\n              at: [].concat(_toConsumableArray(path), [index])\n            });\n          }\n        });\n      }\n    }\n\n    // Perform default behavior\n    return normalizeNode([node, path]);\n  };\n  newEditor.codeBlockOnKeyDown = function (event) {\n    if (isHotkey(['command+enter', 'ctrl+enter'], event)) {\n      if (newEditor.selection && !Range.isExpanded(newEditor.selection)) {\n        var path = Editor.path(newEditor, newEditor.selection);\n        var p = generateEmptyElement(PARAGRAPH);\n        Transforms.insertNodes(newEditor, p, {\n          at: [path[0] + 1]\n        });\n        Transforms.select(newEditor, [path[0] + 1]);\n      }\n    }\n    if (isHotkey('tab', event)) {\n      var selection = newEditor.selection;\n      event.preventDefault();\n      // By default, tab key will insert 4 spaces\n      var indent = ' '.repeat(4);\n      if (Range.isCollapsed(selection)) {\n        newEditor.insertText(indent);\n      } else {\n        var selectedElements = getSelectedElems(newEditor);\n        selectedElements.forEach(function (elem) {\n          if (elem.type !== CODE_LINE) return;\n          var text = indent + Node.string(elem);\n          var insertPoint = ReactEditor.findPath(newEditor, elem);\n          Transforms.insertText(editor, text, {\n            at: insertPoint\n          });\n        });\n      }\n    }\n    if (isHotkey('shift+tab', event)) {\n      var range = {\n        anchor: {\n          offset: 0,\n          path: newEditor.selection.focus.path\n        },\n        focus: _objectSpread({}, newEditor.selection.focus)\n      };\n      var str = Editor.string(newEditor, range);\n      if (str.trim() === '') {\n        deleteBackwardByLength(newEditor, str.length);\n      }\n    }\n  };\n  return newEditor;\n};\nexport default withCodeBlock;","map":{"version":3,"names":["_objectSpread","slugid","isHotkey","Transforms","Node","Range","Editor","ReactEditor","getNodeType","isLastNode","getSelectedNodeByType","generateEmptyElement","isSelectionAtBlockStart","getSelectedElems","deleteBackwardByLength","CODE_BLOCK","PARAGRAPH","CODE_LINE","BLOCKQUOTE","withCodeBlock","editor","normalizeNode","insertFragment","insertText","insertBreak","insertData","deleteBackward","newEditor","data","unit","node","types","includes","options","path","selection","codeBlockNode","JSON","parse","getData","insertNodes","length","type","forEach","index","newBlock","children","map","line","text","string","p","splice","apply","concat","_toConsumableArray","codeLineArr","newData","codeLine","id","nice","focus","isCollapsed","_newData","_toArray","restNode","slice","_ref","_ref2","_slicedToArray","setNodes","at","delete","isLast","paragraph","unwrapNodes","mode","child","codeBlockOnKeyDown","event","isExpanded","select","preventDefault","indent","repeat","selectedElements","elem","insertPoint","findPath","range","anchor","offset","str","trim"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/plugins/code-block/plugin.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport slugid from 'slugid';\nimport isHotkey from 'is-hotkey';\nimport { Transforms, Node, Range, Editor } from '@seafile/slate';\nimport { ReactEditor } from '@seafile/slate-react';\nimport { getNodeType, isLastNode, getSelectedNodeByType, generateEmptyElement, isSelectionAtBlockStart, getSelectedElems } from '../../core';\nimport { deleteBackwardByLength } from './helpers';\nimport { CODE_BLOCK, PARAGRAPH, CODE_LINE, BLOCKQUOTE } from '../../constants';\nconst withCodeBlock = editor => {\n  const {\n    normalizeNode,\n    insertFragment,\n    insertText,\n    insertBreak,\n    insertData,\n    deleteBackward\n  } = editor;\n  const newEditor = editor;\n\n  // If you enter two Spaces in quick succession, a period and a space appear （Default Settings for mac）\n  newEditor.insertText = data => {\n    if (data === '. ') {\n      return insertText('  ');\n    }\n    return insertText(data);\n  };\n  newEditor.deleteBackward = unit => {\n    const node = getSelectedNodeByType(editor, CODE_BLOCK);\n    if (node) {\n      if (isSelectionAtBlockStart(editor)) return;\n    }\n    deleteBackward(unit);\n  };\n  newEditor.insertData = data => {\n    // Paste a single code block element somewhere other than a code block\n    if (data.types.includes('text/code-block') && !getSelectedNodeByType(editor, CODE_BLOCK)) {\n      const options = {};\n      // Paste into quote block\n      if (getSelectedNodeByType(newEditor, BLOCKQUOTE)) {\n        const path = Editor.path(newEditor, newEditor.selection);\n        options['at'] = [path[0]];\n      }\n      const codeBlockNode = JSON.parse(data.getData('text/code-block'));\n      return Transforms.insertNodes(newEditor, codeBlockNode, _objectSpread({}, options));\n    }\n    insertData(data);\n  };\n  newEditor.insertFragment = data => {\n    // Only selected code block content\n    if (data.length === 1 && data[0].type === CODE_BLOCK && !getSelectedNodeByType(editor, CODE_BLOCK)) {\n      data.forEach((node, index) => {\n        if (node.type === CODE_BLOCK) {\n          const newBlock = node.children.map(line => {\n            const text = Node.string(line);\n            const p = generateEmptyElement(PARAGRAPH);\n            p.children[0].text = text;\n            return p;\n          });\n          data.splice(index, 1, ...newBlock);\n        }\n      });\n      return insertFragment(data);\n    } else {\n      // Paste into code block\n      if (getSelectedNodeByType(editor, CODE_BLOCK)) {\n        // Pasted data is code block split with code-line\n        data.forEach((node, index) => {\n          if (node.type === CODE_BLOCK) {\n            const codeLineArr = node.children.map(line => line);\n            data.splice(index, 1, ...codeLineArr);\n          }\n        });\n        const newData = data.map(node => {\n          const text = Node.string(node);\n          const codeLine = {\n            id: slugid.nice(),\n            type: CODE_LINE,\n            children: [{\n              text: text,\n              id: slugid.nice()\n            }]\n          };\n          return codeLine;\n        });\n\n        // current focus code-line string not empty\n        const string = Editor.string(newEditor, newEditor.selection.focus.path);\n        if (string.length !== 0 && Range.isCollapsed(newEditor.selection)) {\n          const [node, ...restNode] = newData;\n          const text = Node.string(node);\n          insertText(text);\n          if (restNode.length !== 0) {\n            insertBreak();\n            insertFragment(restNode);\n          }\n          return;\n        }\n        return insertFragment(newData);\n      } else {\n        // Paste into not a code block\n        return insertFragment(data);\n      }\n    }\n  };\n\n  // Rewrite normalizeNode\n  newEditor.normalizeNode = _ref => {\n    let [node, path] = _ref;\n    const type = getNodeType(node);\n    if (type === CODE_LINE && path.length <= 1) {\n      Transforms.setNodes(newEditor, {\n        type: PARAGRAPH\n      }, {\n        at: path\n      });\n      return;\n    }\n    if (type === CODE_BLOCK) {\n      if (node.children.length === 0) {\n        Transforms.delete(newEditor, {\n          at: path\n        });\n        return;\n      }\n\n      // code-block is the last node in the editor and needs to be followed by a p node\n      const isLast = isLastNode(newEditor, node);\n      if (isLast) {\n        const paragraph = generateEmptyElement(PARAGRAPH);\n        Transforms.insertNodes(newEditor, paragraph, {\n          at: [path[0] + 1]\n        });\n      }\n\n      // There must be a code node below code-block\n      if (getNodeType(node.children[0]) !== CODE_LINE) {\n        Transforms.unwrapNodes(newEditor);\n        Transforms.setNodes(newEditor, {\n          type: PARAGRAPH\n        }, {\n          mode: 'highest'\n        });\n      }\n      if (node.children.length > 1) {\n        node.children.forEach((child, index) => {\n          if (child.type !== CODE_LINE) {\n            Transforms.setNodes(newEditor, {\n              type: CODE_LINE\n            }, {\n              at: [...path, index]\n            });\n          }\n        });\n      }\n    }\n\n    // Perform default behavior\n    return normalizeNode([node, path]);\n  };\n  newEditor.codeBlockOnKeyDown = event => {\n    if (isHotkey(['command+enter', 'ctrl+enter'], event)) {\n      if (newEditor.selection && !Range.isExpanded(newEditor.selection)) {\n        const path = Editor.path(newEditor, newEditor.selection);\n        const p = generateEmptyElement(PARAGRAPH);\n        Transforms.insertNodes(newEditor, p, {\n          at: [path[0] + 1]\n        });\n        Transforms.select(newEditor, [path[0] + 1]);\n      }\n    }\n    if (isHotkey('tab', event)) {\n      const {\n        selection\n      } = newEditor;\n      event.preventDefault();\n      // By default, tab key will insert 4 spaces\n      const indent = ' '.repeat(4);\n      if (Range.isCollapsed(selection)) {\n        newEditor.insertText(indent);\n      } else {\n        const selectedElements = getSelectedElems(newEditor);\n        selectedElements.forEach(elem => {\n          if (elem.type !== CODE_LINE) return;\n          const text = indent + Node.string(elem);\n          const insertPoint = ReactEditor.findPath(newEditor, elem);\n          Transforms.insertText(editor, text, {\n            at: insertPoint\n          });\n        });\n      }\n    }\n    if (isHotkey('shift+tab', event)) {\n      const range = {\n        anchor: {\n          offset: 0,\n          path: newEditor.selection.focus.path\n        },\n        focus: _objectSpread({}, newEditor.selection.focus)\n      };\n      const str = Editor.string(newEditor, range);\n      if (str.trim() === '') {\n        deleteBackwardByLength(newEditor, str.length);\n      }\n    }\n  };\n  return newEditor;\n};\nexport default withCodeBlock;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}