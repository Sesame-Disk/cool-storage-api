{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Fragment}from'react';import{Input}from'reactstrap';import{seafileAPI}from'../../utils/seafile-api';import{gettext,isPro}from'../../utils/constants';import{Utils}from'../../utils/utils';import toaster from'../toast';import RepoInfo from'../../models/repo-info';import RepoListView from'./repo-list-view';import Loading from'../loading';import SearchedListView from'./searched-list-view';import'../../css/file-chooser.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FileChooser=/*#__PURE__*/function(_React$Component){_inherits(FileChooser,_React$Component);var _super=_createSuper(FileChooser);function FileChooser(props){var _this;_classCallCheck(this,FileChooser);_this=_super.call(this,props);_this.onOtherRepoToggle=function(){if(!_this.state.hasRequest){var that=_assertThisInitialized(_this);seafileAPI.listRepos().then(function(res){// todo optimized code\nvar repos=res.data.repos;var repoList=[];var repoIdList=[];for(var i=0;i<repos.length;i++){if(repos[i].permission!=='rw'){continue;}if(that.props.repoID&&repos[i].repo_name===that.state.currentRepoInfo.repo_name){continue;}if(repoIdList.indexOf(repos[i].repo_id)>-1){continue;}repoList.push(repos[i]);repoIdList.push(repos[i].repo_id);}repoList=Utils.sortRepos(repoList,'name','asc');_this.setState({repoList:repoList,isOtherRepoShow:!_this.state.isOtherRepoShow,selectedItemInfo:{}});});}else{_this.setState({isOtherRepoShow:!_this.state.isOtherRepoShow});}};_this.onCurrentRepoToggle=function(){_this.setState({isCurrentRepoShow:!_this.state.isCurrentRepoShow});};_this.onDirentItemClick=function(repo,filePath,dirent){_this.props.onDirentItemClick(repo,filePath,dirent);_this.setState({selectedRepo:repo,selectedPath:filePath});};_this.onRepoItemClick=function(repo){if(_this.props.onRepoItemClick){_this.props.onRepoItemClick(repo);}_this.setState({selectedRepo:repo,selectedPath:'/'});};_this.onCloseSearching=function(){_this.setState({isSearching:false,isResultGot:false,searchInfo:'',searchResults:[]});_this.inputValue='';_this.timer=null;_this.source=null;};_this.onSearchInfoChanged=function(event){var searchInfo=event.target.value.trim();_this.setState({searchInfo:searchInfo});if(_this.inputValue===searchInfo){return false;}_this.inputValue=searchInfo;if(searchInfo.length===0){_this.setState({isSearching:false,searchResults:[]});return false;}if(!_this.state.searchResults.length&&searchInfo.length>0){_this.setState({isSearching:true,isResultGot:false});}if(_this.inputValue===''||_this.getValueLength(_this.inputValue)<3){_this.setState({isResultGot:false});return false;}var repoID=_this.props.repoID;var isShowFile=_this.props.isShowFile;var mode=_this.props.mode;var searchRepo=mode==='only_current_library'?repoID:'all';var queryData={q:searchInfo,search_repo:searchRepo,search_ftypes:'all',obj_type:isShowFile?'file':'dir'};if(_this.timer){clearTimeout(_this.timer);}_this.timer=setTimeout(_this.getSearchResult(queryData),500);};_this.getSearchResult=function(queryData){if(_this.source){_this.cancelRequest();}_this.setState({isResultGot:false});_this.source=seafileAPI.getSource();_this.sendRequest(queryData,_this.source.token);};_this.sendRequest=function(queryData,cancelToken){seafileAPI.searchFiles(queryData,cancelToken).then(function(res){if(!res.data.total){_this.setState({searchResults:[],isResultGot:true});_this.source=null;return;}var items=_this.formatResultItems(res.data.results);_this.setState({searchResults:items,isResultGot:true});_this.source=null;});};_this.cancelRequest=function(){_this.source.cancel('prev request is cancelled');};_this.getValueLength=function(str){var i=0,code,len=0;for(;i<str.length;i++){code=str.charCodeAt(i);if(code==10){//solve enter problem\nlen+=2;}else if(code<0x007f){len+=1;}else if(code>=0x0080&&code<=0x07ff){len+=2;}else if(code>=0x0800&&code<=0xffff){len+=3;}}return len;};_this.formatResultItems=function(data){var items=[];var length=data.length>10?10:data.length;for(var i=0;i<length;i++){items[i]={};items[i]['index']=[i];items[i]['name']=data[i].name;items[i]['path']=data[i].fullpath;items[i]['repo_id']=data[i].repo_id;items[i]['repo_name']=data[i].repo_name;items[i]['is_dir']=data[i].is_dir;items[i]['link_content']=decodeURI(data[i].fullpath).substring(1);items[i]['content']=data[i].content_highlight;}return items;};_this.onSearchedItemClick=function(item){item['type']=item.is_dir?'dir':'file';var repo=new RepoInfo(item);_this.props.onDirentItemClick(repo,item.path,item);};_this.renderSearchedView=function(){if(_this.getValueLength(_this.inputValue)<3){return'';}if(!_this.state.isResultGot){return/*#__PURE__*/_jsx(Loading,{});}if(_this.state.isResultGot&&_this.state.searchResults.length===0){return/*#__PURE__*/_jsx(\"div\",{className:\"search-result-none text-center\",children:gettext('No results matching')});}if(_this.state.isResultGot&&_this.state.searchResults.length>0){return/*#__PURE__*/_jsx(SearchedListView,{searchResults:_this.state.searchResults,onItemClick:_this.onSearchedItemClick,onSearchedItemDoubleClick:_this.onSearchedItemDoubleClick});}};_this.onSearchedItemDoubleClick=function(item){if(item.type!=='dir'){return;}var selectedItemInfo={repoID:item.repo_id,filePath:item.path};_this.setState({selectedItemInfo:selectedItemInfo});if(_this.props.repoID&&item.repo_id===_this.props.repoID){seafileAPI.getRepoInfo(_this.props.repoID).then(function(res){// need to optimized\nvar repoInfo=new RepoInfo(res.data);var path=item.path.substring(0,item.path.length-1);_this.setState({selectedRepo:repoInfo,selectedPath:path,isCurrentRepoShow:true});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});}else{if(!_this.state.hasRequest){var that=_assertThisInitialized(_this);seafileAPI.listRepos().then(function(res){// todo optimized code\nvar repos=res.data.repos;var repoList=[];var repoIdList=[];for(var i=0;i<repos.length;i++){if(repos[i].permission!=='rw'){continue;}if(that.props.repoID&&repos[i].repo_name===that.state.currentRepoInfo.repo_name){continue;}if(repoIdList.indexOf(repos[i].repo_id)>-1){continue;}repoList.push(repos[i]);repoIdList.push(repos[i].repo_id);}repoList=Utils.sortRepos(repoList,'name','asc');var repo=repoList.filter(function(repoItem){return repoItem.repo_id===item.repo_id;});var path=item.path.substring(0,item.path.length-1);var selectRepo=repo[0];_this.setState({repoList:repoList,isOtherRepoShow:true,selectedPath:path,selectedRepo:selectRepo});});}else{_this.setState({isOtherRepoShow:!_this.state.isOtherRepoShow});}}_this.onCloseSearching();};_this.onScroll=function(event){event.stopPropagation();};_this.renderRepoListView=function(){return/*#__PURE__*/_jsxs(\"div\",{className:\"file-chooser-container user-select-none\",onScroll:_this.onScroll,children:[_this.props.mode==='current_repo_and_other_repos'&&/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"list-view\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"list-view-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-toggle fa \".concat(_this.state.isCurrentRepoShow?'fa-caret-down':'fa-caret-right'),onClick:_this.onCurrentRepoToggle}),/*#__PURE__*/_jsx(\"span\",{className:\"library\",children:gettext('Current Library')})]}),_this.state.isCurrentRepoShow&&_this.state.currentRepoInfo&&/*#__PURE__*/_jsx(RepoListView,{initToShowChildren:true,currentRepoInfo:_this.state.currentRepoInfo,currentPath:_this.props.currentPath,selectedRepo:_this.state.selectedRepo,selectedPath:_this.state.selectedPath,onRepoItemClick:_this.onRepoItemClick,onDirentItemClick:_this.onDirentItemClick,isShowFile:_this.props.isShowFile,fileSuffixes:_this.props.fileSuffixes,selectedItemInfo:_this.state.selectedItemInfo})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"list-view\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"list-view-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-toggle fa \".concat(_this.state.isOtherRepoShow?'fa-caret-down':'fa-caret-right'),onClick:_this.onOtherRepoToggle}),/*#__PURE__*/_jsx(\"span\",{className:\"library\",children:gettext('Other Libraries')})]}),_this.state.isOtherRepoShow&&/*#__PURE__*/_jsx(RepoListView,{initToShowChildren:false,repoList:_this.state.repoList,selectedRepo:_this.state.selectedRepo,selectedPath:_this.state.selectedPath,onRepoItemClick:_this.onRepoItemClick,onDirentItemClick:_this.onDirentItemClick,isShowFile:_this.props.isShowFile,fileSuffixes:_this.props.fileSuffixes,selectedItemInfo:_this.state.selectedItemInfo})]})]}),_this.props.mode==='only_current_library'&&/*#__PURE__*/_jsxs(\"div\",{className:\"list-view\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"list-view-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-toggle fa \".concat(_this.state.isCurrentRepoShow?'fa-caret-down':'fa-caret-right'),onClick:_this.onCurrentRepoToggle}),/*#__PURE__*/_jsx(\"span\",{className:\"library\",children:gettext('Current Library')})]}),_this.state.isCurrentRepoShow&&_this.state.currentRepoInfo&&/*#__PURE__*/_jsx(RepoListView,{initToShowChildren:true,currentRepoInfo:_this.state.currentRepoInfo,currentPath:_this.props.currentPath,selectedRepo:_this.state.selectedRepo,selectedPath:_this.state.selectedPath,onRepoItemClick:_this.onRepoItemClick,onDirentItemClick:_this.onDirentItemClick,isShowFile:_this.props.isShowFile,fileSuffixes:_this.props.fileSuffixes,selectedItemInfo:_this.state.selectedItemInfo})]}),_this.props.mode==='only_all_repos'&&/*#__PURE__*/_jsx(\"div\",{className:\"file-chooser-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"list-view\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"list-view-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-toggle fa fa-caret-down\"}),/*#__PURE__*/_jsx(\"span\",{className:\"library\",children:gettext('Libraries')})]}),/*#__PURE__*/_jsx(RepoListView,{initToShowChildren:false,repoList:_this.state.repoList,selectedRepo:_this.state.selectedRepo,selectedPath:_this.state.selectedPath,onRepoItemClick:_this.onRepoItemClick,onDirentItemClick:_this.onDirentItemClick,isShowFile:_this.props.isShowFile,fileSuffixes:_this.props.fileSuffixes,selectedItemInfo:_this.state.selectedItemInfo})]})})]});};_this.state={hasRequest:false,isCurrentRepoShow:true,isOtherRepoShow:false,repoList:[],currentRepoInfo:null,selectedRepo:null,selectedPath:_this.props.currentPath||'/',isSearching:false,isResultGot:false,searchInfo:'',searchResults:[],selectedItemInfo:{}};_this.inputValue='';_this.timer=null;_this.source=null;return _this;}_createClass(FileChooser,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;if(this.props.repoID){// current_repo_and_other_repos, only_current_library\nvar repoID=this.props.repoID;seafileAPI.getRepoInfo(repoID).then(function(res){// need to optimized\nvar repoInfo=new RepoInfo(res.data);_this2.setState({currentRepoInfo:repoInfo,selectedRepo:repoInfo});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});}else{// only_all_repos\nseafileAPI.listRepos().then(function(res){var repos=res.data.repos;var repoList=[];var repoIdList=[];for(var i=0;i<repos.length;i++){if(repos[i].permission!=='rw'){continue;}if(repoIdList.indexOf(repos[i].repo_id)>-1){continue;}repoList.push(repos[i]);repoIdList.push(repos[i].repo_id);}repoList=Utils.sortRepos(repoList,'name','asc');_this2.setState({repoList:repoList});});}}},{key:\"render\",value:function render(){if(!this.state.selectedRepo&&this.props.repoID){return'';}return/*#__PURE__*/_jsxs(Fragment,{children:[isPro&&/*#__PURE__*/_jsxs(\"div\",{className:\"file-chooser-search-input\",children:[/*#__PURE__*/_jsx(Input,{className:\"search-input mb-2\",placeholder:gettext('Search'),type:\"text\",value:this.state.searchInfo,onChange:this.onSearchInfoChanged}),this.state.searchInfo.length!==0&&/*#__PURE__*/_jsx(\"span\",{className:\"search-control attr-action-icon fas fa-times\",onClick:this.onCloseSearching})]}),this.state.isSearching&&/*#__PURE__*/_jsx(\"div\",{className:\"file-chooser-search-container\",children:this.renderSearchedView()}),!this.state.isSearching&&this.renderRepoListView()]});}}]);return FileChooser;}(React.Component);export default FileChooser;","map":{"version":3,"names":["React","Fragment","Input","seafileAPI","gettext","isPro","Utils","toaster","RepoInfo","RepoListView","Loading","SearchedListView","jsx","_jsx","jsxs","_jsxs","FileChooser","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","onOtherRepoToggle","state","hasRequest","that","_assertThisInitialized","listRepos","then","res","repos","data","repoList","repoIdList","i","length","permission","repoID","repo_name","currentRepoInfo","indexOf","repo_id","push","sortRepos","setState","isOtherRepoShow","selectedItemInfo","onCurrentRepoToggle","isCurrentRepoShow","onDirentItemClick","repo","filePath","dirent","selectedRepo","selectedPath","onRepoItemClick","onCloseSearching","isSearching","isResultGot","searchInfo","searchResults","inputValue","timer","source","onSearchInfoChanged","event","target","value","trim","getValueLength","isShowFile","mode","searchRepo","queryData","q","search_repo","search_ftypes","obj_type","clearTimeout","setTimeout","getSearchResult","cancelRequest","getSource","sendRequest","token","cancelToken","searchFiles","total","items","formatResultItems","results","cancel","str","code","len","charCodeAt","name","fullpath","is_dir","decodeURI","substring","content_highlight","onSearchedItemClick","item","path","renderSearchedView","className","children","onItemClick","onSearchedItemDoubleClick","type","getRepoInfo","repoInfo","catch","error","errMessage","getErrorMsg","danger","filter","repoItem","selectRepo","onScroll","stopPropagation","renderRepoListView","concat","onClick","initToShowChildren","currentPath","fileSuffixes","_createClass","key","componentDidMount","_this2","render","placeholder","onChange","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/file-chooser/file-chooser.js"],"sourcesContent":["import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Input } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, isPro } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport RepoInfo from '../../models/repo-info';\nimport RepoListView from './repo-list-view';\nimport Loading from '../loading';\nimport SearchedListView from './searched-list-view';\n\nimport '../../css/file-chooser.css';\n\nconst propTypes = {\n  isShowFile: PropTypes.bool,\n  repoID: PropTypes.string,\n  onDirentItemClick: PropTypes.func,\n  onRepoItemClick: PropTypes.func,\n  mode: PropTypes.oneOf(['current_repo_and_other_repos', 'only_all_repos', 'only_current_library']),\n  fileSuffixes: PropTypes.array,\n  currentPath: PropTypes.string,\n};\n\nclass FileChooser extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      hasRequest: false,\n      isCurrentRepoShow: true,\n      isOtherRepoShow: false,\n      repoList: [],\n      currentRepoInfo: null,\n      selectedRepo: null,\n      selectedPath: this.props.currentPath || '/',\n      isSearching: false,\n      isResultGot: false,\n      searchInfo: '',\n      searchResults: [],\n      selectedItemInfo: {},\n    };\n    this.inputValue = '';\n    this.timer = null;\n    this.source = null;\n  }\n\n  componentDidMount() {\n    if (this.props.repoID) {  // current_repo_and_other_repos, only_current_library\n      let repoID = this.props.repoID;\n      seafileAPI.getRepoInfo(repoID).then(res => {\n        // need to optimized\n        let repoInfo = new RepoInfo(res.data);\n        this.setState({\n          currentRepoInfo: repoInfo,\n          selectedRepo: repoInfo\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else { // only_all_repos\n      seafileAPI.listRepos().then(res => {\n        let repos = res.data.repos;\n        let repoList = [];\n        let repoIdList = [];\n        for(let i = 0; i < repos.length; i++) {\n          if (repos[i].permission !== 'rw') {\n            continue;\n          }\n          if (repoIdList.indexOf(repos[i].repo_id) > -1) {\n            continue;\n          }\n          repoList.push(repos[i]);\n          repoIdList.push(repos[i].repo_id);\n        }\n        repoList = Utils.sortRepos(repoList, 'name', 'asc');\n        this.setState({repoList: repoList});\n      });\n    }\n  }\n\n  onOtherRepoToggle = () => {\n    if (!this.state.hasRequest) {\n      let that = this;\n      seafileAPI.listRepos().then(res => {\n        // todo optimized code\n        let repos = res.data.repos;\n        let repoList = [];\n        let repoIdList = [];\n        for(let i = 0; i < repos.length; i++) {\n          if (repos[i].permission !== 'rw') {\n            continue;\n          }\n          if (that.props.repoID && (repos[i].repo_name === that.state.currentRepoInfo.repo_name)) {\n            continue;\n          }\n          if (repoIdList.indexOf(repos[i].repo_id) > -1) {\n            continue;\n          }\n          repoList.push(repos[i]);\n          repoIdList.push(repos[i].repo_id);\n        }\n        repoList = Utils.sortRepos(repoList, 'name', 'asc');\n        this.setState({\n          repoList: repoList,\n          isOtherRepoShow: !this.state.isOtherRepoShow,\n          selectedItemInfo: {}\n        });\n      });\n    }\n    else {\n      this.setState({isOtherRepoShow: !this.state.isOtherRepoShow});\n    }\n  };\n\n  onCurrentRepoToggle = () => {\n    this.setState({isCurrentRepoShow: !this.state.isCurrentRepoShow});\n  };\n\n  onDirentItemClick = (repo, filePath, dirent) => {\n    this.props.onDirentItemClick(repo, filePath, dirent);\n    this.setState({\n      selectedRepo: repo,\n      selectedPath: filePath\n    });\n  };\n\n  onRepoItemClick = (repo) => {\n    if (this.props.onRepoItemClick) {\n      this.props.onRepoItemClick(repo);\n    }\n    this.setState({\n      selectedRepo: repo,\n      selectedPath: '/',\n    });\n  };\n\n  onCloseSearching = () => {\n    this.setState({\n      isSearching: false,\n      isResultGot: false,\n      searchInfo: '',\n      searchResults: [],\n    });\n    this.inputValue = '';\n    this.timer = null;\n    this.source = null;\n  };\n\n  onSearchInfoChanged = (event) => {\n    let searchInfo = event.target.value.trim();\n\n    this.setState({searchInfo: searchInfo});\n\n    if (this.inputValue === searchInfo) {\n      return false;\n    }\n\n    this.inputValue = searchInfo;\n\n    if (searchInfo.length === 0) {\n      this.setState({\n        isSearching: false,\n        searchResults: [],\n      });\n      return false;\n    }\n\n    if (!this.state.searchResults.length && searchInfo.length > 0) {\n      this.setState({\n        isSearching: true,\n        isResultGot: false,\n      });\n    }\n\n    if (this.inputValue === '' || this.getValueLength(this.inputValue) < 3) {\n      this.setState({isResultGot: false});\n      return false;\n    }\n\n    let repoID = this.props.repoID;\n    let isShowFile = this.props.isShowFile;\n    let mode = this.props.mode;\n    let searchRepo = mode === 'only_current_library' ? repoID : 'all';\n\n    let queryData = {\n      q: searchInfo,\n      search_repo: searchRepo,\n      search_ftypes: 'all',\n      obj_type: isShowFile ? 'file' : 'dir',\n    };\n\n    if (this.timer) {\n      clearTimeout(this.timer);\n    }\n\n    this.timer = setTimeout(this.getSearchResult(queryData), 500);\n  };\n\n  getSearchResult = (queryData) => {\n    if (this.source) {\n      this.cancelRequest();\n    }\n\n    this.setState({isResultGot: false});\n\n    this.source = seafileAPI.getSource();\n    this.sendRequest(queryData, this.source.token);\n  };\n\n  sendRequest = (queryData, cancelToken) => {\n    seafileAPI.searchFiles(queryData, cancelToken).then(res => {\n      if (!res.data.total) {\n        this.setState({\n          searchResults: [],\n          isResultGot: true\n        });\n        this.source = null;\n        return;\n      }\n\n      let items = this.formatResultItems(res.data.results);\n      this.setState({\n        searchResults: items,\n        isResultGot: true\n      });\n      this.source = null;\n    });\n  };\n\n  cancelRequest = () => {\n    this.source.cancel('prev request is cancelled');\n  };\n\n  getValueLength = (str) => {\n    var i = 0, code, len = 0;\n    for (; i < str.length; i++) {\n      code = str.charCodeAt(i);\n      if (code == 10) { //solve enter problem\n        len += 2;\n      } else if (code < 0x007f) {\n        len += 1;\n      } else if (code >= 0x0080 && code <= 0x07ff) {\n        len += 2;\n      } else if (code >= 0x0800 && code <= 0xffff) {\n        len += 3;\n      }\n    }\n    return len;\n  };\n\n  formatResultItems = (data) => {\n    let items = [];\n    let length = data.length > 10 ? 10 : data.length;\n    for (let i = 0; i < length; i++) {\n      items[i] = {};\n      items[i]['index'] = [i];\n      items[i]['name'] = data[i].name;\n      items[i]['path'] = data[i].fullpath;\n      items[i]['repo_id'] = data[i].repo_id;\n      items[i]['repo_name'] = data[i].repo_name;\n      items[i]['is_dir'] = data[i].is_dir;\n      items[i]['link_content'] = decodeURI(data[i].fullpath).substring(1);\n      items[i]['content'] = data[i].content_highlight;\n    }\n    return items;\n  };\n\n  onSearchedItemClick = (item) => {\n    item['type'] = item.is_dir ? 'dir' : 'file';\n    let repo = new RepoInfo(item);\n    this.props.onDirentItemClick(repo, item.path, item);\n  };\n\n  renderSearchedView = () => {\n    if (this.getValueLength(this.inputValue) < 3) {\n      return '';\n    }\n\n    if (!this.state.isResultGot) {\n      return (<Loading />);\n    }\n\n    if (this.state.isResultGot && this.state.searchResults.length === 0) {\n      return (<div className=\"search-result-none text-center\">{gettext('No results matching')}</div>);\n    }\n\n    if (this.state.isResultGot && this.state.searchResults.length > 0) {\n      return (\n        <SearchedListView\n          searchResults={this.state.searchResults}\n          onItemClick={this.onSearchedItemClick}\n          onSearchedItemDoubleClick={this.onSearchedItemDoubleClick}\n        />);\n    }\n  };\n\n  onSearchedItemDoubleClick = (item) => {\n    if (item.type !== 'dir') {\n      return;\n    }\n\n    let selectedItemInfo = {\n      repoID: item.repo_id,\n      filePath: item.path,\n    };\n\n    this.setState({\n      selectedItemInfo: selectedItemInfo\n    });\n\n    if (this.props.repoID && item.repo_id === this.props.repoID) {\n      seafileAPI.getRepoInfo(this.props.repoID).then(res => {\n        // need to optimized\n        let repoInfo = new RepoInfo(res.data);\n        let path = item.path.substring(0, (item.path.length - 1));\n\n        this.setState({\n          selectedRepo: repoInfo,\n          selectedPath: path,\n          isCurrentRepoShow: true,\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      if (!this.state.hasRequest) {\n        let that = this;\n        seafileAPI.listRepos().then(res => {\n          // todo optimized code\n          let repos = res.data.repos;\n          let repoList = [];\n          let repoIdList = [];\n          for (let i = 0; i < repos.length; i++) {\n            if (repos[i].permission !== 'rw') {\n              continue;\n            }\n            if (that.props.repoID && (repos[i].repo_name === that.state.currentRepoInfo.repo_name)) {\n              continue;\n            }\n            if (repoIdList.indexOf(repos[i].repo_id) > -1) {\n              continue;\n            }\n            repoList.push(repos[i]);\n            repoIdList.push(repos[i].repo_id);\n          }\n          repoList = Utils.sortRepos(repoList, 'name', 'asc');\n          let repo = repoList.filter(repoItem => repoItem.repo_id === item.repo_id);\n          let path = item.path.substring(0, (item.path.length - 1));\n\n          let selectRepo = repo[0];\n          this.setState({\n            repoList: repoList,\n            isOtherRepoShow: true,\n            selectedPath: path,\n            selectedRepo: selectRepo,\n          });\n        });\n      }\n      else {\n        this.setState({isOtherRepoShow: !this.state.isOtherRepoShow});\n      }\n    }\n    this.onCloseSearching();\n  };\n\n  onScroll = (event) => {\n    event.stopPropagation();\n  };\n\n  renderRepoListView = () => {\n\n    return (\n      <div className=\"file-chooser-container user-select-none\" onScroll={this.onScroll}>\n        {this.props.mode === 'current_repo_and_other_repos' && (\n          <Fragment>\n            <div className=\"list-view\">\n              <div className=\"list-view-header\">\n                <span className={`item-toggle fa ${this.state.isCurrentRepoShow ? 'fa-caret-down' : 'fa-caret-right'}`} onClick={this.onCurrentRepoToggle}></span>\n                <span className=\"library\">{gettext('Current Library')}</span>\n              </div>\n              {\n                this.state.isCurrentRepoShow && this.state.currentRepoInfo &&\n                <RepoListView\n                  initToShowChildren={true}\n                  currentRepoInfo={this.state.currentRepoInfo}\n                  currentPath={this.props.currentPath}\n                  selectedRepo={this.state.selectedRepo}\n                  selectedPath={this.state.selectedPath}\n                  onRepoItemClick={this.onRepoItemClick}\n                  onDirentItemClick={this.onDirentItemClick}\n                  isShowFile={this.props.isShowFile}\n                  fileSuffixes={this.props.fileSuffixes}\n                  selectedItemInfo={this.state.selectedItemInfo}\n                />\n              }\n            </div>\n            <div className=\"list-view\">\n              <div className=\"list-view-header\">\n                <span className={`item-toggle fa ${this.state.isOtherRepoShow ? 'fa-caret-down' : 'fa-caret-right'}`} onClick={this.onOtherRepoToggle}></span>\n                <span className=\"library\">{gettext('Other Libraries')}</span>\n              </div>\n              {\n                this.state.isOtherRepoShow &&\n                <RepoListView\n                  initToShowChildren={false}\n                  repoList={this.state.repoList}\n                  selectedRepo={this.state.selectedRepo}\n                  selectedPath={this.state.selectedPath}\n                  onRepoItemClick={this.onRepoItemClick}\n                  onDirentItemClick={this.onDirentItemClick}\n                  isShowFile={this.props.isShowFile}\n                  fileSuffixes={this.props.fileSuffixes}\n                  selectedItemInfo={this.state.selectedItemInfo}\n                />\n              }\n            </div>\n          </Fragment>\n        )}\n        {this.props.mode === 'only_current_library' && (\n          <div className=\"list-view\">\n            <div className=\"list-view-header\">\n              <span className={`item-toggle fa ${this.state.isCurrentRepoShow ? 'fa-caret-down' : 'fa-caret-right'}`} onClick={this.onCurrentRepoToggle}></span>\n              <span className=\"library\">{gettext('Current Library')}</span>\n            </div>\n            {\n              this.state.isCurrentRepoShow && this.state.currentRepoInfo &&\n              <RepoListView\n                initToShowChildren={true}\n                currentRepoInfo={this.state.currentRepoInfo}\n                currentPath={this.props.currentPath}\n                selectedRepo={this.state.selectedRepo}\n                selectedPath={this.state.selectedPath}\n                onRepoItemClick={this.onRepoItemClick}\n                onDirentItemClick={this.onDirentItemClick}\n                isShowFile={this.props.isShowFile}\n                fileSuffixes={this.props.fileSuffixes}\n                selectedItemInfo={this.state.selectedItemInfo}\n              />\n            }\n          </div>\n        )}\n        {this.props.mode === 'only_all_repos' && (\n          <div className=\"file-chooser-container\">\n            <div className=\"list-view\">\n              <div className=\"list-view-header\">\n                <span className=\"item-toggle fa fa-caret-down\"></span>\n                <span className=\"library\">{gettext('Libraries')}</span>\n              </div>\n              <RepoListView\n                initToShowChildren={false}\n                repoList={this.state.repoList}\n                selectedRepo={this.state.selectedRepo}\n                selectedPath={this.state.selectedPath}\n                onRepoItemClick={this.onRepoItemClick}\n                onDirentItemClick={this.onDirentItemClick}\n                isShowFile={this.props.isShowFile}\n                fileSuffixes={this.props.fileSuffixes}\n                selectedItemInfo={this.state.selectedItemInfo}\n              />\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  render() {\n    if (!this.state.selectedRepo && this.props.repoID) {\n      return '';\n    }\n\n    return (\n      <Fragment>\n        {isPro && (\n          <div className=\"file-chooser-search-input\">\n            <Input className=\"search-input mb-2\" placeholder={gettext('Search')} type='text' value={this.state.searchInfo} onChange={this.onSearchInfoChanged}></Input>\n            {this.state.searchInfo.length !== 0 && (\n              <span className=\"search-control attr-action-icon fas fa-times\" onClick={this.onCloseSearching}></span>\n            )}\n          </div>\n        )}\n        {this.state.isSearching && (\n          <div className=\"file-chooser-search-container\">\n            {this.renderSearchedView()}\n          </div>\n        )}\n        {!this.state.isSearching && this.renderRepoListView()}\n      </Fragment>\n    );\n  }\n}\n\nFileChooser.propTypes = propTypes;\n\nexport default FileChooser;\n"],"mappings":"8uBAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CAEvC,OAASC,KAAK,KAAQ,YAAY,CAClC,OAASC,UAAU,KAAQ,yBAAyB,CACpD,OAASC,OAAO,CAAEC,KAAK,KAAQ,uBAAuB,CACtD,OAASC,KAAK,KAAQ,mBAAmB,CACzC,MAAO,CAAAC,OAAO,KAAM,UAAU,CAC9B,MAAO,CAAAC,QAAQ,KAAM,wBAAwB,CAC7C,MAAO,CAAAC,YAAY,KAAM,kBAAkB,CAC3C,MAAO,CAAAC,OAAO,KAAM,YAAY,CAChC,MAAO,CAAAC,gBAAgB,KAAM,sBAAsB,CAEnD,MAAO,4BAA4B,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,4BAY9B,CAAAC,WAAW,uBAAAC,gBAAA,EAAAC,SAAA,CAAAF,WAAA,CAAAC,gBAAA,MAAAE,MAAA,CAAAC,YAAA,CAAAJ,WAAA,EAEf,SAAAA,YAAYK,KAAK,CAAE,KAAAC,KAAA,CAAAC,eAAA,MAAAP,WAAA,EACjBM,KAAA,CAAAH,MAAA,CAAAK,IAAA,MAAMH,KAAK,EAAEC,KAAA,CAuDfG,iBAAiB,CAAG,UAAM,CACxB,GAAI,CAACH,KAAA,CAAKI,KAAK,CAACC,UAAU,CAAE,CAC1B,GAAI,CAAAC,IAAI,CAAAC,sBAAA,CAAAP,KAAA,CAAO,CACfnB,UAAU,CAAC2B,SAAS,CAAC,CAAC,CAACC,IAAI,CAAC,SAAAC,GAAG,CAAI,CACjC;AACA,GAAI,CAAAC,KAAK,CAAGD,GAAG,CAACE,IAAI,CAACD,KAAK,CAC1B,GAAI,CAAAE,QAAQ,CAAG,EAAE,CACjB,GAAI,CAAAC,UAAU,CAAG,EAAE,CACnB,IAAI,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGJ,KAAK,CAACK,MAAM,CAAED,CAAC,EAAE,CAAE,CACpC,GAAIJ,KAAK,CAACI,CAAC,CAAC,CAACE,UAAU,GAAK,IAAI,CAAE,CAChC,SACF,CACA,GAAIX,IAAI,CAACP,KAAK,CAACmB,MAAM,EAAKP,KAAK,CAACI,CAAC,CAAC,CAACI,SAAS,GAAKb,IAAI,CAACF,KAAK,CAACgB,eAAe,CAACD,SAAU,CAAE,CACtF,SACF,CACA,GAAIL,UAAU,CAACO,OAAO,CAACV,KAAK,CAACI,CAAC,CAAC,CAACO,OAAO,CAAC,CAAG,CAAC,CAAC,CAAE,CAC7C,SACF,CACAT,QAAQ,CAACU,IAAI,CAACZ,KAAK,CAACI,CAAC,CAAC,CAAC,CACvBD,UAAU,CAACS,IAAI,CAACZ,KAAK,CAACI,CAAC,CAAC,CAACO,OAAO,CAAC,CACnC,CACAT,QAAQ,CAAG7B,KAAK,CAACwC,SAAS,CAACX,QAAQ,CAAE,MAAM,CAAE,KAAK,CAAC,CACnDb,KAAA,CAAKyB,QAAQ,CAAC,CACZZ,QAAQ,CAAEA,QAAQ,CAClBa,eAAe,CAAE,CAAC1B,KAAA,CAAKI,KAAK,CAACsB,eAAe,CAC5CC,gBAAgB,CAAE,CAAC,CACrB,CAAC,CAAC,CACJ,CAAC,CAAC,CACJ,CAAC,IACI,CACH3B,KAAA,CAAKyB,QAAQ,CAAC,CAACC,eAAe,CAAE,CAAC1B,KAAA,CAAKI,KAAK,CAACsB,eAAe,CAAC,CAAC,CAC/D,CACF,CAAC,CAAA1B,KAAA,CAED4B,mBAAmB,CAAG,UAAM,CAC1B5B,KAAA,CAAKyB,QAAQ,CAAC,CAACI,iBAAiB,CAAE,CAAC7B,KAAA,CAAKI,KAAK,CAACyB,iBAAiB,CAAC,CAAC,CACnE,CAAC,CAAA7B,KAAA,CAED8B,iBAAiB,CAAG,SAACC,IAAI,CAAEC,QAAQ,CAAEC,MAAM,CAAK,CAC9CjC,KAAA,CAAKD,KAAK,CAAC+B,iBAAiB,CAACC,IAAI,CAAEC,QAAQ,CAAEC,MAAM,CAAC,CACpDjC,KAAA,CAAKyB,QAAQ,CAAC,CACZS,YAAY,CAAEH,IAAI,CAClBI,YAAY,CAAEH,QAChB,CAAC,CAAC,CACJ,CAAC,CAAAhC,KAAA,CAEDoC,eAAe,CAAG,SAACL,IAAI,CAAK,CAC1B,GAAI/B,KAAA,CAAKD,KAAK,CAACqC,eAAe,CAAE,CAC9BpC,KAAA,CAAKD,KAAK,CAACqC,eAAe,CAACL,IAAI,CAAC,CAClC,CACA/B,KAAA,CAAKyB,QAAQ,CAAC,CACZS,YAAY,CAAEH,IAAI,CAClBI,YAAY,CAAE,GAChB,CAAC,CAAC,CACJ,CAAC,CAAAnC,KAAA,CAEDqC,gBAAgB,CAAG,UAAM,CACvBrC,KAAA,CAAKyB,QAAQ,CAAC,CACZa,WAAW,CAAE,KAAK,CAClBC,WAAW,CAAE,KAAK,CAClBC,UAAU,CAAE,EAAE,CACdC,aAAa,CAAE,EACjB,CAAC,CAAC,CACFzC,KAAA,CAAK0C,UAAU,CAAG,EAAE,CACpB1C,KAAA,CAAK2C,KAAK,CAAG,IAAI,CACjB3C,KAAA,CAAK4C,MAAM,CAAG,IAAI,CACpB,CAAC,CAAA5C,KAAA,CAED6C,mBAAmB,CAAG,SAACC,KAAK,CAAK,CAC/B,GAAI,CAAAN,UAAU,CAAGM,KAAK,CAACC,MAAM,CAACC,KAAK,CAACC,IAAI,CAAC,CAAC,CAE1CjD,KAAA,CAAKyB,QAAQ,CAAC,CAACe,UAAU,CAAEA,UAAU,CAAC,CAAC,CAEvC,GAAIxC,KAAA,CAAK0C,UAAU,GAAKF,UAAU,CAAE,CAClC,MAAO,MAAK,CACd,CAEAxC,KAAA,CAAK0C,UAAU,CAAGF,UAAU,CAE5B,GAAIA,UAAU,CAACxB,MAAM,GAAK,CAAC,CAAE,CAC3BhB,KAAA,CAAKyB,QAAQ,CAAC,CACZa,WAAW,CAAE,KAAK,CAClBG,aAAa,CAAE,EACjB,CAAC,CAAC,CACF,MAAO,MAAK,CACd,CAEA,GAAI,CAACzC,KAAA,CAAKI,KAAK,CAACqC,aAAa,CAACzB,MAAM,EAAIwB,UAAU,CAACxB,MAAM,CAAG,CAAC,CAAE,CAC7DhB,KAAA,CAAKyB,QAAQ,CAAC,CACZa,WAAW,CAAE,IAAI,CACjBC,WAAW,CAAE,KACf,CAAC,CAAC,CACJ,CAEA,GAAIvC,KAAA,CAAK0C,UAAU,GAAK,EAAE,EAAI1C,KAAA,CAAKkD,cAAc,CAAClD,KAAA,CAAK0C,UAAU,CAAC,CAAG,CAAC,CAAE,CACtE1C,KAAA,CAAKyB,QAAQ,CAAC,CAACc,WAAW,CAAE,KAAK,CAAC,CAAC,CACnC,MAAO,MAAK,CACd,CAEA,GAAI,CAAArB,MAAM,CAAGlB,KAAA,CAAKD,KAAK,CAACmB,MAAM,CAC9B,GAAI,CAAAiC,UAAU,CAAGnD,KAAA,CAAKD,KAAK,CAACoD,UAAU,CACtC,GAAI,CAAAC,IAAI,CAAGpD,KAAA,CAAKD,KAAK,CAACqD,IAAI,CAC1B,GAAI,CAAAC,UAAU,CAAGD,IAAI,GAAK,sBAAsB,CAAGlC,MAAM,CAAG,KAAK,CAEjE,GAAI,CAAAoC,SAAS,CAAG,CACdC,CAAC,CAAEf,UAAU,CACbgB,WAAW,CAAEH,UAAU,CACvBI,aAAa,CAAE,KAAK,CACpBC,QAAQ,CAAEP,UAAU,CAAG,MAAM,CAAG,KAClC,CAAC,CAED,GAAInD,KAAA,CAAK2C,KAAK,CAAE,CACdgB,YAAY,CAAC3D,KAAA,CAAK2C,KAAK,CAAC,CAC1B,CAEA3C,KAAA,CAAK2C,KAAK,CAAGiB,UAAU,CAAC5D,KAAA,CAAK6D,eAAe,CAACP,SAAS,CAAC,CAAE,GAAG,CAAC,CAC/D,CAAC,CAAAtD,KAAA,CAED6D,eAAe,CAAG,SAACP,SAAS,CAAK,CAC/B,GAAItD,KAAA,CAAK4C,MAAM,CAAE,CACf5C,KAAA,CAAK8D,aAAa,CAAC,CAAC,CACtB,CAEA9D,KAAA,CAAKyB,QAAQ,CAAC,CAACc,WAAW,CAAE,KAAK,CAAC,CAAC,CAEnCvC,KAAA,CAAK4C,MAAM,CAAG/D,UAAU,CAACkF,SAAS,CAAC,CAAC,CACpC/D,KAAA,CAAKgE,WAAW,CAACV,SAAS,CAAEtD,KAAA,CAAK4C,MAAM,CAACqB,KAAK,CAAC,CAChD,CAAC,CAAAjE,KAAA,CAEDgE,WAAW,CAAG,SAACV,SAAS,CAAEY,WAAW,CAAK,CACxCrF,UAAU,CAACsF,WAAW,CAACb,SAAS,CAAEY,WAAW,CAAC,CAACzD,IAAI,CAAC,SAAAC,GAAG,CAAI,CACzD,GAAI,CAACA,GAAG,CAACE,IAAI,CAACwD,KAAK,CAAE,CACnBpE,KAAA,CAAKyB,QAAQ,CAAC,CACZgB,aAAa,CAAE,EAAE,CACjBF,WAAW,CAAE,IACf,CAAC,CAAC,CACFvC,KAAA,CAAK4C,MAAM,CAAG,IAAI,CAClB,OACF,CAEA,GAAI,CAAAyB,KAAK,CAAGrE,KAAA,CAAKsE,iBAAiB,CAAC5D,GAAG,CAACE,IAAI,CAAC2D,OAAO,CAAC,CACpDvE,KAAA,CAAKyB,QAAQ,CAAC,CACZgB,aAAa,CAAE4B,KAAK,CACpB9B,WAAW,CAAE,IACf,CAAC,CAAC,CACFvC,KAAA,CAAK4C,MAAM,CAAG,IAAI,CACpB,CAAC,CAAC,CACJ,CAAC,CAAA5C,KAAA,CAED8D,aAAa,CAAG,UAAM,CACpB9D,KAAA,CAAK4C,MAAM,CAAC4B,MAAM,CAAC,2BAA2B,CAAC,CACjD,CAAC,CAAAxE,KAAA,CAEDkD,cAAc,CAAG,SAACuB,GAAG,CAAK,CACxB,GAAI,CAAA1D,CAAC,CAAG,CAAC,CAAE2D,IAAI,CAAEC,GAAG,CAAG,CAAC,CACxB,KAAO5D,CAAC,CAAG0D,GAAG,CAACzD,MAAM,CAAED,CAAC,EAAE,CAAE,CAC1B2D,IAAI,CAAGD,GAAG,CAACG,UAAU,CAAC7D,CAAC,CAAC,CACxB,GAAI2D,IAAI,EAAI,EAAE,CAAE,CAAE;AAChBC,GAAG,EAAI,CAAC,CACV,CAAC,IAAM,IAAID,IAAI,CAAG,MAAM,CAAE,CACxBC,GAAG,EAAI,CAAC,CACV,CAAC,IAAM,IAAID,IAAI,EAAI,MAAM,EAAIA,IAAI,EAAI,MAAM,CAAE,CAC3CC,GAAG,EAAI,CAAC,CACV,CAAC,IAAM,IAAID,IAAI,EAAI,MAAM,EAAIA,IAAI,EAAI,MAAM,CAAE,CAC3CC,GAAG,EAAI,CAAC,CACV,CACF,CACA,MAAO,CAAAA,GAAG,CACZ,CAAC,CAAA3E,KAAA,CAEDsE,iBAAiB,CAAG,SAAC1D,IAAI,CAAK,CAC5B,GAAI,CAAAyD,KAAK,CAAG,EAAE,CACd,GAAI,CAAArD,MAAM,CAAGJ,IAAI,CAACI,MAAM,CAAG,EAAE,CAAG,EAAE,CAAGJ,IAAI,CAACI,MAAM,CAChD,IAAK,GAAI,CAAAD,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGC,MAAM,CAAED,CAAC,EAAE,CAAE,CAC/BsD,KAAK,CAACtD,CAAC,CAAC,CAAG,CAAC,CAAC,CACbsD,KAAK,CAACtD,CAAC,CAAC,CAAC,OAAO,CAAC,CAAG,CAACA,CAAC,CAAC,CACvBsD,KAAK,CAACtD,CAAC,CAAC,CAAC,MAAM,CAAC,CAAGH,IAAI,CAACG,CAAC,CAAC,CAAC8D,IAAI,CAC/BR,KAAK,CAACtD,CAAC,CAAC,CAAC,MAAM,CAAC,CAAGH,IAAI,CAACG,CAAC,CAAC,CAAC+D,QAAQ,CACnCT,KAAK,CAACtD,CAAC,CAAC,CAAC,SAAS,CAAC,CAAGH,IAAI,CAACG,CAAC,CAAC,CAACO,OAAO,CACrC+C,KAAK,CAACtD,CAAC,CAAC,CAAC,WAAW,CAAC,CAAGH,IAAI,CAACG,CAAC,CAAC,CAACI,SAAS,CACzCkD,KAAK,CAACtD,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAGH,IAAI,CAACG,CAAC,CAAC,CAACgE,MAAM,CACnCV,KAAK,CAACtD,CAAC,CAAC,CAAC,cAAc,CAAC,CAAGiE,SAAS,CAACpE,IAAI,CAACG,CAAC,CAAC,CAAC+D,QAAQ,CAAC,CAACG,SAAS,CAAC,CAAC,CAAC,CACnEZ,KAAK,CAACtD,CAAC,CAAC,CAAC,SAAS,CAAC,CAAGH,IAAI,CAACG,CAAC,CAAC,CAACmE,iBAAiB,CACjD,CACA,MAAO,CAAAb,KAAK,CACd,CAAC,CAAArE,KAAA,CAEDmF,mBAAmB,CAAG,SAACC,IAAI,CAAK,CAC9BA,IAAI,CAAC,MAAM,CAAC,CAAGA,IAAI,CAACL,MAAM,CAAG,KAAK,CAAG,MAAM,CAC3C,GAAI,CAAAhD,IAAI,CAAG,GAAI,CAAA7C,QAAQ,CAACkG,IAAI,CAAC,CAC7BpF,KAAA,CAAKD,KAAK,CAAC+B,iBAAiB,CAACC,IAAI,CAAEqD,IAAI,CAACC,IAAI,CAAED,IAAI,CAAC,CACrD,CAAC,CAAApF,KAAA,CAEDsF,kBAAkB,CAAG,UAAM,CACzB,GAAItF,KAAA,CAAKkD,cAAc,CAAClD,KAAA,CAAK0C,UAAU,CAAC,CAAG,CAAC,CAAE,CAC5C,MAAO,EAAE,CACX,CAEA,GAAI,CAAC1C,KAAA,CAAKI,KAAK,CAACmC,WAAW,CAAE,CAC3B,mBAAQhD,IAAA,CAACH,OAAO,GAAE,CAAC,CACrB,CAEA,GAAIY,KAAA,CAAKI,KAAK,CAACmC,WAAW,EAAIvC,KAAA,CAAKI,KAAK,CAACqC,aAAa,CAACzB,MAAM,GAAK,CAAC,CAAE,CACnE,mBAAQzB,IAAA,QAAKgG,SAAS,CAAC,gCAAgC,CAAAC,QAAA,CAAE1G,OAAO,CAAC,qBAAqB,CAAC,CAAM,CAAC,CAChG,CAEA,GAAIkB,KAAA,CAAKI,KAAK,CAACmC,WAAW,EAAIvC,KAAA,CAAKI,KAAK,CAACqC,aAAa,CAACzB,MAAM,CAAG,CAAC,CAAE,CACjE,mBACEzB,IAAA,CAACF,gBAAgB,EACfoD,aAAa,CAAEzC,KAAA,CAAKI,KAAK,CAACqC,aAAc,CACxCgD,WAAW,CAAEzF,KAAA,CAAKmF,mBAAoB,CACtCO,yBAAyB,CAAE1F,KAAA,CAAK0F,yBAA0B,CAC3D,CAAC,CACN,CACF,CAAC,CAAA1F,KAAA,CAED0F,yBAAyB,CAAG,SAACN,IAAI,CAAK,CACpC,GAAIA,IAAI,CAACO,IAAI,GAAK,KAAK,CAAE,CACvB,OACF,CAEA,GAAI,CAAAhE,gBAAgB,CAAG,CACrBT,MAAM,CAAEkE,IAAI,CAAC9D,OAAO,CACpBU,QAAQ,CAAEoD,IAAI,CAACC,IACjB,CAAC,CAEDrF,KAAA,CAAKyB,QAAQ,CAAC,CACZE,gBAAgB,CAAEA,gBACpB,CAAC,CAAC,CAEF,GAAI3B,KAAA,CAAKD,KAAK,CAACmB,MAAM,EAAIkE,IAAI,CAAC9D,OAAO,GAAKtB,KAAA,CAAKD,KAAK,CAACmB,MAAM,CAAE,CAC3DrC,UAAU,CAAC+G,WAAW,CAAC5F,KAAA,CAAKD,KAAK,CAACmB,MAAM,CAAC,CAACT,IAAI,CAAC,SAAAC,GAAG,CAAI,CACpD;AACA,GAAI,CAAAmF,QAAQ,CAAG,GAAI,CAAA3G,QAAQ,CAACwB,GAAG,CAACE,IAAI,CAAC,CACrC,GAAI,CAAAyE,IAAI,CAAGD,IAAI,CAACC,IAAI,CAACJ,SAAS,CAAC,CAAC,CAAGG,IAAI,CAACC,IAAI,CAACrE,MAAM,CAAG,CAAE,CAAC,CAEzDhB,KAAA,CAAKyB,QAAQ,CAAC,CACZS,YAAY,CAAE2D,QAAQ,CACtB1D,YAAY,CAAEkD,IAAI,CAClBxD,iBAAiB,CAAE,IACrB,CAAC,CAAC,CACJ,CAAC,CAAC,CAACiE,KAAK,CAAC,SAAAC,KAAK,CAAI,CAChB,GAAI,CAAAC,UAAU,CAAGhH,KAAK,CAACiH,WAAW,CAACF,KAAK,CAAC,CACzC9G,OAAO,CAACiH,MAAM,CAACF,UAAU,CAAC,CAC5B,CAAC,CAAC,CACJ,CAAC,IAAM,CACL,GAAI,CAAChG,KAAA,CAAKI,KAAK,CAACC,UAAU,CAAE,CAC1B,GAAI,CAAAC,IAAI,CAAAC,sBAAA,CAAAP,KAAA,CAAO,CACfnB,UAAU,CAAC2B,SAAS,CAAC,CAAC,CAACC,IAAI,CAAC,SAAAC,GAAG,CAAI,CACjC;AACA,GAAI,CAAAC,KAAK,CAAGD,GAAG,CAACE,IAAI,CAACD,KAAK,CAC1B,GAAI,CAAAE,QAAQ,CAAG,EAAE,CACjB,GAAI,CAAAC,UAAU,CAAG,EAAE,CACnB,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGJ,KAAK,CAACK,MAAM,CAAED,CAAC,EAAE,CAAE,CACrC,GAAIJ,KAAK,CAACI,CAAC,CAAC,CAACE,UAAU,GAAK,IAAI,CAAE,CAChC,SACF,CACA,GAAIX,IAAI,CAACP,KAAK,CAACmB,MAAM,EAAKP,KAAK,CAACI,CAAC,CAAC,CAACI,SAAS,GAAKb,IAAI,CAACF,KAAK,CAACgB,eAAe,CAACD,SAAU,CAAE,CACtF,SACF,CACA,GAAIL,UAAU,CAACO,OAAO,CAACV,KAAK,CAACI,CAAC,CAAC,CAACO,OAAO,CAAC,CAAG,CAAC,CAAC,CAAE,CAC7C,SACF,CACAT,QAAQ,CAACU,IAAI,CAACZ,KAAK,CAACI,CAAC,CAAC,CAAC,CACvBD,UAAU,CAACS,IAAI,CAACZ,KAAK,CAACI,CAAC,CAAC,CAACO,OAAO,CAAC,CACnC,CACAT,QAAQ,CAAG7B,KAAK,CAACwC,SAAS,CAACX,QAAQ,CAAE,MAAM,CAAE,KAAK,CAAC,CACnD,GAAI,CAAAkB,IAAI,CAAGlB,QAAQ,CAACsF,MAAM,CAAC,SAAAC,QAAQ,QAAI,CAAAA,QAAQ,CAAC9E,OAAO,GAAK8D,IAAI,CAAC9D,OAAO,GAAC,CACzE,GAAI,CAAA+D,IAAI,CAAGD,IAAI,CAACC,IAAI,CAACJ,SAAS,CAAC,CAAC,CAAGG,IAAI,CAACC,IAAI,CAACrE,MAAM,CAAG,CAAE,CAAC,CAEzD,GAAI,CAAAqF,UAAU,CAAGtE,IAAI,CAAC,CAAC,CAAC,CACxB/B,KAAA,CAAKyB,QAAQ,CAAC,CACZZ,QAAQ,CAAEA,QAAQ,CAClBa,eAAe,CAAE,IAAI,CACrBS,YAAY,CAAEkD,IAAI,CAClBnD,YAAY,CAAEmE,UAChB,CAAC,CAAC,CACJ,CAAC,CAAC,CACJ,CAAC,IACI,CACHrG,KAAA,CAAKyB,QAAQ,CAAC,CAACC,eAAe,CAAE,CAAC1B,KAAA,CAAKI,KAAK,CAACsB,eAAe,CAAC,CAAC,CAC/D,CACF,CACA1B,KAAA,CAAKqC,gBAAgB,CAAC,CAAC,CACzB,CAAC,CAAArC,KAAA,CAEDsG,QAAQ,CAAG,SAACxD,KAAK,CAAK,CACpBA,KAAK,CAACyD,eAAe,CAAC,CAAC,CACzB,CAAC,CAAAvG,KAAA,CAEDwG,kBAAkB,CAAG,UAAM,CAEzB,mBACE/G,KAAA,QAAK8F,SAAS,CAAC,yCAAyC,CAACe,QAAQ,CAAEtG,KAAA,CAAKsG,QAAS,CAAAd,QAAA,EAC9ExF,KAAA,CAAKD,KAAK,CAACqD,IAAI,GAAK,8BAA8B,eACjD3D,KAAA,CAACd,QAAQ,EAAA6G,QAAA,eACP/F,KAAA,QAAK8F,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxB/F,KAAA,QAAK8F,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/BjG,IAAA,SAAMgG,SAAS,mBAAAkB,MAAA,CAAoBzG,KAAA,CAAKI,KAAK,CAACyB,iBAAiB,CAAG,eAAe,CAAG,gBAAgB,CAAG,CAAC6E,OAAO,CAAE1G,KAAA,CAAK4B,mBAAoB,CAAO,CAAC,cAClJrC,IAAA,SAAMgG,SAAS,CAAC,SAAS,CAAAC,QAAA,CAAE1G,OAAO,CAAC,iBAAiB,CAAC,CAAO,CAAC,EAC1D,CAAC,CAEJkB,KAAA,CAAKI,KAAK,CAACyB,iBAAiB,EAAI7B,KAAA,CAAKI,KAAK,CAACgB,eAAe,eAC1D7B,IAAA,CAACJ,YAAY,EACXwH,kBAAkB,CAAE,IAAK,CACzBvF,eAAe,CAAEpB,KAAA,CAAKI,KAAK,CAACgB,eAAgB,CAC5CwF,WAAW,CAAE5G,KAAA,CAAKD,KAAK,CAAC6G,WAAY,CACpC1E,YAAY,CAAElC,KAAA,CAAKI,KAAK,CAAC8B,YAAa,CACtCC,YAAY,CAAEnC,KAAA,CAAKI,KAAK,CAAC+B,YAAa,CACtCC,eAAe,CAAEpC,KAAA,CAAKoC,eAAgB,CACtCN,iBAAiB,CAAE9B,KAAA,CAAK8B,iBAAkB,CAC1CqB,UAAU,CAAEnD,KAAA,CAAKD,KAAK,CAACoD,UAAW,CAClC0D,YAAY,CAAE7G,KAAA,CAAKD,KAAK,CAAC8G,YAAa,CACtClF,gBAAgB,CAAE3B,KAAA,CAAKI,KAAK,CAACuB,gBAAiB,CAC/C,CAAC,EAED,CAAC,cACNlC,KAAA,QAAK8F,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxB/F,KAAA,QAAK8F,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/BjG,IAAA,SAAMgG,SAAS,mBAAAkB,MAAA,CAAoBzG,KAAA,CAAKI,KAAK,CAACsB,eAAe,CAAG,eAAe,CAAG,gBAAgB,CAAG,CAACgF,OAAO,CAAE1G,KAAA,CAAKG,iBAAkB,CAAO,CAAC,cAC9IZ,IAAA,SAAMgG,SAAS,CAAC,SAAS,CAAAC,QAAA,CAAE1G,OAAO,CAAC,iBAAiB,CAAC,CAAO,CAAC,EAC1D,CAAC,CAEJkB,KAAA,CAAKI,KAAK,CAACsB,eAAe,eAC1BnC,IAAA,CAACJ,YAAY,EACXwH,kBAAkB,CAAE,KAAM,CAC1B9F,QAAQ,CAAEb,KAAA,CAAKI,KAAK,CAACS,QAAS,CAC9BqB,YAAY,CAAElC,KAAA,CAAKI,KAAK,CAAC8B,YAAa,CACtCC,YAAY,CAAEnC,KAAA,CAAKI,KAAK,CAAC+B,YAAa,CACtCC,eAAe,CAAEpC,KAAA,CAAKoC,eAAgB,CACtCN,iBAAiB,CAAE9B,KAAA,CAAK8B,iBAAkB,CAC1CqB,UAAU,CAAEnD,KAAA,CAAKD,KAAK,CAACoD,UAAW,CAClC0D,YAAY,CAAE7G,KAAA,CAAKD,KAAK,CAAC8G,YAAa,CACtClF,gBAAgB,CAAE3B,KAAA,CAAKI,KAAK,CAACuB,gBAAiB,CAC/C,CAAC,EAED,CAAC,EACE,CACX,CACA3B,KAAA,CAAKD,KAAK,CAACqD,IAAI,GAAK,sBAAsB,eACzC3D,KAAA,QAAK8F,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxB/F,KAAA,QAAK8F,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/BjG,IAAA,SAAMgG,SAAS,mBAAAkB,MAAA,CAAoBzG,KAAA,CAAKI,KAAK,CAACyB,iBAAiB,CAAG,eAAe,CAAG,gBAAgB,CAAG,CAAC6E,OAAO,CAAE1G,KAAA,CAAK4B,mBAAoB,CAAO,CAAC,cAClJrC,IAAA,SAAMgG,SAAS,CAAC,SAAS,CAAAC,QAAA,CAAE1G,OAAO,CAAC,iBAAiB,CAAC,CAAO,CAAC,EAC1D,CAAC,CAEJkB,KAAA,CAAKI,KAAK,CAACyB,iBAAiB,EAAI7B,KAAA,CAAKI,KAAK,CAACgB,eAAe,eAC1D7B,IAAA,CAACJ,YAAY,EACXwH,kBAAkB,CAAE,IAAK,CACzBvF,eAAe,CAAEpB,KAAA,CAAKI,KAAK,CAACgB,eAAgB,CAC5CwF,WAAW,CAAE5G,KAAA,CAAKD,KAAK,CAAC6G,WAAY,CACpC1E,YAAY,CAAElC,KAAA,CAAKI,KAAK,CAAC8B,YAAa,CACtCC,YAAY,CAAEnC,KAAA,CAAKI,KAAK,CAAC+B,YAAa,CACtCC,eAAe,CAAEpC,KAAA,CAAKoC,eAAgB,CACtCN,iBAAiB,CAAE9B,KAAA,CAAK8B,iBAAkB,CAC1CqB,UAAU,CAAEnD,KAAA,CAAKD,KAAK,CAACoD,UAAW,CAClC0D,YAAY,CAAE7G,KAAA,CAAKD,KAAK,CAAC8G,YAAa,CACtClF,gBAAgB,CAAE3B,KAAA,CAAKI,KAAK,CAACuB,gBAAiB,CAC/C,CAAC,EAED,CACN,CACA3B,KAAA,CAAKD,KAAK,CAACqD,IAAI,GAAK,gBAAgB,eACnC7D,IAAA,QAAKgG,SAAS,CAAC,wBAAwB,CAAAC,QAAA,cACrC/F,KAAA,QAAK8F,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxB/F,KAAA,QAAK8F,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/BjG,IAAA,SAAMgG,SAAS,CAAC,8BAA8B,CAAO,CAAC,cACtDhG,IAAA,SAAMgG,SAAS,CAAC,SAAS,CAAAC,QAAA,CAAE1G,OAAO,CAAC,WAAW,CAAC,CAAO,CAAC,EACpD,CAAC,cACNS,IAAA,CAACJ,YAAY,EACXwH,kBAAkB,CAAE,KAAM,CAC1B9F,QAAQ,CAAEb,KAAA,CAAKI,KAAK,CAACS,QAAS,CAC9BqB,YAAY,CAAElC,KAAA,CAAKI,KAAK,CAAC8B,YAAa,CACtCC,YAAY,CAAEnC,KAAA,CAAKI,KAAK,CAAC+B,YAAa,CACtCC,eAAe,CAAEpC,KAAA,CAAKoC,eAAgB,CACtCN,iBAAiB,CAAE9B,KAAA,CAAK8B,iBAAkB,CAC1CqB,UAAU,CAAEnD,KAAA,CAAKD,KAAK,CAACoD,UAAW,CAClC0D,YAAY,CAAE7G,KAAA,CAAKD,KAAK,CAAC8G,YAAa,CACtClF,gBAAgB,CAAE3B,KAAA,CAAKI,KAAK,CAACuB,gBAAiB,CAC/C,CAAC,EACC,CAAC,CACH,CACN,EACE,CAAC,CAEV,CAAC,CAvbC3B,KAAA,CAAKI,KAAK,CAAG,CACXC,UAAU,CAAE,KAAK,CACjBwB,iBAAiB,CAAE,IAAI,CACvBH,eAAe,CAAE,KAAK,CACtBb,QAAQ,CAAE,EAAE,CACZO,eAAe,CAAE,IAAI,CACrBc,YAAY,CAAE,IAAI,CAClBC,YAAY,CAAEnC,KAAA,CAAKD,KAAK,CAAC6G,WAAW,EAAI,GAAG,CAC3CtE,WAAW,CAAE,KAAK,CAClBC,WAAW,CAAE,KAAK,CAClBC,UAAU,CAAE,EAAE,CACdC,aAAa,CAAE,EAAE,CACjBd,gBAAgB,CAAE,CAAC,CACrB,CAAC,CACD3B,KAAA,CAAK0C,UAAU,CAAG,EAAE,CACpB1C,KAAA,CAAK2C,KAAK,CAAG,IAAI,CACjB3C,KAAA,CAAK4C,MAAM,CAAG,IAAI,CAAC,OAAA5C,KAAA,CACrB,CAAC8G,YAAA,CAAApH,WAAA,GAAAqH,GAAA,qBAAA/D,KAAA,CAED,SAAAgE,kBAAA,CAAoB,KAAAC,MAAA,MAClB,GAAI,IAAI,CAAClH,KAAK,CAACmB,MAAM,CAAE,CAAG;AACxB,GAAI,CAAAA,MAAM,CAAG,IAAI,CAACnB,KAAK,CAACmB,MAAM,CAC9BrC,UAAU,CAAC+G,WAAW,CAAC1E,MAAM,CAAC,CAACT,IAAI,CAAC,SAAAC,GAAG,CAAI,CACzC;AACA,GAAI,CAAAmF,QAAQ,CAAG,GAAI,CAAA3G,QAAQ,CAACwB,GAAG,CAACE,IAAI,CAAC,CACrCqG,MAAI,CAACxF,QAAQ,CAAC,CACZL,eAAe,CAAEyE,QAAQ,CACzB3D,YAAY,CAAE2D,QAChB,CAAC,CAAC,CACJ,CAAC,CAAC,CAACC,KAAK,CAAC,SAAAC,KAAK,CAAI,CAChB,GAAI,CAAAC,UAAU,CAAGhH,KAAK,CAACiH,WAAW,CAACF,KAAK,CAAC,CACzC9G,OAAO,CAACiH,MAAM,CAACF,UAAU,CAAC,CAC5B,CAAC,CAAC,CACJ,CAAC,IAAM,CAAE;AACPnH,UAAU,CAAC2B,SAAS,CAAC,CAAC,CAACC,IAAI,CAAC,SAAAC,GAAG,CAAI,CACjC,GAAI,CAAAC,KAAK,CAAGD,GAAG,CAACE,IAAI,CAACD,KAAK,CAC1B,GAAI,CAAAE,QAAQ,CAAG,EAAE,CACjB,GAAI,CAAAC,UAAU,CAAG,EAAE,CACnB,IAAI,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGJ,KAAK,CAACK,MAAM,CAAED,CAAC,EAAE,CAAE,CACpC,GAAIJ,KAAK,CAACI,CAAC,CAAC,CAACE,UAAU,GAAK,IAAI,CAAE,CAChC,SACF,CACA,GAAIH,UAAU,CAACO,OAAO,CAACV,KAAK,CAACI,CAAC,CAAC,CAACO,OAAO,CAAC,CAAG,CAAC,CAAC,CAAE,CAC7C,SACF,CACAT,QAAQ,CAACU,IAAI,CAACZ,KAAK,CAACI,CAAC,CAAC,CAAC,CACvBD,UAAU,CAACS,IAAI,CAACZ,KAAK,CAACI,CAAC,CAAC,CAACO,OAAO,CAAC,CACnC,CACAT,QAAQ,CAAG7B,KAAK,CAACwC,SAAS,CAACX,QAAQ,CAAE,MAAM,CAAE,KAAK,CAAC,CACnDoG,MAAI,CAACxF,QAAQ,CAAC,CAACZ,QAAQ,CAAEA,QAAQ,CAAC,CAAC,CACrC,CAAC,CAAC,CACJ,CACF,CAAC,GAAAkG,GAAA,UAAA/D,KAAA,CAqYD,SAAAkE,OAAA,CAAS,CACP,GAAI,CAAC,IAAI,CAAC9G,KAAK,CAAC8B,YAAY,EAAI,IAAI,CAACnC,KAAK,CAACmB,MAAM,CAAE,CACjD,MAAO,EAAE,CACX,CAEA,mBACEzB,KAAA,CAACd,QAAQ,EAAA6G,QAAA,EACNzG,KAAK,eACJU,KAAA,QAAK8F,SAAS,CAAC,2BAA2B,CAAAC,QAAA,eACxCjG,IAAA,CAACX,KAAK,EAAC2G,SAAS,CAAC,mBAAmB,CAAC4B,WAAW,CAAErI,OAAO,CAAC,QAAQ,CAAE,CAAC6G,IAAI,CAAC,MAAM,CAAC3C,KAAK,CAAE,IAAI,CAAC5C,KAAK,CAACoC,UAAW,CAAC4E,QAAQ,CAAE,IAAI,CAACvE,mBAAoB,CAAQ,CAAC,CAC1J,IAAI,CAACzC,KAAK,CAACoC,UAAU,CAACxB,MAAM,GAAK,CAAC,eACjCzB,IAAA,SAAMgG,SAAS,CAAC,8CAA8C,CAACmB,OAAO,CAAE,IAAI,CAACrE,gBAAiB,CAAO,CACtG,EACE,CACN,CACA,IAAI,CAACjC,KAAK,CAACkC,WAAW,eACrB/C,IAAA,QAAKgG,SAAS,CAAC,+BAA+B,CAAAC,QAAA,CAC3C,IAAI,CAACF,kBAAkB,CAAC,CAAC,CACvB,CACN,CACA,CAAC,IAAI,CAAClF,KAAK,CAACkC,WAAW,EAAI,IAAI,CAACkE,kBAAkB,CAAC,CAAC,EAC7C,CAAC,CAEf,CAAC,WAAA9G,WAAA,GApduBhB,KAAK,CAAC2I,SAAS,EAydzC,cAAe,CAAA3H,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}