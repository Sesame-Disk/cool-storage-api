{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{Button,Modal,ModalHeader,ModalBody,ModalFooter,FormGroup,Label,Input,Alert}from'reactstrap';import{gettext,siteRoot}from'../../../utils/constants';import moment from'moment';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LogsExportExcelDialog=/*#__PURE__*/function(_React$Component){_inherits(LogsExportExcelDialog,_React$Component);var _super=_createSuper(LogsExportExcelDialog);function LogsExportExcelDialog(props){var _this;_classCallCheck(this,LogsExportExcelDialog);_this=_super.call(this,props);_this.downloadExcel=function(){if(!_this.isValidDateStr()){return;}var _this$state=_this.state,startDateStr=_this$state.startDateStr,endDateStr=_this$state.endDateStr;var url=siteRoot;switch(_this.props.logType){case'login':url+='sys/loginadmin/export-excel/';break;case'fileAccess':url+='sys/log/fileaudit/export-excel/';break;case'fileUpdate':url+='sys/log/fileupdate/export-excel/';break;case'sharePermission':url+='sys/log/permaudit/export-excel/';break;}location.href=url+'?start='+startDateStr+'&end='+endDateStr;_this.props.toggle();};_this.isValidDateStr=function(){var _this$state2=_this.state,startDateStr=_this$state2.startDateStr,endDateStr=_this$state2.endDateStr;if(moment(startDateStr,'YYYY-MM-DD',true).isValid()&&moment(endDateStr,'YYYY-MM-DD',true).isValid()&&moment(startDateStr).isBefore(endDateStr)){return true;}else{_this.setState({errMsg:gettext('Date Invalid.')});return false;}};_this.handleStartChange=function(e){var startDateStr=e.target.value.trim();_this.setState({startDateStr:startDateStr,errMsg:''});};_this.handleEndChange=function(e){var endDateStr=e.target.value.trim();_this.setState({endDateStr:endDateStr,errMsg:''});};_this.state={loading:true,startDateStr:'',endDateStr:'',errMsg:''};return _this;}_createClass(LogsExportExcelDialog,[{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(Modal,{isOpen:true,toggle:this.props.toggle,autoFocus:false,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:this.props.toggle,children:gettext('Choose date')}),/*#__PURE__*/_jsxs(ModalBody,{children:[/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(Label,{children:gettext('Start date')}),/*#__PURE__*/_jsx(Input,{value:this.state.startDateStr,onChange:this.handleStartChange,placeholder:\"yyyy-mm-dd\",autoFocus:true})]}),/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(Label,{children:gettext('End date')}),/*#__PURE__*/_jsx(Input,{value:this.state.endDateStr,onChange:this.handleEndChange,placeholder:\"yyyy-mm-dd\"})]}),this.state.errMsg&&/*#__PURE__*/_jsx(Alert,{className:\"mt-2\",color:\"danger\",children:gettext(this.state.errMsg)})]}),/*#__PURE__*/_jsxs(ModalFooter,{children:[/*#__PURE__*/_jsx(Button,{color:\"secondary\",onClick:this.props.toggle,children:gettext('Cancel')}),/*#__PURE__*/_jsx(Button,{color:\"primary\",onClick:this.downloadExcel,children:gettext('Submit')})]})]});}}]);return LogsExportExcelDialog;}(React.Component);export default LogsExportExcelDialog;","map":{"version":3,"names":["React","Button","Modal","ModalHeader","ModalBody","ModalFooter","FormGroup","Label","Input","Alert","gettext","siteRoot","moment","jsx","_jsx","jsxs","_jsxs","LogsExportExcelDialog","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","downloadExcel","isValidDateStr","_this$state","state","startDateStr","endDateStr","url","logType","location","href","toggle","_this$state2","isValid","isBefore","setState","errMsg","handleStartChange","e","target","value","trim","handleEndChange","loading","_createClass","key","render","isOpen","autoFocus","children","onChange","placeholder","className","color","onClick","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/sysadmin-dialog/sysadmin-logs-export-excel-dialog.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, FormGroup, Label, Input, Alert } from 'reactstrap';\nimport { gettext, siteRoot } from '../../../utils/constants';\nimport moment from 'moment';\n\nclass LogsExportExcelDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      startDateStr: '',\n      endDateStr: '',\n      errMsg: '',\n    };\n  }\n\n  downloadExcel = () => {\n    if (!this.isValidDateStr()) {\n      return;\n    }\n    let { startDateStr, endDateStr } = this.state;\n    let url = siteRoot;\n\n    switch (this.props.logType) {\n      case 'login':\n        url += 'sys/loginadmin/export-excel/';\n        break;\n      case 'fileAccess':\n        url += 'sys/log/fileaudit/export-excel/';\n        break;\n      case 'fileUpdate':\n        url += 'sys/log/fileupdate/export-excel/';\n        break;\n      case 'sharePermission':\n        url += 'sys/log/permaudit/export-excel/';\n        break;\n    }\n    location.href = url + '?start=' + startDateStr + '&end=' + endDateStr;\n    this.props.toggle();\n  };\n\n  isValidDateStr = () => {\n    let { startDateStr, endDateStr } = this.state;\n    if (moment(startDateStr, 'YYYY-MM-DD', true).isValid() &&\n      moment(endDateStr, 'YYYY-MM-DD', true).isValid() &&\n      moment(startDateStr).isBefore(endDateStr)\n    ) {\n      return true;\n    } else {\n      this.setState({\n        errMsg: gettext('Date Invalid.')\n      });\n      return false;\n    }\n  };\n\n  handleStartChange = (e) => {\n    const startDateStr = e.target.value.trim();\n    this.setState({\n      startDateStr: startDateStr,\n      errMsg: ''\n    });\n  };\n\n  handleEndChange = (e) => {\n    const endDateStr = e.target.value.trim();\n    this.setState({\n      endDateStr: endDateStr,\n      errMsg: '',\n    });\n  };\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggle} autoFocus={false}>\n        <ModalHeader toggle={this.props.toggle}>{gettext('Choose date')}</ModalHeader>\n        <ModalBody>\n          <FormGroup>\n            <Label>{gettext('Start date')}</Label>\n            <Input\n              value={this.state.startDateStr}\n              onChange={this.handleStartChange}\n              placeholder='yyyy-mm-dd'\n              autoFocus={true}\n            />\n          </FormGroup>\n          <FormGroup>\n            <Label>{gettext('End date')}</Label>\n            <Input\n              value={this.state.endDateStr}\n              onChange={this.handleEndChange}\n              placeholder='yyyy-mm-dd'\n            />\n          </FormGroup>\n          {this.state.errMsg &&\n            <Alert className=\"mt-2\" color=\"danger\">\n              {gettext(this.state.errMsg)}\n            </Alert>\n          }\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.downloadExcel}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nconst propTypes = {\n  toggle: PropTypes.func.isRequired,\n  logType: PropTypes.string.isRequired,\n};\n\nLogsExportExcelDialog.propTypes = propTypes;\n\nexport default LogsExportExcelDialog;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}