{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import moment from'moment';import{Dropdown,DropdownToggle,DropdownMenu,DropdownItem}from'reactstrap';import{gettext,filePath}from'../../utils/constants';import URLDecorator from'../../utils/url-decorator';import'../../css/history-record-item.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";moment.locale(window.app.config.lang);var HistoryListItem=/*#__PURE__*/function(_React$Component){_inherits(HistoryListItem,_React$Component);var _super=_createSuper(HistoryListItem);function HistoryListItem(props){var _this;_classCallCheck(this,HistoryListItem);_this=_super.call(this,props);_this.onMouseEnter=function(){if(!_this.props.isItemFreezed){_this.setState({isShowOperationIcon:true});}};_this.onMouseLeave=function(){if(!_this.props.isItemFreezed){_this.setState({isShowOperationIcon:false});}};_this.onToggleClick=function(e){_this.setState({isMenuShow:!_this.state.isMenuShow});_this.props.onFreezedItemToggle();};_this.onItemClick=function(){_this.setState({isShowOperationIcon:false});//restore to default state\nif(_this.props.item.commit_id===_this.props.currentItem.commit_id){return;}var currentIndex=_this.props.index;_this.props.onItemClick(_this.props.item,currentIndex);};_this.onItemRestore=function(){_this.props.onItemRestore(_this.props.currentItem);};_this.onItemDownload=function(){// nothing todo\n};_this.state={isShowOperationIcon:false,isMenuShow:false};return _this;}_createClass(HistoryListItem,[{key:\"render\",value:function render(){if(!this.props.currentItem){return'';}var item=this.props.item;var time=moment(item.ctime).format('YYYY-MM-DD HH:mm');var isHigtlightItem=false;if(this.props.item&&this.props.currentItem){isHigtlightItem=this.props.item.commit_id===this.props.currentItem.commit_id;}var objID=this.props.currentItem.rev_file_id;var url=URLDecorator.getUrl({type:'download_historic_file',filePath:filePath,objID:objID});return/*#__PURE__*/_jsxs(\"li\",{className:\"history-list-item \".concat(isHigtlightItem?'item-active':''),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onItemClick,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"history-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"time\",children:time}),/*#__PURE__*/_jsxs(\"div\",{className:\"owner\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"squire-icon\"}),/*#__PURE__*/_jsx(\"span\",{children:item.creator_name})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"history-operation\",children:/*#__PURE__*/_jsxs(Dropdown,{isOpen:this.state.isMenuShow,toggle:this.onToggleClick,children:[/*#__PURE__*/_jsx(DropdownToggle,{tag:\"a\",className:\"fas fa-ellipsis-v \".concat(this.state.isShowOperationIcon||isHigtlightItem?'':'invisible'),\"data-toggle\":\"dropdown\",\"aria-expanded\":this.state.isMenuShow,title:gettext('More operations'),\"aria-label\":gettext('More operations')}),/*#__PURE__*/_jsxs(DropdownMenu,{children:[this.props.index!==0&&/*#__PURE__*/_jsx(DropdownItem,{onClick:this.onItemRestore,children:gettext('Restore')}),/*#__PURE__*/_jsx(DropdownItem,{tag:\"a\",href:url,onClick:this.onItemDownLoad,children:gettext('Download')})]})]})})]});}}]);return HistoryListItem;}(React.Component);export default HistoryListItem;","map":{"version":3,"names":["React","moment","Dropdown","DropdownToggle","DropdownMenu","DropdownItem","gettext","filePath","URLDecorator","jsx","_jsx","jsxs","_jsxs","locale","window","app","config","lang","HistoryListItem","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","onMouseEnter","isItemFreezed","setState","isShowOperationIcon","onMouseLeave","onToggleClick","e","isMenuShow","state","onFreezedItemToggle","onItemClick","item","commit_id","currentItem","currentIndex","index","onItemRestore","onItemDownload","_createClass","key","value","render","time","ctime","format","isHigtlightItem","objID","rev_file_id","url","getUrl","type","className","concat","onClick","children","creator_name","isOpen","toggle","tag","title","href","onItemDownLoad","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/history-list-view/history-list-item.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Dropdown, DropdownToggle, DropdownMenu, DropdownItem} from 'reactstrap';\nimport { gettext, filePath } from '../../utils/constants';\nimport URLDecorator from '../../utils/url-decorator';\n\nimport '../../css/history-record-item.css';\n\nmoment.locale(window.app.config.lang);\n\nconst propTypes = {\n  index: PropTypes.number.isRequired,\n  item: PropTypes.object.isRequired,\n  currentItem: PropTypes.object,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onItemRestore: PropTypes.func.isRequired,\n  onFreezedItemToggle: PropTypes.func.isRequired,\n};\n\nclass HistoryListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isShowOperationIcon: false,\n      isMenuShow: false,\n    };\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({isShowOperationIcon: true});\n    }\n  };\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({isShowOperationIcon: false});\n    }\n  };\n\n  onToggleClick = (e) => {\n    this.setState({isMenuShow: !this.state.isMenuShow});\n    this.props.onFreezedItemToggle();\n  };\n\n  onItemClick = () => {\n    this.setState({isShowOperationIcon: false});  //restore to default state\n    if (this.props.item.commit_id === this.props.currentItem.commit_id) {\n      return;\n    }\n    let currentIndex = this.props.index;\n    this.props.onItemClick(this.props.item, currentIndex);\n  };\n\n  onItemRestore = () => {\n    this.props.onItemRestore(this.props.currentItem);\n  };\n\n  onItemDownload = () => {\n    // nothing todo\n  };\n\n  render() {\n    if (!this.props.currentItem) {\n      return '';\n    }\n    let item = this.props.item;\n    let time = moment(item.ctime).format('YYYY-MM-DD HH:mm');\n    let isHigtlightItem = false;\n    if (this.props.item && this.props.currentItem) {\n      isHigtlightItem = this.props.item.commit_id === this.props.currentItem.commit_id;\n    }\n    let objID = this.props.currentItem.rev_file_id;\n    let url = URLDecorator.getUrl({type: 'download_historic_file', filePath: filePath, objID: objID});\n    return (\n      <li\n        className={`history-list-item ${isHigtlightItem ? 'item-active' : ''}`}\n        onMouseEnter={this.onMouseEnter}\n        onMouseLeave={this.onMouseLeave}\n        onClick={this.onItemClick}\n      >\n        <div className=\"history-info\">\n          <div className=\"time\">{time}</div>\n          <div className=\"owner\">\n            <span className=\"squire-icon\"></span>\n            <span>{item.creator_name}</span>\n          </div>\n        </div>\n        <div className=\"history-operation\">\n          <Dropdown isOpen={this.state.isMenuShow} toggle={this.onToggleClick}>\n            <DropdownToggle\n              tag='a'\n              className={`fas fa-ellipsis-v ${(this.state.isShowOperationIcon || isHigtlightItem) ? '' : 'invisible'}`}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isMenuShow}\n              title={gettext('More operations')}\n              aria-label={gettext('More operations')}\n            />\n            <DropdownMenu>\n              {(this.props.index !== 0) && <DropdownItem onClick={this.onItemRestore}>{gettext('Restore')}</DropdownItem>}\n              <DropdownItem tag='a' href={url} onClick={this.onItemDownLoad}>{gettext('Download')}</DropdownItem>\n            </DropdownMenu>\n          </Dropdown>\n        </div>\n      </li>\n    );\n  }\n}\n\nHistoryListItem.propTypes = propTypes;\n\nexport default HistoryListItem;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}