{"ast":null,"code":"import _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useCallback, useState } from 'react';\nimport { Transforms } from '@seafile/slate';\nimport { ReactEditor, useReadOnly } from '@seafile/slate-react';\nimport { withTranslation } from 'react-i18next';\nimport classnames from 'classnames';\nimport { FILE_LINK_TYPE_CONFIG, FILE_LINK_TYPE, FILE_LINK_TYPES } from '../constants';\nimport { ElementPopover } from '../../../commons';\nimport toaster from '../../../../../components/toast';\nimport { getUrl, onCopyFileLinkNode } from '../helpers';\nimport './index.css';\nvar FileLinkHoverMenu = function FileLinkHoverMenu(_ref) {\n  var editor = _ref.editor,\n    menuPosition = _ref.menuPosition,\n    element = _ref.element,\n    onUnwrapFileLinkNode = _ref.onUnwrapFileLinkNode,\n    onHideInsertHoverMenu = _ref.onHideInsertHoverMenu,\n    t = _ref.t;\n  var readOnly = useReadOnly();\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    isShowDisplayStylePopover = _useState2[0],\n    setIsShowDisplayStylePopover = _useState2[1];\n  var onCopy = useCallback(function (e) {\n    e.stopPropagation();\n    onCopyFileLinkNode(editor, element);\n    toaster.success(t('Copied'), {\n      hasCloseButton: false,\n      duration: 2\n    });\n    onHideInsertHoverMenu();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  var onShowProver = useCallback(function (e) {\n    setIsShowDisplayStylePopover(true);\n  }, []);\n  var onSelect = useCallback(function (event, value) {\n    event.stopPropagation();\n    var path = ReactEditor.findPath(editor, element);\n    if (path) {\n      Transforms.setNodes(editor, {\n        display_type: value\n      }, {\n        at: path\n      });\n    }\n    onHideInsertHoverMenu();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  var selectedType = element.display_type || FILE_LINK_TYPE.TEXT_LINK;\n  var id = \"file-link-display-type-\".concat(element.id);\n  return /*#__PURE__*/React.createElement(ElementPopover, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-file-link-hover-menu-container\",\n    style: menuPosition\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"hover-menu-container\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"op-group-item\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    role: \"button\",\n    className: classnames('op-item', {\n      'ml-0': readOnly\n    })\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    href: getUrl(element.doc_uuid),\n    target: \"_blank\",\n    rel: \"noopener noreferrer\",\n    className: \"link-op-menu-link\"\n  }, t('Open_link')))), !readOnly && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"op-group-item\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    role: \"button\",\n    className: \"op-item\",\n    onClick: onCopy\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-copy icon-font\"\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    role: \"button\",\n    className: classnames('op-item', {\n      'link-style-icon-active': isShowDisplayStylePopover\n    }),\n    onClick: onShowProver,\n    id: id\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: classnames('icon-font mr-1', FILE_LINK_TYPE_CONFIG[selectedType].icon)\n  }), /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-drop-down icon-font\"\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    role: \"button\",\n    className: \"op-item\",\n    onClick: onUnwrapFileLinkNode\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-unlink icon-font\"\n  })))), isShowDisplayStylePopover && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-file-display-style-popover sdoc-dropdown-menu\"\n  }, FILE_LINK_TYPES.map(function (fileLinkType) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: fileLinkType,\n      \"date-type\": fileLinkType,\n      className: \"sdoc-dropdown-menu-item sdoc-dropdown-item-with-left-icon pr-2\",\n      onClick: function onClick(event) {\n        return onSelect(event, fileLinkType);\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sdoc-dropdown-item-content\"\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: classnames('sdoc-dropdown-item-content-icon', FILE_LINK_TYPE_CONFIG[fileLinkType].icon)\n    }), /*#__PURE__*/React.createElement(\"span\", null, t(FILE_LINK_TYPE_CONFIG[fileLinkType].text))), selectedType === fileLinkType && /*#__PURE__*/React.createElement(\"i\", {\n      className: \"sdocfont sdoc-check-mark sdoc-dropdown-item-right-icon\"\n    }));\n  }))));\n};\nexport default withTranslation('sdoc-editor')(FileLinkHoverMenu);","map":{"version":3,"names":["React","useCallback","useState","Transforms","ReactEditor","useReadOnly","withTranslation","classnames","FILE_LINK_TYPE_CONFIG","FILE_LINK_TYPE","FILE_LINK_TYPES","ElementPopover","toaster","getUrl","onCopyFileLinkNode","FileLinkHoverMenu","_ref","editor","menuPosition","element","onUnwrapFileLinkNode","onHideInsertHoverMenu","t","readOnly","_useState","_useState2","_slicedToArray","isShowDisplayStylePopover","setIsShowDisplayStylePopover","onCopy","e","stopPropagation","success","hasCloseButton","duration","onShowProver","onSelect","event","value","path","findPath","setNodes","display_type","at","selectedType","TEXT_LINK","id","concat","createElement","className","style","role","href","doc_uuid","target","rel","onClick","icon","map","fileLinkType","key","text"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/plugins/file-link/hover-menu/index.js"],"sourcesContent":["import React, { useCallback, useState } from 'react';\nimport { Transforms } from '@seafile/slate';\nimport { ReactEditor, useReadOnly } from '@seafile/slate-react';\nimport { withTranslation } from 'react-i18next';\nimport classnames from 'classnames';\nimport { FILE_LINK_TYPE_CONFIG, FILE_LINK_TYPE, FILE_LINK_TYPES } from '../constants';\nimport { ElementPopover } from '../../../commons';\nimport toaster from '../../../../../components/toast';\nimport { getUrl, onCopyFileLinkNode } from '../helpers';\nimport './index.css';\nconst FileLinkHoverMenu = _ref => {\n  let {\n    editor,\n    menuPosition,\n    element,\n    onUnwrapFileLinkNode,\n    onHideInsertHoverMenu,\n    t\n  } = _ref;\n  const readOnly = useReadOnly();\n  const [isShowDisplayStylePopover, setIsShowDisplayStylePopover] = useState(false);\n  const onCopy = useCallback(e => {\n    e.stopPropagation();\n    onCopyFileLinkNode(editor, element);\n    toaster.success(t('Copied'), {\n      hasCloseButton: false,\n      duration: 2\n    });\n    onHideInsertHoverMenu();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const onShowProver = useCallback(e => {\n    setIsShowDisplayStylePopover(true);\n  }, []);\n  const onSelect = useCallback((event, value) => {\n    event.stopPropagation();\n    const path = ReactEditor.findPath(editor, element);\n    if (path) {\n      Transforms.setNodes(editor, {\n        display_type: value\n      }, {\n        at: path\n      });\n    }\n    onHideInsertHoverMenu();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const selectedType = element.display_type || FILE_LINK_TYPE.TEXT_LINK;\n  const id = \"file-link-display-type-\".concat(element.id);\n  return /*#__PURE__*/React.createElement(ElementPopover, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-file-link-hover-menu-container\",\n    style: menuPosition\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"hover-menu-container\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"op-group-item\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    role: \"button\",\n    className: classnames('op-item', {\n      'ml-0': readOnly\n    })\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    href: getUrl(element.doc_uuid),\n    target: \"_blank\",\n    rel: \"noopener noreferrer\",\n    className: \"link-op-menu-link\"\n  }, t('Open_link')))), !readOnly && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"op-group-item\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    role: \"button\",\n    className: \"op-item\",\n    onClick: onCopy\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-copy icon-font\"\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    role: \"button\",\n    className: classnames('op-item', {\n      'link-style-icon-active': isShowDisplayStylePopover\n    }),\n    onClick: onShowProver,\n    id: id\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: classnames('icon-font mr-1', FILE_LINK_TYPE_CONFIG[selectedType].icon)\n  }), /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-drop-down icon-font\"\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    role: \"button\",\n    className: \"op-item\",\n    onClick: onUnwrapFileLinkNode\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-unlink icon-font\"\n  })))), isShowDisplayStylePopover && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-file-display-style-popover sdoc-dropdown-menu\"\n  }, FILE_LINK_TYPES.map(fileLinkType => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: fileLinkType,\n      \"date-type\": fileLinkType,\n      className: \"sdoc-dropdown-menu-item sdoc-dropdown-item-with-left-icon pr-2\",\n      onClick: event => onSelect(event, fileLinkType)\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sdoc-dropdown-item-content\"\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: classnames('sdoc-dropdown-item-content-icon', FILE_LINK_TYPE_CONFIG[fileLinkType].icon)\n    }), /*#__PURE__*/React.createElement(\"span\", null, t(FILE_LINK_TYPE_CONFIG[fileLinkType].text))), selectedType === fileLinkType && /*#__PURE__*/React.createElement(\"i\", {\n      className: \"sdocfont sdoc-check-mark sdoc-dropdown-item-right-icon\"\n    }));\n  }))));\n};\nexport default withTranslation('sdoc-editor')(FileLinkHoverMenu);"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}