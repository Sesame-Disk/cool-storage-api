{"ast":null,"code":"import _toConsumableArray from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component,Fragment}from'react';import isHotkey from'is-hotkey';import classnames from'classnames';import MediaQuery from'react-responsive';import{seafileAPI}from'../../utils/seafile-api';import Icon from'../icon';import{gettext,siteRoot,username}from'../../utils/constants';import SearchResultItem from'./search-result-item';import{Utils}from'../../utils/utils';import{isMac}from'../../utils/extra-attributes';import toaster from'../toast';import Switch from'../common/switch';import{SEARCH_DELAY_TIME,getValueLength}from'./constant';import AISearchAsk from'./ai-search-ask';import AISearchRobot from'./ai-search-widgets/ai-search-robot';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var INDEX_STATE={RUNNING:'running',UNCREATED:'uncreated',FINISHED:'finished'};var SEARCH_MODE={QA:'question-answering',COMBINED:'combined-search'};var PER_PAGE=10;var controlKey=isMac()?'⌘':'Ctrl';var AISearch=/*#__PURE__*/function(_Component){_inherits(AISearch,_Component);var _super=_createSuper(AISearch);function AISearch(props){var _this;_classCallCheck(this,AISearch);_this=_super.call(this,props);_this.clearTimer=function(){if(_this.timer){clearTimeout(_this.timer);_this.timer=null;}};_this.onCompositionStart=function(){_this.isChineseInput=true;_this.clearTimer();};_this.onCompositionEnd=function(){_this.isChineseInput=false;// chrome：compositionstart -> onChange -> compositionend\n// not chrome：compositionstart -> compositionend -> onChange\n// The onChange event will setState and change input value, then setTimeout to initiate the search\n_this.clearTimer();_this.timer=setTimeout(function(){_this.onSearch();},SEARCH_DELAY_TIME);};_this.onDocumentKeydown=function(e){if(isHotkey('mod+f')(e)){e.preventDefault();_this.onFocusHandler();if(_this.inputRef&&_this.inputRef.current){_this.inputRef.current.focus();}}else if(isHotkey('esc',e)){e.preventDefault();_this.inputRef&&_this.inputRef.current&&_this.inputRef.current.blur();_this.resetToDefault();}else if(isHotkey('enter',e)){_this.onEnter(e);}else if(isHotkey('up',e)){_this.onUp(e);}else if(isHotkey('down',e)){_this.onDown(e);}};_this.onFocusHandler=function(){_this.setState({width:'570px',isMaskShow:true,isCloseShow:true});};_this.onCloseHandler=function(){_this.resetToDefault();};_this.onUp=function(e){e.preventDefault();e.stopPropagation();var highlightIndex=_this.state.highlightIndex;if(highlightIndex>0){_this.setState({highlightIndex:highlightIndex-1},function(){if(_this.highlightRef){var _this$highlightRef$ge=_this.highlightRef.getBoundingClientRect(),top=_this$highlightRef$ge.top,height=_this$highlightRef$ge.height;if(top-height<0){_this.searchContainer.current.scrollTop-=height;}}});}};_this.onDown=function(e){e.preventDefault();e.stopPropagation();var _this$state=_this.state,highlightIndex=_this$state.highlightIndex,resultItems=_this$state.resultItems;if(highlightIndex<resultItems.length-1){_this.setState({highlightIndex:highlightIndex+1},function(){if(_this.highlightRef){var _this$highlightRef$ge2=_this.highlightRef.getBoundingClientRect(),top=_this$highlightRef$ge2.top,height=_this$highlightRef$ge2.height;var outerHeight=300;if(top>outerHeight){_this.searchContainer.current.scrollTop+=height;}}});}};_this.onEnter=function(e){e.preventDefault();var item=_this.state.resultItems[_this.state.highlightIndex];if(item){if(document.activeElement){document.activeElement.blur();}_this.onItemClickHandler(item);}};_this.onItemClickHandler=function(item){_this.resetToDefault();_this.keepVisitedItem(item);_this.props.onSearchedClick(item);};_this.keepVisitedItem=function(targetItem){var repoID=_this.props.repoID;var targetIndex;var storeKey='sfVisitedAISearchItems';if(repoID){storeKey+=repoID;}var items=JSON.parse(localStorage.getItem(storeKey))||[];for(var i=0,len=items.length;i<len;i++){var _items$i=items[i],repo_id=_items$i.repo_id,path=_items$i.path;var targetRepoID=targetItem.repo_id,targetPath=targetItem.path;if(repo_id==targetRepoID&&path==targetPath){targetIndex=i;break;}}if(targetIndex!=undefined){items.splice(targetIndex,1);}items.unshift(targetItem);if(items.length>50){// keep 50 items at most\nitems.pop();}localStorage.setItem(storeKey,JSON.stringify(items));};_this.onChangeHandler=function(event){if(_this.state.showRecent){_this.setState({showRecent:false});}var newValue=event.target.value;_this.setState({value:newValue},function(){if(_this.inputValue===newValue.trim())return;_this.inputValue=newValue.trim();if(!_this.isChineseInput){_this.clearTimer();_this.timer=setTimeout(function(){_this.onSearch();},SEARCH_DELAY_TIME);}});};_this.onKeydownHandler=function(event){if(isHotkey('enter',event)){_this.onSearch();}};_this.onSearch=function(){var value=_this.state.value;var repoID=_this.props.repoID;if(_this.inputValue===''||getValueLength(_this.inputValue)<3){_this.setState({highlightIndex:0,resultItems:[],isResultGetted:false});return;}var queryData={q:value,search_repo:repoID?repoID:'all',search_ftypes:'all'};_this.getSearchResult(queryData);};_this.getSearchResult=function(queryData){if(_this.source){_this.source.cancel('prev request is cancelled');}_this.setState({isResultGetted:false,resultItems:[],highlightIndex:0});_this.source=seafileAPI.getSource();_this.sendRequest(queryData,_this.source.token,1);};_this.sendRequest=function(queryData,cancelToken,page){_this.queryData=queryData;_this.updateSearchPageURL(queryData);queryData['per_page']=PER_PAGE;queryData['page']=page;_this.onAiSearch(queryData,cancelToken,page);};_this.onAiSearch=function(queryData,cancelToken,page){var results=[];seafileAPI.aiSearchFiles(queryData,cancelToken).then(function(res){results=[].concat(_toConsumableArray(results),_toConsumableArray(_this.formatResultItems(res.data.results)));_this.setState({resultItems:results,isResultGetted:true,isLoading:false,page:page+1,hasMore:false});}).catch(function(error){/* eslint-disable */console.log(error);_this.setState({isLoading:false});});};_this.onResultListScroll=function(e){// Load less than 100 results\nif(!_this.state.hasMore||_this.state.isLoading||_this.state.resultItems.length>100){return;}var listPadding=20;if(e.target.scrollTop+e.target.clientHeight+listPadding>_this.searchResultListRef.current.clientHeight-10){_this.setState({isLoading:true},function(){_this.source=seafileAPI.getSource();_this.sendRequest(_this.queryData,_this.source.token,_this.state.page);});}};_this.openAsk=function(){_this.clearTimer();_this.setState({searchMode:SEARCH_MODE.QA});};_this.closeAsk=function(){_this.clearTimer();_this.setState({searchMode:SEARCH_MODE.COMBINED});};_this.renderVisitedItems=function(items){var highlightIndex=_this.state.highlightIndex;var results=/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"visited-search-results-title\",children:gettext('Search results visited recently')}),/*#__PURE__*/_jsx(\"ul\",{className:\"search-result-list\",ref:_this.searchResultListRef,children:items.map(function(item,index){var isHighlight=index===highlightIndex;return/*#__PURE__*/_jsx(SearchResultItem,{item:item,onItemClickHandler:_this.onItemClickHandler,isHighlight:isHighlight,setRef:isHighlight?function(ref){_this.highlightRef=ref;}:function(){}},index);})})]});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(MediaQuery,{query:\"(min-width: 768px)\",children:/*#__PURE__*/_jsx(\"div\",{className:\"search-result-list-container\",children:results})}),/*#__PURE__*/_jsx(MediaQuery,{query:\"(max-width: 767.8px)\",children:results})]});};_this.onSearchToggle=function(){_this.setState({isSearchInputShow:!_this.state.isSearchInputShow,isMaskShow:!_this.state.isMaskShow});};_this.queryIndexTaskStatus=function(taskId){if(!taskId)return;_this.indexStateTimer=setInterval(function(){seafileAPI.queryIndexTaskStatus(taskId).then(function(res){var isFinished=res.data.is_finished;if(isFinished){_this.setState({indexState:INDEX_STATE.FINISHED});_this.indexStateTimer&&clearInterval(_this.indexStateTimer);_this.indexStateTimer=null;}}).catch(function(error){_this.indexStateTimer&&clearInterval(_this.indexStateTimer);_this.indexStateTimer=null;var errorMsg=Utils.getErrorMsg(error);toaster.danger(errorMsg);_this.setState({indexState:INDEX_STATE.UNCREATED});});},3000);};_this.onCreateIndex=function(){_this.setState({indexState:INDEX_STATE.RUNNING});seafileAPI.createLibraryIndex(_this.props.repoID).then(function(res){var taskId=res.data.task_id;toaster.notify(gettext('Indexing the library. Semantic search will be available within a few minutes.'));_this.queryIndexTaskStatus(taskId);}).catch(function(error){var errorMsg=Utils.getErrorMsg(error);toaster.danger(errorMsg);_this.setState({indexState:INDEX_STATE.UNCREATED});});};_this.onDeleteIndex=function(){seafileAPI.deleteLibraryIndex(_this.props.repoID).then(function(res){toaster.notify(gettext('Successfully turned it off'));_this.setState({indexState:INDEX_STATE.UNCREATED});}).catch(function(error){var errorMsg=Utils.getErrorMsg(error);toaster.danger(errorMsg);});};_this.setSettingsContainerRef=function(ref){_this.settingsContainer=ref;};_this.renderSwitch=function(){var indexState=_this.state.indexState;if(indexState===INDEX_STATE.RUNNING){return/*#__PURE__*/_jsx(Switch,{checked:true,placeholder:gettext('Turn on semantic search for this library'),className:\"position-absolute p-4 bg-white border rounded shadow-sm search-settings\",size:\"small\",textPosition:\"right\",disabled:true,setRef:_this.setSettingsContainerRef});}else if(indexState===INDEX_STATE.FINISHED){return/*#__PURE__*/_jsx(Switch,{checked:true,placeholder:gettext('Turn off semantic search for this library'),className:\"position-absolute p-4 bg-white border rounded shadow-sm search-settings\",size:\"small\",onChange:_this.onDeleteIndex,textPosition:\"right\",setRef:_this.setSettingsContainerRef});}else if(indexState===''||indexState===INDEX_STATE.UNCREATED){return/*#__PURE__*/_jsx(Switch,{checked:false,placeholder:gettext('Turn on semantic search for this library'),className:\"position-absolute p-4 bg-white border rounded shadow-sm search-settings\",size:\"small\",onChange:_this.onCreateIndex,textPosition:\"right\",setRef:_this.setSettingsContainerRef});}return null;};_this.renderSearchIcon=function(){var indexState=_this.state.indexState;if(indexState===INDEX_STATE.RUNNING||indexState===INDEX_STATE.FINISHED){return/*#__PURE__*/_jsx(Icon,{symbol:\"AI-search\",className:\"input-icon-addon\"});}else{return/*#__PURE__*/_jsx(Icon,{symbol:\"search\",className:\"input-icon-addon\"});}};_this.toggleSettingsShown=function(){_this.setState({isSettingsShown:!_this.state.isSettingsShown});};_this.handleOutsideClick=function(e){var isSettingsShown=_this.state.isSettingsShown;if(isSettingsShown&&!_this.settingsContainer.contains(e.target)&&!_this.settingIcon.contains(e.target)){_this.toggleSettingsShown();}};_this.baseSearchPageURL=\"\".concat(siteRoot,\"search/\");_this.state={width:'default',value:'',resultItems:[],highlightIndex:0,page:0,isLoading:false,hasMore:true,isMaskShow:false,showRecent:true,isResultGetted:false,isCloseShow:false,isSettingsShown:false,isSearchInputShow:false,// for mobile\nsearchPageUrl:_this.baseSearchPageURL,indexState:'',searchMode:SEARCH_MODE.COMBINED};_this.inputValue='';_this.highlightRef=null;_this.source=null;// used to cancel request;\n_this.inputRef=/*#__PURE__*/React.createRef();_this.searchContainer=/*#__PURE__*/React.createRef();_this.searchResultListRef=/*#__PURE__*/React.createRef();_this.indexStateTimer=null;_this.timer=null;_this.isChineseInput=false;_this.isRepoOwner=props.currentRepoInfo.owner_email===username;_this.isAdmin=props.currentRepoInfo.is_admin;return _this;}_createClass(AISearch,[{key:\"componentDidMount\",value:function componentDidMount(){document.addEventListener('keydown',this.onDocumentKeydown);document.addEventListener('compositionstart',this.onCompositionStart);document.addEventListener('compositionend',this.onCompositionEnd);document.addEventListener('click',this.handleOutsideClick);this.queryLibraryIndexState();}},{key:\"queryLibraryIndexState\",value:function queryLibraryIndexState(){var _this2=this;seafileAPI.queryLibraryIndexState(this.props.repoID).then(function(res){var _res$data=res.data,indexState=_res$data.state,taskId=_res$data.task_id;_this2.setState({indexState:indexState},function(){if(indexState===INDEX_STATE.RUNNING){_this2.queryIndexTaskStatus(taskId);}});}).catch(function(error){_this2.setState({indexState:INDEX_STATE.UNCREATED});});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){document.removeEventListener('keydown',this.onDocumentKeydown);document.removeEventListener('compositionstart',this.onCompositionStart);document.removeEventListener('compositionend',this.onCompositionEnd);document.removeEventListener('click',this.handleOutsideClick);this.isChineseInput=false;this.clearTimer();if(this.indexStateTimer){clearInterval(this.indexStateTimer);this.indexStateTimer=null;}}},{key:\"updateSearchPageURL\",value:function updateSearchPageURL(queryData){var params='';for(var key in queryData){params+=key+'='+encodeURIComponent(queryData[key])+'&';}this.setState({searchPageUrl:\"\".concat(this.baseSearchPageURL,\"?\").concat(params.substring(0,params.length-1))});}},{key:\"formatResultItems\",value:function formatResultItems(data){var items=[];for(var i=0;i<data.length;i++){items[i]={};var name=data[i].is_dir?data[i].name:data[i].fullpath.split('/').pop();items[i]['index']=[i];items[i]['name']=name;items[i]['path']=data[i].fullpath;items[i]['repo_id']=data[i].repo_id;items[i]['repo_name']=data[i].repo_name;items[i]['is_dir']=data[i].is_dir;items[i]['content']=data[i].content;items[i]['link_content']=decodeURI(data[i].fullpath).substring(1);}return items;}},{key:\"resetToDefault\",value:function resetToDefault(){this.inputValue='';this.setState({width:'',value:'',isMaskShow:false,isCloseShow:false,isSettingsShown:false,isResultGetted:false,resultItems:[],highlightIndex:0,isSearchInputShow:false,showRecent:true});}},{key:\"renderSearchResult\",value:function renderSearchResult(){var _this3=this;var _this$state2=this.state,resultItems=_this$state2.resultItems,highlightIndex=_this$state2.highlightIndex,width=_this$state2.width,isResultGetted=_this$state2.isResultGetted;if(!width||width==='default')return null;if(this.state.showRecent){var repoID=this.props.repoID;var storeKey='sfVisitedAISearchItems';if(repoID){storeKey+=repoID;}var visitedItems=JSON.parse(localStorage.getItem(storeKey))||[];if(visitedItems.length){return this.renderVisitedItems(visitedItems);}}var searchStrLength=getValueLength(this.inputValue);if(searchStrLength===0){return/*#__PURE__*/_jsx(\"div\",{className:\"search-result-none\",children:gettext('Type characters to start search')});}else if(searchStrLength<3){return/*#__PURE__*/_jsx(\"div\",{className:\"search-result-none\",children:gettext('Type more characters to start search')});}else if(!isResultGetted){return/*#__PURE__*/_jsx(\"span\",{className:\"loading-icon loading-tip\"});}else if(!resultItems.length){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"li\",{className:\"search-result-item align-items-center\",onClick:this.openAsk,children:[/*#__PURE__*/_jsx(AISearchRobot,{}),/*#__PURE__*/_jsx(\"div\",{className:\"item-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"item-name ellipsis\",children:[gettext('Ask AI'),': ',this.state.value.trim()]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"search-result-none\",children:gettext('No results matching')})]});}var results=/*#__PURE__*/_jsxs(\"ul\",{className:\"search-result-list\",ref:this.searchResultListRef,children:[/*#__PURE__*/_jsxs(\"li\",{className:classnames('search-result-item align-items-center py-3',{'search-result-item-highlight':highlightIndex===0}),onClick:this.openAsk,children:[/*#__PURE__*/_jsx(AISearchRobot,{style:{width:36}}),/*#__PURE__*/_jsx(\"div\",{className:\"item-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"item-name ellipsis\",children:[gettext('Ask AI'),': ',this.state.value.trim()]})})]}),resultItems.map(function(item,index){var isHighlight=index+1===highlightIndex;return/*#__PURE__*/_jsx(SearchResultItem,{item:item,onItemClickHandler:_this3.onItemClickHandler,isHighlight:isHighlight,setRef:isHighlight?function(ref){_this3.highlightRef=ref;}:function(){}},index);})]});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(MediaQuery,{query:\"(min-width: 768px)\",children:/*#__PURE__*/_jsx(\"div\",{className:\"search-result-list-container\",children:results})}),/*#__PURE__*/_jsx(MediaQuery,{query:\"(max-width: 767.8px)\",children:results})]});}},{key:\"render\",value:function render(){var _this4=this;var width=this.state.width!=='default'?this.state.width:'';var style={'width':width};var _this$state3=this.state,isMaskShow=_this$state3.isMaskShow,searchMode=_this$state3.searchMode;var placeholder=\"\".concat(this.props.placeholder).concat(isMaskShow?'':\" (\".concat(controlKey,\" + f )\"));if(searchMode===SEARCH_MODE.QA){return/*#__PURE__*/_jsx(AISearchAsk,{token:this.source?this.source.token:null,indexState:this.state.indexState,repoID:this.props.repoID,value:this.state.value.trim(),closeAsk:this.closeAsk,onItemClickHandler:this.onItemClickHandler});}return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(MediaQuery,{query:\"(min-width: 768px)\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"search\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-mask \".concat(isMaskShow?'show':'hide'),onClick:this.onCloseHandler}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-container \".concat(isMaskShow?'show':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-icon \".concat(isMaskShow?'mb-1':''),children:[this.renderSearchIcon(),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control search-input\",name:\"query\",placeholder:placeholder,style:style,value:this.state.value,onFocus:this.onFocusHandler,onChange:this.onChangeHandler,autoComplete:\"off\",ref:this.inputRef,onKeyDown:this.onKeydownHandler}),this.state.isCloseShow&&/*#__PURE__*/_jsxs(_Fragment,{children:[(this.isRepoOwner||this.isAdmin)&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"search-icon-right input-icon-addon sf3-font-set-up sf3-font border-0 bg-transparent mr-3\",onClick:this.toggleSettingsShown,\"aria-label\":gettext('Settings'),ref:function ref(_ref){return _this4.settingIcon=_ref;}}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"search-icon-right input-icon-addon fas fa-times border-0 bg-transparent mr-4\",onClick:this.onCloseHandler,\"aria-label\":gettext('Close')})]})]}),this.state.isSettingsShown&&this.renderSwitch(),/*#__PURE__*/_jsx(\"div\",{className:\"search-result-container dropdown-search-result-container\",onScroll:this.onResultListScroll,ref:this.searchContainer,children:this.renderSearchResult()})]})]})}),/*#__PURE__*/_jsxs(MediaQuery,{query:\"(max-width: 767.8px)\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-icon-container\",onClick:this.onSearchToggle,children:this.renderSearchIcon()}),this.state.isSearchInputShow&&/*#__PURE__*/_jsxs(\"div\",{className:\"search\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-mask \".concat(isMaskShow?'':'hide'),onClick:this.onCloseHandler}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-icon\",children:[this.renderSearchIcon(),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control search-input\",name:\"query\",placeholder:placeholder,style:style,value:this.state.value,onFocus:this.onFocusHandler,onChange:this.onChangeHandler,autoComplete:\"off\"}),this.state.isCloseShow&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"search-icon-right input-icon-addon fas fa-times border-0 bg-transparent\",onClick:this.onCloseHandler,\"aria-label\":gettext('Close')})]}),/*#__PURE__*/_jsx(\"div\",{className:\"search-result-container dropdown-search-result-container\",onScroll:this.onResultListScroll,children:this.renderSearchResult()})]})]})]})]});}}]);return AISearch;}(Component);export{AISearch as default};","map":{"version":3,"names":["React","Component","Fragment","isHotkey","classnames","MediaQuery","seafileAPI","Icon","gettext","siteRoot","username","SearchResultItem","Utils","isMac","toaster","Switch","SEARCH_DELAY_TIME","getValueLength","AISearchAsk","AISearchRobot","jsx","_jsx","_Fragment","jsxs","_jsxs","INDEX_STATE","RUNNING","UNCREATED","FINISHED","SEARCH_MODE","QA","COMBINED","PER_PAGE","controlKey","AISearch","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","clearTimer","timer","clearTimeout","onCompositionStart","isChineseInput","onCompositionEnd","setTimeout","onSearch","onDocumentKeydown","e","preventDefault","onFocusHandler","inputRef","current","focus","blur","resetToDefault","onEnter","onUp","onDown","setState","width","isMaskShow","isCloseShow","onCloseHandler","stopPropagation","highlightIndex","state","highlightRef","_this$highlightRef$ge","getBoundingClientRect","top","height","searchContainer","scrollTop","_this$state","resultItems","length","_this$highlightRef$ge2","outerHeight","item","document","activeElement","onItemClickHandler","keepVisitedItem","onSearchedClick","targetItem","repoID","targetIndex","storeKey","items","JSON","parse","localStorage","getItem","i","len","_items$i","repo_id","path","targetRepoID","targetPath","undefined","splice","unshift","pop","setItem","stringify","onChangeHandler","event","showRecent","newValue","target","value","inputValue","trim","onKeydownHandler","isResultGetted","queryData","q","search_repo","search_ftypes","getSearchResult","source","cancel","getSource","sendRequest","token","cancelToken","page","updateSearchPageURL","onAiSearch","results","aiSearchFiles","then","res","concat","_toConsumableArray","formatResultItems","data","isLoading","hasMore","catch","error","console","log","onResultListScroll","listPadding","clientHeight","searchResultListRef","openAsk","searchMode","closeAsk","renderVisitedItems","children","className","ref","map","index","isHighlight","setRef","query","onSearchToggle","isSearchInputShow","queryIndexTaskStatus","taskId","indexStateTimer","setInterval","isFinished","is_finished","indexState","clearInterval","errorMsg","getErrorMsg","danger","onCreateIndex","createLibraryIndex","task_id","notify","onDeleteIndex","deleteLibraryIndex","setSettingsContainerRef","settingsContainer","renderSwitch","checked","placeholder","size","textPosition","disabled","onChange","renderSearchIcon","symbol","toggleSettingsShown","isSettingsShown","handleOutsideClick","contains","settingIcon","baseSearchPageURL","searchPageUrl","createRef","isRepoOwner","currentRepoInfo","owner_email","isAdmin","is_admin","_createClass","key","componentDidMount","addEventListener","queryLibraryIndexState","_this2","_res$data","componentWillUnmount","removeEventListener","params","encodeURIComponent","substring","name","is_dir","fullpath","split","repo_name","content","decodeURI","renderSearchResult","_this3","_this$state2","visitedItems","searchStrLength","onClick","style","render","_this4","_this$state3","type","onFocus","autoComplete","onKeyDown","onScroll","default"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/search/ai-search.js"],"sourcesContent":["import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport isHotkey from 'is-hotkey';\nimport classnames from 'classnames';\nimport MediaQuery from 'react-responsive';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport Icon from '../icon';\nimport { gettext, siteRoot, username } from '../../utils/constants';\nimport SearchResultItem from './search-result-item';\nimport { Utils } from '../../utils/utils';\nimport { isMac } from '../../utils/extra-attributes';\nimport toaster from '../toast';\nimport Switch from '../common/switch';\nimport { SEARCH_DELAY_TIME, getValueLength } from './constant';\nimport AISearchAsk from './ai-search-ask';\nimport AISearchRobot from './ai-search-widgets/ai-search-robot';\n\nconst INDEX_STATE = {\n  RUNNING: 'running',\n  UNCREATED: 'uncreated',\n  FINISHED: 'finished'\n};\n\nconst SEARCH_MODE = {\n  QA: 'question-answering',\n  COMBINED: 'combined-search',\n};\n\nconst PER_PAGE = 10;\nconst controlKey = isMac() ? '⌘' : 'Ctrl';\n\nexport default class AISearch extends Component {\n\n  static propTypes = {\n    repoID: PropTypes.string,\n    placeholder: PropTypes.string,\n    onSearchedClick: PropTypes.func.isRequired,\n    repoName: PropTypes.string,\n    currentRepoInfo: PropTypes.object,\n  };\n\n  constructor(props) {\n    super(props);\n    this.baseSearchPageURL = `${siteRoot}search/`;\n    this.state = {\n      width: 'default',\n      value: '',\n      resultItems: [],\n      highlightIndex: 0,\n      page: 0,\n      isLoading: false,\n      hasMore: true,\n      isMaskShow: false,\n      showRecent: true,\n      isResultGetted: false,\n      isCloseShow: false,\n      isSettingsShown: false,\n      isSearchInputShow: false, // for mobile\n      searchPageUrl: this.baseSearchPageURL,\n      indexState: '',\n      searchMode: SEARCH_MODE.COMBINED,\n    };\n    this.inputValue = '';\n    this.highlightRef = null;\n    this.source = null; // used to cancel request;\n    this.inputRef = React.createRef();\n    this.searchContainer = React.createRef();\n    this.searchResultListRef = React.createRef();\n    this.indexStateTimer = null;\n    this.timer = null;\n    this.isChineseInput = false;\n    this.isRepoOwner = props.currentRepoInfo.owner_email === username;\n    this.isAdmin = props.currentRepoInfo.is_admin;\n  }\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.onDocumentKeydown);\n    document.addEventListener('compositionstart', this.onCompositionStart);\n    document.addEventListener('compositionend', this.onCompositionEnd);\n    document.addEventListener('click', this.handleOutsideClick);\n    this.queryLibraryIndexState();\n  }\n\n  queryLibraryIndexState() {\n    seafileAPI.queryLibraryIndexState(this.props.repoID).then(res => {\n      const { state: indexState, task_id: taskId } = res.data;\n      this.setState({ indexState }, () => {\n        if (indexState === INDEX_STATE.RUNNING) {\n          this.queryIndexTaskStatus(taskId);\n        }\n      });\n    }).catch(error => {\n      this.setState({ indexState: INDEX_STATE.UNCREATED });\n    });\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.onDocumentKeydown);\n    document.removeEventListener('compositionstart', this.onCompositionStart);\n    document.removeEventListener('compositionend', this.onCompositionEnd);\n    document.removeEventListener('click', this.handleOutsideClick);\n    this.isChineseInput = false;\n    this.clearTimer();\n    if (this.indexStateTimer) {\n      clearInterval(this.indexStateTimer);\n      this.indexStateTimer = null;\n    }\n  }\n\n  clearTimer = () => {\n    if (this.timer) {\n      clearTimeout(this.timer);\n      this.timer = null;\n    }\n  };\n\n  onCompositionStart = () => {\n    this.isChineseInput = true;\n    this.clearTimer();\n  };\n\n  onCompositionEnd = () => {\n    this.isChineseInput = false;\n    // chrome：compositionstart -> onChange -> compositionend\n    // not chrome：compositionstart -> compositionend -> onChange\n    // The onChange event will setState and change input value, then setTimeout to initiate the search\n    this.clearTimer();\n    this.timer = setTimeout(() => {\n      this.onSearch();\n    }, SEARCH_DELAY_TIME);\n  };\n\n  onDocumentKeydown = (e) => {\n    if (isHotkey('mod+f')(e)) {\n      e.preventDefault();\n      this.onFocusHandler();\n      if (this.inputRef && this.inputRef.current) {\n        this.inputRef.current.focus();\n      }\n    } else if (isHotkey('esc', e)) {\n      e.preventDefault();\n      this.inputRef && this.inputRef.current && this.inputRef.current.blur();\n      this.resetToDefault();\n    } else if (isHotkey('enter', e)) {\n      this.onEnter(e);\n    } else if (isHotkey('up', e)) {\n      this.onUp(e);\n    } else if (isHotkey('down', e)) {\n      this.onDown(e);\n    }\n  };\n\n  onFocusHandler = () => {\n    this.setState({ width: '570px', isMaskShow: true, isCloseShow: true });\n  };\n\n  onCloseHandler = () => {\n    this.resetToDefault();\n  };\n\n  onUp = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const { highlightIndex } = this.state;\n    if (highlightIndex > 0) {\n      this.setState({ highlightIndex: highlightIndex - 1 }, () => {\n        if (this.highlightRef) {\n          const { top, height } = this.highlightRef.getBoundingClientRect();\n          if (top - height < 0) {\n            this.searchContainer.current.scrollTop -= height;\n          }\n        }\n      });\n    }\n  };\n\n  onDown = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const { highlightIndex, resultItems } = this.state;\n    if (highlightIndex < resultItems.length - 1) {\n      this.setState({ highlightIndex: highlightIndex + 1 }, () => {\n        if (this.highlightRef) {\n          const { top, height } = this.highlightRef.getBoundingClientRect();\n          const outerHeight = 300;\n          if (top > outerHeight) {\n            this.searchContainer.current.scrollTop += height;\n          }\n        }\n      });\n    }\n  };\n\n  onEnter = (e) => {\n    e.preventDefault();\n    let item = this.state.resultItems[this.state.highlightIndex];\n    if (item) {\n      if (document.activeElement) {\n        document.activeElement.blur();\n      }\n      this.onItemClickHandler(item);\n    }\n  };\n\n  onItemClickHandler = (item) => {\n    this.resetToDefault();\n    this.keepVisitedItem(item);\n    this.props.onSearchedClick(item);\n  };\n\n  keepVisitedItem = (targetItem) => {\n    const { repoID } = this.props;\n    let targetIndex;\n    let storeKey = 'sfVisitedAISearchItems';\n    if (repoID) {\n      storeKey += repoID;\n    }\n    const items = JSON.parse(localStorage.getItem(storeKey)) || [];\n    for (let i = 0, len = items.length; i < len; i++) {\n      const { repo_id, path } = items[i];\n      const { repo_id: targetRepoID, path: targetPath } = targetItem;\n      if (repo_id == targetRepoID && path == targetPath) {\n        targetIndex = i;\n        break;\n      }\n    }\n    if (targetIndex != undefined) {\n      items.splice(targetIndex, 1);\n    }\n    items.unshift(targetItem);\n    if (items.length > 50) { // keep 50 items at most\n      items.pop();\n    }\n    localStorage.setItem(storeKey, JSON.stringify(items));\n  };\n\n  onChangeHandler = (event) => {\n    if (this.state.showRecent) {\n      this.setState({ showRecent: false });\n    }\n    const newValue = event.target.value;\n    this.setState({ value: newValue }, () => {\n      if (this.inputValue === newValue.trim()) return;\n      this.inputValue = newValue.trim();\n      if (!this.isChineseInput) {\n        this.clearTimer();\n        this.timer = setTimeout(() => {\n          this.onSearch();\n        }, SEARCH_DELAY_TIME);\n      }\n    });\n  };\n\n  onKeydownHandler = (event) => {\n    if (isHotkey('enter', event)) {\n      this.onSearch();\n    }\n  };\n\n  onSearch = () => {\n    const { value } = this.state;\n    const { repoID } = this.props;\n    if (this.inputValue === '' || getValueLength(this.inputValue) < 3) {\n      this.setState({\n        highlightIndex: 0,\n        resultItems: [],\n        isResultGetted: false\n      });\n      return;\n    }\n    const queryData = {\n      q: value,\n      search_repo: repoID ? repoID : 'all',\n      search_ftypes: 'all',\n    };\n    this.getSearchResult(queryData);\n  };\n\n  getSearchResult = (queryData) => {\n    if (this.source) {\n      this.source.cancel('prev request is cancelled');\n    }\n    this.setState({\n      isResultGetted: false,\n      resultItems: [],\n      highlightIndex: 0,\n    });\n    this.source = seafileAPI.getSource();\n    this.sendRequest(queryData, this.source.token, 1);\n  };\n\n  sendRequest = (queryData, cancelToken, page) => {\n    this.queryData = queryData;\n    this.updateSearchPageURL(queryData);\n    queryData['per_page'] = PER_PAGE;\n    queryData['page'] = page;\n    this.onAiSearch(queryData, cancelToken, page);\n  };\n\n  onAiSearch = (queryData, cancelToken, page) => {\n    let results = [];\n    seafileAPI.aiSearchFiles(queryData, cancelToken).then(res => {\n      results = [...results, ...this.formatResultItems(res.data.results)];\n      this.setState({\n        resultItems: results,\n        isResultGetted: true,\n        isLoading: false,\n        page: page + 1,\n        hasMore: false,\n      });\n    }).catch(error => {\n      /* eslint-disable */\n      console.log(error);\n      this.setState({ isLoading: false });\n    });\n  };\n\n  onResultListScroll = (e) => {\n    // Load less than 100 results\n    if (!this.state.hasMore || this.state.isLoading || this.state.resultItems.length > 100) {\n      return;\n    }\n    const listPadding = 20;\n    if (e.target.scrollTop + e.target.clientHeight + listPadding > this.searchResultListRef.current.clientHeight - 10) {\n      this.setState({isLoading: true}, () => {\n        this.source = seafileAPI.getSource();\n        this.sendRequest(this.queryData, this.source.token, this.state.page);\n      });\n    }\n  };\n\n  updateSearchPageURL(queryData) {\n    let params = '';\n    for (let key in queryData) {\n      params += key + '=' + encodeURIComponent(queryData[key]) + '&';\n    }\n    this.setState({searchPageUrl: `${this.baseSearchPageURL}?${params.substring(0, params.length - 1)}`});\n  }\n\n  formatResultItems(data) {\n    let items = [];\n    for (let i = 0; i < data.length; i++) {\n      items[i] = {};\n      let name = data[i].is_dir ? data[i].name : data[i].fullpath.split('/').pop();\n      items[i]['index'] = [i];\n      items[i]['name'] = name;\n      items[i]['path'] = data[i].fullpath;\n      items[i]['repo_id'] = data[i].repo_id;\n      items[i]['repo_name'] = data[i].repo_name;\n      items[i]['is_dir'] = data[i].is_dir;\n      items[i]['content'] = data[i].content;\n      items[i]['link_content'] = decodeURI(data[i].fullpath).substring(1);\n    }\n    return items;\n  }\n\n  resetToDefault() {\n    this.inputValue = '';\n    this.setState({\n      width: '',\n      value: '',\n      isMaskShow: false,\n      isCloseShow: false,\n      isSettingsShown: false,\n      isResultGetted: false,\n      resultItems: [],\n      highlightIndex: 0,\n      isSearchInputShow: false,\n      showRecent: true,\n    });\n  }\n\n  openAsk = () => {\n    this.clearTimer();\n    this.setState({ searchMode: SEARCH_MODE.QA });\n  }\n\n  closeAsk = () => {\n    this.clearTimer();\n    this.setState({ searchMode: SEARCH_MODE.COMBINED });\n  }\n\n  renderVisitedItems = (items) => {\n    const { highlightIndex } = this.state;\n    const results = (\n      <>\n        <h4 className=\"visited-search-results-title\">{gettext('Search results visited recently')}</h4>\n        <ul className=\"search-result-list\" ref={this.searchResultListRef}>\n          {items.map((item, index) => {\n            const isHighlight = index === highlightIndex;\n            return (\n              <SearchResultItem\n              key={index}\n              item={item}\n              onItemClickHandler={this.onItemClickHandler}\n              isHighlight={isHighlight}\n              setRef={isHighlight ? (ref) => {this.highlightRef = ref;} : () => {}}\n              />\n            );\n          })}\n        </ul>\n      </>\n    );\n\n    return (\n      <>\n        <MediaQuery query=\"(min-width: 768px)\">\n          <div className=\"search-result-list-container\">{results}</div>\n        </MediaQuery>\n        <MediaQuery query=\"(max-width: 767.8px)\">\n          {results}\n        </MediaQuery>\n      </>\n    );\n  }\n\n  renderSearchResult() {\n    const { resultItems, highlightIndex, width, isResultGetted } = this.state;\n    if (!width || width === 'default') return null;\n\n    if (this.state.showRecent) {\n      const { repoID } = this.props;\n      let storeKey = 'sfVisitedAISearchItems';\n      if (repoID) {\n        storeKey += repoID;\n      }\n      const visitedItems = JSON.parse(localStorage.getItem(storeKey)) || [];\n      if (visitedItems.length) {\n        return this.renderVisitedItems(visitedItems);\n      }\n    }\n\n    const searchStrLength = getValueLength(this.inputValue);\n\n    if (searchStrLength === 0) {\n      return <div className=\"search-result-none\">{gettext('Type characters to start search')}</div>;\n    }\n    else if (searchStrLength < 3) {\n      return <div className=\"search-result-none\">{gettext('Type more characters to start search')}</div>;\n    }\n    else if (!isResultGetted) {\n      return <span className=\"loading-icon loading-tip\"></span>;\n    }\n    else if (!resultItems.length) {\n      return (\n        <>\n          <li className='search-result-item align-items-center' onClick={this.openAsk}>\n            <AISearchRobot />\n            <div className=\"item-content\">\n              <div className=\"item-name ellipsis\">{gettext('Ask AI')}{': '}{this.state.value.trim()}</div>\n            </div>\n          </li>\n          <div className=\"search-result-none\">{gettext('No results matching')}</div>\n        </>\n      );\n    }\n\n    const results = (\n      <ul className=\"search-result-list\" ref={this.searchResultListRef}>\n        <li\n          className={classnames('search-result-item align-items-center py-3', {'search-result-item-highlight': highlightIndex === 0 })}\n          onClick={this.openAsk}\n        >\n          <AISearchRobot style={{width: 36}}/>\n          <div className=\"item-content\">\n            <div className=\"item-name ellipsis\">\n            {gettext('Ask AI')}{': '}{this.state.value.trim()}\n            </div>\n          </div>\n        </li>\n        {resultItems.map((item, index) => {\n          const isHighlight = (index + 1) === highlightIndex;\n          return (\n            <SearchResultItem\n              key={index}\n              item={item}\n              onItemClickHandler={this.onItemClickHandler}\n              isHighlight={isHighlight}\n              setRef={isHighlight ? (ref) => {this.highlightRef = ref;} : () => {}}\n            />\n          );\n        })}\n      </ul>\n    );\n\n    return (\n      <>\n        <MediaQuery query=\"(min-width: 768px)\">\n          <div className=\"search-result-list-container\">{results}</div>\n        </MediaQuery>\n        <MediaQuery query=\"(max-width: 767.8px)\">\n          {results}\n        </MediaQuery>\n      </>\n    );\n  }\n\n  onSearchToggle = () => {\n    this.setState({\n      isSearchInputShow: !this.state.isSearchInputShow,\n      isMaskShow: !this.state.isMaskShow,\n    });\n  };\n\n  queryIndexTaskStatus = (taskId) => {\n    if (!taskId) return;\n    this.indexStateTimer = setInterval(() => {\n      seafileAPI.queryIndexTaskStatus(taskId).then(res => {\n        const isFinished = res.data.is_finished;\n        if (isFinished) {\n          this.setState({ indexState: INDEX_STATE.FINISHED });\n          this.indexStateTimer && clearInterval(this.indexStateTimer);\n          this.indexStateTimer = null;\n        }\n      }).catch(error => {\n        this.indexStateTimer && clearInterval(this.indexStateTimer);\n        this.indexStateTimer = null;\n        const errorMsg = Utils.getErrorMsg(error);\n        toaster.danger(errorMsg);\n        this.setState({ indexState: INDEX_STATE.UNCREATED });\n      });\n    }, 3000);\n  };\n\n  onCreateIndex = () => {\n    this.setState({ indexState: INDEX_STATE.RUNNING });\n    seafileAPI.createLibraryIndex(this.props.repoID).then(res => {\n      const taskId = res.data.task_id;\n      toaster.notify(gettext('Indexing the library. Semantic search will be available within a few minutes.'));\n      this.queryIndexTaskStatus(taskId);\n    }).catch(error => {\n      const errorMsg = Utils.getErrorMsg(error);\n      toaster.danger(errorMsg);\n      this.setState({ indexState: INDEX_STATE.UNCREATED });\n    });\n  };\n\n  onDeleteIndex = () => {\n    seafileAPI.deleteLibraryIndex(this.props.repoID).then(res => {\n      toaster.notify(gettext('Successfully turned it off'));\n      this.setState({ indexState: INDEX_STATE.UNCREATED });\n    }).catch(error => {\n      const errorMsg = Utils.getErrorMsg(error);\n      toaster.danger(errorMsg);\n    });\n  };\n\n  setSettingsContainerRef = (ref) => {\n    this.settingsContainer = ref;\n  }\n\n  renderSwitch = () => {\n    const { indexState } = this.state;\n    if (indexState === INDEX_STATE.RUNNING) {\n      return (\n        <Switch\n          checked={true}\n          placeholder={gettext('Turn on semantic search for this library')}\n          className=\"position-absolute p-4 bg-white border rounded shadow-sm search-settings\"\n          size=\"small\"\n          textPosition='right'\n          disabled={true}\n          setRef={this.setSettingsContainerRef}\n        />\n      );\n    } else if (indexState === INDEX_STATE.FINISHED) {\n      return (\n        <Switch\n          checked={true}\n          placeholder={gettext('Turn off semantic search for this library')}\n          className=\"position-absolute p-4 bg-white border rounded shadow-sm search-settings\"\n          size=\"small\"\n          onChange={this.onDeleteIndex}\n          textPosition='right'\n          setRef={this.setSettingsContainerRef}\n        />\n      );\n    } else if (indexState === '' || indexState === INDEX_STATE.UNCREATED) {\n      return (\n        <Switch\n          checked={false}\n          placeholder={gettext('Turn on semantic search for this library')}\n          className=\"position-absolute p-4 bg-white border rounded shadow-sm search-settings\"\n          size=\"small\"\n          onChange={this.onCreateIndex}\n          textPosition='right'\n          setRef={this.setSettingsContainerRef}\n        />\n      );\n    }\n    return null;\n  }\n\n  renderSearchIcon = () => {\n    const { indexState } = this.state;\n    if (indexState === INDEX_STATE.RUNNING || indexState === INDEX_STATE.FINISHED) {\n      return <Icon symbol='AI-search' className='input-icon-addon' />;\n    } else {\n      return <Icon symbol='search' className='input-icon-addon' />;\n    }\n  }\n\n  toggleSettingsShown = () => {\n    this.setState({\n      isSettingsShown: !this.state.isSettingsShown\n    });\n  }\n\n  handleOutsideClick = (e) => {\n    const { isSettingsShown } = this.state;\n    if (isSettingsShown &&\n      !this.settingsContainer.contains(e.target) &&\n      !this.settingIcon.contains(e.target)) {\n      this.toggleSettingsShown();\n    }\n  };\n\n  render() {\n    let width = this.state.width !== 'default' ? this.state.width : '';\n    let style = {'width': width};\n    const { isMaskShow, searchMode } = this.state;\n    const placeholder = `${this.props.placeholder}${isMaskShow ? '' : ` (${controlKey} + f )`}`;\n\n    if (searchMode === SEARCH_MODE.QA) {\n      return (\n        <AISearchAsk\n          token={this.source ? this.source.token : null}\n          indexState={this.state.indexState}\n          repoID={this.props.repoID}\n          value={this.state.value.trim()}\n          closeAsk={this.closeAsk}\n          onItemClickHandler={this.onItemClickHandler}\n        />\n      );\n    }\n\n    return (\n      <Fragment>\n        <MediaQuery query=\"(min-width: 768px)\">\n          <div className=\"search\">\n            <div className={`search-mask ${isMaskShow ? 'show' : 'hide'}`} onClick={this.onCloseHandler}></div>\n            <div className={`search-container ${isMaskShow ? 'show' : ''}`}>\n              <div className={`input-icon ${isMaskShow ? 'mb-1' : ''}`}>\n                {this.renderSearchIcon()}\n                <input\n                  type=\"text\"\n                  className=\"form-control search-input\"\n                  name=\"query\"\n                  placeholder={placeholder}\n                  style={style}\n                  value={this.state.value}\n                  onFocus={this.onFocusHandler}\n                  onChange={this.onChangeHandler}\n                  autoComplete=\"off\"\n                  ref={this.inputRef}\n                  onKeyDown={this.onKeydownHandler}\n                />\n                {this.state.isCloseShow &&\n                  <>\n                  {(this.isRepoOwner || this.isAdmin) &&\n                    <button type=\"button\" className=\"search-icon-right input-icon-addon sf3-font-set-up sf3-font border-0 bg-transparent mr-3\" onClick={this.toggleSettingsShown} aria-label={gettext('Settings')} ref={ref => this.settingIcon = ref}></button>\n                  }\n                  <button type=\"button\" className=\"search-icon-right input-icon-addon fas fa-times border-0 bg-transparent mr-4\" onClick={this.onCloseHandler} aria-label={gettext('Close')}></button>\n                  </>\n                }\n              </div>\n              {this.state.isSettingsShown && this.renderSwitch()}\n              <div\n                className=\"search-result-container dropdown-search-result-container\"\n                onScroll={this.onResultListScroll}\n                ref={this.searchContainer}\n              >\n                {this.renderSearchResult()}\n              </div>\n            </div>\n          </div>\n        </MediaQuery>\n        <MediaQuery query=\"(max-width: 767.8px)\">\n          <div className=\"search-icon-container\" onClick={this.onSearchToggle}>\n            {this.renderSearchIcon()}\n          </div>\n          {this.state.isSearchInputShow &&\n            <div className=\"search\">\n              <div className={`search-mask ${isMaskShow ? '' : 'hide'}`} onClick={this.onCloseHandler}></div>\n              <div className=\"search-container\">\n                <div className=\"input-icon\">\n                  {this.renderSearchIcon()}\n                  <input\n                    type=\"text\"\n                    className=\"form-control search-input\"\n                    name=\"query\"\n                    placeholder={placeholder}\n                    style={style}\n                    value={this.state.value}\n                    onFocus={this.onFocusHandler}\n                    onChange={this.onChangeHandler}\n                    autoComplete=\"off\"\n                  />\n                  {this.state.isCloseShow &&\n                    <button type=\"button\" className=\"search-icon-right input-icon-addon fas fa-times border-0 bg-transparent\" onClick={this.onCloseHandler} aria-label={gettext('Close')}></button>\n                  }\n                </div>\n                <div className=\"search-result-container dropdown-search-result-container\" onScroll={this.onResultListScroll}>\n                  {this.renderSearchResult()}\n                </div>\n              </div>\n            </div>\n          }\n        </MediaQuery>\n      </Fragment>\n    );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}