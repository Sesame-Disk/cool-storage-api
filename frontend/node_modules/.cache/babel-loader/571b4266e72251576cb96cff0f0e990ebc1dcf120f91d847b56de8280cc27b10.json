{"ast":null,"code":"import _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useEffect, useState } from 'react';\nimport context from '../../context';\nimport { getDiff } from '../utils/diff';\nimport SDocViewer from './sdoc-viewer';\nimport Loading from '../../components/loading';\nimport '../../assets/css/diff-viewer.css';\nvar PublishedRevisionDiffViewer = function PublishedRevisionDiffViewer(_ref) {\n  var isShowChanges = _ref.isShowChanges,\n    revisionContent = _ref.revisionContent,\n    didMountCallback = _ref.didMountCallback;\n  var _useState = useState(true),\n    _useState2 = _slicedToArray(_useState, 2),\n    isLoading = _useState2[0],\n    setIsLoading = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    diff = _useState4[0],\n    setDiff = _useState4[1];\n  useEffect(function () {\n    setIsLoading(true);\n    if (isShowChanges) {\n      if (diff) {\n        didMountCallback && didMountCallback(diff);\n        setTimeout(function () {\n          setIsLoading(false);\n        }, 1);\n        return;\n      }\n      context.getRevisionBaseVersionContent().then(function (res) {\n        var baseContentString = res.data.content;\n        var baseContent = JSON.parse(baseContentString);\n        var diff = getDiff(revisionContent, baseContent);\n        setDiff(diff);\n        didMountCallback && didMountCallback(diff);\n        setIsLoading(false);\n      }).catch(function (error) {\n        console.log('error');\n        setIsLoading(false);\n      });\n      return;\n    }\n    setTimeout(function () {\n      setIsLoading(false);\n    }, 1);\n  }, [revisionContent, didMountCallback, isShowChanges, diff]);\n  if (isLoading) {\n    return /*#__PURE__*/React.createElement(Loading, null);\n  }\n  var document = {\n    children: isShowChanges && (diff === null || diff === void 0 ? void 0 : diff.value) || revisionContent.children\n  };\n  return /*#__PURE__*/React.createElement(SDocViewer, {\n    document: document,\n    showToolbar: true,\n    showOutline: true,\n    showComment: false\n  });\n};\nexport default PublishedRevisionDiffViewer;","map":{"version":3,"names":["React","useEffect","useState","context","getDiff","SDocViewer","Loading","PublishedRevisionDiffViewer","_ref","isShowChanges","revisionContent","didMountCallback","_useState","_useState2","_slicedToArray","isLoading","setIsLoading","_useState3","_useState4","diff","setDiff","setTimeout","getRevisionBaseVersionContent","then","res","baseContentString","data","content","baseContent","JSON","parse","catch","error","console","log","createElement","document","children","value","showToolbar","showOutline","showComment"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/views/published-revision-diff-viewer.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport context from '../../context';\nimport { getDiff } from '../utils/diff';\nimport SDocViewer from './sdoc-viewer';\nimport Loading from '../../components/loading';\nimport '../../assets/css/diff-viewer.css';\nconst PublishedRevisionDiffViewer = _ref => {\n  let {\n    isShowChanges,\n    revisionContent,\n    didMountCallback\n  } = _ref;\n  const [isLoading, setIsLoading] = useState(true);\n  const [diff, setDiff] = useState(null);\n  useEffect(() => {\n    setIsLoading(true);\n    if (isShowChanges) {\n      if (diff) {\n        didMountCallback && didMountCallback(diff);\n        setTimeout(() => {\n          setIsLoading(false);\n        }, 1);\n        return;\n      }\n      context.getRevisionBaseVersionContent().then(res => {\n        const {\n          content: baseContentString\n        } = res.data;\n        const baseContent = JSON.parse(baseContentString);\n        const diff = getDiff(revisionContent, baseContent);\n        setDiff(diff);\n        didMountCallback && didMountCallback(diff);\n        setIsLoading(false);\n      }).catch(error => {\n        console.log('error');\n        setIsLoading(false);\n      });\n      return;\n    }\n    setTimeout(() => {\n      setIsLoading(false);\n    }, 1);\n  }, [revisionContent, didMountCallback, isShowChanges, diff]);\n  if (isLoading) {\n    return /*#__PURE__*/React.createElement(Loading, null);\n  }\n  const document = {\n    children: isShowChanges && (diff === null || diff === void 0 ? void 0 : diff.value) || revisionContent.children\n  };\n  return /*#__PURE__*/React.createElement(SDocViewer, {\n    document: document,\n    showToolbar: true,\n    showOutline: true,\n    showComment: false\n  });\n};\nexport default PublishedRevisionDiffViewer;"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,OAAOC,OAAO,MAAM,eAAe;AACnC,SAASC,OAAO,QAAQ,eAAe;AACvC,OAAOC,UAAU,MAAM,eAAe;AACtC,OAAOC,OAAO,MAAM,0BAA0B;AAC9C,OAAO,kCAAkC;AACzC,IAAMC,2BAA2B,GAAG,SAA9BA,2BAA2BA,CAAGC,IAAI,EAAI;EAC1C,IACEC,aAAa,GAGXD,IAAI,CAHNC,aAAa;IACbC,eAAe,GAEbF,IAAI,CAFNE,eAAe;IACfC,gBAAgB,GACdH,IAAI,CADNG,gBAAgB;EAElB,IAAAC,SAAA,GAAkCV,QAAQ,CAAC,IAAI,CAAC;IAAAW,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAAzCG,SAAS,GAAAF,UAAA;IAAEG,YAAY,GAAAH,UAAA;EAC9B,IAAAI,UAAA,GAAwBf,QAAQ,CAAC,IAAI,CAAC;IAAAgB,UAAA,GAAAJ,cAAA,CAAAG,UAAA;IAA/BE,IAAI,GAAAD,UAAA;IAAEE,OAAO,GAAAF,UAAA;EACpBjB,SAAS,CAAC,YAAM;IACde,YAAY,CAAC,IAAI,CAAC;IAClB,IAAIP,aAAa,EAAE;MACjB,IAAIU,IAAI,EAAE;QACRR,gBAAgB,IAAIA,gBAAgB,CAACQ,IAAI,CAAC;QAC1CE,UAAU,CAAC,YAAM;UACfL,YAAY,CAAC,KAAK,CAAC;QACrB,CAAC,EAAE,CAAC,CAAC;QACL;MACF;MACAb,OAAO,CAACmB,6BAA6B,CAAC,CAAC,CAACC,IAAI,CAAC,UAAAC,GAAG,EAAI;QAClD,IACWC,iBAAiB,GACxBD,GAAG,CAACE,IAAI,CADVC,OAAO;QAET,IAAMC,WAAW,GAAGC,IAAI,CAACC,KAAK,CAACL,iBAAiB,CAAC;QACjD,IAAMN,IAAI,GAAGf,OAAO,CAACM,eAAe,EAAEkB,WAAW,CAAC;QAClDR,OAAO,CAACD,IAAI,CAAC;QACbR,gBAAgB,IAAIA,gBAAgB,CAACQ,IAAI,CAAC;QAC1CH,YAAY,CAAC,KAAK,CAAC;MACrB,CAAC,CAAC,CAACe,KAAK,CAAC,UAAAC,KAAK,EAAI;QAChBC,OAAO,CAACC,GAAG,CAAC,OAAO,CAAC;QACpBlB,YAAY,CAAC,KAAK,CAAC;MACrB,CAAC,CAAC;MACF;IACF;IACAK,UAAU,CAAC,YAAM;MACfL,YAAY,CAAC,KAAK,CAAC;IACrB,CAAC,EAAE,CAAC,CAAC;EACP,CAAC,EAAE,CAACN,eAAe,EAAEC,gBAAgB,EAAEF,aAAa,EAAEU,IAAI,CAAC,CAAC;EAC5D,IAAIJ,SAAS,EAAE;IACb,OAAO,aAAaf,KAAK,CAACmC,aAAa,CAAC7B,OAAO,EAAE,IAAI,CAAC;EACxD;EACA,IAAM8B,QAAQ,GAAG;IACfC,QAAQ,EAAE5B,aAAa,KAAKU,IAAI,KAAK,IAAI,IAAIA,IAAI,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,IAAI,CAACmB,KAAK,CAAC,IAAI5B,eAAe,CAAC2B;EACzG,CAAC;EACD,OAAO,aAAarC,KAAK,CAACmC,aAAa,CAAC9B,UAAU,EAAE;IAClD+B,QAAQ,EAAEA,QAAQ;IAClBG,WAAW,EAAE,IAAI;IACjBC,WAAW,EAAE,IAAI;IACjBC,WAAW,EAAE;EACf,CAAC,CAAC;AACJ,CAAC;AACD,eAAelC,2BAA2B"},"metadata":{},"sourceType":"module","externalDependencies":[]}