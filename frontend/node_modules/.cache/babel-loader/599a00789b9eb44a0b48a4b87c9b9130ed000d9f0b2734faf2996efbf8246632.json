{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _slugid = _interopRequireDefault(require(\"slugid\"));\nvar _typeOf = _interopRequireDefault(require(\"type-of\"));\nvar _constants = require(\"./constants\");\nvar _rules = _interopRequireDefault(require(\"./rules\"));\nvar _helper = require(\"./helper\");\nvar cruftNewline = function cruftNewline(element) {\n  return !(element.nodeName === '#text' && element.nodeValue === '\\n');\n};\nvar deserializeElement = function deserializeElement(element) {\n  var node;\n  var next = function next(elements) {\n    if (Object.prototype.toString.call(elements) === '[object NodeList]') {\n      elements = Array.from(elements);\n    }\n    switch ((0, _typeOf.default)(elements)) {\n      case 'array':\n        return deserializeElements(elements);\n      case 'object':\n        return deserializeElement(elements);\n      case 'null':\n      case 'undefined':\n        return;\n      default:\n        throw new Error(\"The `next` argument was called with invalid children: \\\"\".concat(elements, \"\\\".\"));\n    }\n  };\n  for (var i = 0; i < _rules.default.length; i++) {\n    var rule = _rules.default[i];\n    if (!rule) continue;\n    var ret = rule(element, next);\n    var type = (0, _typeOf.default)(ret);\n    if (type !== 'array' && type !== 'object' && type !== 'null' && type !== 'undefined') {\n      throw new Error(\"A rule returned an invalid deserialized representation: \\\"\".concat(node, \"\\\".\"));\n    }\n\n    // Not eligible for current component processing\n    if (ret === undefined) {\n      continue;\n    }\n\n    // Empty tags will be discarded and not converted accordingly\n    if (ret === null) {\n      return null;\n    }\n\n    // Assign the final processing result to node\n    node = ret;\n    break;\n  }\n\n  // If node is undefined, it means that the label is not processed, and continue to process the child nodes of the element\n  return node || next(element.childNodes);\n};\nvar deserializeElements = function deserializeElements() {\n  var elements = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var isTopLevel = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var nodes = [];\n  elements.filter(cruftNewline).forEach(function (element) {\n    var node = deserializeElement(element);\n    switch ((0, _typeOf.default)(node)) {\n      case 'array':\n        var formatNode = isTopLevel ? formatElementNodes(node) : node;\n        nodes = nodes.concat(formatNode);\n        break;\n      case 'object':\n        nodes.push(node);\n        break;\n      default:\n      // nothing todo\n    }\n  });\n\n  return (0, _helper.formatInlineNodes)(nodes);\n};\nvar formatElementNodes = function formatElementNodes(nodes) {\n  if (nodes.length === 0) {\n    return [{\n      id: _slugid.default.nice(),\n      type: _constants.PARAGRAPH,\n      children: [{\n        text: '',\n        id: _slugid.default.nice()\n      }]\n    }];\n  }\n  nodes = nodes.reduce(function (memo, node) {\n    if (_constants.TOP_LEVEL_TYPES.includes(node.type)) {\n      memo.push(node);\n    }\n    if (node.type === _constants.LIST_ITEM) {\n      var newNode = {\n        id: _slugid.default.nice(),\n        type: _constants.UNORDERED_LIST,\n        children: [node]\n      };\n      memo.push(newNode);\n      return memo;\n    }\n\n    // The following types will not appear individually during the pasting process\n    // code_line\n    // table_row | table_cell\n\n    // text | image | link\n    if (!node.type || _constants.INLINE_LEVEL_TYPES.includes(node.type)) {\n      var prevNode = memo[memo.length - 1];\n      if (prevNode && prevNode.type === _constants.PARAGRAPH) {\n        prevNode.children.push(node);\n        return memo;\n      }\n      var _newNode = {\n        id: _slugid.default.nice(),\n        type: _constants.PARAGRAPH,\n        children: [node]\n      };\n      memo.push(_newNode);\n      return memo;\n    }\n    return memo;\n  }, []);\n  return nodes;\n};\nvar deserializeHtml = function deserializeHtml(html) {\n  var parsed = new DOMParser().parseFromString(html, 'text/html');\n  var fragment = parsed.body;\n  var children = Array.from(fragment.childNodes);\n  var nodes = [];\n  nodes = deserializeElements(children, true);\n  nodes = formatElementNodes(nodes);\n  return nodes;\n};\nvar _default = exports.default = deserializeHtml;","map":{"version":3,"names":["_interopRequireDefault","require","default","Object","defineProperty","exports","value","_slugid","_typeOf","_constants","_rules","_helper","cruftNewline","element","nodeName","nodeValue","deserializeElement","node","next","elements","prototype","toString","call","Array","from","deserializeElements","Error","concat","i","length","rule","ret","type","undefined","childNodes","arguments","isTopLevel","nodes","filter","forEach","formatNode","formatElementNodes","push","formatInlineNodes","id","nice","PARAGRAPH","children","text","reduce","memo","TOP_LEVEL_TYPES","includes","LIST_ITEM","newNode","UNORDERED_LIST","INLINE_LEVEL_TYPES","prevNode","deserializeHtml","html","parsed","DOMParser","parseFromString","fragment","body","_default"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/seafile-editor/dist/slate-convert/html-to-slate/index.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _slugid = _interopRequireDefault(require(\"slugid\"));\nvar _typeOf = _interopRequireDefault(require(\"type-of\"));\nvar _constants = require(\"./constants\");\nvar _rules = _interopRequireDefault(require(\"./rules\"));\nvar _helper = require(\"./helper\");\nconst cruftNewline = element => {\n  return !(element.nodeName === '#text' && element.nodeValue === '\\n');\n};\nconst deserializeElement = element => {\n  let node;\n  const next = elements => {\n    if (Object.prototype.toString.call(elements) === '[object NodeList]') {\n      elements = Array.from(elements);\n    }\n    switch ((0, _typeOf.default)(elements)) {\n      case 'array':\n        return deserializeElements(elements);\n      case 'object':\n        return deserializeElement(elements);\n      case 'null':\n      case 'undefined':\n        return;\n      default:\n        throw new Error(\"The `next` argument was called with invalid children: \\\"\".concat(elements, \"\\\".\"));\n    }\n  };\n  for (let i = 0; i < _rules.default.length; i++) {\n    const rule = _rules.default[i];\n    if (!rule) continue;\n    const ret = rule(element, next);\n    const type = (0, _typeOf.default)(ret);\n    if (type !== 'array' && type !== 'object' && type !== 'null' && type !== 'undefined') {\n      throw new Error(\"A rule returned an invalid deserialized representation: \\\"\".concat(node, \"\\\".\"));\n    }\n\n    // Not eligible for current component processing\n    if (ret === undefined) {\n      continue;\n    }\n\n    // Empty tags will be discarded and not converted accordingly\n    if (ret === null) {\n      return null;\n    }\n\n    // Assign the final processing result to node\n    node = ret;\n    break;\n  }\n\n  // If node is undefined, it means that the label is not processed, and continue to process the child nodes of the element\n  return node || next(element.childNodes);\n};\nconst deserializeElements = function () {\n  let elements = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  let isTopLevel = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  let nodes = [];\n  elements.filter(cruftNewline).forEach(element => {\n    const node = deserializeElement(element);\n    switch ((0, _typeOf.default)(node)) {\n      case 'array':\n        const formatNode = isTopLevel ? formatElementNodes(node) : node;\n        nodes = nodes.concat(formatNode);\n        break;\n      case 'object':\n        nodes.push(node);\n        break;\n      default:\n      // nothing todo\n    }\n  });\n  return (0, _helper.formatInlineNodes)(nodes);\n};\nconst formatElementNodes = nodes => {\n  if (nodes.length === 0) {\n    return [{\n      id: _slugid.default.nice(),\n      type: _constants.PARAGRAPH,\n      children: [{\n        text: '',\n        id: _slugid.default.nice()\n      }]\n    }];\n  }\n  nodes = nodes.reduce((memo, node) => {\n    if (_constants.TOP_LEVEL_TYPES.includes(node.type)) {\n      memo.push(node);\n    }\n    if (node.type === _constants.LIST_ITEM) {\n      const newNode = {\n        id: _slugid.default.nice(),\n        type: _constants.UNORDERED_LIST,\n        children: [node]\n      };\n      memo.push(newNode);\n      return memo;\n    }\n\n    // The following types will not appear individually during the pasting process\n    // code_line\n    // table_row | table_cell\n\n    // text | image | link\n    if (!node.type || _constants.INLINE_LEVEL_TYPES.includes(node.type)) {\n      let prevNode = memo[memo.length - 1];\n      if (prevNode && prevNode.type === _constants.PARAGRAPH) {\n        prevNode.children.push(node);\n        return memo;\n      }\n      const newNode = {\n        id: _slugid.default.nice(),\n        type: _constants.PARAGRAPH,\n        children: [node]\n      };\n      memo.push(newNode);\n      return memo;\n    }\n    return memo;\n  }, []);\n  return nodes;\n};\nconst deserializeHtml = html => {\n  const parsed = new DOMParser().parseFromString(html, 'text/html');\n  const fragment = parsed.body;\n  const children = Array.from(fragment.childNodes);\n  let nodes = [];\n  nodes = deserializeElements(children, true);\n  nodes = formatElementNodes(nodes);\n  return nodes;\n};\nvar _default = exports.default = deserializeHtml;"],"mappings":"AAAA,YAAY;;AAEZ,IAAIA,sBAAsB,GAAGC,OAAO,CAAC,8CAA8C,CAAC,CAACC,OAAO;AAC5FC,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAC3CC,KAAK,EAAE;AACT,CAAC,CAAC;AACFD,OAAO,CAACH,OAAO,GAAG,KAAK,CAAC;AACxB,IAAIK,OAAO,GAAGP,sBAAsB,CAACC,OAAO,CAAC,QAAQ,CAAC,CAAC;AACvD,IAAIO,OAAO,GAAGR,sBAAsB,CAACC,OAAO,CAAC,SAAS,CAAC,CAAC;AACxD,IAAIQ,UAAU,GAAGR,OAAO,CAAC,aAAa,CAAC;AACvC,IAAIS,MAAM,GAAGV,sBAAsB,CAACC,OAAO,CAAC,SAAS,CAAC,CAAC;AACvD,IAAIU,OAAO,GAAGV,OAAO,CAAC,UAAU,CAAC;AACjC,IAAMW,YAAY,GAAG,SAAfA,YAAYA,CAAGC,OAAO,EAAI;EAC9B,OAAO,EAAEA,OAAO,CAACC,QAAQ,KAAK,OAAO,IAAID,OAAO,CAACE,SAAS,KAAK,IAAI,CAAC;AACtE,CAAC;AACD,IAAMC,kBAAkB,GAAG,SAArBA,kBAAkBA,CAAGH,OAAO,EAAI;EACpC,IAAII,IAAI;EACR,IAAMC,IAAI,GAAG,SAAPA,IAAIA,CAAGC,QAAQ,EAAI;IACvB,IAAIhB,MAAM,CAACiB,SAAS,CAACC,QAAQ,CAACC,IAAI,CAACH,QAAQ,CAAC,KAAK,mBAAmB,EAAE;MACpEA,QAAQ,GAAGI,KAAK,CAACC,IAAI,CAACL,QAAQ,CAAC;IACjC;IACA,QAAQ,CAAC,CAAC,EAAEX,OAAO,CAACN,OAAO,EAAEiB,QAAQ,CAAC;MACpC,KAAK,OAAO;QACV,OAAOM,mBAAmB,CAACN,QAAQ,CAAC;MACtC,KAAK,QAAQ;QACX,OAAOH,kBAAkB,CAACG,QAAQ,CAAC;MACrC,KAAK,MAAM;MACX,KAAK,WAAW;QACd;MACF;QACE,MAAM,IAAIO,KAAK,CAAC,0DAA0D,CAACC,MAAM,CAACR,QAAQ,EAAE,KAAK,CAAC,CAAC;IACvG;EACF,CAAC;EACD,KAAK,IAAIS,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGlB,MAAM,CAACR,OAAO,CAAC2B,MAAM,EAAED,CAAC,EAAE,EAAE;IAC9C,IAAME,IAAI,GAAGpB,MAAM,CAACR,OAAO,CAAC0B,CAAC,CAAC;IAC9B,IAAI,CAACE,IAAI,EAAE;IACX,IAAMC,GAAG,GAAGD,IAAI,CAACjB,OAAO,EAAEK,IAAI,CAAC;IAC/B,IAAMc,IAAI,GAAG,CAAC,CAAC,EAAExB,OAAO,CAACN,OAAO,EAAE6B,GAAG,CAAC;IACtC,IAAIC,IAAI,KAAK,OAAO,IAAIA,IAAI,KAAK,QAAQ,IAAIA,IAAI,KAAK,MAAM,IAAIA,IAAI,KAAK,WAAW,EAAE;MACpF,MAAM,IAAIN,KAAK,CAAC,4DAA4D,CAACC,MAAM,CAACV,IAAI,EAAE,KAAK,CAAC,CAAC;IACnG;;IAEA;IACA,IAAIc,GAAG,KAAKE,SAAS,EAAE;MACrB;IACF;;IAEA;IACA,IAAIF,GAAG,KAAK,IAAI,EAAE;MAChB,OAAO,IAAI;IACb;;IAEA;IACAd,IAAI,GAAGc,GAAG;IACV;EACF;;EAEA;EACA,OAAOd,IAAI,IAAIC,IAAI,CAACL,OAAO,CAACqB,UAAU,CAAC;AACzC,CAAC;AACD,IAAMT,mBAAmB,GAAG,SAAtBA,mBAAmBA,CAAA,EAAe;EACtC,IAAIN,QAAQ,GAAGgB,SAAS,CAACN,MAAM,GAAG,CAAC,IAAIM,SAAS,CAAC,CAAC,CAAC,KAAKF,SAAS,GAAGE,SAAS,CAAC,CAAC,CAAC,GAAG,EAAE;EACrF,IAAIC,UAAU,GAAGD,SAAS,CAACN,MAAM,GAAG,CAAC,IAAIM,SAAS,CAAC,CAAC,CAAC,KAAKF,SAAS,GAAGE,SAAS,CAAC,CAAC,CAAC,GAAG,KAAK;EAC1F,IAAIE,KAAK,GAAG,EAAE;EACdlB,QAAQ,CAACmB,MAAM,CAAC1B,YAAY,CAAC,CAAC2B,OAAO,CAAC,UAAA1B,OAAO,EAAI;IAC/C,IAAMI,IAAI,GAAGD,kBAAkB,CAACH,OAAO,CAAC;IACxC,QAAQ,CAAC,CAAC,EAAEL,OAAO,CAACN,OAAO,EAAEe,IAAI,CAAC;MAChC,KAAK,OAAO;QACV,IAAMuB,UAAU,GAAGJ,UAAU,GAAGK,kBAAkB,CAACxB,IAAI,CAAC,GAAGA,IAAI;QAC/DoB,KAAK,GAAGA,KAAK,CAACV,MAAM,CAACa,UAAU,CAAC;QAChC;MACF,KAAK,QAAQ;QACXH,KAAK,CAACK,IAAI,CAACzB,IAAI,CAAC;QAChB;MACF;MACA;IACF;EACF,CAAC,CAAC;;EACF,OAAO,CAAC,CAAC,EAAEN,OAAO,CAACgC,iBAAiB,EAAEN,KAAK,CAAC;AAC9C,CAAC;AACD,IAAMI,kBAAkB,GAAG,SAArBA,kBAAkBA,CAAGJ,KAAK,EAAI;EAClC,IAAIA,KAAK,CAACR,MAAM,KAAK,CAAC,EAAE;IACtB,OAAO,CAAC;MACNe,EAAE,EAAErC,OAAO,CAACL,OAAO,CAAC2C,IAAI,CAAC,CAAC;MAC1Bb,IAAI,EAAEvB,UAAU,CAACqC,SAAS;MAC1BC,QAAQ,EAAE,CAAC;QACTC,IAAI,EAAE,EAAE;QACRJ,EAAE,EAAErC,OAAO,CAACL,OAAO,CAAC2C,IAAI,CAAC;MAC3B,CAAC;IACH,CAAC,CAAC;EACJ;EACAR,KAAK,GAAGA,KAAK,CAACY,MAAM,CAAC,UAACC,IAAI,EAAEjC,IAAI,EAAK;IACnC,IAAIR,UAAU,CAAC0C,eAAe,CAACC,QAAQ,CAACnC,IAAI,CAACe,IAAI,CAAC,EAAE;MAClDkB,IAAI,CAACR,IAAI,CAACzB,IAAI,CAAC;IACjB;IACA,IAAIA,IAAI,CAACe,IAAI,KAAKvB,UAAU,CAAC4C,SAAS,EAAE;MACtC,IAAMC,OAAO,GAAG;QACdV,EAAE,EAAErC,OAAO,CAACL,OAAO,CAAC2C,IAAI,CAAC,CAAC;QAC1Bb,IAAI,EAAEvB,UAAU,CAAC8C,cAAc;QAC/BR,QAAQ,EAAE,CAAC9B,IAAI;MACjB,CAAC;MACDiC,IAAI,CAACR,IAAI,CAACY,OAAO,CAAC;MAClB,OAAOJ,IAAI;IACb;;IAEA;IACA;IACA;;IAEA;IACA,IAAI,CAACjC,IAAI,CAACe,IAAI,IAAIvB,UAAU,CAAC+C,kBAAkB,CAACJ,QAAQ,CAACnC,IAAI,CAACe,IAAI,CAAC,EAAE;MACnE,IAAIyB,QAAQ,GAAGP,IAAI,CAACA,IAAI,CAACrB,MAAM,GAAG,CAAC,CAAC;MACpC,IAAI4B,QAAQ,IAAIA,QAAQ,CAACzB,IAAI,KAAKvB,UAAU,CAACqC,SAAS,EAAE;QACtDW,QAAQ,CAACV,QAAQ,CAACL,IAAI,CAACzB,IAAI,CAAC;QAC5B,OAAOiC,IAAI;MACb;MACA,IAAMI,QAAO,GAAG;QACdV,EAAE,EAAErC,OAAO,CAACL,OAAO,CAAC2C,IAAI,CAAC,CAAC;QAC1Bb,IAAI,EAAEvB,UAAU,CAACqC,SAAS;QAC1BC,QAAQ,EAAE,CAAC9B,IAAI;MACjB,CAAC;MACDiC,IAAI,CAACR,IAAI,CAACY,QAAO,CAAC;MAClB,OAAOJ,IAAI;IACb;IACA,OAAOA,IAAI;EACb,CAAC,EAAE,EAAE,CAAC;EACN,OAAOb,KAAK;AACd,CAAC;AACD,IAAMqB,eAAe,GAAG,SAAlBA,eAAeA,CAAGC,IAAI,EAAI;EAC9B,IAAMC,MAAM,GAAG,IAAIC,SAAS,CAAC,CAAC,CAACC,eAAe,CAACH,IAAI,EAAE,WAAW,CAAC;EACjE,IAAMI,QAAQ,GAAGH,MAAM,CAACI,IAAI;EAC5B,IAAMjB,QAAQ,GAAGxB,KAAK,CAACC,IAAI,CAACuC,QAAQ,CAAC7B,UAAU,CAAC;EAChD,IAAIG,KAAK,GAAG,EAAE;EACdA,KAAK,GAAGZ,mBAAmB,CAACsB,QAAQ,EAAE,IAAI,CAAC;EAC3CV,KAAK,GAAGI,kBAAkB,CAACJ,KAAK,CAAC;EACjC,OAAOA,KAAK;AACd,CAAC;AACD,IAAI4B,QAAQ,GAAG5D,OAAO,CAACH,OAAO,GAAGwD,eAAe"},"metadata":{},"sourceType":"script","externalDependencies":[]}