{"ast":null,"code":"import _objectSpread from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useParams}from'@gatsbyjs/reach-router';import React,{useCallback,useEffect,useState}from'react';import{Utils}from'../../../utils/utils';import{gettext}from'../../../utils/constants';import Loading from'../../../components/loading';import SetQuotaDialog from'../../../components/dialog/sysadmin-dialog/set-quota';import instAdminAPI from'../api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function UserInfo(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isShowEditDialog=_useState6[0],setIsShowEditDialog=_useState6[1];var params=useParams();useEffect(function(){instAdminAPI.getInstitutionUserInfo(decodeURIComponent(params.email)).then(function(res){var user=res.data;setUser(user);setIsLoading(false);});},[params.email]);var toggleSetQuotaDialog=useCallback(function(){setIsShowEditDialog(!isShowEditDialog);},[isShowEditDialog]);var updateQuota=useCallback(function(quote){instAdminAPI.setInstitutionUserQuote(user.email,quote).then(function(res){// convert value to mb\nvar newUser=_objectSpread(_objectSpread({},user),{},{quota_total:quote*1000*1000});setUser(newUser);});},[user]);if(isLoading){return/*#__PURE__*/_jsx(Loading,{});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"dl\",{className:\"m-0\",children:[/*#__PURE__*/_jsx(\"dt\",{className:\"info-item-heading\",children:gettext('Avatar')}),/*#__PURE__*/_jsx(\"dd\",{className:\"info-item-content\",children:/*#__PURE__*/_jsx(\"img\",{src:user.avatar_url,alt:user.name,width:\"80\",className:\"rounded\"})}),/*#__PURE__*/_jsx(\"dt\",{className:\"info-item-heading\",children:gettext('Email')}),/*#__PURE__*/_jsx(\"dd\",{className:\"info-item-content\",children:user.email}),/*#__PURE__*/_jsx(\"dt\",{className:\"info-item-heading\",children:gettext('Name')}),/*#__PURE__*/_jsx(\"dd\",{className:\"info-item-content\",children:user.name||'--'}),/*#__PURE__*/_jsx(\"dt\",{className:\"info-item-heading\",children:gettext('Space Used / Quota')}),/*#__PURE__*/_jsxs(\"dd\",{className:\"info-item-content\",children:[\"\".concat(Utils.bytesToSize(user.quota_usage),\" / \").concat(user.quota_total>0?Utils.bytesToSize(user.quota_total):'--'),/*#__PURE__*/_jsx(\"span\",{title:gettext('Edit'),className:\"fa fa-pencil-alt attr-action-icon\",onClick:toggleSetQuotaDialog})]})]}),isShowEditDialog&&/*#__PURE__*/_jsx(SetQuotaDialog,{updateQuota:updateQuota,toggle:toggleSetQuotaDialog})]});}","map":{"version":3,"names":["useParams","React","useCallback","useEffect","useState","Utils","gettext","Loading","SetQuotaDialog","instAdminAPI","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","UserInfo","_useState","_useState2","_slicedToArray","isLoading","setIsLoading","_useState3","_useState4","user","setUser","_useState5","_useState6","isShowEditDialog","setIsShowEditDialog","params","getInstitutionUserInfo","decodeURIComponent","email","then","res","data","toggleSetQuotaDialog","updateQuota","quote","setInstitutionUserQuote","newUser","_objectSpread","quota_total","children","className","src","avatar_url","alt","name","width","concat","bytesToSize","quota_usage","title","onClick","toggle"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/pages/institution-admin/user-content/user-info.js"],"sourcesContent":["import { useParams } from '@gatsbyjs/reach-router';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { Utils } from '../../../utils/utils';\nimport { gettext } from '../../../utils/constants';\nimport Loading from '../../../components/loading';\nimport SetQuotaDialog from '../../../components/dialog/sysadmin-dialog/set-quota';\nimport instAdminAPI from '../api';\n\nexport default function UserInfo() {\n\n  const [isLoading, setIsLoading] = useState(true);\n  const [user, setUser] = useState(null);\n  const [isShowEditDialog, setIsShowEditDialog] = useState(false);\n  const params = useParams();\n\n  useEffect(() => {\n    instAdminAPI.getInstitutionUserInfo(decodeURIComponent(params.email)).then(res => {\n      const user = res.data;\n      setUser(user);\n      setIsLoading(false);\n    });\n  }, [params.email]);\n\n  const toggleSetQuotaDialog = useCallback(() => {\n    setIsShowEditDialog(!isShowEditDialog);\n  }, [isShowEditDialog]);\n\n  const updateQuota = useCallback((quote) => {\n    instAdminAPI.setInstitutionUserQuote(user.email, quote).then(res => {\n      // convert value to mb\n      const newUser = {...user, quota_total: quote * 1000 * 1000};\n      setUser(newUser);\n    });\n  }, [user]);\n\n  if (isLoading) {\n    return <Loading />;\n  }\n\n\n  return (\n    <>\n      <dl className=\"m-0\">\n        <dt className=\"info-item-heading\">{gettext('Avatar')}</dt>\n        <dd className=\"info-item-content\">\n          <img src={user.avatar_url} alt={user.name} width=\"80\" className=\"rounded\"  />\n        </dd>\n\n        <dt className=\"info-item-heading\">{gettext('Email')}</dt>\n        <dd className=\"info-item-content\">{user.email}</dd>\n\n        <dt className=\"info-item-heading\">{gettext('Name')}</dt>\n        <dd className=\"info-item-content\">\n          {user.name || '--'}\n        </dd>\n\n        <dt className=\"info-item-heading\">{gettext('Space Used / Quota')}</dt>\n        <dd className=\"info-item-content\">\n          {`${Utils.bytesToSize(user.quota_usage)} / ${user.quota_total > 0 ? Utils.bytesToSize(user.quota_total) : '--'}`}\n          <span\n            title={gettext('Edit')}\n            className=\"fa fa-pencil-alt attr-action-icon\"\n            onClick={toggleSetQuotaDialog}>\n          </span>\n        </dd>\n      </dl>\n      {isShowEditDialog && (\n        <SetQuotaDialog updateQuota={updateQuota} toggle={toggleSetQuotaDialog}/>\n      )}\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}