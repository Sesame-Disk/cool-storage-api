{"ast":null,"code":"import React, { useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport ColumnsHeader from './columns-header';\nimport RowsHeader from './rows-header';\nimport { useResizeHandlersContext, useTableSelectedRangeContext } from '../hooks';\nimport RowsColumnsHeader from './rows-columns-header';\nimport { generateDragMoveElement, getTableDragType, getTableRowSelectedRange, getTableColumnSelectedRange } from '../../helpers';\nimport { DRAG_HANDLER_COLUMN, DRAG_HANDLER_ROW, EMPTY_SELECTED_RANGE } from '../../constants';\nimport { TABLE_DRAG_KEY } from '../../../../constants';\nimport './index.css';\nvar TableHeader = function TableHeader(_ref) {\n  var editor = _ref.editor,\n    table = _ref.table,\n    setSelectedRange = _ref.setSelectedRange,\n    setIsDragMove = _ref.setIsDragMove;\n  var _useTranslation = useTranslation(),\n    t = _useTranslation.t;\n  var columns = useResizeHandlersContext();\n  var selectedRange = useTableSelectedRangeContext() || EMPTY_SELECTED_RANGE;\n  var selectColumn = useCallback(function (columnIndex) {\n    var selectedRange = getTableColumnSelectedRange(table, columnIndex);\n    setSelectedRange(selectedRange);\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [table, columns]);\n  var selectRow = useCallback(function (rowIndex) {\n    var selectedRange = getTableRowSelectedRange(table, rowIndex);\n    setSelectedRange(selectedRange);\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [table, columns]);\n  var selectTable = useCallback(function () {\n    var columnsCount = columns.length;\n    var rowsCount = table.children.length;\n    var range = {\n      minRowIndex: 0,\n      maxRowIndex: rowsCount - 1,\n      minColIndex: 0,\n      maxColIndex: columnsCount - 1\n    };\n    setSelectedRange(range);\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [table, columns]);\n  var tableSize = [table.children.length, columns.length];\n  var handleDragStart = function handleDragStart(event) {\n    event.stopPropagation();\n    var tableSelectedRange = editor.tableSelectedRange;\n    var tableId = table.id;\n    var minColIndex = tableSelectedRange.minColIndex,\n      maxColIndex = tableSelectedRange.maxColIndex,\n      minRowIndex = tableSelectedRange.minRowIndex,\n      maxRowIndex = tableSelectedRange.maxRowIndex;\n    var dragType = getTableDragType(table, selectedRange);\n    var startIndex = dragType === DRAG_HANDLER_COLUMN ? minColIndex : minRowIndex;\n    var endIndex = dragType === DRAG_HANDLER_ROW ? maxRowIndex : maxColIndex;\n    var data = {\n      tableId: tableId,\n      dragType: dragType,\n      startIndex: startIndex,\n      endIndex: endIndex\n    };\n    var dragData = JSON.stringify(data);\n    event.dataTransfer.setData(TABLE_DRAG_KEY, dragData);\n    event.dataTransfer.effectAllowed = 'move';\n    var moveCount = endIndex - startIndex + 1;\n    var tipText = dragType === DRAG_HANDLER_COLUMN ? t('Move_column_count', {\n      count: moveCount\n    }) : t('Move_row_count', {\n      count: moveCount\n    });\n    var dragImage = generateDragMoveElement(tipText);\n    event.dataTransfer.setDragImage(dragImage, 0, 0);\n    setIsDragMove(true);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  };\n\n  var handleDragEnd = function handleDragEnd(event) {\n    setIsDragMove(false);\n    var indicator = document.getElementById('sdoc-drag-image');\n    indicator.style.display = 'none';\n  };\n  return /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(ColumnsHeader, {\n    table: table,\n    selectRange: selectColumn,\n    tableSize: tableSize,\n    handleDragStart: handleDragStart,\n    handleDragEnd: handleDragEnd\n  }), /*#__PURE__*/React.createElement(RowsColumnsHeader, {\n    selectRange: selectTable,\n    tableSize: tableSize\n  }), /*#__PURE__*/React.createElement(RowsHeader, {\n    table: table,\n    selectRange: selectRow,\n    tableSize: tableSize,\n    handleDragStart: handleDragStart,\n    handleDragEnd: handleDragEnd\n  }));\n};\nexport default TableHeader;","map":{"version":3,"names":["React","useCallback","useTranslation","ColumnsHeader","RowsHeader","useResizeHandlersContext","useTableSelectedRangeContext","RowsColumnsHeader","generateDragMoveElement","getTableDragType","getTableRowSelectedRange","getTableColumnSelectedRange","DRAG_HANDLER_COLUMN","DRAG_HANDLER_ROW","EMPTY_SELECTED_RANGE","TABLE_DRAG_KEY","TableHeader","_ref","editor","table","setSelectedRange","setIsDragMove","_useTranslation","t","columns","selectedRange","selectColumn","columnIndex","selectRow","rowIndex","selectTable","columnsCount","length","rowsCount","children","range","minRowIndex","maxRowIndex","minColIndex","maxColIndex","tableSize","handleDragStart","event","stopPropagation","tableSelectedRange","tableId","id","dragType","startIndex","endIndex","data","dragData","JSON","stringify","dataTransfer","setData","effectAllowed","moveCount","tipText","count","dragImage","setDragImage","handleDragEnd","indicator","document","getElementById","style","display","createElement","selectRange"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/plugins/table/render/table-header/index.js"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport ColumnsHeader from './columns-header';\nimport RowsHeader from './rows-header';\nimport { useResizeHandlersContext, useTableSelectedRangeContext } from '../hooks';\nimport RowsColumnsHeader from './rows-columns-header';\nimport { generateDragMoveElement, getTableDragType, getTableRowSelectedRange, getTableColumnSelectedRange } from '../../helpers';\nimport { DRAG_HANDLER_COLUMN, DRAG_HANDLER_ROW, EMPTY_SELECTED_RANGE } from '../../constants';\nimport { TABLE_DRAG_KEY } from '../../../../constants';\nimport './index.css';\nconst TableHeader = _ref => {\n  let {\n    editor,\n    table,\n    setSelectedRange,\n    setIsDragMove\n  } = _ref;\n  const {\n    t\n  } = useTranslation();\n  const columns = useResizeHandlersContext();\n  const selectedRange = useTableSelectedRangeContext() || EMPTY_SELECTED_RANGE;\n  const selectColumn = useCallback(columnIndex => {\n    const selectedRange = getTableColumnSelectedRange(table, columnIndex);\n    setSelectedRange(selectedRange);\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [table, columns]);\n  const selectRow = useCallback(rowIndex => {\n    const selectedRange = getTableRowSelectedRange(table, rowIndex);\n    setSelectedRange(selectedRange);\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [table, columns]);\n  const selectTable = useCallback(() => {\n    const columnsCount = columns.length;\n    const rowsCount = table.children.length;\n    const range = {\n      minRowIndex: 0,\n      maxRowIndex: rowsCount - 1,\n      minColIndex: 0,\n      maxColIndex: columnsCount - 1\n    };\n    setSelectedRange(range);\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [table, columns]);\n  const tableSize = [table.children.length, columns.length];\n  const handleDragStart = event => {\n    event.stopPropagation();\n    const {\n      tableSelectedRange\n    } = editor;\n    const tableId = table.id;\n    const {\n      minColIndex,\n      maxColIndex,\n      minRowIndex,\n      maxRowIndex\n    } = tableSelectedRange;\n    const dragType = getTableDragType(table, selectedRange);\n    const startIndex = dragType === DRAG_HANDLER_COLUMN ? minColIndex : minRowIndex;\n    const endIndex = dragType === DRAG_HANDLER_ROW ? maxRowIndex : maxColIndex;\n    const data = {\n      tableId,\n      dragType,\n      startIndex,\n      endIndex\n    };\n    const dragData = JSON.stringify(data);\n    event.dataTransfer.setData(TABLE_DRAG_KEY, dragData);\n    event.dataTransfer.effectAllowed = 'move';\n    const moveCount = endIndex - startIndex + 1;\n    const tipText = dragType === DRAG_HANDLER_COLUMN ? t('Move_column_count', {\n      count: moveCount\n    }) : t('Move_row_count', {\n      count: moveCount\n    });\n    const dragImage = generateDragMoveElement(tipText);\n    event.dataTransfer.setDragImage(dragImage, 0, 0);\n    setIsDragMove(true);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  };\n\n  const handleDragEnd = event => {\n    setIsDragMove(false);\n    const indicator = document.getElementById('sdoc-drag-image');\n    indicator.style.display = 'none';\n  };\n  return /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(ColumnsHeader, {\n    table: table,\n    selectRange: selectColumn,\n    tableSize: tableSize,\n    handleDragStart: handleDragStart,\n    handleDragEnd: handleDragEnd\n  }), /*#__PURE__*/React.createElement(RowsColumnsHeader, {\n    selectRange: selectTable,\n    tableSize: tableSize\n  }), /*#__PURE__*/React.createElement(RowsHeader, {\n    table: table,\n    selectRange: selectRow,\n    tableSize: tableSize,\n    handleDragStart: handleDragStart,\n    handleDragEnd: handleDragEnd\n  }));\n};\nexport default TableHeader;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}