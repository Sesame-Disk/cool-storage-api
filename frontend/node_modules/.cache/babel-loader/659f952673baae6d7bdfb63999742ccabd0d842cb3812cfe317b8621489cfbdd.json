{"ast":null,"code":"import _toConsumableArray from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Fragment}from'react';import Resumablejs from'@seafile/resumablejs';import MD5 from'MD5';import{resumableUploadFileBlockSize,maxUploadFileSize,maxNumberOfFilesForFileupload}from'../../utils/constants';import{seafileAPI}from'../../utils/seafile-api';import{Utils}from'../../utils/utils';import{gettext}from'../../utils/constants';import UploadProgressDialog from'./upload-progress-dialog';import UploadRemindDialog from'../dialog/upload-remind-dialog';import toaster from'../toast';import'../../css/file-uploader.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FileUploader=/*#__PURE__*/function(_React$Component){_inherits(FileUploader,_React$Component);var _super=_createSuper(FileUploader);function FileUploader(props){var _this;_classCallCheck(this,FileUploader);_this=_super.call(this,props);_this.componentWillUnmount=function(){window.onbeforeunload=null;if(_this.props.dragAndDrop===true){_this.resumable.disableDropOnDocument();}};_this.onbeforeunload=function(){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&window.uploader.totalProgress!==100){return'';}};_this.bindCallbackHandler=function(){var _this$props=_this.props,minFileSizeErrorCallback=_this$props.minFileSizeErrorCallback,fileTypeErrorCallback=_this$props.fileTypeErrorCallback;if(_this.maxFilesErrorCallback){_this.resumable.opts.maxFilesErrorCallback=_this.maxFilesErrorCallback;}if(minFileSizeErrorCallback){_this.resumable.opts.minFileSizeErrorCallback=_this.props.minFileSizeErrorCallback;}if(_this.maxFileSizeErrorCallback){_this.resumable.opts.maxFileSizeErrorCallback=_this.maxFileSizeErrorCallback;}if(fileTypeErrorCallback){_this.resumable.opts.fileTypeErrorCallback=_this.props.fileTypeErrorCallback;}};_this.bindEventHandler=function(){_this.resumable.on('chunkingComplete',_this.onChunkingComplete.bind(_assertThisInitialized(_this)));_this.resumable.on('fileAdded',_this.onFileAdded.bind(_assertThisInitialized(_this)));_this.resumable.on('filesAddedComplete',_this.filesAddedComplete.bind(_assertThisInitialized(_this)));_this.resumable.on('fileProgress',_this.onFileProgress.bind(_assertThisInitialized(_this)));_this.resumable.on('fileSuccess',_this.onFileUploadSuccess.bind(_assertThisInitialized(_this)));_this.resumable.on('progress',_this.onProgress.bind(_assertThisInitialized(_this)));_this.resumable.on('complete',_this.onComplete.bind(_assertThisInitialized(_this)));_this.resumable.on('pause',_this.onPause.bind(_assertThisInitialized(_this)));_this.resumable.on('fileRetry',_this.onFileRetry.bind(_assertThisInitialized(_this)));_this.resumable.on('fileError',_this.onFileError.bind(_assertThisInitialized(_this)));_this.resumable.on('error',_this.onError.bind(_assertThisInitialized(_this)));_this.resumable.on('beforeCancel',_this.onBeforeCancel.bind(_assertThisInitialized(_this)));_this.resumable.on('cancel',_this.onCancel.bind(_assertThisInitialized(_this)));_this.resumable.on('dragstart',_this.onDragStart.bind(_assertThisInitialized(_this)));};_this.maxFilesErrorCallback=function(files,errorCount){var maxFiles=maxNumberOfFilesForFileupload;var message=gettext('Please upload no more than {maxFiles} files at a time.');message=message.replace('{maxFiles}',maxFiles);toaster.danger(message);};_this.maxFileSizeErrorCallback=function(file){var forbidUploadFileList=_this.state.forbidUploadFileList;forbidUploadFileList.push(file);_this.setState({forbidUploadFileList:forbidUploadFileList});};_this.onChunkingComplete=function(resumableFile){//get parent_dir relative_path\nvar path=_this.props.path==='/'?'/':_this.props.path+'/';var fileName=resumableFile.fileName;var relativePath=resumableFile.relativePath;var isFile=fileName===relativePath;//update formdata\nresumableFile.formData={};if(isFile){// upload file\nresumableFile.formData={parent_dir:path};}else{// upload folder\nvar relative_path=relativePath.slice(0,relativePath.lastIndexOf('/')+1);resumableFile.formData={parent_dir:path,relative_path:relative_path};}};_this.onFileAdded=function(resumableFile,files){var isCustomPermission=_this.props.isCustomPermission;var isFile=resumableFile.fileName===resumableFile.relativePath;// uploading is file and only upload one file\nif(isFile&&files.length===1){var hasRepetition=false;if(!isCustomPermission){var direntList=_this.props.direntList;for(var i=0;i<direntList.length;i++){if(direntList[i].type==='file'&&direntList[i].name===resumableFile.fileName){hasRepetition=true;break;}}}if(hasRepetition){_this.setState({isUploadRemindDialogShow:true,currentResumableFile:resumableFile});}else{_this.setUploadFileList(_this.resumable.files);var _this$props2=_this.props,repoID=_this$props2.repoID,path=_this$props2.path;seafileAPI.getFileServerUploadLink(repoID,path).then(function(res){_this.resumable.opts.target=res.data+'?ret-json=1';_this.resumableUpload(resumableFile);}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});}}else{_this.setUploadFileList(_this.resumable.files);if(!_this.isUploadLinkLoaded){_this.isUploadLinkLoaded=true;var _this$props3=_this.props,_repoID=_this$props3.repoID,_path=_this$props3.path;seafileAPI.getFileServerUploadLink(_repoID,_path).then(function(res){_this.resumable.opts.target=res.data+'?ret-json=1';_this.resumable.upload();}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});}}};_this.resumableUpload=function(resumableFile){var _this$props4=_this.props,repoID=_this$props4.repoID,path=_this$props4.path;seafileAPI.getFileUploadedBytes(repoID,path,resumableFile.fileName).then(function(res){var uploadedBytes=res.data.uploadedBytes;var blockSize=parseInt(resumableUploadFileBlockSize)*1024*1024||1024*1024;var offset=Math.floor(uploadedBytes/blockSize);resumableFile.markChunksCompleted(offset);_this.resumable.upload();}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.filesAddedComplete=function(resumable,files){var forbidUploadFileList=_this.state.forbidUploadFileList;if(forbidUploadFileList.length>0&&files.length===0){_this.setState({isUploadProgressDialogShow:true,totalProgress:100});}};_this.setUploadFileList=function(){var uploadFileList=_this.resumable.files;_this.setState({uploadFileList:uploadFileList,isUploadProgressDialogShow:true});Utils.registerGlobalVariable('uploader','isUploadProgressDialogShow',true);};_this.onFileProgress=function(resumableFile){var uploadBitrate=_this.getBitrate();var uploadFileList=_this.state.uploadFileList.map(function(item){if(item.uniqueIdentifier===resumableFile.uniqueIdentifier){if(uploadBitrate){var lastSize=(item.size-item.size*item.progress())*8;var time=Math.floor(lastSize/uploadBitrate);item.remainingTime=time;}}return item;});_this.setState({uploadBitrate:uploadBitrate,uploadFileList:uploadFileList});};_this.getBitrate=function(){var loaded=0;var uploadBitrate=0;var now=new Date().getTime();_this.resumable.files.forEach(function(file){loaded+=file.progress()*file.size;});if(_this.timestamp){var timeDiff=now-_this.timestamp;if(timeDiff<_this.bitrateInterval){return _this.state.uploadBitrate;}// 1. Cancel will produce loaded greater than this.loaded\n// 2. reset can make this.loaded to be 0\nif(loaded<_this.loaded||_this.loaded===0){_this.loaded=loaded;//\n}uploadBitrate=(loaded-_this.loaded)*(1000/timeDiff)*8;}_this.timestamp=now;_this.loaded=loaded;return uploadBitrate;};_this.onProgress=function(){var progress=Math.round(_this.resumable.progress()*100);_this.setState({totalProgress:progress});Utils.registerGlobalVariable('uploader','totalProgress',progress);};_this.onFileUploadSuccess=function(resumableFile,message){var formData=resumableFile.formData;var currentTime=new Date().getTime()/1000;message=formData.replace?message:JSON.parse(message)[0];if(formData.relative_path){// upload folder\nvar relative_path=formData.relative_path;var dir_name=relative_path.slice(0,relative_path.indexOf('/'));var _dirent={id:message.id,name:dir_name,type:'dir',mtime:currentTime};// update folders cache\nvar isExist=_this.notifiedFolders.some(function(item){return item.name===_dirent.name;});if(!isExist){_this.notifiedFolders.push(_dirent);_this.props.onFileUploadSuccess(_dirent);}// update uploadFileList\nvar _uploadFileList=_this.state.uploadFileList.map(function(item){if(item.uniqueIdentifier===resumableFile.uniqueIdentifier){item.newFileName=relative_path+message.name;item.isSaved=true;}return item;});_this.setState({uploadFileList:_uploadFileList});return;}if(formData.replace){// upload file -- replace exist file\nvar fileName=resumableFile.fileName;var _dirent2={id:message,name:fileName,type:'file',mtime:currentTime};_this.props.onFileUploadSuccess(_dirent2);// this contance: just one file\nvar _uploadFileList2=_this.state.uploadFileList.map(function(item){if(item.uniqueIdentifier===resumableFile.uniqueIdentifier){item.newFileName=fileName;item.isSaved=true;}return item;});_this.setState({uploadFileList:_uploadFileList2});return;}// upload file -- add files\nvar dirent={id:message.id,type:'file',name:message.name,size:message.size,mtime:currentTime};_this.props.onFileUploadSuccess(dirent);// this contance:  no repetition file\nvar uploadFileList=_this.state.uploadFileList.map(function(item){if(item.uniqueIdentifier===resumableFile.uniqueIdentifier){item.newFileName=message.name;item.isSaved=true;}return item;});_this.setState({uploadFileList:uploadFileList});};_this.getFileServerErrorMessage=function(key){var errorMessage={'File locked by others.':gettext('File is locked by others.'),// 403\n'Invalid filename.':gettext('Invalid filename.'),// 440\n'File already exists.':gettext('File already exists.'),// 441\n'File size is too large.':gettext('File size is too large.'),// 442\n'Out of quota.':gettext('Out of quota.'),// 443\n'Internal error.':gettext('Internal Server Error')// 500\n};return errorMessage[key]||key;};_this.onFileError=function(resumableFile,message){var error='';if(!message){error=gettext('Network error');}else{// eg: '{\"error\": \"Internal error\" \\n }'\nvar errorMessage=message.replace(/\\n/g,'');errorMessage=JSON.parse(errorMessage);error=_this.getFileServerErrorMessage(errorMessage.error);}var uploadFileList=_this.state.uploadFileList.map(function(item){if(item.uniqueIdentifier===resumableFile.uniqueIdentifier){_this.state.retryFileList.push(item);item.error=error;}return item;});_this.loaded=0;// reset loaded data;\n_this.setState({retryFileList:_this.state.retryFileList,uploadFileList:uploadFileList});};_this.onComplete=function(){_this.notifiedFolders=[];// reset upload link loaded\n_this.isUploadLinkLoaded=false;};_this.onPause=function(){};_this.onError=function(message){// reset upload link loaded\n_this.isUploadLinkLoaded=false;// After the error, the user can switch windows\nUtils.registerGlobalVariable('uploader','totalProgress',100);};_this.onFileRetry=function(){// todo, cancel upload file, uploded again;\n};_this.onBeforeCancel=function(){// todo, giving a pop message ?\n};_this.onCancel=function(){};_this.setHeaders=function(resumableFile,resumable){var offset=resumable.offset;var chunkSize=resumable.getOpt('chunkSize');var fileSize=resumableFile.size===0?1:resumableFile.size;var startByte=offset!==0?offset*chunkSize:0;var endByte=Math.min(fileSize,(offset+1)*chunkSize)-1;if(fileSize-resumable.endByte<chunkSize&&!resumable.getOpt('forceChunkSize')){endByte=fileSize;}var headers={'Accept':'application/json; text/javascript, */*; q=0.01','Content-Disposition':'attachment; filename=\"'+encodeURI(resumableFile.fileName)+'\"','Content-Range':'bytes '+startByte+'-'+endByte+'/'+fileSize};return headers;};_this.setQuery=function(resumableFile){var formData=resumableFile.formData;return formData;};_this.generateUniqueIdentifier=function(file){var relativePath=file.webkitRelativePath||file.relativePath||file.fileName||file.name;return MD5(relativePath+new Date())+relativePath;};_this.onClick=function(e){e.nativeEvent.stopImmediatePropagation();e.stopPropagation();};_this.onFileUpload=function(){_this.uploadInput.current.removeAttribute('webkitdirectory');_this.uploadInput.current.click();};_this.onFolderUpload=function(){_this.uploadInput.current.setAttribute('webkitdirectory','webkitdirectory');_this.uploadInput.current.click();};_this.onDragStart=function(){_this.uploadInput.current.setAttribute('webkitdirectory','webkitdirectory');};_this.onCloseUploadDialog=function(){_this.loaded=0;_this.resumable.files=[];// reset upload link loaded\n_this.isUploadLinkLoaded=false;_this.setState({isUploadProgressDialogShow:false,uploadFileList:[],forbidUploadFileList:[]});Utils.registerGlobalVariable('uploader','isUploadProgressDialogShow',false);};_this.onUploadCancel=function(uploadingItem){var uploadFileList=_this.state.uploadFileList.filter(function(item){if(item.uniqueIdentifier===uploadingItem.uniqueIdentifier){item.cancel();// execute cancel function will delete the file at the same time\nreturn false;}return true;});if(!_this.resumable.isUploading()){_this.setState({totalProgress:100});_this.loaded=0;}_this.setState({uploadFileList:uploadFileList});};_this.onCancelAllUploading=function(){var uploadFileList=_this.state.uploadFileList.filter(function(item){if(Math.round(item.progress()!==1)){item.cancel();return false;}return true;});_this.loaded=0;_this.setState({totalProgress:100,uploadFileList:uploadFileList});// reset upload link loaded\n_this.isUploadLinkLoaded=false;};_this.onUploadRetry=function(resumableFile){seafileAPI.getFileServerUploadLink(_this.props.repoID,_this.props.path).then(function(res){_this.resumable.opts.target=res.data+'?ret-json=1';var retryFileList=_this.state.retryFileList.filter(function(item){return item.uniqueIdentifier!==resumableFile.uniqueIdentifier;});var uploadFileList=_this.state.uploadFileList.map(function(item){if(item.uniqueIdentifier===resumableFile.uniqueIdentifier){item.error=null;_this.retryUploadFile(item);}return item;});_this.setState({retryFileList:retryFileList,uploadFileList:uploadFileList});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.onUploadRetryAll=function(){seafileAPI.getFileServerUploadLink(_this.props.repoID,_this.props.path).then(function(res){_this.resumable.opts.target=res.data+'?ret-json=1';_this.state.retryFileList.forEach(function(item){item.error=false;_this.retryUploadFile(item);});var uploadFileList=_this.state.uploadFileList.slice(0);_this.setState({retryFileList:[],uploadFileList:uploadFileList});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.retryUploadFile=function(resumableFile){var _this$props5=_this.props,repoID=_this$props5.repoID,path=_this$props5.path;var fileName=resumableFile.fileName;var isFile=resumableFile.fileName===resumableFile.relativePath;if(!isFile){var relative_path=resumableFile.formData.relative_path;var prefix=path==='/'?path+relative_path:path+'/'+relative_path;fileName=prefix+fileName;}resumableFile.bootstrap();var firedRetry=false;resumableFile.resumableObj.on('chunkingComplete',function(){if(!firedRetry){seafileAPI.getFileUploadedBytes(repoID,path,fileName).then(function(res){var uploadedBytes=res.data.uploadedBytes;var blockSize=parseInt(resumableUploadFileBlockSize)*1024*1024||1024*1024;var offset=Math.floor(uploadedBytes/blockSize);resumableFile.markChunksCompleted(offset);resumableFile.resumableObj.upload();}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});}firedRetry=true;});};_this.replaceRepetitionFile=function(){var _this$props6=_this.props,repoID=_this$props6.repoID,path=_this$props6.path;seafileAPI.getUpdateLink(repoID,path).then(function(res){_this.resumable.opts.target=res.data;var resumableFile=_this.resumable.files[_this.resumable.files.length-1];resumableFile.formData['replace']=1;resumableFile.formData['target_file']=resumableFile.formData.parent_dir+resumableFile.fileName;_this.setState({isUploadRemindDialogShow:false});_this.setUploadFileList(_this.resumable.files);_this.resumable.upload();}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.uploadFile=function(){var resumableFile=_this.resumable.files[_this.resumable.files.length-1];var _this$props7=_this.props,repoID=_this$props7.repoID,path=_this$props7.path;seafileAPI.getFileServerUploadLink(repoID,path).then(function(res){// get upload link\n_this.resumable.opts.target=res.data+'?ret-json=1';_this.setState({isUploadRemindDialogShow:false,isUploadProgressDialogShow:true,uploadFileList:[].concat(_toConsumableArray(_this.state.uploadFileList),[resumableFile])},function(){_this.resumable.upload();});Utils.registerGlobalVariable('uploader','isUploadProgressDialogShow',true);}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.cancelFileUpload=function(){_this.resumable.files.pop();//delete latest file；\n_this.setState({isUploadRemindDialogShow:false});};_this.state={retryFileList:[],uploadFileList:[],forbidUploadFileList:[],totalProgress:0,isUploadProgressDialogShow:false,isUploadRemindDialogShow:false,currentResumableFile:null,uploadBitrate:0};_this.uploadInput=/*#__PURE__*/React.createRef();_this.notifiedFolders=[];_this.timestamp=null;_this.loaded=0;_this.bitrateInterval=500;// Interval in milliseconds to calculate the bitrate\nwindow.onbeforeunload=_this.onbeforeunload;_this.isUploadLinkLoaded=false;return _this;}_createClass(FileUploader,[{key:\"componentDidMount\",value:function componentDidMount(){this.resumable=new Resumablejs({target:'',query:this.setQuery||{},fileType:this.props.filetypes,maxFiles:maxNumberOfFilesForFileupload||undefined,maxFileSize:maxUploadFileSize*1000*1000||undefined,testMethod:this.props.testMethod||'post',testChunks:this.props.testChunks||false,headers:this.setHeaders||{},withCredentials:this.props.withCredentials||false,chunkSize:parseInt(resumableUploadFileBlockSize)*1024*1024||1*1024*1024,simultaneousUploads:this.props.simultaneousUploads||1,fileParameterName:this.props.fileParameterName,generateUniqueIdentifier:this.generateUniqueIdentifier,forceChunkSize:true,maxChunkRetries:3,minFileSize:0});this.resumable.assignBrowse(this.uploadInput.current,true);//Enable or Disable DragAnd Drop\nif(this.props.dragAndDrop===true){this.resumable.enableDropOnDocument();}this.bindCallbackHandler();this.bindEventHandler();}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"file-uploader-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"file-uploader\",children:/*#__PURE__*/_jsx(\"input\",{className:\"upload-input\",type:\"file\",ref:this.uploadInput,onClick:this.onClick,\"aria-label\":gettext('Upload')})})}),this.state.isUploadRemindDialogShow&&/*#__PURE__*/_jsx(UploadRemindDialog,{currentResumableFile:this.state.currentResumableFile,replaceRepetitionFile:this.replaceRepetitionFile,uploadFile:this.uploadFile,cancelFileUpload:this.cancelFileUpload}),this.state.isUploadProgressDialogShow&&/*#__PURE__*/_jsx(UploadProgressDialog,{retryFileList:this.state.retryFileList,uploadFileList:this.state.uploadFileList,forbidUploadFileList:this.state.forbidUploadFileList,totalProgress:this.state.totalProgress,uploadBitrate:this.state.uploadBitrate,onCloseUploadDialog:this.onCloseUploadDialog,onCancelAllUploading:this.onCancelAllUploading,onUploadCancel:this.onUploadCancel,onUploadRetry:this.onUploadRetry,onUploadRetryAll:this.onUploadRetryAll,isUploading:this.resumable.isUploading()})]});}}]);return FileUploader;}(React.Component);FileUploader.defaultProps={isCustomPermission:false};export default FileUploader;","map":{"version":3,"names":["React","Fragment","Resumablejs","MD5","resumableUploadFileBlockSize","maxUploadFileSize","maxNumberOfFilesForFileupload","seafileAPI","Utils","gettext","UploadProgressDialog","UploadRemindDialog","toaster","jsx","_jsx","jsxs","_jsxs","FileUploader","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","componentWillUnmount","window","onbeforeunload","dragAndDrop","resumable","disableDropOnDocument","uploader","isUploadProgressDialogShow","totalProgress","bindCallbackHandler","_this$props","minFileSizeErrorCallback","fileTypeErrorCallback","maxFilesErrorCallback","opts","maxFileSizeErrorCallback","bindEventHandler","on","onChunkingComplete","bind","_assertThisInitialized","onFileAdded","filesAddedComplete","onFileProgress","onFileUploadSuccess","onProgress","onComplete","onPause","onFileRetry","onFileError","onError","onBeforeCancel","onCancel","onDragStart","files","errorCount","maxFiles","message","replace","danger","file","forbidUploadFileList","state","push","setState","resumableFile","path","fileName","relativePath","isFile","formData","parent_dir","relative_path","slice","lastIndexOf","isCustomPermission","length","hasRepetition","direntList","i","type","name","isUploadRemindDialogShow","currentResumableFile","setUploadFileList","_this$props2","repoID","getFileServerUploadLink","then","res","target","data","resumableUpload","catch","error","errMessage","getErrorMsg","isUploadLinkLoaded","_this$props3","upload","_this$props4","getFileUploadedBytes","uploadedBytes","blockSize","parseInt","offset","Math","floor","markChunksCompleted","uploadFileList","registerGlobalVariable","uploadBitrate","getBitrate","map","item","uniqueIdentifier","lastSize","size","progress","time","remainingTime","loaded","now","Date","getTime","forEach","timestamp","timeDiff","bitrateInterval","round","currentTime","JSON","parse","dir_name","indexOf","dirent","id","mtime","isExist","notifiedFolders","some","newFileName","isSaved","getFileServerErrorMessage","key","errorMessage","retryFileList","setHeaders","chunkSize","getOpt","fileSize","startByte","endByte","min","headers","encodeURI","setQuery","generateUniqueIdentifier","webkitRelativePath","onClick","e","nativeEvent","stopImmediatePropagation","stopPropagation","onFileUpload","uploadInput","current","removeAttribute","click","onFolderUpload","setAttribute","onCloseUploadDialog","onUploadCancel","uploadingItem","filter","cancel","isUploading","onCancelAllUploading","onUploadRetry","retryUploadFile","onUploadRetryAll","_this$props5","prefix","bootstrap","firedRetry","resumableObj","replaceRepetitionFile","_this$props6","getUpdateLink","uploadFile","_this$props7","concat","_toConsumableArray","cancelFileUpload","pop","createRef","_createClass","value","componentDidMount","query","fileType","filetypes","undefined","maxFileSize","testMethod","testChunks","withCredentials","simultaneousUploads","fileParameterName","forceChunkSize","maxChunkRetries","minFileSize","assignBrowse","enableDropOnDocument","render","children","className","ref","Component","defaultProps"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/file-uploader/file-uploader.js"],"sourcesContent":["import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport Resumablejs from '@seafile/resumablejs';\nimport MD5 from 'MD5';\nimport { resumableUploadFileBlockSize, maxUploadFileSize, maxNumberOfFilesForFileupload } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { gettext } from '../../utils/constants';\nimport UploadProgressDialog from './upload-progress-dialog';\nimport UploadRemindDialog from '../dialog/upload-remind-dialog';\nimport toaster from '../toast';\nimport '../../css/file-uploader.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  direntList: PropTypes.array.isRequired,\n  filetypes: PropTypes.array,\n  chunkSize: PropTypes.number,\n  withCredentials: PropTypes.bool,\n  testMethod: PropTypes.string,\n  testChunks: PropTypes.number,\n  simultaneousUploads: PropTypes.number,\n  fileParameterName: PropTypes.string,\n  minFileSizeErrorCallback: PropTypes.func,\n  fileTypeErrorCallback: PropTypes.func,\n  dragAndDrop: PropTypes.bool.isRequired,\n  path: PropTypes.string.isRequired,\n  onFileUploadSuccess: PropTypes.func.isRequired,\n  isCustomPermission: PropTypes.bool,\n};\n\nclass FileUploader extends React.Component {\n\n  static defaultProps = {\n    isCustomPermission: false\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      retryFileList: [],\n      uploadFileList: [],\n      forbidUploadFileList: [],\n      totalProgress: 0,\n      isUploadProgressDialogShow: false,\n      isUploadRemindDialogShow: false,\n      currentResumableFile: null,\n      uploadBitrate: 0,\n    };\n\n    this.uploadInput = React.createRef();\n\n    this.notifiedFolders = [];\n\n    this.timestamp = null;\n    this.loaded = 0;\n    this.bitrateInterval = 500; // Interval in milliseconds to calculate the bitrate\n    window.onbeforeunload = this.onbeforeunload;\n    this.isUploadLinkLoaded = false;\n  }\n\n  componentDidMount() {\n    this.resumable = new Resumablejs({\n      target: '',\n      query: this.setQuery || {},\n      fileType: this.props.filetypes,\n      maxFiles: maxNumberOfFilesForFileupload || undefined,\n      maxFileSize: maxUploadFileSize * 1000 * 1000 || undefined,\n      testMethod: this.props.testMethod || 'post',\n      testChunks: this.props.testChunks || false,\n      headers: this.setHeaders || {},\n      withCredentials: this.props.withCredentials || false,\n      chunkSize: parseInt(resumableUploadFileBlockSize) * 1024 * 1024 || 1 * 1024 * 1024,\n      simultaneousUploads: this.props.simultaneousUploads || 1,\n      fileParameterName: this.props.fileParameterName,\n      generateUniqueIdentifier: this.generateUniqueIdentifier,\n      forceChunkSize: true,\n      maxChunkRetries: 3,\n      minFileSize: 0,\n    });\n\n    this.resumable.assignBrowse(this.uploadInput.current, true);\n\n    //Enable or Disable DragAnd Drop\n    if (this.props.dragAndDrop === true) {\n      this.resumable.enableDropOnDocument();\n    }\n\n    this.bindCallbackHandler();\n    this.bindEventHandler();\n  }\n\n  componentWillUnmount = () => {\n    window.onbeforeunload = null;\n    if (this.props.dragAndDrop === true) {\n      this.resumable.disableDropOnDocument();\n    }\n  };\n\n  onbeforeunload = () => {\n    if (window.uploader &&\n        window.uploader.isUploadProgressDialogShow &&\n        window.uploader.totalProgress !== 100) {\n      return '';\n    }\n  };\n\n  bindCallbackHandler = () => {\n    let { minFileSizeErrorCallback, fileTypeErrorCallback } = this.props;\n\n    if (this.maxFilesErrorCallback) {\n      this.resumable.opts.maxFilesErrorCallback = this.maxFilesErrorCallback;\n    }\n\n    if (minFileSizeErrorCallback) {\n      this.resumable.opts.minFileSizeErrorCallback = this.props.minFileSizeErrorCallback;\n    }\n\n    if (this.maxFileSizeErrorCallback) {\n      this.resumable.opts.maxFileSizeErrorCallback = this.maxFileSizeErrorCallback;\n    }\n\n    if (fileTypeErrorCallback) {\n      this.resumable.opts.fileTypeErrorCallback = this.props.fileTypeErrorCallback;\n    }\n\n  };\n\n  bindEventHandler = () => {\n    this.resumable.on('chunkingComplete', this.onChunkingComplete.bind(this));\n    this.resumable.on('fileAdded', this.onFileAdded.bind(this));\n    this.resumable.on('filesAddedComplete', this.filesAddedComplete.bind(this));\n    this.resumable.on('fileProgress', this.onFileProgress.bind(this));\n    this.resumable.on('fileSuccess', this.onFileUploadSuccess.bind(this));\n    this.resumable.on('progress', this.onProgress.bind(this));\n    this.resumable.on('complete', this.onComplete.bind(this));\n    this.resumable.on('pause', this.onPause.bind(this));\n    this.resumable.on('fileRetry', this.onFileRetry.bind(this));\n    this.resumable.on('fileError', this.onFileError.bind(this));\n    this.resumable.on('error', this.onError.bind(this));\n    this.resumable.on('beforeCancel', this.onBeforeCancel.bind(this));\n    this.resumable.on('cancel', this.onCancel.bind(this));\n    this.resumable.on('dragstart', this.onDragStart.bind(this));\n  };\n\n  maxFilesErrorCallback = (files, errorCount) => {\n    let maxFiles = maxNumberOfFilesForFileupload;\n    let message = gettext('Please upload no more than {maxFiles} files at a time.');\n    message = message.replace('{maxFiles}', maxFiles);\n    toaster.danger(message);\n  };\n\n  maxFileSizeErrorCallback = (file) => {\n    let { forbidUploadFileList } = this.state;\n    forbidUploadFileList.push(file);\n    this.setState({forbidUploadFileList: forbidUploadFileList});\n  };\n\n  onChunkingComplete = (resumableFile) => {\n\n    //get parent_dir relative_path\n    let path = this.props.path === '/' ? '/' : this.props.path + '/';\n    let fileName = resumableFile.fileName;\n    let relativePath = resumableFile.relativePath;\n    let isFile = fileName === relativePath;\n\n    //update formdata\n    resumableFile.formData = {};\n    if (isFile) { // upload file\n      resumableFile.formData  = {\n        parent_dir: path,\n      };\n    } else { // upload folder\n      let relative_path = relativePath.slice(0, relativePath.lastIndexOf('/') + 1);\n      resumableFile.formData  = {\n        parent_dir: path,\n        relative_path: relative_path\n      };\n    }\n  };\n\n  onFileAdded = (resumableFile, files) => {\n    const { isCustomPermission } = this.props;\n    let isFile = resumableFile.fileName === resumableFile.relativePath;\n    // uploading is file and only upload one file\n    if (isFile && files.length === 1) {\n      let hasRepetition = false;\n      if (!isCustomPermission) {\n        let direntList = this.props.direntList;\n        for (let i = 0; i < direntList.length; i++) {\n          if (direntList[i].type === 'file' && direntList[i].name === resumableFile.fileName) {\n            hasRepetition = true;\n            break;\n          }\n        }\n      }\n      if (hasRepetition) {\n        this.setState({\n          isUploadRemindDialogShow: true,\n          currentResumableFile: resumableFile,\n        });\n      } else {\n        this.setUploadFileList(this.resumable.files);\n        let { repoID, path } = this.props;\n        seafileAPI.getFileServerUploadLink(repoID, path).then(res => {\n          this.resumable.opts.target = res.data + '?ret-json=1';\n          this.resumableUpload(resumableFile);\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n    } else {\n      this.setUploadFileList(this.resumable.files);\n      if (!this.isUploadLinkLoaded) {\n        this.isUploadLinkLoaded = true;\n        let { repoID, path } = this.props;\n        seafileAPI.getFileServerUploadLink(repoID, path).then(res => {\n          this.resumable.opts.target = res.data + '?ret-json=1';\n          this.resumable.upload();\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n    }\n  };\n\n  resumableUpload = (resumableFile) => {\n    let { repoID, path } = this.props;\n    seafileAPI.getFileUploadedBytes(repoID, path, resumableFile.fileName).then(res => {\n      let uploadedBytes = res.data.uploadedBytes;\n      let blockSize = parseInt(resumableUploadFileBlockSize) * 1024 * 1024 || 1024 * 1024;\n      let offset = Math.floor(uploadedBytes / blockSize);\n      resumableFile.markChunksCompleted(offset);\n      this.resumable.upload();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  filesAddedComplete = (resumable, files) => {\n    let { forbidUploadFileList } = this.state;\n    if (forbidUploadFileList.length > 0 && files.length === 0) {\n      this.setState({\n        isUploadProgressDialogShow: true,\n        totalProgress: 100\n      });\n    }\n  };\n\n  setUploadFileList = () => {\n    let uploadFileList = this.resumable.files;\n    this.setState({\n      uploadFileList: uploadFileList,\n      isUploadProgressDialogShow: true,\n    });\n    Utils.registerGlobalVariable('uploader', 'isUploadProgressDialogShow', true);\n  };\n\n  onFileProgress = (resumableFile) => {\n    let uploadBitrate = this.getBitrate();\n    let uploadFileList = this.state.uploadFileList.map(item => {\n      if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n        if (uploadBitrate) {\n          let lastSize = (item.size - (item.size * item.progress())) * 8;\n          let time = Math.floor(lastSize / uploadBitrate);\n          item.remainingTime = time;\n        }\n      }\n      return item;\n    });\n\n    this.setState({\n      uploadBitrate: uploadBitrate,\n      uploadFileList: uploadFileList\n    });\n  };\n\n  getBitrate = () => {\n    let loaded = 0;\n    let uploadBitrate = 0;\n    let now = new Date().getTime();\n\n    this.resumable.files.forEach(file => {\n      loaded += file.progress() * file.size;\n    });\n\n    if (this.timestamp) {\n      let timeDiff = (now - this.timestamp);\n      if (timeDiff < this.bitrateInterval) {\n        return this.state.uploadBitrate;\n      }\n\n      // 1. Cancel will produce loaded greater than this.loaded\n      // 2. reset can make this.loaded to be 0\n      if (loaded < this.loaded || this.loaded === 0) {\n        this.loaded = loaded; //\n      }\n\n      uploadBitrate = (loaded - this.loaded) * (1000 / timeDiff) * 8;\n    }\n\n    this.timestamp = now;\n    this.loaded = loaded;\n\n    return uploadBitrate;\n  };\n\n  onProgress = () => {\n    let progress = Math.round(this.resumable.progress() * 100);\n    this.setState({totalProgress: progress});\n    Utils.registerGlobalVariable('uploader', 'totalProgress', progress);\n  };\n\n  onFileUploadSuccess = (resumableFile, message) => {\n    let formData = resumableFile.formData;\n    let currentTime = new Date().getTime()/1000;\n    message = formData.replace ? message : JSON.parse(message)[0];\n    if (formData.relative_path) { // upload folder\n      let relative_path = formData.relative_path;\n      let dir_name = relative_path.slice(0, relative_path.indexOf('/'));\n      let dirent = {\n        id: message.id,\n        name: dir_name,\n        type: 'dir',\n        mtime: currentTime,\n      };\n\n      // update folders cache\n      let isExist = this.notifiedFolders.some(item => {return item.name === dirent.name;});\n      if (!isExist) {\n        this.notifiedFolders.push(dirent);\n        this.props.onFileUploadSuccess(dirent);\n      }\n\n      // update uploadFileList\n      let uploadFileList = this.state.uploadFileList.map(item => {\n        if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n          item.newFileName = relative_path + message.name;\n          item.isSaved = true;\n        }\n        return item;\n      });\n      this.setState({uploadFileList: uploadFileList});\n\n      return;\n    }\n\n    if (formData.replace) { // upload file -- replace exist file\n      let fileName = resumableFile.fileName;\n      let dirent = {\n        id: message,\n        name: fileName,\n        type: 'file',\n        mtime: currentTime\n      };\n      this.props.onFileUploadSuccess(dirent); // this contance: just one file\n\n      let uploadFileList = this.state.uploadFileList.map(item => {\n        if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n          item.newFileName = fileName;\n          item.isSaved = true;\n        }\n        return item;\n      });\n      this.setState({uploadFileList: uploadFileList});\n\n      return;\n    }\n\n    // upload file -- add files\n    let dirent = {\n      id: message.id,\n      type: 'file',\n      name: message.name,\n      size: message.size,\n      mtime: currentTime,\n    };\n    this.props.onFileUploadSuccess(dirent); // this contance:  no repetition file\n\n    let uploadFileList = this.state.uploadFileList.map(item => {\n      if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n        item.newFileName = message.name;\n        item.isSaved = true;\n      }\n      return item;\n    });\n    this.setState({uploadFileList: uploadFileList});\n  };\n\n  getFileServerErrorMessage = (key) => {\n    const errorMessage = {\n      'File locked by others.': gettext('File is locked by others.'),       // 403\n      'Invalid filename.': gettext('Invalid filename.'),                    // 440\n      'File already exists.': gettext('File already exists.'),              // 441\n      'File size is too large.': gettext('File size is too large.'),        // 442\n      'Out of quota.': gettext('Out of quota.'),                            // 443\n      'Internal error.': gettext('Internal Server Error'),                  // 500\n    };\n    return errorMessage[key] || key;\n  };\n\n  onFileError = (resumableFile, message) => {\n    let error = '';\n    if (!message) {\n      error = gettext('Network error');\n    } else {\n      // eg: '{\"error\": \"Internal error\" \\n }'\n      let errorMessage = message.replace(/\\n/g, '');\n      errorMessage  = JSON.parse(errorMessage);\n      error = this.getFileServerErrorMessage(errorMessage.error);\n    }\n\n    let uploadFileList = this.state.uploadFileList.map(item => {\n      if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n        this.state.retryFileList.push(item);\n        item.error = error;\n      }\n      return item;\n    });\n\n    this.loaded = 0;  // reset loaded data;\n    this.setState({\n      retryFileList: this.state.retryFileList,\n      uploadFileList: uploadFileList\n    });\n\n  };\n\n  onComplete = () => {\n    this.notifiedFolders = [];\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n  };\n\n  onPause = () => {\n  };\n\n  onError = (message) => {\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n    // After the error, the user can switch windows\n    Utils.registerGlobalVariable('uploader', 'totalProgress', 100);\n  };\n\n  onFileRetry = () => {\n    // todo, cancel upload file, uploded again;\n  };\n\n  onBeforeCancel = () => {\n    // todo, giving a pop message ?\n  };\n\n  onCancel = () => {\n\n  };\n\n  setHeaders = (resumableFile, resumable) => {\n    let offset = resumable.offset;\n    let chunkSize = resumable.getOpt('chunkSize');\n    let fileSize = resumableFile.size === 0 ? 1 : resumableFile.size;\n    let startByte = offset !== 0 ? offset * chunkSize : 0;\n    let endByte = Math.min(fileSize, (offset + 1) * chunkSize) - 1;\n\n    if (fileSize - resumable.endByte < chunkSize && !resumable.getOpt('forceChunkSize')) {\n      endByte = fileSize;\n    }\n\n    let headers = {\n      'Accept': 'application/json; text/javascript, */*; q=0.01',\n      'Content-Disposition': 'attachment; filename=\"' + encodeURI(resumableFile.fileName) + '\"',\n      'Content-Range': 'bytes ' + startByte + '-' + endByte + '/' + fileSize,\n    };\n\n    return headers;\n  };\n\n  setQuery = (resumableFile) => {\n    let formData = resumableFile.formData;\n    return formData;\n  };\n\n  generateUniqueIdentifier = (file) => {\n    let relativePath = file.webkitRelativePath||file.relativePath||file.fileName||file.name;\n    return MD5(relativePath + new Date()) + relativePath;\n  };\n\n  onClick = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    e.stopPropagation();\n  };\n\n  onFileUpload = () => {\n    this.uploadInput.current.removeAttribute('webkitdirectory');\n\n    this.uploadInput.current.click();\n  };\n\n  onFolderUpload = () => {\n    this.uploadInput.current.setAttribute('webkitdirectory', 'webkitdirectory');\n    this.uploadInput.current.click();\n  };\n\n  onDragStart = () => {\n    this.uploadInput.current.setAttribute('webkitdirectory', 'webkitdirectory');\n  };\n\n  onCloseUploadDialog = () => {\n    this.loaded = 0;\n    this.resumable.files = [];\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n    this.setState({isUploadProgressDialogShow: false, uploadFileList: [], forbidUploadFileList: []});\n    Utils.registerGlobalVariable('uploader', 'isUploadProgressDialogShow', false);\n  };\n\n  onUploadCancel = (uploadingItem) => {\n\n    let uploadFileList = this.state.uploadFileList.filter(item => {\n      if (item.uniqueIdentifier === uploadingItem.uniqueIdentifier) {\n        item.cancel(); // execute cancel function will delete the file at the same time\n        return false;\n      }\n      return true;\n    });\n\n    if (!this.resumable.isUploading()) {\n      this.setState({\n        totalProgress: 100,\n      });\n      this.loaded = 0;\n    }\n\n    this.setState({uploadFileList: uploadFileList});\n  };\n\n  onCancelAllUploading = () => {\n    let uploadFileList = this.state.uploadFileList.filter(item => {\n      if (Math.round(item.progress() !== 1)) {\n        item.cancel();\n        return false;\n      }\n      return true;\n    });\n\n    this.loaded = 0;\n\n    this.setState({\n      totalProgress: 100,\n      uploadFileList: uploadFileList\n    });\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n  };\n\n  onUploadRetry = (resumableFile) => {\n\n    seafileAPI.getFileServerUploadLink(this.props.repoID, this.props.path).then(res => {\n      this.resumable.opts.target = res.data + '?ret-json=1';\n\n      let retryFileList = this.state.retryFileList.filter(item => {\n        return item.uniqueIdentifier !== resumableFile.uniqueIdentifier;\n      });\n      let uploadFileList = this.state.uploadFileList.map(item => {\n        if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n          item.error = null;\n          this.retryUploadFile(item);\n        }\n        return item;\n      });\n\n      this.setState({\n        retryFileList: retryFileList,\n        uploadFileList: uploadFileList\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  onUploadRetryAll = () => {\n\n    seafileAPI.getFileServerUploadLink(this.props.repoID, this.props.path).then(res => {\n      this.resumable.opts.target = res.data + '?ret-json=1';\n      this.state.retryFileList.forEach(item => {\n        item.error = false;\n        this.retryUploadFile(item);\n      });\n\n      let uploadFileList = this.state.uploadFileList.slice(0);\n      this.setState({\n        retryFileList: [],\n        uploadFileList: uploadFileList\n      });\n\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  retryUploadFile = (resumableFile) => {\n    let { repoID, path } = this.props;\n    let fileName = resumableFile.fileName;\n    let isFile = resumableFile.fileName === resumableFile.relativePath;\n    if (!isFile) {\n      let relative_path = resumableFile.formData.relative_path;\n      let prefix = path === '/' ? (path + relative_path) : (path + '/' + relative_path);\n      fileName = prefix + fileName;\n    }\n\n    resumableFile.bootstrap();\n    var firedRetry = false;\n    resumableFile.resumableObj.on('chunkingComplete', () => {\n      if(!firedRetry) {\n        seafileAPI.getFileUploadedBytes(repoID, path, fileName).then(res => {\n          let uploadedBytes = res.data.uploadedBytes;\n          let blockSize = parseInt(resumableUploadFileBlockSize) * 1024 * 1024 || 1024 * 1024;\n          let offset = Math.floor(uploadedBytes / blockSize);\n          resumableFile.markChunksCompleted(offset);\n\n          resumableFile.resumableObj.upload();\n\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n      firedRetry = true;\n    });\n\n  };\n\n  replaceRepetitionFile = () => {\n    let { repoID, path } = this.props;\n    seafileAPI.getUpdateLink(repoID, path).then(res => {\n      this.resumable.opts.target = res.data;\n\n      let resumableFile = this.resumable.files[this.resumable.files.length - 1];\n      resumableFile.formData['replace'] = 1;\n      resumableFile.formData['target_file'] = resumableFile.formData.parent_dir + resumableFile.fileName;\n      this.setState({isUploadRemindDialogShow: false});\n      this.setUploadFileList(this.resumable.files);\n      this.resumable.upload();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  uploadFile = () => {\n    let resumableFile = this.resumable.files[this.resumable.files.length - 1];\n    let { repoID, path } = this.props;\n    seafileAPI.getFileServerUploadLink(repoID, path).then((res) => {  // get upload link\n      this.resumable.opts.target = res.data + '?ret-json=1';\n      this.setState({\n        isUploadRemindDialogShow: false,\n        isUploadProgressDialogShow: true,\n        uploadFileList: [...this.state.uploadFileList, resumableFile]\n      }, () => {\n        this.resumable.upload();\n      });\n      Utils.registerGlobalVariable('uploader', 'isUploadProgressDialogShow', true);\n\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  cancelFileUpload = () => {\n    this.resumable.files.pop(); //delete latest file；\n    this.setState({isUploadRemindDialogShow: false});\n  };\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"file-uploader-container\">\n          <div className=\"file-uploader\">\n            <input className=\"upload-input\" type=\"file\" ref={this.uploadInput} onClick={this.onClick} aria-label={gettext('Upload')} />\n          </div>\n        </div>\n        {this.state.isUploadRemindDialogShow &&\n          <UploadRemindDialog\n            currentResumableFile={this.state.currentResumableFile}\n            replaceRepetitionFile={this.replaceRepetitionFile}\n            uploadFile={this.uploadFile}\n            cancelFileUpload={this.cancelFileUpload}\n          />\n        }\n        {this.state.isUploadProgressDialogShow &&\n          <UploadProgressDialog\n            retryFileList={this.state.retryFileList}\n            uploadFileList={this.state.uploadFileList}\n            forbidUploadFileList={this.state.forbidUploadFileList}\n            totalProgress={this.state.totalProgress}\n            uploadBitrate={this.state.uploadBitrate}\n            onCloseUploadDialog={this.onCloseUploadDialog}\n            onCancelAllUploading={this.onCancelAllUploading}\n            onUploadCancel={this.onUploadCancel}\n            onUploadRetry={this.onUploadRetry}\n            onUploadRetryAll={this.onUploadRetryAll}\n            isUploading={this.resumable.isUploading()}\n          />\n        }\n      </Fragment>\n    );\n  }\n}\n\nFileUploader.propTypes = propTypes;\n\nexport default FileUploader;\n"],"mappings":"44BAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CAEvC,MAAO,CAAAC,WAAW,KAAM,sBAAsB,CAC9C,MAAO,CAAAC,GAAG,KAAM,KAAK,CACrB,OAASC,4BAA4B,CAAEC,iBAAiB,CAAEC,6BAA6B,KAAQ,uBAAuB,CACtH,OAASC,UAAU,KAAQ,yBAAyB,CACpD,OAASC,KAAK,KAAQ,mBAAmB,CACzC,OAASC,OAAO,KAAQ,uBAAuB,CAC/C,MAAO,CAAAC,oBAAoB,KAAM,0BAA0B,CAC3D,MAAO,CAAAC,kBAAkB,KAAM,gCAAgC,CAC/D,MAAO,CAAAC,OAAO,KAAM,UAAU,CAC9B,MAAO,6BAA6B,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,4BAoB/B,CAAAC,YAAY,uBAAAC,gBAAA,EAAAC,SAAA,CAAAF,YAAA,CAAAC,gBAAA,MAAAE,MAAA,CAAAC,YAAA,CAAAJ,YAAA,EAMhB,SAAAA,aAAYK,KAAK,CAAE,KAAAC,KAAA,CAAAC,eAAA,MAAAP,YAAA,EACjBM,KAAA,CAAAH,MAAA,CAAAK,IAAA,MAAMH,KAAK,EAAEC,KAAA,CAsDfG,oBAAoB,CAAG,UAAM,CAC3BC,MAAM,CAACC,cAAc,CAAG,IAAI,CAC5B,GAAIL,KAAA,CAAKD,KAAK,CAACO,WAAW,GAAK,IAAI,CAAE,CACnCN,KAAA,CAAKO,SAAS,CAACC,qBAAqB,CAAC,CAAC,CACxC,CACF,CAAC,CAAAR,KAAA,CAEDK,cAAc,CAAG,UAAM,CACrB,GAAID,MAAM,CAACK,QAAQ,EACfL,MAAM,CAACK,QAAQ,CAACC,0BAA0B,EAC1CN,MAAM,CAACK,QAAQ,CAACE,aAAa,GAAK,GAAG,CAAE,CACzC,MAAO,EAAE,CACX,CACF,CAAC,CAAAX,KAAA,CAEDY,mBAAmB,CAAG,UAAM,CAC1B,IAAAC,WAAA,CAA0Db,KAAA,CAAKD,KAAK,CAA9De,wBAAwB,CAAAD,WAAA,CAAxBC,wBAAwB,CAAEC,qBAAqB,CAAAF,WAAA,CAArBE,qBAAqB,CAErD,GAAIf,KAAA,CAAKgB,qBAAqB,CAAE,CAC9BhB,KAAA,CAAKO,SAAS,CAACU,IAAI,CAACD,qBAAqB,CAAGhB,KAAA,CAAKgB,qBAAqB,CACxE,CAEA,GAAIF,wBAAwB,CAAE,CAC5Bd,KAAA,CAAKO,SAAS,CAACU,IAAI,CAACH,wBAAwB,CAAGd,KAAA,CAAKD,KAAK,CAACe,wBAAwB,CACpF,CAEA,GAAId,KAAA,CAAKkB,wBAAwB,CAAE,CACjClB,KAAA,CAAKO,SAAS,CAACU,IAAI,CAACC,wBAAwB,CAAGlB,KAAA,CAAKkB,wBAAwB,CAC9E,CAEA,GAAIH,qBAAqB,CAAE,CACzBf,KAAA,CAAKO,SAAS,CAACU,IAAI,CAACF,qBAAqB,CAAGf,KAAA,CAAKD,KAAK,CAACgB,qBAAqB,CAC9E,CAEF,CAAC,CAAAf,KAAA,CAEDmB,gBAAgB,CAAG,UAAM,CACvBnB,KAAA,CAAKO,SAAS,CAACa,EAAE,CAAC,kBAAkB,CAAEpB,KAAA,CAAKqB,kBAAkB,CAACC,IAAI,CAAAC,sBAAA,CAAAvB,KAAA,CAAK,CAAC,CAAC,CACzEA,KAAA,CAAKO,SAAS,CAACa,EAAE,CAAC,WAAW,CAAEpB,KAAA,CAAKwB,WAAW,CAACF,IAAI,CAAAC,sBAAA,CAAAvB,KAAA,CAAK,CAAC,CAAC,CAC3DA,KAAA,CAAKO,SAAS,CAACa,EAAE,CAAC,oBAAoB,CAAEpB,KAAA,CAAKyB,kBAAkB,CAACH,IAAI,CAAAC,sBAAA,CAAAvB,KAAA,CAAK,CAAC,CAAC,CAC3EA,KAAA,CAAKO,SAAS,CAACa,EAAE,CAAC,cAAc,CAAEpB,KAAA,CAAK0B,cAAc,CAACJ,IAAI,CAAAC,sBAAA,CAAAvB,KAAA,CAAK,CAAC,CAAC,CACjEA,KAAA,CAAKO,SAAS,CAACa,EAAE,CAAC,aAAa,CAAEpB,KAAA,CAAK2B,mBAAmB,CAACL,IAAI,CAAAC,sBAAA,CAAAvB,KAAA,CAAK,CAAC,CAAC,CACrEA,KAAA,CAAKO,SAAS,CAACa,EAAE,CAAC,UAAU,CAAEpB,KAAA,CAAK4B,UAAU,CAACN,IAAI,CAAAC,sBAAA,CAAAvB,KAAA,CAAK,CAAC,CAAC,CACzDA,KAAA,CAAKO,SAAS,CAACa,EAAE,CAAC,UAAU,CAAEpB,KAAA,CAAK6B,UAAU,CAACP,IAAI,CAAAC,sBAAA,CAAAvB,KAAA,CAAK,CAAC,CAAC,CACzDA,KAAA,CAAKO,SAAS,CAACa,EAAE,CAAC,OAAO,CAAEpB,KAAA,CAAK8B,OAAO,CAACR,IAAI,CAAAC,sBAAA,CAAAvB,KAAA,CAAK,CAAC,CAAC,CACnDA,KAAA,CAAKO,SAAS,CAACa,EAAE,CAAC,WAAW,CAAEpB,KAAA,CAAK+B,WAAW,CAACT,IAAI,CAAAC,sBAAA,CAAAvB,KAAA,CAAK,CAAC,CAAC,CAC3DA,KAAA,CAAKO,SAAS,CAACa,EAAE,CAAC,WAAW,CAAEpB,KAAA,CAAKgC,WAAW,CAACV,IAAI,CAAAC,sBAAA,CAAAvB,KAAA,CAAK,CAAC,CAAC,CAC3DA,KAAA,CAAKO,SAAS,CAACa,EAAE,CAAC,OAAO,CAAEpB,KAAA,CAAKiC,OAAO,CAACX,IAAI,CAAAC,sBAAA,CAAAvB,KAAA,CAAK,CAAC,CAAC,CACnDA,KAAA,CAAKO,SAAS,CAACa,EAAE,CAAC,cAAc,CAAEpB,KAAA,CAAKkC,cAAc,CAACZ,IAAI,CAAAC,sBAAA,CAAAvB,KAAA,CAAK,CAAC,CAAC,CACjEA,KAAA,CAAKO,SAAS,CAACa,EAAE,CAAC,QAAQ,CAAEpB,KAAA,CAAKmC,QAAQ,CAACb,IAAI,CAAAC,sBAAA,CAAAvB,KAAA,CAAK,CAAC,CAAC,CACrDA,KAAA,CAAKO,SAAS,CAACa,EAAE,CAAC,WAAW,CAAEpB,KAAA,CAAKoC,WAAW,CAACd,IAAI,CAAAC,sBAAA,CAAAvB,KAAA,CAAK,CAAC,CAAC,CAC7D,CAAC,CAAAA,KAAA,CAEDgB,qBAAqB,CAAG,SAACqB,KAAK,CAAEC,UAAU,CAAK,CAC7C,GAAI,CAAAC,QAAQ,CAAGxD,6BAA6B,CAC5C,GAAI,CAAAyD,OAAO,CAAGtD,OAAO,CAAC,wDAAwD,CAAC,CAC/EsD,OAAO,CAAGA,OAAO,CAACC,OAAO,CAAC,YAAY,CAAEF,QAAQ,CAAC,CACjDlD,OAAO,CAACqD,MAAM,CAACF,OAAO,CAAC,CACzB,CAAC,CAAAxC,KAAA,CAEDkB,wBAAwB,CAAG,SAACyB,IAAI,CAAK,CACnC,GAAM,CAAAC,oBAAoB,CAAK5C,KAAA,CAAK6C,KAAK,CAAnCD,oBAAoB,CAC1BA,oBAAoB,CAACE,IAAI,CAACH,IAAI,CAAC,CAC/B3C,KAAA,CAAK+C,QAAQ,CAAC,CAACH,oBAAoB,CAAEA,oBAAoB,CAAC,CAAC,CAC7D,CAAC,CAAA5C,KAAA,CAEDqB,kBAAkB,CAAG,SAAC2B,aAAa,CAAK,CAEtC;AACA,GAAI,CAAAC,IAAI,CAAGjD,KAAA,CAAKD,KAAK,CAACkD,IAAI,GAAK,GAAG,CAAG,GAAG,CAAGjD,KAAA,CAAKD,KAAK,CAACkD,IAAI,CAAG,GAAG,CAChE,GAAI,CAAAC,QAAQ,CAAGF,aAAa,CAACE,QAAQ,CACrC,GAAI,CAAAC,YAAY,CAAGH,aAAa,CAACG,YAAY,CAC7C,GAAI,CAAAC,MAAM,CAAGF,QAAQ,GAAKC,YAAY,CAEtC;AACAH,aAAa,CAACK,QAAQ,CAAG,CAAC,CAAC,CAC3B,GAAID,MAAM,CAAE,CAAE;AACZJ,aAAa,CAACK,QAAQ,CAAI,CACxBC,UAAU,CAAEL,IACd,CAAC,CACH,CAAC,IAAM,CAAE;AACP,GAAI,CAAAM,aAAa,CAAGJ,YAAY,CAACK,KAAK,CAAC,CAAC,CAAEL,YAAY,CAACM,WAAW,CAAC,GAAG,CAAC,CAAG,CAAC,CAAC,CAC5ET,aAAa,CAACK,QAAQ,CAAI,CACxBC,UAAU,CAAEL,IAAI,CAChBM,aAAa,CAAEA,aACjB,CAAC,CACH,CACF,CAAC,CAAAvD,KAAA,CAEDwB,WAAW,CAAG,SAACwB,aAAa,CAAEX,KAAK,CAAK,CACtC,GAAQ,CAAAqB,kBAAkB,CAAK1D,KAAA,CAAKD,KAAK,CAAjC2D,kBAAkB,CAC1B,GAAI,CAAAN,MAAM,CAAGJ,aAAa,CAACE,QAAQ,GAAKF,aAAa,CAACG,YAAY,CAClE;AACA,GAAIC,MAAM,EAAIf,KAAK,CAACsB,MAAM,GAAK,CAAC,CAAE,CAChC,GAAI,CAAAC,aAAa,CAAG,KAAK,CACzB,GAAI,CAACF,kBAAkB,CAAE,CACvB,GAAI,CAAAG,UAAU,CAAG7D,KAAA,CAAKD,KAAK,CAAC8D,UAAU,CACtC,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGD,UAAU,CAACF,MAAM,CAAEG,CAAC,EAAE,CAAE,CAC1C,GAAID,UAAU,CAACC,CAAC,CAAC,CAACC,IAAI,GAAK,MAAM,EAAIF,UAAU,CAACC,CAAC,CAAC,CAACE,IAAI,GAAKhB,aAAa,CAACE,QAAQ,CAAE,CAClFU,aAAa,CAAG,IAAI,CACpB,MACF,CACF,CACF,CACA,GAAIA,aAAa,CAAE,CACjB5D,KAAA,CAAK+C,QAAQ,CAAC,CACZkB,wBAAwB,CAAE,IAAI,CAC9BC,oBAAoB,CAAElB,aACxB,CAAC,CAAC,CACJ,CAAC,IAAM,CACLhD,KAAA,CAAKmE,iBAAiB,CAACnE,KAAA,CAAKO,SAAS,CAAC8B,KAAK,CAAC,CAC5C,IAAA+B,YAAA,CAAuBpE,KAAA,CAAKD,KAAK,CAA3BsE,MAAM,CAAAD,YAAA,CAANC,MAAM,CAAEpB,IAAI,CAAAmB,YAAA,CAAJnB,IAAI,CAClBjE,UAAU,CAACsF,uBAAuB,CAACD,MAAM,CAAEpB,IAAI,CAAC,CAACsB,IAAI,CAAC,SAAAC,GAAG,CAAI,CAC3DxE,KAAA,CAAKO,SAAS,CAACU,IAAI,CAACwD,MAAM,CAAGD,GAAG,CAACE,IAAI,CAAG,aAAa,CACrD1E,KAAA,CAAK2E,eAAe,CAAC3B,aAAa,CAAC,CACrC,CAAC,CAAC,CAAC4B,KAAK,CAAC,SAAAC,KAAK,CAAI,CAChB,GAAI,CAAAC,UAAU,CAAG7F,KAAK,CAAC8F,WAAW,CAACF,KAAK,CAAC,CACzCxF,OAAO,CAACqD,MAAM,CAACoC,UAAU,CAAC,CAC5B,CAAC,CAAC,CACJ,CACF,CAAC,IAAM,CACL9E,KAAA,CAAKmE,iBAAiB,CAACnE,KAAA,CAAKO,SAAS,CAAC8B,KAAK,CAAC,CAC5C,GAAI,CAACrC,KAAA,CAAKgF,kBAAkB,CAAE,CAC5BhF,KAAA,CAAKgF,kBAAkB,CAAG,IAAI,CAC9B,IAAAC,YAAA,CAAuBjF,KAAA,CAAKD,KAAK,CAA3BsE,OAAM,CAAAY,YAAA,CAANZ,MAAM,CAAEpB,KAAI,CAAAgC,YAAA,CAAJhC,IAAI,CAClBjE,UAAU,CAACsF,uBAAuB,CAACD,OAAM,CAAEpB,KAAI,CAAC,CAACsB,IAAI,CAAC,SAAAC,GAAG,CAAI,CAC3DxE,KAAA,CAAKO,SAAS,CAACU,IAAI,CAACwD,MAAM,CAAGD,GAAG,CAACE,IAAI,CAAG,aAAa,CACrD1E,KAAA,CAAKO,SAAS,CAAC2E,MAAM,CAAC,CAAC,CACzB,CAAC,CAAC,CAACN,KAAK,CAAC,SAAAC,KAAK,CAAI,CAChB,GAAI,CAAAC,UAAU,CAAG7F,KAAK,CAAC8F,WAAW,CAACF,KAAK,CAAC,CACzCxF,OAAO,CAACqD,MAAM,CAACoC,UAAU,CAAC,CAC5B,CAAC,CAAC,CACJ,CACF,CACF,CAAC,CAAA9E,KAAA,CAED2E,eAAe,CAAG,SAAC3B,aAAa,CAAK,CACnC,IAAAmC,YAAA,CAAuBnF,KAAA,CAAKD,KAAK,CAA3BsE,MAAM,CAAAc,YAAA,CAANd,MAAM,CAAEpB,IAAI,CAAAkC,YAAA,CAAJlC,IAAI,CAClBjE,UAAU,CAACoG,oBAAoB,CAACf,MAAM,CAAEpB,IAAI,CAAED,aAAa,CAACE,QAAQ,CAAC,CAACqB,IAAI,CAAC,SAAAC,GAAG,CAAI,CAChF,GAAI,CAAAa,aAAa,CAAGb,GAAG,CAACE,IAAI,CAACW,aAAa,CAC1C,GAAI,CAAAC,SAAS,CAAGC,QAAQ,CAAC1G,4BAA4B,CAAC,CAAG,IAAI,CAAG,IAAI,EAAI,IAAI,CAAG,IAAI,CACnF,GAAI,CAAA2G,MAAM,CAAGC,IAAI,CAACC,KAAK,CAACL,aAAa,CAAGC,SAAS,CAAC,CAClDtC,aAAa,CAAC2C,mBAAmB,CAACH,MAAM,CAAC,CACzCxF,KAAA,CAAKO,SAAS,CAAC2E,MAAM,CAAC,CAAC,CACzB,CAAC,CAAC,CAACN,KAAK,CAAC,SAAAC,KAAK,CAAI,CAChB,GAAI,CAAAC,UAAU,CAAG7F,KAAK,CAAC8F,WAAW,CAACF,KAAK,CAAC,CACzCxF,OAAO,CAACqD,MAAM,CAACoC,UAAU,CAAC,CAC5B,CAAC,CAAC,CACJ,CAAC,CAAA9E,KAAA,CAEDyB,kBAAkB,CAAG,SAAClB,SAAS,CAAE8B,KAAK,CAAK,CACzC,GAAM,CAAAO,oBAAoB,CAAK5C,KAAA,CAAK6C,KAAK,CAAnCD,oBAAoB,CAC1B,GAAIA,oBAAoB,CAACe,MAAM,CAAG,CAAC,EAAItB,KAAK,CAACsB,MAAM,GAAK,CAAC,CAAE,CACzD3D,KAAA,CAAK+C,QAAQ,CAAC,CACZrC,0BAA0B,CAAE,IAAI,CAChCC,aAAa,CAAE,GACjB,CAAC,CAAC,CACJ,CACF,CAAC,CAAAX,KAAA,CAEDmE,iBAAiB,CAAG,UAAM,CACxB,GAAI,CAAAyB,cAAc,CAAG5F,KAAA,CAAKO,SAAS,CAAC8B,KAAK,CACzCrC,KAAA,CAAK+C,QAAQ,CAAC,CACZ6C,cAAc,CAAEA,cAAc,CAC9BlF,0BAA0B,CAAE,IAC9B,CAAC,CAAC,CACFzB,KAAK,CAAC4G,sBAAsB,CAAC,UAAU,CAAE,4BAA4B,CAAE,IAAI,CAAC,CAC9E,CAAC,CAAA7F,KAAA,CAED0B,cAAc,CAAG,SAACsB,aAAa,CAAK,CAClC,GAAI,CAAA8C,aAAa,CAAG9F,KAAA,CAAK+F,UAAU,CAAC,CAAC,CACrC,GAAI,CAAAH,cAAc,CAAG5F,KAAA,CAAK6C,KAAK,CAAC+C,cAAc,CAACI,GAAG,CAAC,SAAAC,IAAI,CAAI,CACzD,GAAIA,IAAI,CAACC,gBAAgB,GAAKlD,aAAa,CAACkD,gBAAgB,CAAE,CAC5D,GAAIJ,aAAa,CAAE,CACjB,GAAI,CAAAK,QAAQ,CAAG,CAACF,IAAI,CAACG,IAAI,CAAIH,IAAI,CAACG,IAAI,CAAGH,IAAI,CAACI,QAAQ,CAAC,CAAE,EAAI,CAAC,CAC9D,GAAI,CAAAC,IAAI,CAAGb,IAAI,CAACC,KAAK,CAACS,QAAQ,CAAGL,aAAa,CAAC,CAC/CG,IAAI,CAACM,aAAa,CAAGD,IAAI,CAC3B,CACF,CACA,MAAO,CAAAL,IAAI,CACb,CAAC,CAAC,CAEFjG,KAAA,CAAK+C,QAAQ,CAAC,CACZ+C,aAAa,CAAEA,aAAa,CAC5BF,cAAc,CAAEA,cAClB,CAAC,CAAC,CACJ,CAAC,CAAA5F,KAAA,CAED+F,UAAU,CAAG,UAAM,CACjB,GAAI,CAAAS,MAAM,CAAG,CAAC,CACd,GAAI,CAAAV,aAAa,CAAG,CAAC,CACrB,GAAI,CAAAW,GAAG,CAAG,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAE9B3G,KAAA,CAAKO,SAAS,CAAC8B,KAAK,CAACuE,OAAO,CAAC,SAAAjE,IAAI,CAAI,CACnC6D,MAAM,EAAI7D,IAAI,CAAC0D,QAAQ,CAAC,CAAC,CAAG1D,IAAI,CAACyD,IAAI,CACvC,CAAC,CAAC,CAEF,GAAIpG,KAAA,CAAK6G,SAAS,CAAE,CAClB,GAAI,CAAAC,QAAQ,CAAIL,GAAG,CAAGzG,KAAA,CAAK6G,SAAU,CACrC,GAAIC,QAAQ,CAAG9G,KAAA,CAAK+G,eAAe,CAAE,CACnC,MAAO,CAAA/G,KAAA,CAAK6C,KAAK,CAACiD,aAAa,CACjC,CAEA;AACA;AACA,GAAIU,MAAM,CAAGxG,KAAA,CAAKwG,MAAM,EAAIxG,KAAA,CAAKwG,MAAM,GAAK,CAAC,CAAE,CAC7CxG,KAAA,CAAKwG,MAAM,CAAGA,MAAM,CAAE;AACxB,CAEAV,aAAa,CAAG,CAACU,MAAM,CAAGxG,KAAA,CAAKwG,MAAM,GAAK,IAAI,CAAGM,QAAQ,CAAC,CAAG,CAAC,CAChE,CAEA9G,KAAA,CAAK6G,SAAS,CAAGJ,GAAG,CACpBzG,KAAA,CAAKwG,MAAM,CAAGA,MAAM,CAEpB,MAAO,CAAAV,aAAa,CACtB,CAAC,CAAA9F,KAAA,CAED4B,UAAU,CAAG,UAAM,CACjB,GAAI,CAAAyE,QAAQ,CAAGZ,IAAI,CAACuB,KAAK,CAAChH,KAAA,CAAKO,SAAS,CAAC8F,QAAQ,CAAC,CAAC,CAAG,GAAG,CAAC,CAC1DrG,KAAA,CAAK+C,QAAQ,CAAC,CAACpC,aAAa,CAAE0F,QAAQ,CAAC,CAAC,CACxCpH,KAAK,CAAC4G,sBAAsB,CAAC,UAAU,CAAE,eAAe,CAAEQ,QAAQ,CAAC,CACrE,CAAC,CAAArG,KAAA,CAED2B,mBAAmB,CAAG,SAACqB,aAAa,CAAER,OAAO,CAAK,CAChD,GAAI,CAAAa,QAAQ,CAAGL,aAAa,CAACK,QAAQ,CACrC,GAAI,CAAA4D,WAAW,CAAG,GAAI,CAAAP,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC,IAAI,CAC3CnE,OAAO,CAAGa,QAAQ,CAACZ,OAAO,CAAGD,OAAO,CAAG0E,IAAI,CAACC,KAAK,CAAC3E,OAAO,CAAC,CAAC,CAAC,CAAC,CAC7D,GAAIa,QAAQ,CAACE,aAAa,CAAE,CAAE;AAC5B,GAAI,CAAAA,aAAa,CAAGF,QAAQ,CAACE,aAAa,CAC1C,GAAI,CAAA6D,QAAQ,CAAG7D,aAAa,CAACC,KAAK,CAAC,CAAC,CAAED,aAAa,CAAC8D,OAAO,CAAC,GAAG,CAAC,CAAC,CACjE,GAAI,CAAAC,OAAM,CAAG,CACXC,EAAE,CAAE/E,OAAO,CAAC+E,EAAE,CACdvD,IAAI,CAAEoD,QAAQ,CACdrD,IAAI,CAAE,KAAK,CACXyD,KAAK,CAAEP,WACT,CAAC,CAED;AACA,GAAI,CAAAQ,OAAO,CAAGzH,KAAA,CAAK0H,eAAe,CAACC,IAAI,CAAC,SAAA1B,IAAI,CAAI,CAAC,MAAO,CAAAA,IAAI,CAACjC,IAAI,GAAKsD,OAAM,CAACtD,IAAI,CAAC,CAAC,CAAC,CACpF,GAAI,CAACyD,OAAO,CAAE,CACZzH,KAAA,CAAK0H,eAAe,CAAC5E,IAAI,CAACwE,OAAM,CAAC,CACjCtH,KAAA,CAAKD,KAAK,CAAC4B,mBAAmB,CAAC2F,OAAM,CAAC,CACxC,CAEA;AACA,GAAI,CAAA1B,eAAc,CAAG5F,KAAA,CAAK6C,KAAK,CAAC+C,cAAc,CAACI,GAAG,CAAC,SAAAC,IAAI,CAAI,CACzD,GAAIA,IAAI,CAACC,gBAAgB,GAAKlD,aAAa,CAACkD,gBAAgB,CAAE,CAC5DD,IAAI,CAAC2B,WAAW,CAAGrE,aAAa,CAAGf,OAAO,CAACwB,IAAI,CAC/CiC,IAAI,CAAC4B,OAAO,CAAG,IAAI,CACrB,CACA,MAAO,CAAA5B,IAAI,CACb,CAAC,CAAC,CACFjG,KAAA,CAAK+C,QAAQ,CAAC,CAAC6C,cAAc,CAAEA,eAAc,CAAC,CAAC,CAE/C,OACF,CAEA,GAAIvC,QAAQ,CAACZ,OAAO,CAAE,CAAE;AACtB,GAAI,CAAAS,QAAQ,CAAGF,aAAa,CAACE,QAAQ,CACrC,GAAI,CAAAoE,QAAM,CAAG,CACXC,EAAE,CAAE/E,OAAO,CACXwB,IAAI,CAAEd,QAAQ,CACda,IAAI,CAAE,MAAM,CACZyD,KAAK,CAAEP,WACT,CAAC,CACDjH,KAAA,CAAKD,KAAK,CAAC4B,mBAAmB,CAAC2F,QAAM,CAAC,CAAE;AAExC,GAAI,CAAA1B,gBAAc,CAAG5F,KAAA,CAAK6C,KAAK,CAAC+C,cAAc,CAACI,GAAG,CAAC,SAAAC,IAAI,CAAI,CACzD,GAAIA,IAAI,CAACC,gBAAgB,GAAKlD,aAAa,CAACkD,gBAAgB,CAAE,CAC5DD,IAAI,CAAC2B,WAAW,CAAG1E,QAAQ,CAC3B+C,IAAI,CAAC4B,OAAO,CAAG,IAAI,CACrB,CACA,MAAO,CAAA5B,IAAI,CACb,CAAC,CAAC,CACFjG,KAAA,CAAK+C,QAAQ,CAAC,CAAC6C,cAAc,CAAEA,gBAAc,CAAC,CAAC,CAE/C,OACF,CAEA;AACA,GAAI,CAAA0B,MAAM,CAAG,CACXC,EAAE,CAAE/E,OAAO,CAAC+E,EAAE,CACdxD,IAAI,CAAE,MAAM,CACZC,IAAI,CAAExB,OAAO,CAACwB,IAAI,CAClBoC,IAAI,CAAE5D,OAAO,CAAC4D,IAAI,CAClBoB,KAAK,CAAEP,WACT,CAAC,CACDjH,KAAA,CAAKD,KAAK,CAAC4B,mBAAmB,CAAC2F,MAAM,CAAC,CAAE;AAExC,GAAI,CAAA1B,cAAc,CAAG5F,KAAA,CAAK6C,KAAK,CAAC+C,cAAc,CAACI,GAAG,CAAC,SAAAC,IAAI,CAAI,CACzD,GAAIA,IAAI,CAACC,gBAAgB,GAAKlD,aAAa,CAACkD,gBAAgB,CAAE,CAC5DD,IAAI,CAAC2B,WAAW,CAAGpF,OAAO,CAACwB,IAAI,CAC/BiC,IAAI,CAAC4B,OAAO,CAAG,IAAI,CACrB,CACA,MAAO,CAAA5B,IAAI,CACb,CAAC,CAAC,CACFjG,KAAA,CAAK+C,QAAQ,CAAC,CAAC6C,cAAc,CAAEA,cAAc,CAAC,CAAC,CACjD,CAAC,CAAA5F,KAAA,CAED8H,yBAAyB,CAAG,SAACC,GAAG,CAAK,CACnC,GAAM,CAAAC,YAAY,CAAG,CACnB,wBAAwB,CAAE9I,OAAO,CAAC,2BAA2B,CAAC,CAAQ;AACtE,mBAAmB,CAAEA,OAAO,CAAC,mBAAmB,CAAC,CAAqB;AACtE,sBAAsB,CAAEA,OAAO,CAAC,sBAAsB,CAAC,CAAe;AACtE,yBAAyB,CAAEA,OAAO,CAAC,yBAAyB,CAAC,CAAS;AACtE,eAAe,CAAEA,OAAO,CAAC,eAAe,CAAC,CAA6B;AACtE,iBAAiB,CAAEA,OAAO,CAAC,uBAAuB,CAAoB;AACxE,CAAC,CACD,MAAO,CAAA8I,YAAY,CAACD,GAAG,CAAC,EAAIA,GAAG,CACjC,CAAC,CAAA/H,KAAA,CAEDgC,WAAW,CAAG,SAACgB,aAAa,CAAER,OAAO,CAAK,CACxC,GAAI,CAAAqC,KAAK,CAAG,EAAE,CACd,GAAI,CAACrC,OAAO,CAAE,CACZqC,KAAK,CAAG3F,OAAO,CAAC,eAAe,CAAC,CAClC,CAAC,IAAM,CACL;AACA,GAAI,CAAA8I,YAAY,CAAGxF,OAAO,CAACC,OAAO,CAAC,KAAK,CAAE,EAAE,CAAC,CAC7CuF,YAAY,CAAId,IAAI,CAACC,KAAK,CAACa,YAAY,CAAC,CACxCnD,KAAK,CAAG7E,KAAA,CAAK8H,yBAAyB,CAACE,YAAY,CAACnD,KAAK,CAAC,CAC5D,CAEA,GAAI,CAAAe,cAAc,CAAG5F,KAAA,CAAK6C,KAAK,CAAC+C,cAAc,CAACI,GAAG,CAAC,SAAAC,IAAI,CAAI,CACzD,GAAIA,IAAI,CAACC,gBAAgB,GAAKlD,aAAa,CAACkD,gBAAgB,CAAE,CAC5DlG,KAAA,CAAK6C,KAAK,CAACoF,aAAa,CAACnF,IAAI,CAACmD,IAAI,CAAC,CACnCA,IAAI,CAACpB,KAAK,CAAGA,KAAK,CACpB,CACA,MAAO,CAAAoB,IAAI,CACb,CAAC,CAAC,CAEFjG,KAAA,CAAKwG,MAAM,CAAG,CAAC,CAAG;AAClBxG,KAAA,CAAK+C,QAAQ,CAAC,CACZkF,aAAa,CAAEjI,KAAA,CAAK6C,KAAK,CAACoF,aAAa,CACvCrC,cAAc,CAAEA,cAClB,CAAC,CAAC,CAEJ,CAAC,CAAA5F,KAAA,CAED6B,UAAU,CAAG,UAAM,CACjB7B,KAAA,CAAK0H,eAAe,CAAG,EAAE,CACzB;AACA1H,KAAA,CAAKgF,kBAAkB,CAAG,KAAK,CACjC,CAAC,CAAAhF,KAAA,CAED8B,OAAO,CAAG,UAAM,CAChB,CAAC,CAAA9B,KAAA,CAEDiC,OAAO,CAAG,SAACO,OAAO,CAAK,CACrB;AACAxC,KAAA,CAAKgF,kBAAkB,CAAG,KAAK,CAC/B;AACA/F,KAAK,CAAC4G,sBAAsB,CAAC,UAAU,CAAE,eAAe,CAAE,GAAG,CAAC,CAChE,CAAC,CAAA7F,KAAA,CAED+B,WAAW,CAAG,UAAM,CAClB;AAAA,CACD,CAAA/B,KAAA,CAEDkC,cAAc,CAAG,UAAM,CACrB;AAAA,CACD,CAAAlC,KAAA,CAEDmC,QAAQ,CAAG,UAAM,CAEjB,CAAC,CAAAnC,KAAA,CAEDkI,UAAU,CAAG,SAAClF,aAAa,CAAEzC,SAAS,CAAK,CACzC,GAAI,CAAAiF,MAAM,CAAGjF,SAAS,CAACiF,MAAM,CAC7B,GAAI,CAAA2C,SAAS,CAAG5H,SAAS,CAAC6H,MAAM,CAAC,WAAW,CAAC,CAC7C,GAAI,CAAAC,QAAQ,CAAGrF,aAAa,CAACoD,IAAI,GAAK,CAAC,CAAG,CAAC,CAAGpD,aAAa,CAACoD,IAAI,CAChE,GAAI,CAAAkC,SAAS,CAAG9C,MAAM,GAAK,CAAC,CAAGA,MAAM,CAAG2C,SAAS,CAAG,CAAC,CACrD,GAAI,CAAAI,OAAO,CAAG9C,IAAI,CAAC+C,GAAG,CAACH,QAAQ,CAAE,CAAC7C,MAAM,CAAG,CAAC,EAAI2C,SAAS,CAAC,CAAG,CAAC,CAE9D,GAAIE,QAAQ,CAAG9H,SAAS,CAACgI,OAAO,CAAGJ,SAAS,EAAI,CAAC5H,SAAS,CAAC6H,MAAM,CAAC,gBAAgB,CAAC,CAAE,CACnFG,OAAO,CAAGF,QAAQ,CACpB,CAEA,GAAI,CAAAI,OAAO,CAAG,CACZ,QAAQ,CAAE,gDAAgD,CAC1D,qBAAqB,CAAE,wBAAwB,CAAGC,SAAS,CAAC1F,aAAa,CAACE,QAAQ,CAAC,CAAG,GAAG,CACzF,eAAe,CAAE,QAAQ,CAAGoF,SAAS,CAAG,GAAG,CAAGC,OAAO,CAAG,GAAG,CAAGF,QAChE,CAAC,CAED,MAAO,CAAAI,OAAO,CAChB,CAAC,CAAAzI,KAAA,CAED2I,QAAQ,CAAG,SAAC3F,aAAa,CAAK,CAC5B,GAAI,CAAAK,QAAQ,CAAGL,aAAa,CAACK,QAAQ,CACrC,MAAO,CAAAA,QAAQ,CACjB,CAAC,CAAArD,KAAA,CAED4I,wBAAwB,CAAG,SAACjG,IAAI,CAAK,CACnC,GAAI,CAAAQ,YAAY,CAAGR,IAAI,CAACkG,kBAAkB,EAAElG,IAAI,CAACQ,YAAY,EAAER,IAAI,CAACO,QAAQ,EAAEP,IAAI,CAACqB,IAAI,CACvF,MAAO,CAAApF,GAAG,CAACuE,YAAY,CAAG,GAAI,CAAAuD,IAAI,CAAC,CAAC,CAAC,CAAGvD,YAAY,CACtD,CAAC,CAAAnD,KAAA,CAED8I,OAAO,CAAG,SAACC,CAAC,CAAK,CACfA,CAAC,CAACC,WAAW,CAACC,wBAAwB,CAAC,CAAC,CACxCF,CAAC,CAACG,eAAe,CAAC,CAAC,CACrB,CAAC,CAAAlJ,KAAA,CAEDmJ,YAAY,CAAG,UAAM,CACnBnJ,KAAA,CAAKoJ,WAAW,CAACC,OAAO,CAACC,eAAe,CAAC,iBAAiB,CAAC,CAE3DtJ,KAAA,CAAKoJ,WAAW,CAACC,OAAO,CAACE,KAAK,CAAC,CAAC,CAClC,CAAC,CAAAvJ,KAAA,CAEDwJ,cAAc,CAAG,UAAM,CACrBxJ,KAAA,CAAKoJ,WAAW,CAACC,OAAO,CAACI,YAAY,CAAC,iBAAiB,CAAE,iBAAiB,CAAC,CAC3EzJ,KAAA,CAAKoJ,WAAW,CAACC,OAAO,CAACE,KAAK,CAAC,CAAC,CAClC,CAAC,CAAAvJ,KAAA,CAEDoC,WAAW,CAAG,UAAM,CAClBpC,KAAA,CAAKoJ,WAAW,CAACC,OAAO,CAACI,YAAY,CAAC,iBAAiB,CAAE,iBAAiB,CAAC,CAC7E,CAAC,CAAAzJ,KAAA,CAED0J,mBAAmB,CAAG,UAAM,CAC1B1J,KAAA,CAAKwG,MAAM,CAAG,CAAC,CACfxG,KAAA,CAAKO,SAAS,CAAC8B,KAAK,CAAG,EAAE,CACzB;AACArC,KAAA,CAAKgF,kBAAkB,CAAG,KAAK,CAC/BhF,KAAA,CAAK+C,QAAQ,CAAC,CAACrC,0BAA0B,CAAE,KAAK,CAAEkF,cAAc,CAAE,EAAE,CAAEhD,oBAAoB,CAAE,EAAE,CAAC,CAAC,CAChG3D,KAAK,CAAC4G,sBAAsB,CAAC,UAAU,CAAE,4BAA4B,CAAE,KAAK,CAAC,CAC/E,CAAC,CAAA7F,KAAA,CAED2J,cAAc,CAAG,SAACC,aAAa,CAAK,CAElC,GAAI,CAAAhE,cAAc,CAAG5F,KAAA,CAAK6C,KAAK,CAAC+C,cAAc,CAACiE,MAAM,CAAC,SAAA5D,IAAI,CAAI,CAC5D,GAAIA,IAAI,CAACC,gBAAgB,GAAK0D,aAAa,CAAC1D,gBAAgB,CAAE,CAC5DD,IAAI,CAAC6D,MAAM,CAAC,CAAC,CAAE;AACf,MAAO,MAAK,CACd,CACA,MAAO,KAAI,CACb,CAAC,CAAC,CAEF,GAAI,CAAC9J,KAAA,CAAKO,SAAS,CAACwJ,WAAW,CAAC,CAAC,CAAE,CACjC/J,KAAA,CAAK+C,QAAQ,CAAC,CACZpC,aAAa,CAAE,GACjB,CAAC,CAAC,CACFX,KAAA,CAAKwG,MAAM,CAAG,CAAC,CACjB,CAEAxG,KAAA,CAAK+C,QAAQ,CAAC,CAAC6C,cAAc,CAAEA,cAAc,CAAC,CAAC,CACjD,CAAC,CAAA5F,KAAA,CAEDgK,oBAAoB,CAAG,UAAM,CAC3B,GAAI,CAAApE,cAAc,CAAG5F,KAAA,CAAK6C,KAAK,CAAC+C,cAAc,CAACiE,MAAM,CAAC,SAAA5D,IAAI,CAAI,CAC5D,GAAIR,IAAI,CAACuB,KAAK,CAACf,IAAI,CAACI,QAAQ,CAAC,CAAC,GAAK,CAAC,CAAC,CAAE,CACrCJ,IAAI,CAAC6D,MAAM,CAAC,CAAC,CACb,MAAO,MAAK,CACd,CACA,MAAO,KAAI,CACb,CAAC,CAAC,CAEF9J,KAAA,CAAKwG,MAAM,CAAG,CAAC,CAEfxG,KAAA,CAAK+C,QAAQ,CAAC,CACZpC,aAAa,CAAE,GAAG,CAClBiF,cAAc,CAAEA,cAClB,CAAC,CAAC,CACF;AACA5F,KAAA,CAAKgF,kBAAkB,CAAG,KAAK,CACjC,CAAC,CAAAhF,KAAA,CAEDiK,aAAa,CAAG,SAACjH,aAAa,CAAK,CAEjChE,UAAU,CAACsF,uBAAuB,CAACtE,KAAA,CAAKD,KAAK,CAACsE,MAAM,CAAErE,KAAA,CAAKD,KAAK,CAACkD,IAAI,CAAC,CAACsB,IAAI,CAAC,SAAAC,GAAG,CAAI,CACjFxE,KAAA,CAAKO,SAAS,CAACU,IAAI,CAACwD,MAAM,CAAGD,GAAG,CAACE,IAAI,CAAG,aAAa,CAErD,GAAI,CAAAuD,aAAa,CAAGjI,KAAA,CAAK6C,KAAK,CAACoF,aAAa,CAAC4B,MAAM,CAAC,SAAA5D,IAAI,CAAI,CAC1D,MAAO,CAAAA,IAAI,CAACC,gBAAgB,GAAKlD,aAAa,CAACkD,gBAAgB,CACjE,CAAC,CAAC,CACF,GAAI,CAAAN,cAAc,CAAG5F,KAAA,CAAK6C,KAAK,CAAC+C,cAAc,CAACI,GAAG,CAAC,SAAAC,IAAI,CAAI,CACzD,GAAIA,IAAI,CAACC,gBAAgB,GAAKlD,aAAa,CAACkD,gBAAgB,CAAE,CAC5DD,IAAI,CAACpB,KAAK,CAAG,IAAI,CACjB7E,KAAA,CAAKkK,eAAe,CAACjE,IAAI,CAAC,CAC5B,CACA,MAAO,CAAAA,IAAI,CACb,CAAC,CAAC,CAEFjG,KAAA,CAAK+C,QAAQ,CAAC,CACZkF,aAAa,CAAEA,aAAa,CAC5BrC,cAAc,CAAEA,cAClB,CAAC,CAAC,CACJ,CAAC,CAAC,CAAChB,KAAK,CAAC,SAAAC,KAAK,CAAI,CAChB,GAAI,CAAAC,UAAU,CAAG7F,KAAK,CAAC8F,WAAW,CAACF,KAAK,CAAC,CACzCxF,OAAO,CAACqD,MAAM,CAACoC,UAAU,CAAC,CAC5B,CAAC,CAAC,CACJ,CAAC,CAAA9E,KAAA,CAEDmK,gBAAgB,CAAG,UAAM,CAEvBnL,UAAU,CAACsF,uBAAuB,CAACtE,KAAA,CAAKD,KAAK,CAACsE,MAAM,CAAErE,KAAA,CAAKD,KAAK,CAACkD,IAAI,CAAC,CAACsB,IAAI,CAAC,SAAAC,GAAG,CAAI,CACjFxE,KAAA,CAAKO,SAAS,CAACU,IAAI,CAACwD,MAAM,CAAGD,GAAG,CAACE,IAAI,CAAG,aAAa,CACrD1E,KAAA,CAAK6C,KAAK,CAACoF,aAAa,CAACrB,OAAO,CAAC,SAAAX,IAAI,CAAI,CACvCA,IAAI,CAACpB,KAAK,CAAG,KAAK,CAClB7E,KAAA,CAAKkK,eAAe,CAACjE,IAAI,CAAC,CAC5B,CAAC,CAAC,CAEF,GAAI,CAAAL,cAAc,CAAG5F,KAAA,CAAK6C,KAAK,CAAC+C,cAAc,CAACpC,KAAK,CAAC,CAAC,CAAC,CACvDxD,KAAA,CAAK+C,QAAQ,CAAC,CACZkF,aAAa,CAAE,EAAE,CACjBrC,cAAc,CAAEA,cAClB,CAAC,CAAC,CAEJ,CAAC,CAAC,CAAChB,KAAK,CAAC,SAAAC,KAAK,CAAI,CAChB,GAAI,CAAAC,UAAU,CAAG7F,KAAK,CAAC8F,WAAW,CAACF,KAAK,CAAC,CACzCxF,OAAO,CAACqD,MAAM,CAACoC,UAAU,CAAC,CAC5B,CAAC,CAAC,CACJ,CAAC,CAAA9E,KAAA,CAEDkK,eAAe,CAAG,SAAClH,aAAa,CAAK,CACnC,IAAAoH,YAAA,CAAuBpK,KAAA,CAAKD,KAAK,CAA3BsE,MAAM,CAAA+F,YAAA,CAAN/F,MAAM,CAAEpB,IAAI,CAAAmH,YAAA,CAAJnH,IAAI,CAClB,GAAI,CAAAC,QAAQ,CAAGF,aAAa,CAACE,QAAQ,CACrC,GAAI,CAAAE,MAAM,CAAGJ,aAAa,CAACE,QAAQ,GAAKF,aAAa,CAACG,YAAY,CAClE,GAAI,CAACC,MAAM,CAAE,CACX,GAAI,CAAAG,aAAa,CAAGP,aAAa,CAACK,QAAQ,CAACE,aAAa,CACxD,GAAI,CAAA8G,MAAM,CAAGpH,IAAI,GAAK,GAAG,CAAIA,IAAI,CAAGM,aAAa,CAAKN,IAAI,CAAG,GAAG,CAAGM,aAAc,CACjFL,QAAQ,CAAGmH,MAAM,CAAGnH,QAAQ,CAC9B,CAEAF,aAAa,CAACsH,SAAS,CAAC,CAAC,CACzB,GAAI,CAAAC,UAAU,CAAG,KAAK,CACtBvH,aAAa,CAACwH,YAAY,CAACpJ,EAAE,CAAC,kBAAkB,CAAE,UAAM,CACtD,GAAG,CAACmJ,UAAU,CAAE,CACdvL,UAAU,CAACoG,oBAAoB,CAACf,MAAM,CAAEpB,IAAI,CAAEC,QAAQ,CAAC,CAACqB,IAAI,CAAC,SAAAC,GAAG,CAAI,CAClE,GAAI,CAAAa,aAAa,CAAGb,GAAG,CAACE,IAAI,CAACW,aAAa,CAC1C,GAAI,CAAAC,SAAS,CAAGC,QAAQ,CAAC1G,4BAA4B,CAAC,CAAG,IAAI,CAAG,IAAI,EAAI,IAAI,CAAG,IAAI,CACnF,GAAI,CAAA2G,MAAM,CAAGC,IAAI,CAACC,KAAK,CAACL,aAAa,CAAGC,SAAS,CAAC,CAClDtC,aAAa,CAAC2C,mBAAmB,CAACH,MAAM,CAAC,CAEzCxC,aAAa,CAACwH,YAAY,CAACtF,MAAM,CAAC,CAAC,CAErC,CAAC,CAAC,CAACN,KAAK,CAAC,SAAAC,KAAK,CAAI,CAChB,GAAI,CAAAC,UAAU,CAAG7F,KAAK,CAAC8F,WAAW,CAACF,KAAK,CAAC,CACzCxF,OAAO,CAACqD,MAAM,CAACoC,UAAU,CAAC,CAC5B,CAAC,CAAC,CACJ,CACAyF,UAAU,CAAG,IAAI,CACnB,CAAC,CAAC,CAEJ,CAAC,CAAAvK,KAAA,CAEDyK,qBAAqB,CAAG,UAAM,CAC5B,IAAAC,YAAA,CAAuB1K,KAAA,CAAKD,KAAK,CAA3BsE,MAAM,CAAAqG,YAAA,CAANrG,MAAM,CAAEpB,IAAI,CAAAyH,YAAA,CAAJzH,IAAI,CAClBjE,UAAU,CAAC2L,aAAa,CAACtG,MAAM,CAAEpB,IAAI,CAAC,CAACsB,IAAI,CAAC,SAAAC,GAAG,CAAI,CACjDxE,KAAA,CAAKO,SAAS,CAACU,IAAI,CAACwD,MAAM,CAAGD,GAAG,CAACE,IAAI,CAErC,GAAI,CAAA1B,aAAa,CAAGhD,KAAA,CAAKO,SAAS,CAAC8B,KAAK,CAACrC,KAAA,CAAKO,SAAS,CAAC8B,KAAK,CAACsB,MAAM,CAAG,CAAC,CAAC,CACzEX,aAAa,CAACK,QAAQ,CAAC,SAAS,CAAC,CAAG,CAAC,CACrCL,aAAa,CAACK,QAAQ,CAAC,aAAa,CAAC,CAAGL,aAAa,CAACK,QAAQ,CAACC,UAAU,CAAGN,aAAa,CAACE,QAAQ,CAClGlD,KAAA,CAAK+C,QAAQ,CAAC,CAACkB,wBAAwB,CAAE,KAAK,CAAC,CAAC,CAChDjE,KAAA,CAAKmE,iBAAiB,CAACnE,KAAA,CAAKO,SAAS,CAAC8B,KAAK,CAAC,CAC5CrC,KAAA,CAAKO,SAAS,CAAC2E,MAAM,CAAC,CAAC,CACzB,CAAC,CAAC,CAACN,KAAK,CAAC,SAAAC,KAAK,CAAI,CAChB,GAAI,CAAAC,UAAU,CAAG7F,KAAK,CAAC8F,WAAW,CAACF,KAAK,CAAC,CACzCxF,OAAO,CAACqD,MAAM,CAACoC,UAAU,CAAC,CAC5B,CAAC,CAAC,CACJ,CAAC,CAAA9E,KAAA,CAED4K,UAAU,CAAG,UAAM,CACjB,GAAI,CAAA5H,aAAa,CAAGhD,KAAA,CAAKO,SAAS,CAAC8B,KAAK,CAACrC,KAAA,CAAKO,SAAS,CAAC8B,KAAK,CAACsB,MAAM,CAAG,CAAC,CAAC,CACzE,IAAAkH,YAAA,CAAuB7K,KAAA,CAAKD,KAAK,CAA3BsE,MAAM,CAAAwG,YAAA,CAANxG,MAAM,CAAEpB,IAAI,CAAA4H,YAAA,CAAJ5H,IAAI,CAClBjE,UAAU,CAACsF,uBAAuB,CAACD,MAAM,CAAEpB,IAAI,CAAC,CAACsB,IAAI,CAAC,SAACC,GAAG,CAAK,CAAG;AAChExE,KAAA,CAAKO,SAAS,CAACU,IAAI,CAACwD,MAAM,CAAGD,GAAG,CAACE,IAAI,CAAG,aAAa,CACrD1E,KAAA,CAAK+C,QAAQ,CAAC,CACZkB,wBAAwB,CAAE,KAAK,CAC/BvD,0BAA0B,CAAE,IAAI,CAChCkF,cAAc,IAAAkF,MAAA,CAAAC,kBAAA,CAAM/K,KAAA,CAAK6C,KAAK,CAAC+C,cAAc,GAAE5C,aAAa,EAC9D,CAAC,CAAE,UAAM,CACPhD,KAAA,CAAKO,SAAS,CAAC2E,MAAM,CAAC,CAAC,CACzB,CAAC,CAAC,CACFjG,KAAK,CAAC4G,sBAAsB,CAAC,UAAU,CAAE,4BAA4B,CAAE,IAAI,CAAC,CAE9E,CAAC,CAAC,CAACjB,KAAK,CAAC,SAAAC,KAAK,CAAI,CAChB,GAAI,CAAAC,UAAU,CAAG7F,KAAK,CAAC8F,WAAW,CAACF,KAAK,CAAC,CACzCxF,OAAO,CAACqD,MAAM,CAACoC,UAAU,CAAC,CAC5B,CAAC,CAAC,CACJ,CAAC,CAAA9E,KAAA,CAEDgL,gBAAgB,CAAG,UAAM,CACvBhL,KAAA,CAAKO,SAAS,CAAC8B,KAAK,CAAC4I,GAAG,CAAC,CAAC,CAAE;AAC5BjL,KAAA,CAAK+C,QAAQ,CAAC,CAACkB,wBAAwB,CAAE,KAAK,CAAC,CAAC,CAClD,CAAC,CA7nBCjE,KAAA,CAAK6C,KAAK,CAAG,CACXoF,aAAa,CAAE,EAAE,CACjBrC,cAAc,CAAE,EAAE,CAClBhD,oBAAoB,CAAE,EAAE,CACxBjC,aAAa,CAAE,CAAC,CAChBD,0BAA0B,CAAE,KAAK,CACjCuD,wBAAwB,CAAE,KAAK,CAC/BC,oBAAoB,CAAE,IAAI,CAC1B4B,aAAa,CAAE,CACjB,CAAC,CAED9F,KAAA,CAAKoJ,WAAW,cAAG3K,KAAK,CAACyM,SAAS,CAAC,CAAC,CAEpClL,KAAA,CAAK0H,eAAe,CAAG,EAAE,CAEzB1H,KAAA,CAAK6G,SAAS,CAAG,IAAI,CACrB7G,KAAA,CAAKwG,MAAM,CAAG,CAAC,CACfxG,KAAA,CAAK+G,eAAe,CAAG,GAAG,CAAE;AAC5B3G,MAAM,CAACC,cAAc,CAAGL,KAAA,CAAKK,cAAc,CAC3CL,KAAA,CAAKgF,kBAAkB,CAAG,KAAK,CAAC,OAAAhF,KAAA,CAClC,CAACmL,YAAA,CAAAzL,YAAA,GAAAqI,GAAA,qBAAAqD,KAAA,CAED,SAAAC,kBAAA,CAAoB,CAClB,IAAI,CAAC9K,SAAS,CAAG,GAAI,CAAA5B,WAAW,CAAC,CAC/B8F,MAAM,CAAE,EAAE,CACV6G,KAAK,CAAE,IAAI,CAAC3C,QAAQ,EAAI,CAAC,CAAC,CAC1B4C,QAAQ,CAAE,IAAI,CAACxL,KAAK,CAACyL,SAAS,CAC9BjJ,QAAQ,CAAExD,6BAA6B,EAAI0M,SAAS,CACpDC,WAAW,CAAE5M,iBAAiB,CAAG,IAAI,CAAG,IAAI,EAAI2M,SAAS,CACzDE,UAAU,CAAE,IAAI,CAAC5L,KAAK,CAAC4L,UAAU,EAAI,MAAM,CAC3CC,UAAU,CAAE,IAAI,CAAC7L,KAAK,CAAC6L,UAAU,EAAI,KAAK,CAC1CnD,OAAO,CAAE,IAAI,CAACP,UAAU,EAAI,CAAC,CAAC,CAC9B2D,eAAe,CAAE,IAAI,CAAC9L,KAAK,CAAC8L,eAAe,EAAI,KAAK,CACpD1D,SAAS,CAAE5C,QAAQ,CAAC1G,4BAA4B,CAAC,CAAG,IAAI,CAAG,IAAI,EAAI,CAAC,CAAG,IAAI,CAAG,IAAI,CAClFiN,mBAAmB,CAAE,IAAI,CAAC/L,KAAK,CAAC+L,mBAAmB,EAAI,CAAC,CACxDC,iBAAiB,CAAE,IAAI,CAAChM,KAAK,CAACgM,iBAAiB,CAC/CnD,wBAAwB,CAAE,IAAI,CAACA,wBAAwB,CACvDoD,cAAc,CAAE,IAAI,CACpBC,eAAe,CAAE,CAAC,CAClBC,WAAW,CAAE,CACf,CAAC,CAAC,CAEF,IAAI,CAAC3L,SAAS,CAAC4L,YAAY,CAAC,IAAI,CAAC/C,WAAW,CAACC,OAAO,CAAE,IAAI,CAAC,CAE3D;AACA,GAAI,IAAI,CAACtJ,KAAK,CAACO,WAAW,GAAK,IAAI,CAAE,CACnC,IAAI,CAACC,SAAS,CAAC6L,oBAAoB,CAAC,CAAC,CACvC,CAEA,IAAI,CAACxL,mBAAmB,CAAC,CAAC,CAC1B,IAAI,CAACO,gBAAgB,CAAC,CAAC,CACzB,CAAC,GAAA4G,GAAA,UAAAqD,KAAA,CA4kBD,SAAAiB,OAAA,CAAS,CACP,mBACE5M,KAAA,CAACf,QAAQ,EAAA4N,QAAA,eACP/M,IAAA,QAAKgN,SAAS,CAAC,yBAAyB,CAAAD,QAAA,cACtC/M,IAAA,QAAKgN,SAAS,CAAC,eAAe,CAAAD,QAAA,cAC5B/M,IAAA,UAAOgN,SAAS,CAAC,cAAc,CAACxI,IAAI,CAAC,MAAM,CAACyI,GAAG,CAAE,IAAI,CAACpD,WAAY,CAACN,OAAO,CAAE,IAAI,CAACA,OAAQ,CAAC,aAAY5J,OAAO,CAAC,QAAQ,CAAE,CAAE,CAAC,CACxH,CAAC,CACH,CAAC,CACL,IAAI,CAAC2D,KAAK,CAACoB,wBAAwB,eAClC1E,IAAA,CAACH,kBAAkB,EACjB8E,oBAAoB,CAAE,IAAI,CAACrB,KAAK,CAACqB,oBAAqB,CACtDuG,qBAAqB,CAAE,IAAI,CAACA,qBAAsB,CAClDG,UAAU,CAAE,IAAI,CAACA,UAAW,CAC5BI,gBAAgB,CAAE,IAAI,CAACA,gBAAiB,CACzC,CAAC,CAEH,IAAI,CAACnI,KAAK,CAACnC,0BAA0B,eACpCnB,IAAA,CAACJ,oBAAoB,EACnB8I,aAAa,CAAE,IAAI,CAACpF,KAAK,CAACoF,aAAc,CACxCrC,cAAc,CAAE,IAAI,CAAC/C,KAAK,CAAC+C,cAAe,CAC1ChD,oBAAoB,CAAE,IAAI,CAACC,KAAK,CAACD,oBAAqB,CACtDjC,aAAa,CAAE,IAAI,CAACkC,KAAK,CAAClC,aAAc,CACxCmF,aAAa,CAAE,IAAI,CAACjD,KAAK,CAACiD,aAAc,CACxC4D,mBAAmB,CAAE,IAAI,CAACA,mBAAoB,CAC9CM,oBAAoB,CAAE,IAAI,CAACA,oBAAqB,CAChDL,cAAc,CAAE,IAAI,CAACA,cAAe,CACpCM,aAAa,CAAE,IAAI,CAACA,aAAc,CAClCE,gBAAgB,CAAE,IAAI,CAACA,gBAAiB,CACxCJ,WAAW,CAAE,IAAI,CAACxJ,SAAS,CAACwJ,WAAW,CAAC,CAAE,CAC3C,CAAC,EAEI,CAAC,CAEf,CAAC,WAAArK,YAAA,GAxqBwBjB,KAAK,CAACgO,SAAS,EAApC/M,YAAY,CAETgN,YAAY,CAAG,CACpBhJ,kBAAkB,CAAE,KACtB,CAAC,CAyqBH,cAAe,CAAAhE,YAAY"},"metadata":{},"sourceType":"module","externalDependencies":[]}