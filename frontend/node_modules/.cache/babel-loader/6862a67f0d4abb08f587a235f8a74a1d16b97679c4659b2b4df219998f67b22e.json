{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Fragment}from'react';import{gettext}from'../../utils/constants';import{Utils}from'../../utils/utils';import UploadListItem from'./upload-list-item';import ForbidUploadListItem from'./forbid-upload-list-item';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UploadProgressDialog=/*#__PURE__*/function(_React$Component){_inherits(UploadProgressDialog,_React$Component);var _super=_createSuper(UploadProgressDialog);function UploadProgressDialog(props){var _this;_classCallCheck(this,UploadProgressDialog);_this=_super.call(this,props);_this.onCancelAllUploading=function(){_this.props.onCancelAllUploading();};_this.onMinimizeUpload=function(e){e.nativeEvent.stopImmediatePropagation();_this.setState({isMinimized:!_this.state.isMinimized});};_this.onCloseUpload=function(e){e.nativeEvent.stopImmediatePropagation();_this.props.onCloseUploadDialog();};_this.state={isMinimized:false};return _this;}_createClass(UploadProgressDialog,[{key:\"render\",value:function render(){var _this2=this;var _this$props=this.props,totalProgress=_this$props.totalProgress,retryFileList=_this$props.retryFileList,uploadBitrate=_this$props.uploadBitrate,uploadFileList=_this$props.uploadFileList,forbidUploadFileList=_this$props.forbidUploadFileList,isUploading=_this$props.isUploading;var filesUploadedMsg=gettext('{uploaded_files_num}/{all_files_num} Files').replace('{uploaded_files_num}',uploadFileList.filter(function(file){return file.isSaved;}).length).replace('{all_files_num}',uploadFileList.length);var filesFailedMsg;if(!isUploading){var failedNum=uploadFileList.filter(function(file){return file.error;}).length+forbidUploadFileList.length;if(failedNum>0){filesFailedMsg=gettext('{failed_files_num} file(s) failed to upload').replace('{failed_files_num}',failedNum);}}return/*#__PURE__*/_jsxs(\"div\",{className:\"uploader-list-view mw-100\",style:{height:this.state.isMinimized?document.querySelector('.uploader-list-header').offsetHeight:'20rem'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"uploader-list-header flex-shrink-0\",children:[/*#__PURE__*/_jsx(\"div\",{children:isUploading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{children:gettext('File Uploading...')}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2\",children:\"\".concat(totalProgress,\"% (\").concat(Utils.formatBitRate(uploadBitrate),\")\")}),/*#__PURE__*/_jsx(\"div\",{className:\"progress\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar\",role:\"progressbar\",style:{width:\"\".concat(totalProgress,\"%\")},\"aria-valuenow\":totalProgress,\"aria-valuemin\":\"0\",\"aria-valuemax\":\"100\"})})]}):/*#__PURE__*/_jsx(_Fragment,{children:filesFailedMsg?/*#__PURE__*/_jsx(\"p\",{className:\"m-0 error\",children:filesFailedMsg}):/*#__PURE__*/_jsx(\"p\",{className:\"m-0\",children:gettext('All files uploaded')})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-dialog-op-container\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sf2-icon-minus upload-dialog-op\",onClick:this.onMinimizeUpload}),!isUploading&&/*#__PURE__*/_jsx(\"span\",{className:\"sf2-icon-x1 upload-dialog-op\",onClick:this.onCloseUpload})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"uploader-list-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center border-bottom\",children:[uploadFileList.length>0&&/*#__PURE__*/_jsx(\"span\",{children:filesUploadedMsg}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-auto\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-lg border-0 background-transparent px-0\",onClick:this.props.onUploadRetryAll,disabled:retryFileList.length==0,children:gettext('Retry All')}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-lg border-0 background-transparent px-0 ml-3\",onClick:this.props.onCancelAllUploading,disabled:!isUploading,children:gettext('Cancel All')})]})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"table-thead-hidden\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{width:\"40%\",children:gettext('name')}),/*#__PURE__*/_jsx(\"th\",{width:\"15%\",children:gettext('size')}),/*#__PURE__*/_jsx(\"th\",{width:\"30%\",children:gettext('progress')}),/*#__PURE__*/_jsx(\"th\",{width:\"15%\",children:gettext('state')})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[this.props.forbidUploadFileList.map(function(file,index){return/*#__PURE__*/_jsx(ForbidUploadListItem,{file:file},index);}),this.props.uploadFileList.map(function(resumableFile,index){return/*#__PURE__*/_jsx(UploadListItem,{resumableFile:resumableFile,onUploadCancel:_this2.props.onUploadCancel,onUploadRetry:_this2.props.onUploadRetry},index);})]})]})]})]});}}]);return UploadProgressDialog;}(React.Component);export default UploadProgressDialog;","map":{"version":3,"names":["React","Fragment","gettext","Utils","UploadListItem","ForbidUploadListItem","jsx","_jsx","_Fragment","jsxs","_jsxs","UploadProgressDialog","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","onCancelAllUploading","onMinimizeUpload","e","nativeEvent","stopImmediatePropagation","setState","isMinimized","state","onCloseUpload","onCloseUploadDialog","_createClass","key","value","render","_this2","_this$props","totalProgress","retryFileList","uploadBitrate","uploadFileList","forbidUploadFileList","isUploading","filesUploadedMsg","replace","filter","file","isSaved","length","filesFailedMsg","failedNum","error","className","style","height","document","querySelector","offsetHeight","children","concat","formatBitRate","role","width","onClick","onUploadRetryAll","disabled","map","index","resumableFile","onUploadCancel","onUploadRetry","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/file-uploader/upload-progress-dialog.js"],"sourcesContent":["import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport UploadListItem from './upload-list-item';\nimport ForbidUploadListItem from './forbid-upload-list-item';\n\nconst propTypes = {\n  uploadBitrate: PropTypes.number.isRequired,\n  totalProgress: PropTypes.number.isRequired,\n  retryFileList: PropTypes.array.isRequired,\n  uploadFileList: PropTypes.array.isRequired,\n  forbidUploadFileList: PropTypes.array.isRequired,\n  onCloseUploadDialog: PropTypes.func.isRequired,\n  onCancelAllUploading: PropTypes.func.isRequired,\n  onUploadCancel: PropTypes.func.isRequired,\n  onUploadRetry: PropTypes.func.isRequired,\n  onUploadRetryAll: PropTypes.func.isRequired,\n  isUploading : PropTypes.bool.isRequired\n};\n\nclass UploadProgressDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isMinimized: false\n    };\n  }\n\n  onCancelAllUploading = () => {\n    this.props.onCancelAllUploading();\n  };\n\n  onMinimizeUpload = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.setState({isMinimized: !this.state.isMinimized});\n  };\n\n  onCloseUpload = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.onCloseUploadDialog();\n  };\n\n  render() {\n    const { totalProgress, retryFileList, uploadBitrate, uploadFileList, forbidUploadFileList, isUploading } = this.props;\n\n    const filesUploadedMsg = gettext('{uploaded_files_num}/{all_files_num} Files')\n      .replace('{uploaded_files_num}', uploadFileList.filter(file => file.isSaved).length)\n      .replace('{all_files_num}', uploadFileList.length);\n\n    let filesFailedMsg;\n    if (!isUploading) {\n      const failedNum = uploadFileList.filter(file => file.error).length + forbidUploadFileList.length;\n      if (failedNum > 0) {\n        filesFailedMsg = gettext('{failed_files_num} file(s) failed to upload')\n          .replace('{failed_files_num}', failedNum);\n      }\n    }\n\n    return (\n      <div className=\"uploader-list-view mw-100\" style={{height: this.state.isMinimized ? document.querySelector('.uploader-list-header').offsetHeight : '20rem'}}>\n        <div className=\"uploader-list-header flex-shrink-0\">\n          <div>\n            {isUploading ? (\n              <>\n                <span>{gettext('File Uploading...')}</span>\n                <span className=\"ml-2\">{`${totalProgress}% (${Utils.formatBitRate(uploadBitrate)})`}</span>\n                <div className=\"progress\">\n                  <div className=\"progress-bar\" role=\"progressbar\" style={{width: `${totalProgress}%`}} aria-valuenow={totalProgress} aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\n                </div>\n              </>\n            ) : (\n              <>\n                {filesFailedMsg ?\n                  <p className=\"m-0 error\">{filesFailedMsg}</p> :\n                  <p className=\"m-0\">{gettext('All files uploaded')}</p>\n                }\n              </>\n            )}\n          </div>\n          <div className=\"upload-dialog-op-container\">\n            <span className=\"sf2-icon-minus upload-dialog-op\" onClick={this.onMinimizeUpload}></span>\n            {!isUploading && <span className=\"sf2-icon-x1 upload-dialog-op\" onClick={this.onCloseUpload}></span>}\n          </div>\n        </div>\n        <div className=\"uploader-list-content\">\n          <div className=\"d-flex justify-content-between align-items-center border-bottom\">\n            {uploadFileList.length > 0 && <span>{filesUploadedMsg}</span>}\n            <div className=\"ml-auto\">\n              <button\n                className=\"btn btn-lg border-0 background-transparent px-0\"\n                onClick={this.props.onUploadRetryAll}\n                disabled={retryFileList.length == 0}\n              >\n                {gettext('Retry All')}\n              </button>\n              <button\n                className=\"btn btn-lg border-0 background-transparent px-0 ml-3\"\n                onClick={this.props.onCancelAllUploading}\n                disabled={!isUploading}\n              >\n                {gettext('Cancel All')}\n              </button>\n            </div>\n          </div>\n          <table className=\"table-thead-hidden\">\n            <thead>\n              <tr>\n                <th width=\"40%\">{gettext('name')}</th>\n                <th width=\"15%\">{gettext('size')}</th>\n                <th width=\"30%\">{gettext('progress')}</th>\n                <th width=\"15%\">{gettext('state')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {\n                this.props.forbidUploadFileList.map((file, index) => {\n                  return (<ForbidUploadListItem key={index} file={file} />);\n                })\n              }\n              {\n                this.props.uploadFileList.map((resumableFile, index) => {\n                  return (\n                    <UploadListItem\n                      key={index}\n                      resumableFile={resumableFile}\n                      onUploadCancel={this.props.onUploadCancel}\n                      onUploadRetry={this.props.onUploadRetry}\n                    />\n                  );\n                })\n              }\n            </tbody>\n          </table>\n        </div>\n      </div>\n    );\n  }\n}\n\nUploadProgressDialog.propTypes = propTypes;\n\nexport default UploadProgressDialog;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}