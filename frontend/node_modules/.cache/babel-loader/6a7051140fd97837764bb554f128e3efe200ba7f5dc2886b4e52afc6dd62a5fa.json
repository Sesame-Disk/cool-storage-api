{"ast":null,"code":"import _toConsumableArray from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component,Fragment}from'react';import isHotkey from'is-hotkey';import MediaQuery from'react-responsive';import{seafileAPI}from'../../utils/seafile-api';import{enableSeafileAI,gettext,siteRoot}from'../../utils/constants';import SearchResultItem from'./search-result-item';import{Utils}from'../../utils/utils';import{isMac}from'../../utils/extra-attributes';import toaster from'../toast';import{SEARCH_DELAY_TIME,getValueLength}from'./constant';import Icon from'../icon';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PER_PAGE=20;var controlKey=isMac()?'⌘':'Ctrl';var Search=/*#__PURE__*/function(_Component){_inherits(Search,_Component);var _super=_createSuper(Search);function Search(props){var _this;_classCallCheck(this,Search);_this=_super.call(this,props);_this.onCompositionStart=function(){_this.isChineseInput=true;if(_this.timer){clearTimeout(_this.timer);_this.timer=null;}};_this.onCompositionEnd=function(){_this.isChineseInput=false;// chrome：compositionstart -> onChange -> compositionend\n// not chrome：compositionstart -> compositionend -> onChange\n// The onChange event will setState and change input value, then setTimeout to initiate the search\nif(_this.timer){clearTimeout(_this.timer);_this.timer=null;}_this.timer=setTimeout(function(){_this.onSearch();},SEARCH_DELAY_TIME);};_this.onDocumentKeydown=function(e){if(isHotkey('mod+f')(e)){e.preventDefault();_this.onFocusHandler();if(_this.inputRef&&_this.inputRef.current){_this.inputRef.current.focus();}}else if(isHotkey('esc',e)){e.preventDefault();_this.inputRef&&_this.inputRef.current&&_this.inputRef.current.blur();_this.resetToDefault();}else if(isHotkey('enter',e)){_this.onEnter(e);}else if(isHotkey('up',e)){_this.onUp(e);}else if(isHotkey('down',e)){_this.onDown(e);}};_this.onFocusHandler=function(){_this.setState({width:'570px',isMaskShow:true,isCloseShow:true});};_this.onCloseHandler=function(){_this.resetToDefault();};_this.onUp=function(e){e.preventDefault();e.stopPropagation();var highlightIndex=_this.state.highlightIndex;if(highlightIndex>0){_this.setState({highlightIndex:highlightIndex-1},function(){if(_this.highlightRef){var _this$highlightRef$ge=_this.highlightRef.getBoundingClientRect(),top=_this$highlightRef$ge.top,height=_this$highlightRef$ge.height;if(top-height<0){_this.searchContainer.current.scrollTop-=height;}}});}};_this.onDown=function(e){e.preventDefault();e.stopPropagation();var _this$state=_this.state,highlightIndex=_this$state.highlightIndex,resultItems=_this$state.resultItems;if(highlightIndex<resultItems.length-1){_this.setState({highlightIndex:highlightIndex+1},function(){if(_this.highlightRef){var _this$highlightRef$ge2=_this.highlightRef.getBoundingClientRect(),top=_this$highlightRef$ge2.top,height=_this$highlightRef$ge2.height;var outerHeight=300;if(top>outerHeight){_this.searchContainer.current.scrollTop+=height;}}});}};_this.onEnter=function(e){e.preventDefault();var item=_this.state.resultItems[_this.state.highlightIndex];if(item){if(document.activeElement){document.activeElement.blur();}_this.onItemClickHandler(item);}};_this.onItemClickHandler=function(item){_this.resetToDefault();_this.keepVisitedItem(item);_this.props.onSearchedClick(item);};_this.keepVisitedItem=function(targetItem){var repoID=_this.props.repoID;var targetIndex;var storeKey='sfVisitedSearchItems';if(repoID){storeKey+=repoID;}var items=JSON.parse(localStorage.getItem(storeKey))||[];for(var i=0,len=items.length;i<len;i++){var _items$i=items[i],repo_id=_items$i.repo_id,path=_items$i.path;var targetRepoID=targetItem.repo_id,targetPath=targetItem.path;if(repo_id==targetRepoID&&path==targetPath){targetIndex=i;break;}}if(targetIndex!=undefined){items.splice(targetIndex,1);}items.unshift(targetItem);if(items.length>50){// keep 50 items at most\nitems.pop();}localStorage.setItem(storeKey,JSON.stringify(items));};_this.onChangeHandler=function(event){if(_this.state.showRecent){_this.setState({showRecent:false});}var newValue=event.target.value;_this.setState({value:newValue},function(){if(_this.inputValue===newValue.trim())return;_this.inputValue=newValue.trim();if(!_this.isChineseInput){if(_this.timer){clearTimeout(_this.timer);_this.timer=null;}_this.timer=setTimeout(function(){_this.onSearch();},SEARCH_DELAY_TIME);}});};_this.onKeydownHandler=function(event){if(isHotkey('enter',event)){_this.onSearch();}};_this.onSearch=function(){var value=_this.state.value;var repoID=_this.props.repoID;if(_this.inputValue===''||getValueLength(_this.inputValue)<3){_this.setState({highlightIndex:0,resultItems:[],isResultGetted:false});return;}var queryData={q:value,search_repo:repoID?repoID:'all',search_ftypes:'all'};_this.getSearchResult(queryData);};_this.getSearchResult=function(queryData){if(_this.source){_this.source.cancel('prev request is cancelled');}_this.setState({isResultGetted:false,resultItems:[],highlightIndex:0});_this.source=seafileAPI.getSource();_this.sendRequest(queryData,_this.source.token,1);};_this.sendRequest=function(queryData,cancelToken,page){var isPublic=_this.props.isPublic;_this.queryData=queryData;if(isPublic){seafileAPI.searchFilesInPublishedRepo(queryData.search_repo,queryData.q,page,PER_PAGE).then(function(res){_this.source=null;if(res.data.total>0){_this.setState({resultItems:[].concat(_toConsumableArray(_this.state.resultItems),_toConsumableArray(_this.formatResultItems(res.data.results))),isResultGetted:true,page:page+1,isLoading:false,hasMore:res.data.has_more});}else{_this.setState({highlightIndex:0,resultItems:[],isLoading:false,isResultGetted:true,hasMore:res.data.has_more});}}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);_this.setState({isLoading:false});});}else{if(enableSeafileAI){_this.onAiSearch(queryData,cancelToken);}else{_this.onNormalSearch(queryData,cancelToken,page);}}};_this.onNormalSearch=function(queryData,cancelToken,page){_this.updateSearchPageURL(queryData);queryData['per_page']=PER_PAGE;queryData['page']=page;seafileAPI.searchFiles(queryData,cancelToken).then(function(res){_this.source=null;if(res.data.total>0){_this.setState({resultItems:[].concat(_toConsumableArray(_this.state.resultItems),_toConsumableArray(_this.formatResultItems(res.data.results))),isResultGetted:true,isLoading:false,page:page+1,hasMore:res.data.has_more});return;}_this.setState({highlightIndex:0,resultItems:[],isLoading:false,isResultGetted:true,hasMore:res.data.has_more});}).catch(function(error){/* eslint-disable */console.log(error);_this.setState({isLoading:false});});};_this.onAiSearch=function(params,cancelToken){var results=[];seafileAPI.aiSearchFiles(params,cancelToken).then(function(res){results=[].concat(_toConsumableArray(results),_toConsumableArray(_this.formatResultItems(res.data.results)));_this.setState({resultItems:results,isResultGetted:true,isLoading:false,hasMore:false});}).catch(function(error){/* eslint-disable */console.log(error);_this.setState({isLoading:false});});};_this.renderResults=function(resultItems,isVisited){var _this$state2=_this.state,highlightIndex=_this$state2.highlightIndex,hasMore=_this$state2.hasMore,searchPageUrl=_this$state2.searchPageUrl;var results=/*#__PURE__*/_jsxs(_Fragment,{children:[isVisited&&/*#__PURE__*/_jsx(\"h4\",{className:\"visited-search-results-title\",children:gettext('Search results visited recently')}),/*#__PURE__*/_jsx(\"ul\",{className:\"search-result-list\",ref:_this.searchResultListRef,children:resultItems.map(function(item,index){var isHighlight=index===highlightIndex;return/*#__PURE__*/_jsx(SearchResultItem,{item:item,onItemClickHandler:_this.onItemClickHandler,isHighlight:isHighlight,setRef:isHighlight?function(ref){_this.highlightRef=ref;}:function(){}},index);})}),!_this.props.isPublic&&hasMore&&/*#__PURE__*/_jsxs(\"div\",{className:\"more-search-result mb-1 pl-2 d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Icon,{symbol:\"more-level\",className:\"more-search-result-icon\"}),/*#__PURE__*/_jsx(\"a\",{href:searchPageUrl,className:\"more-search-result-text ml-1\",children:gettext('More')})]})]});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(MediaQuery,{query:\"(min-width: 768px)\",children:/*#__PURE__*/_jsx(\"div\",{className:\"search-result-list-container\",children:results})}),/*#__PURE__*/_jsx(MediaQuery,{query:\"(max-width: 767.8px)\",children:results})]});};_this.onSearchToggle=function(){_this.setState({isSearchInputShow:!_this.state.isSearchInputShow,isMaskShow:!_this.state.isMaskShow});};_this.baseSearchPageURL=\"\".concat(siteRoot,\"search/\");_this.state={width:'default',value:'',resultItems:[],highlightIndex:0,page:0,isLoading:false,hasMore:false,isMaskShow:false,showRecent:true,isResultGetted:false,isCloseShow:false,isSearchInputShow:false,// for mobile\nsearchPageUrl:_this.baseSearchPageURL};_this.inputValue='';_this.highlightRef=null;_this.source=null;// used to cancel request;\n_this.inputRef=/*#__PURE__*/React.createRef();_this.searchContainer=/*#__PURE__*/React.createRef();_this.searchResultListRef=/*#__PURE__*/React.createRef();_this.timer=null;_this.isChineseInput=false;return _this;}_createClass(Search,[{key:\"componentDidMount\",value:function componentDidMount(){document.addEventListener('keydown',this.onDocumentKeydown);document.addEventListener('compositionstart',this.onCompositionStart);document.addEventListener('compositionend',this.onCompositionEnd);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){document.removeEventListener('keydown',this.onDocumentKeydown);document.removeEventListener('compositionstart',this.onCompositionStart);document.removeEventListener('compositionend',this.onCompositionEnd);if(this.timer){clearTimeout(this.timer);this.timer=null;}this.isChineseInput=false;}},{key:\"updateSearchPageURL\",value:function updateSearchPageURL(queryData){var params='';for(var key in queryData){params+=key+'='+encodeURIComponent(queryData[key])+'&';}this.setState({searchPageUrl:\"\".concat(this.baseSearchPageURL,\"?\").concat(params.substring(0,params.length-1))});}},{key:\"formatResultItems\",value:function formatResultItems(data){var items=[];for(var i=0;i<data.length;i++){items[i]={};var name=data[i].is_dir?data[i].name:data[i].fullpath.split('/').pop();items[i]['index']=[i];items[i]['name']=name;items[i]['path']=data[i].fullpath;items[i]['repo_id']=data[i].repo_id;items[i]['repo_name']=data[i].repo_name;items[i]['is_dir']=data[i].is_dir;items[i]['link_content']=decodeURI(data[i].fullpath).substring(1);items[i]['content']=data[i].content_highlight;items[i]['thumbnail_url']=data[i].thumbnail_url;}return items;}},{key:\"resetToDefault\",value:function resetToDefault(){this.inputValue='';this.setState({width:'',value:'',isMaskShow:false,isCloseShow:false,isResultGetted:false,resultItems:[],highlightIndex:0,isSearchInputShow:false,showRecent:true});}},{key:\"renderSearchResult\",value:function renderSearchResult(){var _this$state3=this.state,resultItems=_this$state3.resultItems,width=_this$state3.width,showRecent=_this$state3.showRecent,isResultGetted=_this$state3.isResultGetted;if(!width||width==='default')return null;if(showRecent){var repoID=this.props.repoID;var storeKey='sfVisitedSearchItems';if(repoID){storeKey+=repoID;}var visitedItems=JSON.parse(localStorage.getItem(storeKey))||[];if(visitedItems.length>0){return this.renderResults(visitedItems,true);}}var searchStrLength=getValueLength(this.inputValue);if(searchStrLength===0){return/*#__PURE__*/_jsx(\"div\",{className:\"search-result-none\",children:gettext('Type characters to start search')});}else if(searchStrLength<3){return/*#__PURE__*/_jsx(\"div\",{className:\"search-result-none\",children:gettext('Type more characters to start search')});}else if(!isResultGetted){return/*#__PURE__*/_jsx(\"span\",{className:\"loading-icon loading-tip\"});}else if(resultItems.length>0){return this.renderResults(resultItems);}else{return/*#__PURE__*/_jsx(\"div\",{className:\"search-result-none\",children:gettext('No results matching')});}}},{key:\"render\",value:function render(){var width=this.state.width!=='default'?this.state.width:'';var style={'width':width};var isMaskShow=this.state.isMaskShow;var placeholder=\"\".concat(this.props.placeholder).concat(isMaskShow?'':\" (\".concat(controlKey,\" + f )\"));return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(MediaQuery,{query:\"(min-width: 768px)\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"search\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-mask \".concat(isMaskShow?'show':'hide'),onClick:this.onCloseHandler}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-container \".concat(isMaskShow?'show':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-icon \".concat(isMaskShow?'mb-1':''),children:[/*#__PURE__*/_jsx(\"i\",{className:\"search-icon-left input-icon-addon fas fa-search\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control search-input\",name:\"query\",placeholder:placeholder,style:style,value:this.state.value,onFocus:this.onFocusHandler,onChange:this.onChangeHandler,autoComplete:\"off\",ref:this.inputRef,onKeyDown:this.onKeydownHandler}),this.state.isCloseShow&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"search-icon-right input-icon-addon fas fa-times border-0 bg-transparent mr-4\",onClick:this.onCloseHandler,\"aria-label\":gettext('Close')})]}),/*#__PURE__*/_jsx(\"div\",{className:\"search-result-container dropdown-search-result-container\",ref:this.searchContainer,children:this.renderSearchResult()})]})]})}),/*#__PURE__*/_jsxs(MediaQuery,{query:\"(max-width: 767.8px)\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-icon-container\",children:/*#__PURE__*/_jsx(\"i\",{className:\"search-icon fas fa-search\",onClick:this.onSearchToggle})}),this.state.isSearchInputShow&&/*#__PURE__*/_jsxs(\"div\",{className:\"search\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-mask \".concat(isMaskShow?'':'hide'),onClick:this.onCloseHandler}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-icon\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"search-icon-left input-icon-addon fas fa-search\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control search-input\",name:\"query\",placeholder:placeholder,style:style,value:this.state.value,onFocus:this.onFocusHandler,onChange:this.onChangeHandler,autoComplete:\"off\"}),this.state.isCloseShow&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"search-icon-right input-icon-addon fas fa-times border-0 bg-transparent\",onClick:this.onCloseHandler,\"aria-label\":gettext('Close')})]}),/*#__PURE__*/_jsx(\"div\",{className:\"search-result-container dropdown-search-result-container\",children:this.renderSearchResult()})]})]})]})]});}}]);return Search;}(Component);export default Search;","map":{"version":3,"names":["React","Component","Fragment","isHotkey","MediaQuery","seafileAPI","enableSeafileAI","gettext","siteRoot","SearchResultItem","Utils","isMac","toaster","SEARCH_DELAY_TIME","getValueLength","Icon","jsx","_jsx","jsxs","_jsxs","_Fragment","PER_PAGE","controlKey","Search","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","onCompositionStart","isChineseInput","timer","clearTimeout","onCompositionEnd","setTimeout","onSearch","onDocumentKeydown","e","preventDefault","onFocusHandler","inputRef","current","focus","blur","resetToDefault","onEnter","onUp","onDown","setState","width","isMaskShow","isCloseShow","onCloseHandler","stopPropagation","highlightIndex","state","highlightRef","_this$highlightRef$ge","getBoundingClientRect","top","height","searchContainer","scrollTop","_this$state","resultItems","length","_this$highlightRef$ge2","outerHeight","item","document","activeElement","onItemClickHandler","keepVisitedItem","onSearchedClick","targetItem","repoID","targetIndex","storeKey","items","JSON","parse","localStorage","getItem","i","len","_items$i","repo_id","path","targetRepoID","targetPath","undefined","splice","unshift","pop","setItem","stringify","onChangeHandler","event","showRecent","newValue","target","value","inputValue","trim","onKeydownHandler","isResultGetted","queryData","q","search_repo","search_ftypes","getSearchResult","source","cancel","getSource","sendRequest","token","cancelToken","page","isPublic","searchFilesInPublishedRepo","then","res","data","total","concat","_toConsumableArray","formatResultItems","results","isLoading","hasMore","has_more","catch","error","errMessage","getErrorMsg","danger","onAiSearch","onNormalSearch","updateSearchPageURL","searchFiles","console","log","params","aiSearchFiles","renderResults","isVisited","_this$state2","searchPageUrl","children","className","ref","searchResultListRef","map","index","isHighlight","setRef","symbol","href","query","onSearchToggle","isSearchInputShow","baseSearchPageURL","createRef","_createClass","key","componentDidMount","addEventListener","componentWillUnmount","removeEventListener","encodeURIComponent","substring","name","is_dir","fullpath","split","repo_name","decodeURI","content_highlight","thumbnail_url","renderSearchResult","_this$state3","visitedItems","searchStrLength","render","style","placeholder","onClick","type","onFocus","onChange","autoComplete","onKeyDown"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/search/search.js"],"sourcesContent":["import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport isHotkey from 'is-hotkey';\nimport MediaQuery from 'react-responsive';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { enableSeafileAI, gettext, siteRoot } from '../../utils/constants';\nimport SearchResultItem from './search-result-item';\nimport { Utils } from '../../utils/utils';\nimport { isMac } from '../../utils/extra-attributes';\nimport toaster from '../toast';\nimport { SEARCH_DELAY_TIME, getValueLength } from './constant';\nimport Icon from '../icon';\n\nconst propTypes = {\n  repoID: PropTypes.string,\n  placeholder: PropTypes.string,\n  onSearchedClick: PropTypes.func.isRequired,\n  isPublic: PropTypes.bool,\n};\n\nconst PER_PAGE = 20;\nconst controlKey = isMac() ? '⌘' : 'Ctrl';\n\nclass Search extends Component {\n\n  constructor(props) {\n    super(props);\n    this.baseSearchPageURL = `${siteRoot}search/`;\n    this.state = {\n      width: 'default',\n      value: '',\n      resultItems: [],\n      highlightIndex: 0,\n      page: 0,\n      isLoading: false,\n      hasMore: false,\n      isMaskShow: false,\n      showRecent: true,\n      isResultGetted: false,\n      isCloseShow: false,\n      isSearchInputShow: false, // for mobile\n      searchPageUrl: this.baseSearchPageURL,\n    };\n    this.inputValue = '';\n    this.highlightRef = null;\n    this.source = null; // used to cancel request;\n    this.inputRef = React.createRef();\n    this.searchContainer = React.createRef();\n    this.searchResultListRef = React.createRef();\n    this.timer = null;\n    this.isChineseInput = false;\n  }\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.onDocumentKeydown);\n    document.addEventListener('compositionstart', this.onCompositionStart);\n    document.addEventListener('compositionend', this.onCompositionEnd);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.onDocumentKeydown);\n    document.removeEventListener('compositionstart', this.onCompositionStart);\n    document.removeEventListener('compositionend', this.onCompositionEnd);\n    if (this.timer) {\n      clearTimeout(this.timer);\n      this.timer = null;\n    }\n    this.isChineseInput = false;\n  }\n\n  onCompositionStart = () => {\n    this.isChineseInput = true;\n    if (this.timer) {\n      clearTimeout(this.timer);\n      this.timer = null;\n    }\n  };\n\n  onCompositionEnd = () => {\n    this.isChineseInput = false;\n    // chrome：compositionstart -> onChange -> compositionend\n    // not chrome：compositionstart -> compositionend -> onChange\n    // The onChange event will setState and change input value, then setTimeout to initiate the search\n    if (this.timer) {\n      clearTimeout(this.timer);\n      this.timer = null;\n    }\n    this.timer = setTimeout(() => {\n      this.onSearch();\n    }, SEARCH_DELAY_TIME);\n  };\n\n  onDocumentKeydown = (e) => {\n    if (isHotkey('mod+f')(e)) {\n      e.preventDefault();\n      this.onFocusHandler();\n      if (this.inputRef && this.inputRef.current) {\n        this.inputRef.current.focus();\n      }\n    } else if (isHotkey('esc', e)) {\n      e.preventDefault();\n      this.inputRef && this.inputRef.current && this.inputRef.current.blur();\n      this.resetToDefault();\n    } else if (isHotkey('enter', e)) {\n      this.onEnter(e);\n    } else if (isHotkey('up', e)) {\n      this.onUp(e);\n    } else if (isHotkey('down', e)) {\n      this.onDown(e);\n    }\n  };\n\n  onFocusHandler = () => {\n    this.setState({ width: '570px', isMaskShow: true, isCloseShow: true });\n  };\n\n  onCloseHandler = () => {\n    this.resetToDefault();\n  };\n\n  onUp = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const { highlightIndex } = this.state;\n    if (highlightIndex > 0) {\n      this.setState({ highlightIndex: highlightIndex - 1 }, () => {\n        if (this.highlightRef) {\n          const { top, height } = this.highlightRef.getBoundingClientRect();\n          if (top - height < 0) {\n            this.searchContainer.current.scrollTop -= height;\n          }\n        }\n      });\n    }\n  };\n\n  onDown = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const { highlightIndex, resultItems } = this.state;\n    if (highlightIndex < resultItems.length - 1) {\n      this.setState({ highlightIndex: highlightIndex + 1 }, () => {\n        if (this.highlightRef) {\n          const { top, height } = this.highlightRef.getBoundingClientRect();\n          const outerHeight = 300;\n          if (top > outerHeight) {\n            this.searchContainer.current.scrollTop += height;\n          }\n        }\n      });\n    }\n  };\n\n  onEnter = (e) => {\n    e.preventDefault();\n    let item = this.state.resultItems[this.state.highlightIndex];\n    if (item) {\n      if (document.activeElement) {\n        document.activeElement.blur();\n      }\n      this.onItemClickHandler(item);\n    }\n  };\n\n  onItemClickHandler = (item) => {\n    this.resetToDefault();\n    this.keepVisitedItem(item);\n    this.props.onSearchedClick(item);\n  };\n\n  keepVisitedItem = (targetItem) => {\n    const { repoID } = this.props;\n    let targetIndex;\n    let storeKey = 'sfVisitedSearchItems';\n    if (repoID) {\n      storeKey += repoID;\n    }\n    const items = JSON.parse(localStorage.getItem(storeKey)) || [];\n    for (let i = 0, len = items.length; i < len; i++) {\n      const { repo_id, path } = items[i];\n      const { repo_id: targetRepoID, path: targetPath } = targetItem;\n      if (repo_id == targetRepoID && path == targetPath) {\n        targetIndex = i;\n        break;\n      }\n    }\n    if (targetIndex != undefined) {\n      items.splice(targetIndex, 1);\n    }\n    items.unshift(targetItem);\n    if (items.length > 50) { // keep 50 items at most\n      items.pop();\n    }\n    localStorage.setItem(storeKey, JSON.stringify(items));\n  };\n\n  onChangeHandler = (event) => {\n    if (this.state.showRecent) {\n      this.setState({ showRecent: false });\n    }\n    const newValue = event.target.value;\n    this.setState({ value: newValue }, () => {\n      if (this.inputValue === newValue.trim()) return;\n      this.inputValue = newValue.trim();\n      if (!this.isChineseInput) {\n        if (this.timer) {\n          clearTimeout(this.timer);\n          this.timer = null;\n        }\n        this.timer = setTimeout(() => {\n          this.onSearch();\n        }, SEARCH_DELAY_TIME);\n      }\n    });\n  };\n\n  onKeydownHandler = (event) => {\n    if (isHotkey('enter', event)) {\n      this.onSearch();\n    }\n  };\n\n  onSearch = () => {\n    const { value } = this.state;\n    const { repoID } = this.props;\n    if (this.inputValue === '' || getValueLength(this.inputValue) < 3) {\n      this.setState({\n        highlightIndex: 0,\n        resultItems: [],\n        isResultGetted: false\n      });\n      return;\n    }\n    const queryData = {\n      q: value,\n      search_repo: repoID ? repoID : 'all',\n      search_ftypes: 'all',\n    };\n    this.getSearchResult(queryData);\n  };\n\n  getSearchResult = (queryData) => {\n    if (this.source) {\n      this.source.cancel('prev request is cancelled');\n    }\n    this.setState({\n      isResultGetted: false,\n      resultItems: [],\n      highlightIndex: 0,\n    });\n    this.source = seafileAPI.getSource();\n    this.sendRequest(queryData, this.source.token, 1);\n  };\n\n  sendRequest = (queryData, cancelToken, page) => {\n    let isPublic = this.props.isPublic;\n    this.queryData = queryData;\n\n    if (isPublic) {\n      seafileAPI.searchFilesInPublishedRepo(queryData.search_repo, queryData.q, page, PER_PAGE).then(res => {\n        this.source = null;\n        if (res.data.total > 0) {\n          this.setState({\n            resultItems: [...this.state.resultItems, ...this.formatResultItems(res.data.results)],\n            isResultGetted: true,\n            page: page + 1,\n            isLoading: false,\n            hasMore: res.data.has_more,\n          });\n        } else {\n          this.setState({\n            highlightIndex: 0,\n            resultItems: [],\n            isLoading: false,\n            isResultGetted: true,\n            hasMore: res.data.has_more,\n          });\n        }\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n        this.setState({ isLoading: false });\n      });\n    } else {\n      if (enableSeafileAI) {\n        this.onAiSearch(queryData, cancelToken);\n      } else {\n        this.onNormalSearch(queryData, cancelToken, page);\n      }\n    }\n  };\n\n  onNormalSearch = (queryData, cancelToken, page) => {\n    this.updateSearchPageURL(queryData);\n    queryData['per_page'] = PER_PAGE;\n    queryData['page'] = page;\n    seafileAPI.searchFiles(queryData, cancelToken).then(res => {\n      this.source = null;\n      if (res.data.total > 0) {\n        this.setState({\n          resultItems: [...this.state.resultItems, ...this.formatResultItems(res.data.results)],\n          isResultGetted: true,\n          isLoading: false,\n          page: page + 1,\n          hasMore: res.data.has_more,\n        });\n        return;\n      }\n      this.setState({\n        highlightIndex: 0,\n        resultItems: [],\n        isLoading: false,\n        isResultGetted: true,\n        hasMore: res.data.has_more,\n      });\n    }).catch(error => {\n      /* eslint-disable */\n      console.log(error);\n      this.setState({ isLoading: false });\n    });\n  }\n\n  onAiSearch = (params, cancelToken) => {\n    let results = [];\n    seafileAPI.aiSearchFiles(params, cancelToken).then(res => {\n      results = [...results, ...this.formatResultItems(res.data.results)];\n      this.setState({\n          resultItems: results,\n          isResultGetted: true,\n          isLoading: false,\n          hasMore: false,\n        });\n    }).catch(error => {\n      /* eslint-disable */\n      console.log(error);\n      this.setState({ isLoading: false });\n    });\n  };\n\n  updateSearchPageURL(queryData) {\n    let params = '';\n    for (let key in queryData) {\n      params += key + '=' + encodeURIComponent(queryData[key]) + '&';\n    }\n    this.setState({searchPageUrl: `${this.baseSearchPageURL}?${params.substring(0, params.length - 1)}`});\n  }\n\n  formatResultItems(data) {\n    let items = [];\n    for (let i = 0; i < data.length; i++) {\n      items[i] = {};\n      let name = data[i].is_dir ? data[i].name : data[i].fullpath.split('/').pop();\n      items[i]['index'] = [i];\n      items[i]['name'] = name;\n      items[i]['path'] = data[i].fullpath;\n      items[i]['repo_id'] = data[i].repo_id;\n      items[i]['repo_name'] = data[i].repo_name;\n      items[i]['is_dir'] = data[i].is_dir;\n      items[i]['link_content'] = decodeURI(data[i].fullpath).substring(1);\n      items[i]['content'] = data[i].content_highlight;\n      items[i]['thumbnail_url'] = data[i].thumbnail_url;\n    }\n    return items;\n  }\n\n  resetToDefault() {\n    this.inputValue = '';\n    this.setState({\n      width: '',\n      value: '',\n      isMaskShow: false,\n      isCloseShow: false,\n      isResultGetted: false,\n      resultItems: [],\n      highlightIndex: 0,\n      isSearchInputShow: false,\n      showRecent: true,\n    });\n  }\n\n  renderSearchResult() {\n    const { resultItems, width, showRecent, isResultGetted } = this.state;\n    if (!width || width === 'default') return null;\n\n    if (showRecent) {\n      const { repoID } = this.props;\n      let storeKey = 'sfVisitedSearchItems';\n      if (repoID) {\n        storeKey += repoID;\n      }\n      const visitedItems = JSON.parse(localStorage.getItem(storeKey)) || [];\n      if (visitedItems.length > 0) {\n        return this.renderResults(visitedItems, true);\n      }\n    }\n\n    const searchStrLength = getValueLength(this.inputValue);\n\n    if (searchStrLength === 0) {\n      return <div className=\"search-result-none\">{gettext('Type characters to start search')}</div>;\n    }\n    else if (searchStrLength < 3) {\n      return <div className=\"search-result-none\">{gettext('Type more characters to start search')}</div>;\n    }\n    else if (!isResultGetted) {\n      return <span className=\"loading-icon loading-tip\"></span>;\n    }\n    else if (resultItems.length > 0) {\n      return this.renderResults(resultItems);\n    }\n    else {\n      return <div className=\"search-result-none\">{gettext('No results matching')}</div>;\n    }\n  }\n\n  renderResults = (resultItems, isVisited) => {\n    const { highlightIndex, hasMore, searchPageUrl } = this.state;\n\n    const results = (\n      <>\n      {isVisited && <h4 className=\"visited-search-results-title\">{gettext('Search results visited recently')}</h4>}\n      <ul className=\"search-result-list\" ref={this.searchResultListRef}>\n        {resultItems.map((item, index) => {\n          const isHighlight = index === highlightIndex;\n          return (\n            <SearchResultItem\n              key={index}\n              item={item}\n              onItemClickHandler={this.onItemClickHandler}\n              isHighlight={isHighlight}\n              setRef={isHighlight ? (ref) => {this.highlightRef = ref;} : () => {}}\n            />\n          );\n        })}\n      </ul>\n      {(!this.props.isPublic && hasMore) &&\n        <div className=\"more-search-result mb-1 pl-2 d-flex align-items-center\">\n          <Icon symbol=\"more-level\" className=\"more-search-result-icon\" />\n          <a href={searchPageUrl} className=\"more-search-result-text ml-1\">{gettext('More')}</a>\n        </div>\n      }\n      </>\n    );\n\n    return (\n      <>\n        <MediaQuery query=\"(min-width: 768px)\">\n          <div className=\"search-result-list-container\">{results}</div>\n        </MediaQuery>\n        <MediaQuery query=\"(max-width: 767.8px)\">\n          {results}\n        </MediaQuery>\n      </>\n    );\n  }\n\n  onSearchToggle = () => {\n    this.setState({\n      isSearchInputShow: !this.state.isSearchInputShow,\n      isMaskShow: !this.state.isMaskShow,\n    });\n  };\n\n  render() {\n    let width = this.state.width !== 'default' ? this.state.width : '';\n    let style = {'width': width};\n    const { isMaskShow } = this.state;\n    const placeholder = `${this.props.placeholder}${isMaskShow ? '' : ` (${controlKey} + f )`}`;\n    return (\n      <Fragment>\n        <MediaQuery query=\"(min-width: 768px)\">\n          <div className=\"search\">\n            <div className={`search-mask ${isMaskShow ? 'show' : 'hide'}`} onClick={this.onCloseHandler}></div>\n            <div className={`search-container ${isMaskShow ? 'show' : ''}`}>\n              <div className={`input-icon ${isMaskShow ? 'mb-1' : ''}`}>\n                <i className=\"search-icon-left input-icon-addon fas fa-search\"></i>\n                <input\n                  type=\"text\"\n                  className=\"form-control search-input\"\n                  name=\"query\"\n                  placeholder={placeholder}\n                  style={style}\n                  value={this.state.value}\n                  onFocus={this.onFocusHandler}\n                  onChange={this.onChangeHandler}\n                  autoComplete=\"off\"\n                  ref={this.inputRef}\n                  onKeyDown={this.onKeydownHandler}\n                />\n                {this.state.isCloseShow &&\n                  <button type=\"button\" className=\"search-icon-right input-icon-addon fas fa-times border-0 bg-transparent mr-4\" onClick={this.onCloseHandler} aria-label={gettext('Close')}></button>\n                }\n              </div>\n              <div\n                className=\"search-result-container dropdown-search-result-container\"\n                ref={this.searchContainer}\n              >\n                {this.renderSearchResult()}\n              </div>\n            </div>\n          </div>\n        </MediaQuery>\n        <MediaQuery query=\"(max-width: 767.8px)\">\n          <div className=\"search-icon-container\">\n            <i className=\"search-icon fas fa-search\" onClick={this.onSearchToggle}></i>\n          </div>\n          {this.state.isSearchInputShow &&\n            <div className=\"search\">\n              <div className={`search-mask ${isMaskShow ? '' : 'hide'}`} onClick={this.onCloseHandler}></div>\n              <div className=\"search-container\">\n                <div className=\"input-icon\">\n                  <i className=\"search-icon-left input-icon-addon fas fa-search\"></i>\n                  <input\n                    type=\"text\"\n                    className=\"form-control search-input\"\n                    name=\"query\"\n                    placeholder={placeholder}\n                    style={style}\n                    value={this.state.value}\n                    onFocus={this.onFocusHandler}\n                    onChange={this.onChangeHandler}\n                    autoComplete=\"off\"\n                  />\n                  {this.state.isCloseShow &&\n                    <button type=\"button\" className=\"search-icon-right input-icon-addon fas fa-times border-0 bg-transparent\" onClick={this.onCloseHandler} aria-label={gettext('Close')}></button>\n                  }\n                </div>\n                <div className=\"search-result-container dropdown-search-result-container\">\n                  {this.renderSearchResult()}\n                </div>\n              </div>\n            </div>\n          }\n        </MediaQuery>\n      </Fragment>\n    );\n  }\n}\n\nSearch.propTypes = propTypes;\n\nexport default Search;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}