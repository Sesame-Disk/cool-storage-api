{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{Button,Modal,ModalHeader,ModalBody,ModalFooter,Alert}from'reactstrap';import{gettext}from'../../utils/constants';import{seafileAPI}from'../../utils/seafile-api';import FileChooser from'../file-chooser/file-chooser';import{Utils}from'../../utils/utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SaveSharedFileDialog=/*#__PURE__*/function(_React$Component){_inherits(SaveSharedFileDialog,_React$Component);var _super=_createSuper(SaveSharedFileDialog);function SaveSharedFileDialog(props){var _this;_classCallCheck(this,SaveSharedFileDialog);_this=_super.call(this,props);_this.onSaveSharedFile=function(){var _this$props=_this.props,sharedToken=_this$props.sharedToken,filePath=_this$props.filePath;seafileAPI.saveSharedFile(_this.state.repo.repo_id,_this.state.selectedPath,sharedToken,filePath).then(function(res){_this.props.toggleCancel();_this.props.handleSaveSharedFile();}).catch(function(error){var errMessage=Utils.getErrorMsg(error);_this.setState({errMessage:errMessage});});};_this.onDirentItemClick=function(repo,selectedPath,dirent){if(dirent.type==='dir'){_this.setState({repo:repo,selectedPath:selectedPath});}else{_this.setState({repo:null,selectedPath:''});}};_this.onRepoItemClick=function(repo){_this.setState({repo:repo,selectedPath:'/'});};_this.state={repo:null,selectedPath:'',errMessage:''};return _this;}_createClass(SaveSharedFileDialog,[{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(Modal,{isOpen:true,className:\"sf-save-file\",children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:this.props.toggleCancel,children:gettext('Save to:')}),/*#__PURE__*/_jsxs(ModalBody,{children:[/*#__PURE__*/_jsx(FileChooser,{isShowFile:false,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:\"only_all_repos\"}),this.state.errMessage&&/*#__PURE__*/_jsx(Alert,{color:\"danger\",children:this.state.errMessage})]}),/*#__PURE__*/_jsxs(ModalFooter,{children:[/*#__PURE__*/_jsx(Button,{color:\"secondary\",onClick:this.props.toggleCancel,children:gettext('Cancel')}),this.state.selectedPath?/*#__PURE__*/_jsx(Button,{color:\"primary\",onClick:this.onSaveSharedFile,children:gettext('Submit')}):/*#__PURE__*/_jsx(Button,{color:\"primary\",disabled:true,children:gettext('Submit')})]})]});}}]);return SaveSharedFileDialog;}(React.Component);export default SaveSharedFileDialog;","map":{"version":3,"names":["React","Button","Modal","ModalHeader","ModalBody","ModalFooter","Alert","gettext","seafileAPI","FileChooser","Utils","jsx","_jsx","jsxs","_jsxs","SaveSharedFileDialog","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","onSaveSharedFile","_this$props","sharedToken","filePath","saveSharedFile","state","repo","repo_id","selectedPath","then","res","toggleCancel","handleSaveSharedFile","catch","error","errMessage","getErrorMsg","setState","onDirentItemClick","dirent","type","onRepoItemClick","_createClass","key","value","render","isOpen","className","children","toggle","isShowFile","mode","color","onClick","disabled","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/save-shared-file-dialog.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport FileChooser from '../file-chooser/file-chooser';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  sharedToken: PropTypes.string.isRequired,\n  filePath: PropTypes.string,\n  toggleCancel: PropTypes.func.isRequired,\n  handleSaveSharedFile: PropTypes.func.isRequired,\n};\n\nclass SaveSharedFileDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repo: null,\n      selectedPath: '',\n      errMessage: '',\n    };\n  }\n\n  onSaveSharedFile = () => {\n    const { sharedToken, filePath } = this.props;\n    seafileAPI.saveSharedFile(this.state.repo.repo_id, this.state.selectedPath, sharedToken, filePath).then((res) => {\n      this.props.toggleCancel();\n      this.props.handleSaveSharedFile();\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      this.setState({errMessage: errMessage});\n    });\n  };\n\n  onDirentItemClick = (repo, selectedPath, dirent) => {\n    if (dirent.type === 'dir') {\n      this.setState({\n        repo: repo,\n        selectedPath: selectedPath,\n      });\n    }\n    else {\n      this.setState({\n        repo: null,\n        selectedPath: '',\n      });\n    }\n  };\n\n  onRepoItemClick = (repo) => {\n    this.setState({\n      repo: repo,\n      selectedPath: '/',\n    });\n  };\n\n  render() {\n    return (\n      <Modal isOpen={true} className=\"sf-save-file\">\n        <ModalHeader toggle={this.props.toggleCancel}>{gettext('Save to:')}</ModalHeader>\n        <ModalBody>\n          <FileChooser\n            isShowFile={false}\n            onDirentItemClick={this.onDirentItemClick}\n            onRepoItemClick={this.onRepoItemClick}\n            mode=\"only_all_repos\"\n          />\n          {this.state.errMessage && <Alert color=\"danger\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleCancel}>{gettext('Cancel')}</Button>\n          { this.state.selectedPath ?\n            <Button color=\"primary\" onClick={this.onSaveSharedFile}>{gettext('Submit')}</Button>\n            :\n            <Button color=\"primary\" disabled>{gettext('Submit')}</Button>\n          }\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nSaveSharedFileDialog.propTypes = propTypes;\n\nexport default SaveSharedFileDialog;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}