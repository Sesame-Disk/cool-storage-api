{"ast":null,"code":"import _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport React, { useCallback, useState } from 'react';\nimport { Button, Modal, ModalHeader, ModalBody } from 'reactstrap';\nimport { useTranslation } from 'react-i18next';\nimport context from '../../../../context';\nimport LocalFiles from './local-files';\nimport toaster from '../../../../components/toast';\nimport { getErrorMsg } from '../../../../utils/';\nimport { ELEMENT_TYPE, FILE_TYPE } from '../../constants';\nimport './index.css';\nvar SelectSdocFileDialog = function SelectSdocFileDialog(_ref) {\n  var editor = _ref.editor,\n    dialogType = _ref.dialogType,\n    closeDialog = _ref.closeDialog,\n    insertLinkCallback = _ref.insertLinkCallback;\n  var modalTitle = dialogType === ELEMENT_TYPE.FILE_LINK ? 'Select_file' : 'Select_sdoc_document';\n  var _useTranslation = useTranslation(),\n    t = _useTranslation.t;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    currentSelectedFile = _useState2[0],\n    setCurrentSelectedFile = _useState2[1];\n  var onSelectedFile = useCallback(function (fileInfo) {\n    setCurrentSelectedFile(fileInfo);\n  }, []);\n  var insertFile = useCallback(function (fileInfo) {\n    var insertFileLinkCallback = insertLinkCallback.insertFileLinkCallback,\n      insertSdocFileLinkCallback = insertLinkCallback.insertSdocFileLinkCallback;\n    if (dialogType === ELEMENT_TYPE.FILE_LINK) {\n      insertFileLinkCallback && insertFileLinkCallback(editor, fileInfo.name, fileInfo.file_uuid);\n    } else {\n      insertSdocFileLinkCallback && insertSdocFileLinkCallback(editor, fileInfo.name, fileInfo.file_uuid);\n    }\n  }, [insertLinkCallback, dialogType, editor]);\n  var onSubmit = useCallback(function () {\n    if (!currentSelectedFile) return;\n    var file_uuid = currentSelectedFile.file_uuid;\n    var fileInfo = _objectSpread({}, currentSelectedFile);\n    // File has no id\n    if (!file_uuid || file_uuid === '') {\n      context.getSdocLocalFileId(currentSelectedFile.path).then(function (res) {\n        if (res.status === 200) {\n          fileInfo = _objectSpread(_objectSpread({}, currentSelectedFile), {}, {\n            file_uuid: res.data.file_uuid\n          });\n        }\n        insertFile(fileInfo);\n        closeDialog();\n      }).catch(function (error) {\n        var errorMessage = getErrorMsg(error);\n        toaster.danger(errorMessage);\n      });\n      return;\n    }\n    insertFile(fileInfo);\n    closeDialog();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [currentSelectedFile]);\n  return /*#__PURE__*/React.createElement(Modal, {\n    toggle: closeDialog,\n    isOpen: true,\n    autoFocus: false,\n    zIndex: 1071,\n    returnFocusAfterClose: false,\n    className: \"sdoc-file-select-dialog\",\n    contentClassName: \"sdoc-file-select-modal\"\n  }, /*#__PURE__*/React.createElement(ModalHeader, {\n    toggle: closeDialog\n  }, t(modalTitle)), /*#__PURE__*/React.createElement(ModalBody, {\n    className: \"p-0\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-file-select-container\"\n  }, /*#__PURE__*/React.createElement(LocalFiles, {\n    fileType: FILE_TYPE[dialogType],\n    onSelectedFile: onSelectedFile,\n    toggle: closeDialog\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-file-select-footer\"\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"secondary\",\n    className: \"mr-2\",\n    onClick: closeDialog\n  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    className: \"highlight-bg-color\",\n    disabled: !currentSelectedFile,\n    onClick: onSubmit\n  }, t('Confirm'))))));\n};\nexport default SelectSdocFileDialog;","map":{"version":3,"names":["_objectSpread","React","useCallback","useState","Button","Modal","ModalHeader","ModalBody","useTranslation","context","LocalFiles","toaster","getErrorMsg","ELEMENT_TYPE","FILE_TYPE","SelectSdocFileDialog","_ref","editor","dialogType","closeDialog","insertLinkCallback","modalTitle","FILE_LINK","_useTranslation","t","_useState","_useState2","_slicedToArray","currentSelectedFile","setCurrentSelectedFile","onSelectedFile","fileInfo","insertFile","insertFileLinkCallback","insertSdocFileLinkCallback","name","file_uuid","onSubmit","getSdocLocalFileId","path","then","res","status","data","catch","error","errorMessage","danger","createElement","toggle","isOpen","autoFocus","zIndex","returnFocusAfterClose","className","contentClassName","fileType","color","onClick","disabled"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/commons/select-file-dialog/index.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport React, { useCallback, useState } from 'react';\nimport { Button, Modal, ModalHeader, ModalBody } from 'reactstrap';\nimport { useTranslation } from 'react-i18next';\nimport context from '../../../../context';\nimport LocalFiles from './local-files';\nimport toaster from '../../../../components/toast';\nimport { getErrorMsg } from '../../../../utils/';\nimport { ELEMENT_TYPE, FILE_TYPE } from '../../constants';\nimport './index.css';\nconst SelectSdocFileDialog = _ref => {\n  let {\n    editor,\n    dialogType,\n    closeDialog,\n    insertLinkCallback\n  } = _ref;\n  const modalTitle = dialogType === ELEMENT_TYPE.FILE_LINK ? 'Select_file' : 'Select_sdoc_document';\n  const {\n    t\n  } = useTranslation();\n  const [currentSelectedFile, setCurrentSelectedFile] = useState(null);\n  const onSelectedFile = useCallback(fileInfo => {\n    setCurrentSelectedFile(fileInfo);\n  }, []);\n  const insertFile = useCallback(fileInfo => {\n    const {\n      insertFileLinkCallback,\n      insertSdocFileLinkCallback\n    } = insertLinkCallback;\n    if (dialogType === ELEMENT_TYPE.FILE_LINK) {\n      insertFileLinkCallback && insertFileLinkCallback(editor, fileInfo.name, fileInfo.file_uuid);\n    } else {\n      insertSdocFileLinkCallback && insertSdocFileLinkCallback(editor, fileInfo.name, fileInfo.file_uuid);\n    }\n  }, [insertLinkCallback, dialogType, editor]);\n  const onSubmit = useCallback(() => {\n    if (!currentSelectedFile) return;\n    const {\n      file_uuid\n    } = currentSelectedFile;\n    let fileInfo = _objectSpread({}, currentSelectedFile);\n    // File has no id\n    if (!file_uuid || file_uuid === '') {\n      context.getSdocLocalFileId(currentSelectedFile.path).then(res => {\n        if (res.status === 200) {\n          fileInfo = _objectSpread(_objectSpread({}, currentSelectedFile), {}, {\n            file_uuid: res.data.file_uuid\n          });\n        }\n        insertFile(fileInfo);\n        closeDialog();\n      }).catch(error => {\n        const errorMessage = getErrorMsg(error);\n        toaster.danger(errorMessage);\n      });\n      return;\n    }\n    insertFile(fileInfo);\n    closeDialog();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [currentSelectedFile]);\n  return /*#__PURE__*/React.createElement(Modal, {\n    toggle: closeDialog,\n    isOpen: true,\n    autoFocus: false,\n    zIndex: 1071,\n    returnFocusAfterClose: false,\n    className: \"sdoc-file-select-dialog\",\n    contentClassName: \"sdoc-file-select-modal\"\n  }, /*#__PURE__*/React.createElement(ModalHeader, {\n    toggle: closeDialog\n  }, t(modalTitle)), /*#__PURE__*/React.createElement(ModalBody, {\n    className: \"p-0\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-file-select-container\"\n  }, /*#__PURE__*/React.createElement(LocalFiles, {\n    fileType: FILE_TYPE[dialogType],\n    onSelectedFile: onSelectedFile,\n    toggle: closeDialog\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-file-select-footer\"\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"secondary\",\n    className: \"mr-2\",\n    onClick: closeDialog\n  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    className: \"highlight-bg-color\",\n    disabled: !currentSelectedFile,\n    onClick: onSubmit\n  }, t('Confirm'))))));\n};\nexport default SelectSdocFileDialog;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}