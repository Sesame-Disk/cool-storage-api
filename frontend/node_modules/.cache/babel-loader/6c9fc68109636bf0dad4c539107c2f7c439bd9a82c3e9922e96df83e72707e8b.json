{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _isUrl = _interopRequireDefault(require(\"is-url\"));\nvar _slugid = _interopRequireDefault(require(\"slugid\"));\nvar _slateConvert = require(\"../../../slate-convert\");\nvar _elementTypes = require(\"../../constants/element-types\");\nvar _helpers = require(\"../code-block/helpers\");\nvar withHtml = function withHtml(editor) {\n  var insertData = editor.insertData;\n  var newEditor = editor;\n  newEditor.insertData = function (data) {\n    // If the text is a link and is not within the code_block block, it is processed as link\n    var text = data.getData('text/plain') || '';\n    if (text.trim() && (0, _isUrl.default)(text.trim()) && !(0, _helpers.isInCodeBlock)(newEditor)) {\n      insertData(data);\n      return;\n    }\n\n    // If the copied content contains files, proceed as shown in the image\n    if (data.types.includes('Files')) {\n      insertData(data);\n      return;\n    }\n\n    // If code_block is selected, the copied content will be processed according to code_block\n    if (!data.types.includes('text/code-block') && (0, _helpers.isInCodeBlock)(newEditor)) {\n      var plaintext = data.getData('text/plain') || '';\n      if (plaintext) {\n        var fragmentData = [];\n        plaintext.split('\\n').forEach(function (item) {\n          var codeLine = {\n            id: _slugid.default.nice(),\n            type: _elementTypes.CODE_LINE,\n            children: [{\n              text: item,\n              id: _slugid.default.nice()\n            }]\n          };\n          fragmentData.push(codeLine);\n        });\n        newEditor.insertFragment(fragmentData);\n      }\n      return;\n    }\n\n    // If it is in slate format, it will be processed in slate format.\n    if (newEditor.insertFragmentData(data)) {\n      return;\n    }\n\n    // If it is in html format, it will be processed in html format.\n    var htmlContent = data.getData('text/html') || '';\n    if (htmlContent) {\n      var content = (0, _slateConvert.deserializeHtml)(htmlContent);\n      editor.insertFragment(content);\n      return;\n    }\n    insertData(data);\n  };\n  return newEditor;\n};\nvar _default = exports.default = withHtml;","map":{"version":3,"names":["_interopRequireDefault","require","default","Object","defineProperty","exports","value","_isUrl","_slugid","_slateConvert","_elementTypes","_helpers","withHtml","editor","insertData","newEditor","data","text","getData","trim","isInCodeBlock","types","includes","plaintext","fragmentData","split","forEach","item","codeLine","id","nice","type","CODE_LINE","children","push","insertFragment","insertFragmentData","htmlContent","content","deserializeHtml","_default"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/seafile-editor/dist/extension/plugins/html/plugin.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _isUrl = _interopRequireDefault(require(\"is-url\"));\nvar _slugid = _interopRequireDefault(require(\"slugid\"));\nvar _slateConvert = require(\"../../../slate-convert\");\nvar _elementTypes = require(\"../../constants/element-types\");\nvar _helpers = require(\"../code-block/helpers\");\nconst withHtml = editor => {\n  const {\n    insertData\n  } = editor;\n  const newEditor = editor;\n  newEditor.insertData = data => {\n    // If the text is a link and is not within the code_block block, it is processed as link\n    const text = data.getData('text/plain') || '';\n    if (text.trim() && (0, _isUrl.default)(text.trim()) && !(0, _helpers.isInCodeBlock)(newEditor)) {\n      insertData(data);\n      return;\n    }\n\n    // If the copied content contains files, proceed as shown in the image\n    if (data.types.includes('Files')) {\n      insertData(data);\n      return;\n    }\n\n    // If code_block is selected, the copied content will be processed according to code_block\n    if (!data.types.includes('text/code-block') && (0, _helpers.isInCodeBlock)(newEditor)) {\n      const plaintext = data.getData('text/plain') || '';\n      if (plaintext) {\n        let fragmentData = [];\n        plaintext.split('\\n').forEach(item => {\n          const codeLine = {\n            id: _slugid.default.nice(),\n            type: _elementTypes.CODE_LINE,\n            children: [{\n              text: item,\n              id: _slugid.default.nice()\n            }]\n          };\n          fragmentData.push(codeLine);\n        });\n        newEditor.insertFragment(fragmentData);\n      }\n      return;\n    }\n\n    // If it is in slate format, it will be processed in slate format.\n    if (newEditor.insertFragmentData(data)) {\n      return;\n    }\n\n    // If it is in html format, it will be processed in html format.\n    const htmlContent = data.getData('text/html') || '';\n    if (htmlContent) {\n      const content = (0, _slateConvert.deserializeHtml)(htmlContent);\n      editor.insertFragment(content);\n      return;\n    }\n    insertData(data);\n  };\n  return newEditor;\n};\nvar _default = exports.default = withHtml;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}