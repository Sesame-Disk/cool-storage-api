{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{v4 as uuidv4}from'uuid';import{gettext,siteRoot}from'../../utils/constants';import{Utils}from'../../utils/utils';import SeahubPopover from'../common/seahub-popover';import ListTagPopover from'../popover/list-tag-popover';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var DirTool=/*#__PURE__*/function(_React$Component){_inherits(DirTool,_React$Component);var _super=_createSuper(DirTool);function DirTool(props){var _this;_classCallCheck(this,DirTool);_this=_super.call(this,props);_this.onMouseDown=function(e){e.stopPropagation();};_this.toggleRepoTag=function(e){e.stopPropagation();_this.setState({isListRepoTagShow:!_this.state.isListRepoTagShow});};_this.hidePopover=function(e){if(e){var dom=e.target;while(dom){if(typeof dom.className==='string'&&dom.className.includes('tag-color-popover'))return;dom=dom.parentNode;}}_this.setState({isListRepoTagShow:false});};_this.toggleCancel=function(){_this.setState({isListRepoTagShow:false});};_this.state={isListRepoTagShow:false};_this.tagsIconID=\"tags-icon-\".concat(uuidv4());return _this;}_createClass(DirTool,[{key:\"isMarkdownFile\",value:function isMarkdownFile(filePath){return Utils.getFileName(filePath).includes('.md');}},{key:\"render\",value:function render(){var _this$props=this.props,repoID=_this$props.repoID,userPerm=_this$props.userPerm,currentPath=_this$props.currentPath;if(userPerm!=='rw'){return'';}if(this.isMarkdownFile(currentPath)){return'';}var toolbarDom=null;if(Utils.getFileName(currentPath)){// name not '' is not root path\nvar trashUrl=siteRoot+'repo/'+repoID+'/trash/?path='+encodeURIComponent(currentPath);toolbarDom=/*#__PURE__*/_jsxs(\"ul\",{className:\"path-toolbar\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"toolbar-item\",children:/*#__PURE__*/_jsx(\"a\",{className:\"op-link sf2-icon-tag\",href:\"#\",id:this.tagsIconID,role:\"button\",onClick:this.toggleRepoTag,onMouseDown:this.onMouseDown,title:gettext('Tags'),\"aria-label\":gettext('Tags')})}),/*#__PURE__*/_jsx(\"li\",{className:\"toolbar-item\",children:/*#__PURE__*/_jsx(\"a\",{className:\"op-link sf2-icon-recycle\",href:trashUrl,title:gettext('Trash'),\"aria-label\":gettext('Trash')})})]});}else{// currentPath === '/' is root path\nvar _trashUrl=siteRoot+'repo/'+repoID+'/trash/';var historyUrl=siteRoot+'repo/history/'+repoID+'/';toolbarDom=/*#__PURE__*/_jsxs(\"ul\",{className:\"path-toolbar\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"toolbar-item\",children:/*#__PURE__*/_jsx(\"a\",{className:\"op-link sf2-icon-tag\",href:\"#\",id:this.tagsIconID,role:\"button\",onClick:this.toggleRepoTag,onMouseDown:this.onMouseDown,title:gettext('Tags'),\"aria-label\":gettext('Tags')})}),/*#__PURE__*/_jsx(\"li\",{className:\"toolbar-item\",children:/*#__PURE__*/_jsx(\"a\",{className:\"op-link sf2-icon-recycle\",href:_trashUrl,title:gettext('Trash'),\"aria-label\":gettext('Trash')})}),/*#__PURE__*/_jsx(\"li\",{className:\"toolbar-item\",children:/*#__PURE__*/_jsx(\"a\",{className:\"op-link sf2-icon-history\",href:historyUrl,title:gettext('History'),\"aria-label\":gettext('History')})})]});}return/*#__PURE__*/_jsxs(_Fragment,{children:[toolbarDom,this.state.isListRepoTagShow&&/*#__PURE__*/_jsx(SeahubPopover,{popoverClassName:\"list-tag-popover\",target:this.tagsIconID,hideSeahubPopover:this.hidePopover,hideSeahubPopoverWithEsc:this.hidePopover,canHideSeahubPopover:true,boundariesElement:document.body,placement:'bottom-end',children:/*#__PURE__*/_jsx(ListTagPopover,{repoID:repoID,onListTagCancel:this.toggleCancel})})]});}}]);return DirTool;}(React.Component);export default DirTool;","map":{"version":3,"names":["React","v4","uuidv4","gettext","siteRoot","Utils","SeahubPopover","ListTagPopover","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","DirTool","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","onMouseDown","e","stopPropagation","toggleRepoTag","setState","isListRepoTagShow","state","hidePopover","dom","target","className","includes","parentNode","toggleCancel","tagsIconID","concat","_createClass","key","value","isMarkdownFile","filePath","getFileName","render","_this$props","repoID","userPerm","currentPath","toolbarDom","trashUrl","encodeURIComponent","children","href","id","role","onClick","title","historyUrl","popoverClassName","hideSeahubPopover","hideSeahubPopoverWithEsc","canHideSeahubPopover","boundariesElement","document","body","placement","onListTagCancel","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/cur-dir-path/dir-tool.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { v4 as uuidv4 } from 'uuid';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport SeahubPopover from '../common/seahub-popover';\nimport ListTagPopover from '../popover/list-tag-popover';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  userPerm: PropTypes.string,\n  currentPath: PropTypes.string.isRequired,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  onDeleteRepoTag: PropTypes.func.isRequired,\n};\n\nclass DirTool extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isListRepoTagShow: false,\n    };\n    this.tagsIconID = `tags-icon-${uuidv4()}`;\n  }\n\n  onMouseDown = (e) => {\n    e.stopPropagation();\n  };\n\n  toggleRepoTag = (e) => {\n    e.stopPropagation();\n    this.setState({ isListRepoTagShow: !this.state.isListRepoTagShow });\n  };\n\n  hidePopover = (e) => {\n    if (e) {\n      let dom = e.target;\n      while (dom) {\n        if (typeof dom.className === 'string' && dom.className.includes('tag-color-popover')) return;\n        dom = dom.parentNode;\n      }\n    }\n    this.setState({ isListRepoTagShow: false });\n  };\n\n  toggleCancel = () => {\n    this.setState({ isListRepoTagShow: false });\n  };\n\n  isMarkdownFile(filePath) {\n    return Utils.getFileName(filePath).includes('.md');\n  }\n\n  render() {\n    let { repoID, userPerm, currentPath } = this.props;\n    if (userPerm !== 'rw') {\n      return '';\n    }\n    if (this.isMarkdownFile(currentPath)) {\n      return '';\n    }\n    let toolbarDom = null;\n    if (Utils.getFileName(currentPath)) { // name not '' is not root path\n      let trashUrl = siteRoot + 'repo/' + repoID + '/trash/?path=' + encodeURIComponent(currentPath);\n      toolbarDom = (\n        <ul className=\"path-toolbar\">\n          <li className=\"toolbar-item\">\n            <a\n              className=\"op-link sf2-icon-tag\"\n              href=\"#\"\n              id={this.tagsIconID}\n              role=\"button\"\n              onClick={this.toggleRepoTag}\n              onMouseDown={this.onMouseDown}\n              title={gettext('Tags')}\n              aria-label={gettext('Tags')}\n            ></a>\n          </li>\n          <li className=\"toolbar-item\">\n            <a className=\"op-link sf2-icon-recycle\" href={trashUrl} title={gettext('Trash')} aria-label={gettext('Trash')}></a>\n          </li>\n        </ul>\n      );\n    } else { // currentPath === '/' is root path\n      let trashUrl = siteRoot + 'repo/' + repoID + '/trash/';\n      let historyUrl = siteRoot + 'repo/history/' + repoID + '/';\n      toolbarDom = (\n        <ul className=\"path-toolbar\">\n          <li className=\"toolbar-item\">\n            <a\n              className=\"op-link sf2-icon-tag\"\n              href=\"#\"\n              id={this.tagsIconID}\n              role=\"button\"\n              onClick={this.toggleRepoTag}\n              onMouseDown={this.onMouseDown}\n              title={gettext('Tags')}\n              aria-label={gettext('Tags')}\n            ></a>\n          </li>\n          <li className=\"toolbar-item\">\n            <a className=\"op-link sf2-icon-recycle\" href={trashUrl} title={gettext('Trash')} aria-label={gettext('Trash')}></a>\n          </li>\n          <li className=\"toolbar-item\">\n            <a className=\"op-link sf2-icon-history\" href={historyUrl} title={gettext('History')} aria-label={gettext('History')}></a>\n          </li>\n        </ul>\n      );\n    }\n    return (\n      <>\n        {toolbarDom}\n        {this.state.isListRepoTagShow &&\n          <SeahubPopover\n            popoverClassName=\"list-tag-popover\"\n            target={this.tagsIconID}\n            hideSeahubPopover={this.hidePopover}\n            hideSeahubPopoverWithEsc={this.hidePopover}\n            canHideSeahubPopover={true}\n            boundariesElement={document.body}\n            placement={'bottom-end'}\n          >\n            <ListTagPopover\n              repoID={repoID}\n              onListTagCancel={this.toggleCancel}\n            />\n          </SeahubPopover>\n        }\n      </>\n    );\n  }\n}\n\nDirTool.propTypes = propTypes;\n\nexport default DirTool;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}