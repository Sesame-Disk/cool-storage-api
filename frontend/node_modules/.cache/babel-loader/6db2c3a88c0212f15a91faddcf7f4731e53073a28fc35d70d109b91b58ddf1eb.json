{"ast":null,"code":"import _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport isHotkey from 'is-hotkey';\nimport { Editor, Range, Transforms } from '@seafile/slate';\nimport { PARAGRAPH } from '../../../constants';\nvar withParagraph = function withParagraph(editor) {\n  var handleTab = editor.handleTab,\n    insertText = editor.insertText,\n    deleteBackward = editor.deleteBackward;\n  var newEditor = editor;\n  newEditor.handleTab = function (event) {\n    var _selectedNode$;\n    var selection = newEditor.selection;\n    if (!selection) return;\n    if (!Range.isCollapsed(selection)) return;\n    var selectedNode = Editor.node(newEditor, selection, {\n      depth: 1\n    });\n    if ((selectedNode === null || selectedNode === void 0 ? void 0 : (_selectedNode$ = selectedNode[0]) === null || _selectedNode$ === void 0 ? void 0 : _selectedNode$.type) === PARAGRAPH) {\n      event.preventDefault();\n      var path = Editor.path(newEditor, selection);\n      var point = Editor.point(newEditor, selection);\n      var isStart = Editor.isStart(newEditor, point, [path[0]]);\n      if (isStart) {\n        var indent;\n        if (isHotkey('shift+tab', event)) {\n          indent = false;\n        }\n        if (isHotkey('tab', event)) {\n          indent = true;\n        }\n        Transforms.setNodes(newEditor, {\n          indent: indent\n        }, {\n          at: [path[0]]\n        });\n      } else {\n        if (isHotkey('tab', event)) insertText('  ');\n      }\n      return;\n    }\n    return handleTab(event);\n  };\n  newEditor.deleteBackward = function (unit) {\n    var selection = newEditor.selection;\n    if (!selection) return;\n    var _Editor$node = Editor.node(newEditor, selection, {\n        depth: 1\n      }),\n      _Editor$node2 = _slicedToArray(_Editor$node, 1),\n      _Editor$node2$ = _Editor$node2[0],\n      selectedNode = _Editor$node2$ === void 0 ? {} : _Editor$node2$;\n    var type = selectedNode.type,\n      indent = selectedNode.indent;\n    if (Range.isCollapsed(selection) && type === PARAGRAPH && indent) {\n      var path = Editor.path(newEditor, selection);\n      var point = Editor.point(newEditor, selection);\n      var isStart = Editor.isStart(newEditor, point, [path[0]]);\n      if (isStart) {\n        Transforms.setNodes(newEditor, {\n          indent: false\n        }, {\n          at: [path[0]]\n        });\n        return;\n      }\n    }\n    return deleteBackward(unit);\n  };\n  return newEditor;\n};\nexport default withParagraph;","map":{"version":3,"names":["isHotkey","Editor","Range","Transforms","PARAGRAPH","withParagraph","editor","handleTab","insertText","deleteBackward","newEditor","event","_selectedNode$","selection","isCollapsed","selectedNode","node","depth","type","preventDefault","path","point","isStart","indent","setNodes","at","unit","_Editor$node","_Editor$node2","_slicedToArray","_Editor$node2$"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/plugins/paragraph/plugin/index.js"],"sourcesContent":["import isHotkey from 'is-hotkey';\nimport { Editor, Range, Transforms } from '@seafile/slate';\nimport { PARAGRAPH } from '../../../constants';\nconst withParagraph = editor => {\n  const {\n    handleTab,\n    insertText,\n    deleteBackward\n  } = editor;\n  const newEditor = editor;\n  newEditor.handleTab = event => {\n    var _selectedNode$;\n    const {\n      selection\n    } = newEditor;\n    if (!selection) return;\n    if (!Range.isCollapsed(selection)) return;\n    const selectedNode = Editor.node(newEditor, selection, {\n      depth: 1\n    });\n    if ((selectedNode === null || selectedNode === void 0 ? void 0 : (_selectedNode$ = selectedNode[0]) === null || _selectedNode$ === void 0 ? void 0 : _selectedNode$.type) === PARAGRAPH) {\n      event.preventDefault();\n      const path = Editor.path(newEditor, selection);\n      const point = Editor.point(newEditor, selection);\n      const isStart = Editor.isStart(newEditor, point, [path[0]]);\n      if (isStart) {\n        let indent;\n        if (isHotkey('shift+tab', event)) {\n          indent = false;\n        }\n        if (isHotkey('tab', event)) {\n          indent = true;\n        }\n        Transforms.setNodes(newEditor, {\n          indent: indent\n        }, {\n          at: [path[0]]\n        });\n      } else {\n        if (isHotkey('tab', event)) insertText('  ');\n      }\n      return;\n    }\n    return handleTab(event);\n  };\n  newEditor.deleteBackward = unit => {\n    const {\n      selection\n    } = newEditor;\n    if (!selection) return;\n    const [selectedNode = {}] = Editor.node(newEditor, selection, {\n      depth: 1\n    });\n    const {\n      type,\n      indent\n    } = selectedNode;\n    if (Range.isCollapsed(selection) && type === PARAGRAPH && indent) {\n      const path = Editor.path(newEditor, selection);\n      const point = Editor.point(newEditor, selection);\n      const isStart = Editor.isStart(newEditor, point, [path[0]]);\n      if (isStart) {\n        Transforms.setNodes(newEditor, {\n          indent: false\n        }, {\n          at: [path[0]]\n        });\n        return;\n      }\n    }\n    return deleteBackward(unit);\n  };\n  return newEditor;\n};\nexport default withParagraph;"],"mappings":";AAAA,OAAOA,QAAQ,MAAM,WAAW;AAChC,SAASC,MAAM,EAAEC,KAAK,EAAEC,UAAU,QAAQ,gBAAgB;AAC1D,SAASC,SAAS,QAAQ,oBAAoB;AAC9C,IAAMC,aAAa,GAAG,SAAhBA,aAAaA,CAAGC,MAAM,EAAI;EAC9B,IACEC,SAAS,GAGPD,MAAM,CAHRC,SAAS;IACTC,UAAU,GAERF,MAAM,CAFRE,UAAU;IACVC,cAAc,GACZH,MAAM,CADRG,cAAc;EAEhB,IAAMC,SAAS,GAAGJ,MAAM;EACxBI,SAAS,CAACH,SAAS,GAAG,UAAAI,KAAK,EAAI;IAC7B,IAAIC,cAAc;IAClB,IACEC,SAAS,GACPH,SAAS,CADXG,SAAS;IAEX,IAAI,CAACA,SAAS,EAAE;IAChB,IAAI,CAACX,KAAK,CAACY,WAAW,CAACD,SAAS,CAAC,EAAE;IACnC,IAAME,YAAY,GAAGd,MAAM,CAACe,IAAI,CAACN,SAAS,EAAEG,SAAS,EAAE;MACrDI,KAAK,EAAE;IACT,CAAC,CAAC;IACF,IAAI,CAACF,YAAY,KAAK,IAAI,IAAIA,YAAY,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,CAACH,cAAc,GAAGG,YAAY,CAAC,CAAC,CAAC,MAAM,IAAI,IAAIH,cAAc,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,cAAc,CAACM,IAAI,MAAMd,SAAS,EAAE;MACvLO,KAAK,CAACQ,cAAc,CAAC,CAAC;MACtB,IAAMC,IAAI,GAAGnB,MAAM,CAACmB,IAAI,CAACV,SAAS,EAAEG,SAAS,CAAC;MAC9C,IAAMQ,KAAK,GAAGpB,MAAM,CAACoB,KAAK,CAACX,SAAS,EAAEG,SAAS,CAAC;MAChD,IAAMS,OAAO,GAAGrB,MAAM,CAACqB,OAAO,CAACZ,SAAS,EAAEW,KAAK,EAAE,CAACD,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;MAC3D,IAAIE,OAAO,EAAE;QACX,IAAIC,MAAM;QACV,IAAIvB,QAAQ,CAAC,WAAW,EAAEW,KAAK,CAAC,EAAE;UAChCY,MAAM,GAAG,KAAK;QAChB;QACA,IAAIvB,QAAQ,CAAC,KAAK,EAAEW,KAAK,CAAC,EAAE;UAC1BY,MAAM,GAAG,IAAI;QACf;QACApB,UAAU,CAACqB,QAAQ,CAACd,SAAS,EAAE;UAC7Ba,MAAM,EAAEA;QACV,CAAC,EAAE;UACDE,EAAE,EAAE,CAACL,IAAI,CAAC,CAAC,CAAC;QACd,CAAC,CAAC;MACJ,CAAC,MAAM;QACL,IAAIpB,QAAQ,CAAC,KAAK,EAAEW,KAAK,CAAC,EAAEH,UAAU,CAAC,IAAI,CAAC;MAC9C;MACA;IACF;IACA,OAAOD,SAAS,CAACI,KAAK,CAAC;EACzB,CAAC;EACDD,SAAS,CAACD,cAAc,GAAG,UAAAiB,IAAI,EAAI;IACjC,IACEb,SAAS,GACPH,SAAS,CADXG,SAAS;IAEX,IAAI,CAACA,SAAS,EAAE;IAChB,IAAAc,YAAA,GAA4B1B,MAAM,CAACe,IAAI,CAACN,SAAS,EAAEG,SAAS,EAAE;QAC5DI,KAAK,EAAE;MACT,CAAC,CAAC;MAAAW,aAAA,GAAAC,cAAA,CAAAF,YAAA;MAAAG,cAAA,GAAAF,aAAA;MAFKb,YAAY,GAAAe,cAAA,cAAG,CAAC,CAAC,GAAAA,cAAA;IAGxB,IACEZ,IAAI,GAEFH,YAAY,CAFdG,IAAI;MACJK,MAAM,GACJR,YAAY,CADdQ,MAAM;IAER,IAAIrB,KAAK,CAACY,WAAW,CAACD,SAAS,CAAC,IAAIK,IAAI,KAAKd,SAAS,IAAImB,MAAM,EAAE;MAChE,IAAMH,IAAI,GAAGnB,MAAM,CAACmB,IAAI,CAACV,SAAS,EAAEG,SAAS,CAAC;MAC9C,IAAMQ,KAAK,GAAGpB,MAAM,CAACoB,KAAK,CAACX,SAAS,EAAEG,SAAS,CAAC;MAChD,IAAMS,OAAO,GAAGrB,MAAM,CAACqB,OAAO,CAACZ,SAAS,EAAEW,KAAK,EAAE,CAACD,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;MAC3D,IAAIE,OAAO,EAAE;QACXnB,UAAU,CAACqB,QAAQ,CAACd,SAAS,EAAE;UAC7Ba,MAAM,EAAE;QACV,CAAC,EAAE;UACDE,EAAE,EAAE,CAACL,IAAI,CAAC,CAAC,CAAC;QACd,CAAC,CAAC;QACF;MACF;IACF;IACA,OAAOX,cAAc,CAACiB,IAAI,CAAC;EAC7B,CAAC;EACD,OAAOhB,SAAS;AAClB,CAAC;AACD,eAAeL,aAAa"},"metadata":{},"sourceType":"module","externalDependencies":[]}