{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/slicedToArray.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.normalizeList = void 0;\nvar _slate = require(\"slate\");\nvar _transforms = require(\"../transforms\");\nvar _elementTypes = require(\"../../../constants/element-types\");\nvar _core = require(\"../../../core\");\nvar _constant = require(\"../constant\");\nvar normalizeList = function normalizeList(editor) {\n  var normalizeNode = editor.normalizeNode;\n  return function (_ref) {\n    var _ref3 = _slicedToArray(_ref, 2),\n      node = _ref3[0],\n      path = _ref3[1];\n    if (!_slate.Element.isElement(node)) {\n      return normalizeNode([node, path]);\n    }\n\n    // root\n    if (_constant.LIST_TYPES.includes(node.type)) {\n      var children = (0, _core.getChildren)([node, path]);\n      var nonLiChild = children.find(function (_ref2) {\n        var _ref4 = _slicedToArray(_ref2, 1),\n          child = _ref4[0];\n        return child.type !== _elementTypes.LIST_ITEM;\n      });\n      if (nonLiChild) {\n        var listItem = (0, _core.generateElement)(_elementTypes.LIST_ITEM, {\n          childrenOrText: []\n        });\n        _slate.Transforms.wrapNodes(editor, listItem, {\n          at: nonLiChild[1]\n        });\n        return;\n      }\n    }\n    if ((0, _core.match)(node, [], {\n      type: _constant.LIST_TYPES\n    })) {\n      if (!node.children.length || !node.children.find(function (item) {\n        return item.type === _elementTypes.LIST_ITEM;\n      })) {\n        _slate.Transforms.removeNodes(editor, {\n          at: path\n        });\n        return;\n      }\n      var nextPath = _slate.Path.next(path);\n      var nextNode = (0, _core.getNode)(editor, nextPath);\n      if ((nextNode === null || nextNode === void 0 ? void 0 : nextNode.type) === node.type) {\n        (0, _transforms.moveListItemsToList)(editor, {\n          fromList: [nextNode, nextPath],\n          toList: [node, path],\n          deleteFromList: true\n        });\n      }\n      var prevPath = (0, _core.getPreviousPath)(path);\n      var prevNode = (0, _core.getNode)(editor, prevPath);\n      if ((prevNode === null || prevNode === void 0 ? void 0 : prevNode.type) === node.type) {\n        editor.normalizeNode([prevNode, prevPath]);\n        return;\n      }\n      if ((0, _transforms.normalizeNestedList)(editor, {\n        nestedListItem: [node, path]\n      })) {\n        return;\n      }\n    }\n    if (node.type === _elementTypes.LIST_ITEM) {\n      if ((0, _transforms.normalizeListItem)(editor, {\n        listItem: [node, path]\n      })) {\n        return;\n      }\n    }\n    normalizeNode([node, path]);\n  };\n};\nexports.normalizeList = normalizeList;","map":{"version":3,"names":["_slicedToArray","require","default","Object","defineProperty","exports","value","normalizeList","_slate","_transforms","_elementTypes","_core","_constant","editor","normalizeNode","_ref","_ref3","node","path","Element","isElement","LIST_TYPES","includes","type","children","getChildren","nonLiChild","find","_ref2","_ref4","child","LIST_ITEM","listItem","generateElement","childrenOrText","Transforms","wrapNodes","at","match","length","item","removeNodes","nextPath","Path","next","nextNode","getNode","moveListItemsToList","fromList","toList","deleteFromList","prevPath","getPreviousPath","prevNode","normalizeNestedList","nestedListItem","normalizeListItem"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/seafile-editor/dist/extension/plugins/list/plugin/normalize-list.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.normalizeList = void 0;\nvar _slate = require(\"slate\");\nvar _transforms = require(\"../transforms\");\nvar _elementTypes = require(\"../../../constants/element-types\");\nvar _core = require(\"../../../core\");\nvar _constant = require(\"../constant\");\nconst normalizeList = editor => {\n  const {\n    normalizeNode\n  } = editor;\n  return _ref => {\n    let [node, path] = _ref;\n    if (!_slate.Element.isElement(node)) {\n      return normalizeNode([node, path]);\n    }\n\n    // root\n    if (_constant.LIST_TYPES.includes(node.type)) {\n      const children = (0, _core.getChildren)([node, path]);\n      const nonLiChild = children.find(_ref2 => {\n        let [child] = _ref2;\n        return child.type !== _elementTypes.LIST_ITEM;\n      });\n      if (nonLiChild) {\n        const listItem = (0, _core.generateElement)(_elementTypes.LIST_ITEM, {\n          childrenOrText: []\n        });\n        _slate.Transforms.wrapNodes(editor, listItem, {\n          at: nonLiChild[1]\n        });\n        return;\n      }\n    }\n    if ((0, _core.match)(node, [], {\n      type: _constant.LIST_TYPES\n    })) {\n      if (!node.children.length || !node.children.find(item => item.type === _elementTypes.LIST_ITEM)) {\n        _slate.Transforms.removeNodes(editor, {\n          at: path\n        });\n        return;\n      }\n      const nextPath = _slate.Path.next(path);\n      const nextNode = (0, _core.getNode)(editor, nextPath);\n      if ((nextNode === null || nextNode === void 0 ? void 0 : nextNode.type) === node.type) {\n        (0, _transforms.moveListItemsToList)(editor, {\n          fromList: [nextNode, nextPath],\n          toList: [node, path],\n          deleteFromList: true\n        });\n      }\n      const prevPath = (0, _core.getPreviousPath)(path);\n      const prevNode = (0, _core.getNode)(editor, prevPath);\n      if ((prevNode === null || prevNode === void 0 ? void 0 : prevNode.type) === node.type) {\n        editor.normalizeNode([prevNode, prevPath]);\n        return;\n      }\n      if ((0, _transforms.normalizeNestedList)(editor, {\n        nestedListItem: [node, path]\n      })) {\n        return;\n      }\n    }\n    if (node.type === _elementTypes.LIST_ITEM) {\n      if ((0, _transforms.normalizeListItem)(editor, {\n        listItem: [node, path]\n      })) {\n        return;\n      }\n    }\n    normalizeNode([node, path]);\n  };\n};\nexports.normalizeList = normalizeList;"],"mappings":"AAAA,YAAY;;AAAC,IAAAA,cAAA,GAAAC,OAAA,0HAAAC,OAAA;AAEbC,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAC3CC,KAAK,EAAE;AACT,CAAC,CAAC;AACFD,OAAO,CAACE,aAAa,GAAG,KAAK,CAAC;AAC9B,IAAIC,MAAM,GAAGP,OAAO,CAAC,OAAO,CAAC;AAC7B,IAAIQ,WAAW,GAAGR,OAAO,CAAC,eAAe,CAAC;AAC1C,IAAIS,aAAa,GAAGT,OAAO,CAAC,kCAAkC,CAAC;AAC/D,IAAIU,KAAK,GAAGV,OAAO,CAAC,eAAe,CAAC;AACpC,IAAIW,SAAS,GAAGX,OAAO,CAAC,aAAa,CAAC;AACtC,IAAMM,aAAa,GAAG,SAAhBA,aAAaA,CAAGM,MAAM,EAAI;EAC9B,IACEC,aAAa,GACXD,MAAM,CADRC,aAAa;EAEf,OAAO,UAAAC,IAAI,EAAI;IACb,IAAAC,KAAA,GAAAhB,cAAA,CAAmBe,IAAI;MAAlBE,IAAI,GAAAD,KAAA;MAAEE,IAAI,GAAAF,KAAA;IACf,IAAI,CAACR,MAAM,CAACW,OAAO,CAACC,SAAS,CAACH,IAAI,CAAC,EAAE;MACnC,OAAOH,aAAa,CAAC,CAACG,IAAI,EAAEC,IAAI,CAAC,CAAC;IACpC;;IAEA;IACA,IAAIN,SAAS,CAACS,UAAU,CAACC,QAAQ,CAACL,IAAI,CAACM,IAAI,CAAC,EAAE;MAC5C,IAAMC,QAAQ,GAAG,CAAC,CAAC,EAAEb,KAAK,CAACc,WAAW,EAAE,CAACR,IAAI,EAAEC,IAAI,CAAC,CAAC;MACrD,IAAMQ,UAAU,GAAGF,QAAQ,CAACG,IAAI,CAAC,UAAAC,KAAK,EAAI;QACxC,IAAAC,KAAA,GAAA7B,cAAA,CAAc4B,KAAK;UAAdE,KAAK,GAAAD,KAAA;QACV,OAAOC,KAAK,CAACP,IAAI,KAAKb,aAAa,CAACqB,SAAS;MAC/C,CAAC,CAAC;MACF,IAAIL,UAAU,EAAE;QACd,IAAMM,QAAQ,GAAG,CAAC,CAAC,EAAErB,KAAK,CAACsB,eAAe,EAAEvB,aAAa,CAACqB,SAAS,EAAE;UACnEG,cAAc,EAAE;QAClB,CAAC,CAAC;QACF1B,MAAM,CAAC2B,UAAU,CAACC,SAAS,CAACvB,MAAM,EAAEmB,QAAQ,EAAE;UAC5CK,EAAE,EAAEX,UAAU,CAAC,CAAC;QAClB,CAAC,CAAC;QACF;MACF;IACF;IACA,IAAI,CAAC,CAAC,EAAEf,KAAK,CAAC2B,KAAK,EAAErB,IAAI,EAAE,EAAE,EAAE;MAC7BM,IAAI,EAAEX,SAAS,CAACS;IAClB,CAAC,CAAC,EAAE;MACF,IAAI,CAACJ,IAAI,CAACO,QAAQ,CAACe,MAAM,IAAI,CAACtB,IAAI,CAACO,QAAQ,CAACG,IAAI,CAAC,UAAAa,IAAI;QAAA,OAAIA,IAAI,CAACjB,IAAI,KAAKb,aAAa,CAACqB,SAAS;MAAA,EAAC,EAAE;QAC/FvB,MAAM,CAAC2B,UAAU,CAACM,WAAW,CAAC5B,MAAM,EAAE;UACpCwB,EAAE,EAAEnB;QACN,CAAC,CAAC;QACF;MACF;MACA,IAAMwB,QAAQ,GAAGlC,MAAM,CAACmC,IAAI,CAACC,IAAI,CAAC1B,IAAI,CAAC;MACvC,IAAM2B,QAAQ,GAAG,CAAC,CAAC,EAAElC,KAAK,CAACmC,OAAO,EAAEjC,MAAM,EAAE6B,QAAQ,CAAC;MACrD,IAAI,CAACG,QAAQ,KAAK,IAAI,IAAIA,QAAQ,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,QAAQ,CAACtB,IAAI,MAAMN,IAAI,CAACM,IAAI,EAAE;QACrF,CAAC,CAAC,EAAEd,WAAW,CAACsC,mBAAmB,EAAElC,MAAM,EAAE;UAC3CmC,QAAQ,EAAE,CAACH,QAAQ,EAAEH,QAAQ,CAAC;UAC9BO,MAAM,EAAE,CAAChC,IAAI,EAAEC,IAAI,CAAC;UACpBgC,cAAc,EAAE;QAClB,CAAC,CAAC;MACJ;MACA,IAAMC,QAAQ,GAAG,CAAC,CAAC,EAAExC,KAAK,CAACyC,eAAe,EAAElC,IAAI,CAAC;MACjD,IAAMmC,QAAQ,GAAG,CAAC,CAAC,EAAE1C,KAAK,CAACmC,OAAO,EAAEjC,MAAM,EAAEsC,QAAQ,CAAC;MACrD,IAAI,CAACE,QAAQ,KAAK,IAAI,IAAIA,QAAQ,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,QAAQ,CAAC9B,IAAI,MAAMN,IAAI,CAACM,IAAI,EAAE;QACrFV,MAAM,CAACC,aAAa,CAAC,CAACuC,QAAQ,EAAEF,QAAQ,CAAC,CAAC;QAC1C;MACF;MACA,IAAI,CAAC,CAAC,EAAE1C,WAAW,CAAC6C,mBAAmB,EAAEzC,MAAM,EAAE;QAC/C0C,cAAc,EAAE,CAACtC,IAAI,EAAEC,IAAI;MAC7B,CAAC,CAAC,EAAE;QACF;MACF;IACF;IACA,IAAID,IAAI,CAACM,IAAI,KAAKb,aAAa,CAACqB,SAAS,EAAE;MACzC,IAAI,CAAC,CAAC,EAAEtB,WAAW,CAAC+C,iBAAiB,EAAE3C,MAAM,EAAE;QAC7CmB,QAAQ,EAAE,CAACf,IAAI,EAAEC,IAAI;MACvB,CAAC,CAAC,EAAE;QACF;MACF;IACF;IACAJ,aAAa,CAAC,CAACG,IAAI,EAAEC,IAAI,CAAC,CAAC;EAC7B,CAAC;AACH,CAAC;AACDb,OAAO,CAACE,aAAa,GAAGA,aAAa"},"metadata":{},"sourceType":"script","externalDependencies":[]}