{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/slicedToArray.js\").default;\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _reactstrap = require(\"reactstrap\");\nvar _reactI18next = require(\"react-i18next\");\nvar _helper = require(\"../helper\");\nvar _core = require(\"../../../core\");\nvar _constants = require(\"../../../../constants\");\nvar FormulaModal = function FormulaModal(_ref) {\n  var editor = _ref.editor,\n    formula = _ref.formula,\n    onCloseModal = _ref.onCloseModal;\n  var oldFormulaRef = (0, _react.useRef)(formula);\n  var _ref2 = (0, _react.useState)(formula),\n    _ref3 = _slicedToArray(_ref2, 2),\n    newFormula = _ref3[0],\n    setNewFormula = _ref3[1];\n  var _ref4 = (0, _react.useState)(null),\n    _ref5 = _slicedToArray(_ref4, 2),\n    modifyPath = _ref5[0],\n    setModifyPath = _ref5[1];\n  var _ref6 = (0, _react.useState)(true),\n    _ref7 = _slicedToArray(_ref6, 2),\n    isDisabled = _ref7[0],\n    setIsDisabled = _ref7[1];\n  var formulaPreviewRef = (0, _react.useRef)(null);\n  var _ref8 = (0, _reactI18next.useTranslation)(_constants.TRANSLATE_NAMESPACE),\n    t = _ref8.t;\n\n  // record current selection position\n  (0, _react.useEffect)(function () {\n    var node = (0, _core.getAboveBlockNode)(editor);\n    if (node) {\n      setModifyPath(node[1]);\n      return;\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  (0, _react.useEffect)(function () {\n    if (formulaPreviewRef.current) {\n      formulaPreviewRef.current.innerHTML = '';\n      var dom = window.MathJax.tex2svg(newFormula);\n      formulaPreviewRef.current.appendChild(dom);\n    }\n  });\n  var onFormulaChange = (0, _react.useCallback)(function (event) {\n    setIsDisabled(false);\n    setNewFormula(event.target.value);\n  }, []);\n  var handleUpdateFormula = (0, _react.useCallback)(function () {\n    var data = {\n      formula: newFormula,\n      at: modifyPath\n    };\n    if (oldFormulaRef.current) {\n      (0, _helper.updateFormula)(editor, data);\n    } else {\n      (0, _helper.insertFormula)(editor, data);\n    }\n    onCloseModal();\n  }, [editor, modifyPath, newFormula, onCloseModal]);\n  return /*#__PURE__*/_react.default.createElement(_reactstrap.Modal, {\n    isOpen: true,\n    toggle: onCloseModal,\n    autoFocus: false,\n    wrapClassName: \"formula-dialog-wrapper\"\n  }, /*#__PURE__*/_react.default.createElement(_reactstrap.ModalHeader, {\n    toggle: onCloseModal\n  }, t('insert_formula')), /*#__PURE__*/_react.default.createElement(_reactstrap.ModalBody, null, /*#__PURE__*/_react.default.createElement(\"div\", {\n    className: \"form-group\"\n  }, /*#__PURE__*/_react.default.createElement(\"label\", {\n    className: \"form-check-label\"\n  }, t('Formula')), /*#__PURE__*/_react.default.createElement(_reactstrap.Input, {\n    type: \"textarea\",\n    className: \"form-control\",\n    value: newFormula,\n    autoFocus: true,\n    onChange: onFormulaChange\n  })), /*#__PURE__*/_react.default.createElement(\"div\", {\n    ref: formulaPreviewRef,\n    className: \"formula-preview\"\n  })), /*#__PURE__*/_react.default.createElement(_reactstrap.ModalFooter, null, /*#__PURE__*/_react.default.createElement(_reactstrap.Button, {\n    color: \"secondary\",\n    onClick: onCloseModal\n  }, t('Cancel')), /*#__PURE__*/_react.default.createElement(_reactstrap.Button, {\n    color: \"primary\",\n    disabled: isDisabled,\n    onClick: handleUpdateFormula\n  }, t('Insert_formula'))));\n};\nvar _default = exports.default = FormulaModal;","map":{"version":3,"names":["_slicedToArray","require","default","_interopRequireWildcard","Object","defineProperty","exports","value","_react","_reactstrap","_reactI18next","_helper","_core","_constants","FormulaModal","_ref","editor","formula","onCloseModal","oldFormulaRef","useRef","_ref2","useState","_ref3","newFormula","setNewFormula","_ref4","_ref5","modifyPath","setModifyPath","_ref6","_ref7","isDisabled","setIsDisabled","formulaPreviewRef","_ref8","useTranslation","TRANSLATE_NAMESPACE","t","useEffect","node","getAboveBlockNode","current","innerHTML","dom","window","MathJax","tex2svg","appendChild","onFormulaChange","useCallback","event","target","handleUpdateFormula","data","at","updateFormula","insertFormula","createElement","Modal","isOpen","toggle","autoFocus","wrapClassName","ModalHeader","ModalBody","className","Input","type","onChange","ref","ModalFooter","Button","color","onClick","disabled","_default"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/seafile-editor/dist/extension/plugins/formula/menu/formula-modal.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _reactstrap = require(\"reactstrap\");\nvar _reactI18next = require(\"react-i18next\");\nvar _helper = require(\"../helper\");\nvar _core = require(\"../../../core\");\nvar _constants = require(\"../../../../constants\");\nconst FormulaModal = _ref => {\n  let {\n    editor,\n    formula,\n    onCloseModal\n  } = _ref;\n  const oldFormulaRef = (0, _react.useRef)(formula);\n  const [newFormula, setNewFormula] = (0, _react.useState)(formula);\n  const [modifyPath, setModifyPath] = (0, _react.useState)(null);\n  const [isDisabled, setIsDisabled] = (0, _react.useState)(true);\n  const formulaPreviewRef = (0, _react.useRef)(null);\n  const {\n    t\n  } = (0, _reactI18next.useTranslation)(_constants.TRANSLATE_NAMESPACE);\n\n  // record current selection position\n  (0, _react.useEffect)(() => {\n    const node = (0, _core.getAboveBlockNode)(editor);\n    if (node) {\n      setModifyPath(node[1]);\n      return;\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  (0, _react.useEffect)(() => {\n    if (formulaPreviewRef.current) {\n      formulaPreviewRef.current.innerHTML = '';\n      const dom = window.MathJax.tex2svg(newFormula);\n      formulaPreviewRef.current.appendChild(dom);\n    }\n  });\n  const onFormulaChange = (0, _react.useCallback)(event => {\n    setIsDisabled(false);\n    setNewFormula(event.target.value);\n  }, []);\n  const handleUpdateFormula = (0, _react.useCallback)(() => {\n    const data = {\n      formula: newFormula,\n      at: modifyPath\n    };\n    if (oldFormulaRef.current) {\n      (0, _helper.updateFormula)(editor, data);\n    } else {\n      (0, _helper.insertFormula)(editor, data);\n    }\n    onCloseModal();\n  }, [editor, modifyPath, newFormula, onCloseModal]);\n  return /*#__PURE__*/_react.default.createElement(_reactstrap.Modal, {\n    isOpen: true,\n    toggle: onCloseModal,\n    autoFocus: false,\n    wrapClassName: \"formula-dialog-wrapper\"\n  }, /*#__PURE__*/_react.default.createElement(_reactstrap.ModalHeader, {\n    toggle: onCloseModal\n  }, t('insert_formula')), /*#__PURE__*/_react.default.createElement(_reactstrap.ModalBody, null, /*#__PURE__*/_react.default.createElement(\"div\", {\n    className: \"form-group\"\n  }, /*#__PURE__*/_react.default.createElement(\"label\", {\n    className: \"form-check-label\"\n  }, t('Formula')), /*#__PURE__*/_react.default.createElement(_reactstrap.Input, {\n    type: \"textarea\",\n    className: \"form-control\",\n    value: newFormula,\n    autoFocus: true,\n    onChange: onFormulaChange\n  })), /*#__PURE__*/_react.default.createElement(\"div\", {\n    ref: formulaPreviewRef,\n    className: \"formula-preview\"\n  })), /*#__PURE__*/_react.default.createElement(_reactstrap.ModalFooter, null, /*#__PURE__*/_react.default.createElement(_reactstrap.Button, {\n    color: \"secondary\",\n    onClick: onCloseModal\n  }, t('Cancel')), /*#__PURE__*/_react.default.createElement(_reactstrap.Button, {\n    color: \"primary\",\n    disabled: isDisabled,\n    onClick: handleUpdateFormula\n  }, t('Insert_formula'))));\n};\nvar _default = exports.default = FormulaModal;"],"mappings":"AAAA,YAAY;;AAAC,IAAAA,cAAA,GAAAC,OAAA,0HAAAC,OAAA;AAEb,IAAIC,uBAAuB,GAAGF,OAAO,CAAC,+CAA+C,CAAC,CAACC,OAAO;AAC9FE,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAC3CC,KAAK,EAAE;AACT,CAAC,CAAC;AACFD,OAAO,CAACJ,OAAO,GAAG,KAAK,CAAC;AACxB,IAAIM,MAAM,GAAGL,uBAAuB,CAACF,OAAO,CAAC,OAAO,CAAC,CAAC;AACtD,IAAIQ,WAAW,GAAGR,OAAO,CAAC,YAAY,CAAC;AACvC,IAAIS,aAAa,GAAGT,OAAO,CAAC,eAAe,CAAC;AAC5C,IAAIU,OAAO,GAAGV,OAAO,CAAC,WAAW,CAAC;AAClC,IAAIW,KAAK,GAAGX,OAAO,CAAC,eAAe,CAAC;AACpC,IAAIY,UAAU,GAAGZ,OAAO,CAAC,uBAAuB,CAAC;AACjD,IAAMa,YAAY,GAAG,SAAfA,YAAYA,CAAGC,IAAI,EAAI;EAC3B,IACEC,MAAM,GAGJD,IAAI,CAHNC,MAAM;IACNC,OAAO,GAELF,IAAI,CAFNE,OAAO;IACPC,YAAY,GACVH,IAAI,CADNG,YAAY;EAEd,IAAMC,aAAa,GAAG,CAAC,CAAC,EAAEX,MAAM,CAACY,MAAM,EAAEH,OAAO,CAAC;EACjD,IAAAI,KAAA,GAAoC,CAAC,CAAC,EAAEb,MAAM,CAACc,QAAQ,EAAEL,OAAO,CAAC;IAAAM,KAAA,GAAAvB,cAAA,CAAAqB,KAAA;IAA1DG,UAAU,GAAAD,KAAA;IAAEE,aAAa,GAAAF,KAAA;EAChC,IAAAG,KAAA,GAAoC,CAAC,CAAC,EAAElB,MAAM,CAACc,QAAQ,EAAE,IAAI,CAAC;IAAAK,KAAA,GAAA3B,cAAA,CAAA0B,KAAA;IAAvDE,UAAU,GAAAD,KAAA;IAAEE,aAAa,GAAAF,KAAA;EAChC,IAAAG,KAAA,GAAoC,CAAC,CAAC,EAAEtB,MAAM,CAACc,QAAQ,EAAE,IAAI,CAAC;IAAAS,KAAA,GAAA/B,cAAA,CAAA8B,KAAA;IAAvDE,UAAU,GAAAD,KAAA;IAAEE,aAAa,GAAAF,KAAA;EAChC,IAAMG,iBAAiB,GAAG,CAAC,CAAC,EAAE1B,MAAM,CAACY,MAAM,EAAE,IAAI,CAAC;EAClD,IAAAe,KAAA,GAEI,CAAC,CAAC,EAAEzB,aAAa,CAAC0B,cAAc,EAAEvB,UAAU,CAACwB,mBAAmB,CAAC;IADnEC,CAAC,GAAAH,KAAA,CAADG,CAAC;;EAGH;EACA,CAAC,CAAC,EAAE9B,MAAM,CAAC+B,SAAS,EAAE,YAAM;IAC1B,IAAMC,IAAI,GAAG,CAAC,CAAC,EAAE5B,KAAK,CAAC6B,iBAAiB,EAAEzB,MAAM,CAAC;IACjD,IAAIwB,IAAI,EAAE;MACRX,aAAa,CAACW,IAAI,CAAC,CAAC,CAAC,CAAC;MACtB;IACF;IACA;EACF,CAAC,EAAE,EAAE,CAAC;EACN,CAAC,CAAC,EAAEhC,MAAM,CAAC+B,SAAS,EAAE,YAAM;IAC1B,IAAIL,iBAAiB,CAACQ,OAAO,EAAE;MAC7BR,iBAAiB,CAACQ,OAAO,CAACC,SAAS,GAAG,EAAE;MACxC,IAAMC,GAAG,GAAGC,MAAM,CAACC,OAAO,CAACC,OAAO,CAACvB,UAAU,CAAC;MAC9CU,iBAAiB,CAACQ,OAAO,CAACM,WAAW,CAACJ,GAAG,CAAC;IAC5C;EACF,CAAC,CAAC;EACF,IAAMK,eAAe,GAAG,CAAC,CAAC,EAAEzC,MAAM,CAAC0C,WAAW,EAAE,UAAAC,KAAK,EAAI;IACvDlB,aAAa,CAAC,KAAK,CAAC;IACpBR,aAAa,CAAC0B,KAAK,CAACC,MAAM,CAAC7C,KAAK,CAAC;EACnC,CAAC,EAAE,EAAE,CAAC;EACN,IAAM8C,mBAAmB,GAAG,CAAC,CAAC,EAAE7C,MAAM,CAAC0C,WAAW,EAAE,YAAM;IACxD,IAAMI,IAAI,GAAG;MACXrC,OAAO,EAAEO,UAAU;MACnB+B,EAAE,EAAE3B;IACN,CAAC;IACD,IAAIT,aAAa,CAACuB,OAAO,EAAE;MACzB,CAAC,CAAC,EAAE/B,OAAO,CAAC6C,aAAa,EAAExC,MAAM,EAAEsC,IAAI,CAAC;IAC1C,CAAC,MAAM;MACL,CAAC,CAAC,EAAE3C,OAAO,CAAC8C,aAAa,EAAEzC,MAAM,EAAEsC,IAAI,CAAC;IAC1C;IACApC,YAAY,CAAC,CAAC;EAChB,CAAC,EAAE,CAACF,MAAM,EAAEY,UAAU,EAAEJ,UAAU,EAAEN,YAAY,CAAC,CAAC;EAClD,OAAO,aAAaV,MAAM,CAACN,OAAO,CAACwD,aAAa,CAACjD,WAAW,CAACkD,KAAK,EAAE;IAClEC,MAAM,EAAE,IAAI;IACZC,MAAM,EAAE3C,YAAY;IACpB4C,SAAS,EAAE,KAAK;IAChBC,aAAa,EAAE;EACjB,CAAC,EAAE,aAAavD,MAAM,CAACN,OAAO,CAACwD,aAAa,CAACjD,WAAW,CAACuD,WAAW,EAAE;IACpEH,MAAM,EAAE3C;EACV,CAAC,EAAEoB,CAAC,CAAC,gBAAgB,CAAC,CAAC,EAAE,aAAa9B,MAAM,CAACN,OAAO,CAACwD,aAAa,CAACjD,WAAW,CAACwD,SAAS,EAAE,IAAI,EAAE,aAAazD,MAAM,CAACN,OAAO,CAACwD,aAAa,CAAC,KAAK,EAAE;IAC/IQ,SAAS,EAAE;EACb,CAAC,EAAE,aAAa1D,MAAM,CAACN,OAAO,CAACwD,aAAa,CAAC,OAAO,EAAE;IACpDQ,SAAS,EAAE;EACb,CAAC,EAAE5B,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,aAAa9B,MAAM,CAACN,OAAO,CAACwD,aAAa,CAACjD,WAAW,CAAC0D,KAAK,EAAE;IAC7EC,IAAI,EAAE,UAAU;IAChBF,SAAS,EAAE,cAAc;IACzB3D,KAAK,EAAEiB,UAAU;IACjBsC,SAAS,EAAE,IAAI;IACfO,QAAQ,EAAEpB;EACZ,CAAC,CAAC,CAAC,EAAE,aAAazC,MAAM,CAACN,OAAO,CAACwD,aAAa,CAAC,KAAK,EAAE;IACpDY,GAAG,EAAEpC,iBAAiB;IACtBgC,SAAS,EAAE;EACb,CAAC,CAAC,CAAC,EAAE,aAAa1D,MAAM,CAACN,OAAO,CAACwD,aAAa,CAACjD,WAAW,CAAC8D,WAAW,EAAE,IAAI,EAAE,aAAa/D,MAAM,CAACN,OAAO,CAACwD,aAAa,CAACjD,WAAW,CAAC+D,MAAM,EAAE;IAC1IC,KAAK,EAAE,WAAW;IAClBC,OAAO,EAAExD;EACX,CAAC,EAAEoB,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,aAAa9B,MAAM,CAACN,OAAO,CAACwD,aAAa,CAACjD,WAAW,CAAC+D,MAAM,EAAE;IAC7EC,KAAK,EAAE,SAAS;IAChBE,QAAQ,EAAE3C,UAAU;IACpB0C,OAAO,EAAErB;EACX,CAAC,EAAEf,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;AAC3B,CAAC;AACD,IAAIsC,QAAQ,GAAGtE,OAAO,CAACJ,OAAO,GAAGY,YAAY"},"metadata":{},"sourceType":"script","externalDependencies":[]}