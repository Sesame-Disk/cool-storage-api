{"ast":null,"code":"import _defineProperty from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{getNumberDisplayString,replaceNumberNotAllowInput,formatStringToNumber,isMac}from'../../../../utils/extra-attributes';import{KeyCodes,DEFAULT_NUMBER_FORMAT}from'../../../../constants';import{jsx as _jsx}from\"react/jsx-runtime\";var NumberEditor=/*#__PURE__*/function(_React$Component){_inherits(NumberEditor,_React$Component);var _super=_createSuper(NumberEditor);function NumberEditor(props){var _this;_classCallCheck(this,NumberEditor);_this=_super.call(this,props);_this.onChange=function(event){var data=_this.props.column.data;// data maybe 'null'\nvar format=data&&data.format?data.format:DEFAULT_NUMBER_FORMAT;var currency_symbol=null;if(data&&data.format==='custom_currency'){currency_symbol=data['currency_symbol'];}var initValue=event.target.value.trim();//Prevent the repetition of periods bug in the Chinese input method of the Windows system\nif(!isMac()&&initValue.indexOf('.。')>-1)return;var value=replaceNumberNotAllowInput(initValue,format,currency_symbol);if(value===_this.state.value)return;_this.setState({value:value});};_this.onKeyDown=function(event){var _event$currentTarget=event.currentTarget,selectionStart=_event$currentTarget.selectionStart,selectionEnd=_event$currentTarget.selectionEnd,value=_event$currentTarget.value;if(event.keyCode===KeyCodes.Enter||event.keyCode===KeyCodes.Esc){event.preventDefault();_this.input.blur();}else if(event.keyCode===KeyCodes.LeftArrow&&selectionStart===0||event.keyCode===KeyCodes.RightArrow&&selectionEnd===value.length){event.stopPropagation();}};_this.onBlur=function(){var value=_this.state.value;var column=_this.props.column;_this.props.onCommit(_defineProperty({},column.key,formatStringToNumber(value,column.data)),column);};_this.setInputRef=function(input){_this.input=input;return _this.input;};_this.onPaste=function(e){e.stopPropagation();};_this.onCut=function(e){e.stopPropagation();};var row=props.row,_column=props.column;var _value=row[_column.key];_this.state={value:getNumberDisplayString(_value,_column.data)};return _this;}_createClass(NumberEditor,[{key:\"render\",value:function render(){var column=this.props.column;return/*#__PURE__*/_jsx(\"input\",{ref:this.setInputRef,type:\"text\",className:\"form-control\",value:this.state.value,onBlur:this.onBlur,onPaste:this.onPaste,onCut:this.onCut,onKeyDown:this.onKeyDown,onChange:this.onChange,disabled:!column.editable});}}]);return NumberEditor;}(React.Component);export default NumberEditor;","map":{"version":3,"names":["React","getNumberDisplayString","replaceNumberNotAllowInput","formatStringToNumber","isMac","KeyCodes","DEFAULT_NUMBER_FORMAT","jsx","_jsx","NumberEditor","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","onChange","event","data","column","format","currency_symbol","initValue","target","value","trim","indexOf","state","setState","onKeyDown","_event$currentTarget","currentTarget","selectionStart","selectionEnd","keyCode","Enter","Esc","preventDefault","input","blur","LeftArrow","RightArrow","length","stopPropagation","onBlur","onCommit","_defineProperty","key","setInputRef","onPaste","e","onCut","row","_createClass","render","ref","type","className","disabled","editable","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/extra-attributes-dialog/editor/number-editor.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { getNumberDisplayString, replaceNumberNotAllowInput, formatStringToNumber, isMac } from '../../../../utils/extra-attributes';\nimport { KeyCodes, DEFAULT_NUMBER_FORMAT } from '../../../../constants';\n\nclass NumberEditor extends React.Component {\n\n  constructor(props) {\n    super(props);\n    const { row, column } = props;\n    const value = row[column.key];\n    this.state = {\n      value: getNumberDisplayString(value, column.data),\n    };\n  }\n\n  onChange = (event) => {\n    const { data } = this.props.column; // data maybe 'null'\n    const format = (data && data.format) ? data.format : DEFAULT_NUMBER_FORMAT;\n    let currency_symbol = null;\n    if (data && data.format === 'custom_currency') {\n      currency_symbol = data['currency_symbol'];\n    }\n    const initValue = event.target.value.trim();\n\n    //Prevent the repetition of periods bug in the Chinese input method of the Windows system\n    if (!isMac() && initValue.indexOf('.。') > -1) return;\n    let value = replaceNumberNotAllowInput(initValue, format, currency_symbol);\n    if (value === this.state.value) return;\n    this.setState({ value });\n  };\n\n  onKeyDown = (event) => {\n    let { selectionStart, selectionEnd, value } = event.currentTarget;\n    if (event.keyCode === KeyCodes.Enter || event.keyCode === KeyCodes.Esc) {\n      event.preventDefault();\n      this.input.blur();\n    } else if ((event.keyCode === KeyCodes.LeftArrow && selectionStart === 0) ||\n      (event.keyCode === KeyCodes.RightArrow && selectionEnd === value.length)\n    ) {\n      event.stopPropagation();\n    }\n  };\n\n  onBlur = () => {\n    const { value } = this.state;\n    const { column } = this.props;\n    this.props.onCommit({ [column.key]: formatStringToNumber(value, column.data) }, column);\n  };\n\n  setInputRef = (input) => {\n    this.input = input;\n    return this.input;\n  };\n\n  onPaste = (e) => {\n    e.stopPropagation();\n  };\n\n  onCut = (e) => {\n    e.stopPropagation();\n  };\n\n  render() {\n    const { column } = this.props;\n\n    return (\n      <input\n        ref={this.setInputRef}\n        type=\"text\"\n        className=\"form-control\"\n        value={this.state.value}\n        onBlur={this.onBlur}\n        onPaste={this.onPaste}\n        onCut={this.onCut}\n        onKeyDown={this.onKeyDown}\n        onChange={this.onChange}\n        disabled={!column.editable}\n      />\n    );\n  }\n}\n\nNumberEditor.propTypes = {\n  column: PropTypes.object,\n  row: PropTypes.object,\n  onCommit: PropTypes.func,\n};\n\nexport default NumberEditor;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}