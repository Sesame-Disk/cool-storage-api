{"ast":null,"code":"import _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { getNodeById } from '../../../extension/core';\nimport { getElementCommentCountTop } from '../../helper';\nimport { eventStopPropagation } from '../../../utils/mouse-event';\nimport { focusToCommentElement } from '../../utils';\nimport { Z_INDEX } from '../../../constants';\nimport { useScrollContext } from '../../../hooks/use-scroll-context';\nvar ElementCommentCount = function ElementCommentCount(_ref) {\n  var elementId = _ref.elementId,\n    isElementSelected = _ref.isElementSelected,\n    commentsCount = _ref.commentsCount,\n    editor = _ref.editor;\n  var element = getNodeById(editor.children, elementId);\n  var _useState = useState(-9999),\n    _useState2 = _slicedToArray(_useState, 2),\n    top = _useState2[0],\n    setTop = _useState2[1];\n  var scrollRef = useScrollContext();\n  var onClick = useCallback(function (event) {\n    eventStopPropagation(event);\n    focusToCommentElement(editor, element);\n  }, [editor, element]);\n  var updatePosition = useCallback(function () {\n    if (!element) return;\n    var scrollTop = scrollRef.current.scrollTop || 0;\n    var newTop = getElementCommentCountTop(editor, element, scrollTop);\n    setTop(newTop);\n  }, [editor, element, scrollRef]);\n  useEffect(function () {\n    updatePosition();\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(function () {\n    var scrollDom = scrollRef.current;\n    scrollDom.addEventListener('scroll', updatePosition);\n    return function () {\n      scrollDom.removeEventListener('scroll', updatePosition);\n    };\n  }, [editor, elementId, element, scrollRef, isElementSelected, updatePosition]);\n  if (!element) return null;\n  var style = {\n    top: top\n  };\n  if (isElementSelected) {\n    style['zIndex'] = Z_INDEX.ACTIVE_COMMENT_COUNT;\n  }\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"element-comments-count\",\n    style: style,\n    onClick: onClick\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-comment-count\"\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"element-comments-count-value\"\n  }, commentsCount));\n};\nexport default ElementCommentCount;","map":{"version":3,"names":["React","useCallback","useEffect","useState","getNodeById","getElementCommentCountTop","eventStopPropagation","focusToCommentElement","Z_INDEX","useScrollContext","ElementCommentCount","_ref","elementId","isElementSelected","commentsCount","editor","element","children","_useState","_useState2","_slicedToArray","top","setTop","scrollRef","onClick","event","updatePosition","scrollTop","current","newTop","scrollDom","addEventListener","removeEventListener","style","ACTIVE_COMMENT_COUNT","createElement","className"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/comment/components/elements-comment-count/element-comment-count.js"],"sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport { getNodeById } from '../../../extension/core';\nimport { getElementCommentCountTop } from '../../helper';\nimport { eventStopPropagation } from '../../../utils/mouse-event';\nimport { focusToCommentElement } from '../../utils';\nimport { Z_INDEX } from '../../../constants';\nimport { useScrollContext } from '../../../hooks/use-scroll-context';\nconst ElementCommentCount = _ref => {\n  let {\n    elementId,\n    isElementSelected,\n    commentsCount,\n    editor\n  } = _ref;\n  const element = getNodeById(editor.children, elementId);\n  const [top, setTop] = useState(-9999);\n  const scrollRef = useScrollContext();\n  const onClick = useCallback(event => {\n    eventStopPropagation(event);\n    focusToCommentElement(editor, element);\n  }, [editor, element]);\n  const updatePosition = useCallback(() => {\n    if (!element) return;\n    const scrollTop = scrollRef.current.scrollTop || 0;\n    const newTop = getElementCommentCountTop(editor, element, scrollTop);\n    setTop(newTop);\n  }, [editor, element, scrollRef]);\n  useEffect(() => {\n    updatePosition();\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(() => {\n    const scrollDom = scrollRef.current;\n    scrollDom.addEventListener('scroll', updatePosition);\n    return () => {\n      scrollDom.removeEventListener('scroll', updatePosition);\n    };\n  }, [editor, elementId, element, scrollRef, isElementSelected, updatePosition]);\n  if (!element) return null;\n  let style = {\n    top\n  };\n  if (isElementSelected) {\n    style['zIndex'] = Z_INDEX.ACTIVE_COMMENT_COUNT;\n  }\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"element-comments-count\",\n    style: style,\n    onClick: onClick\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-comment-count\"\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"element-comments-count-value\"\n  }, commentsCount));\n};\nexport default ElementCommentCount;"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,WAAW,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC/D,SAASC,WAAW,QAAQ,yBAAyB;AACrD,SAASC,yBAAyB,QAAQ,cAAc;AACxD,SAASC,oBAAoB,QAAQ,4BAA4B;AACjE,SAASC,qBAAqB,QAAQ,aAAa;AACnD,SAASC,OAAO,QAAQ,oBAAoB;AAC5C,SAASC,gBAAgB,QAAQ,mCAAmC;AACpE,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAmBA,CAAGC,IAAI,EAAI;EAClC,IACEC,SAAS,GAIPD,IAAI,CAJNC,SAAS;IACTC,iBAAiB,GAGfF,IAAI,CAHNE,iBAAiB;IACjBC,aAAa,GAEXH,IAAI,CAFNG,aAAa;IACbC,MAAM,GACJJ,IAAI,CADNI,MAAM;EAER,IAAMC,OAAO,GAAGZ,WAAW,CAACW,MAAM,CAACE,QAAQ,EAAEL,SAAS,CAAC;EACvD,IAAAM,SAAA,GAAsBf,QAAQ,CAAC,CAAC,IAAI,CAAC;IAAAgB,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAA9BG,GAAG,GAAAF,UAAA;IAAEG,MAAM,GAAAH,UAAA;EAClB,IAAMI,SAAS,GAAGd,gBAAgB,CAAC,CAAC;EACpC,IAAMe,OAAO,GAAGvB,WAAW,CAAC,UAAAwB,KAAK,EAAI;IACnCnB,oBAAoB,CAACmB,KAAK,CAAC;IAC3BlB,qBAAqB,CAACQ,MAAM,EAAEC,OAAO,CAAC;EACxC,CAAC,EAAE,CAACD,MAAM,EAAEC,OAAO,CAAC,CAAC;EACrB,IAAMU,cAAc,GAAGzB,WAAW,CAAC,YAAM;IACvC,IAAI,CAACe,OAAO,EAAE;IACd,IAAMW,SAAS,GAAGJ,SAAS,CAACK,OAAO,CAACD,SAAS,IAAI,CAAC;IAClD,IAAME,MAAM,GAAGxB,yBAAyB,CAACU,MAAM,EAAEC,OAAO,EAAEW,SAAS,CAAC;IACpEL,MAAM,CAACO,MAAM,CAAC;EAChB,CAAC,EAAE,CAACd,MAAM,EAAEC,OAAO,EAAEO,SAAS,CAAC,CAAC;EAChCrB,SAAS,CAAC,YAAM;IACdwB,cAAc,CAAC,CAAC;;IAEhB;EACF,CAAC,EAAE,EAAE,CAAC;EACNxB,SAAS,CAAC,YAAM;IACd,IAAM4B,SAAS,GAAGP,SAAS,CAACK,OAAO;IACnCE,SAAS,CAACC,gBAAgB,CAAC,QAAQ,EAAEL,cAAc,CAAC;IACpD,OAAO,YAAM;MACXI,SAAS,CAACE,mBAAmB,CAAC,QAAQ,EAAEN,cAAc,CAAC;IACzD,CAAC;EACH,CAAC,EAAE,CAACX,MAAM,EAAEH,SAAS,EAAEI,OAAO,EAAEO,SAAS,EAAEV,iBAAiB,EAAEa,cAAc,CAAC,CAAC;EAC9E,IAAI,CAACV,OAAO,EAAE,OAAO,IAAI;EACzB,IAAIiB,KAAK,GAAG;IACVZ,GAAG,EAAHA;EACF,CAAC;EACD,IAAIR,iBAAiB,EAAE;IACrBoB,KAAK,CAAC,QAAQ,CAAC,GAAGzB,OAAO,CAAC0B,oBAAoB;EAChD;EACA,OAAO,aAAalC,KAAK,CAACmC,aAAa,CAAC,KAAK,EAAE;IAC7CC,SAAS,EAAE,wBAAwB;IACnCH,KAAK,EAAEA,KAAK;IACZT,OAAO,EAAEA;EACX,CAAC,EAAE,aAAaxB,KAAK,CAACmC,aAAa,CAAC,GAAG,EAAE;IACvCC,SAAS,EAAE;EACb,CAAC,CAAC,EAAE,aAAapC,KAAK,CAACmC,aAAa,CAAC,KAAK,EAAE;IAC1CC,SAAS,EAAE;EACb,CAAC,EAAEtB,aAAa,CAAC,CAAC;AACpB,CAAC;AACD,eAAeJ,mBAAmB"},"metadata":{},"sourceType":"module","externalDependencies":[]}