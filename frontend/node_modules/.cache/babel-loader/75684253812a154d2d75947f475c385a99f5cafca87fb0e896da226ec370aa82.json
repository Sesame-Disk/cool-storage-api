{"ast":null,"code":"import _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { MenuItem } from '../../../commons';\nimport { MENUS_CONFIG_MAP } from '../../../constants';\nimport { SEARCH_REPLACE } from '../../../constants/menus-config';\nimport SearchReplacePopover from '../popover';\nimport EventBus from '../../../../utils/event-bus';\nimport { INTERNAL_EVENT } from '../../../../constants';\nimport './index.css';\nvar menuConfig = MENUS_CONFIG_MAP[SEARCH_REPLACE];\nvar SearchReplaceMenu = function SearchReplaceMenu(_ref) {\n  var isRichEditor = _ref.isRichEditor,\n    className = _ref.className,\n    editor = _ref.editor,\n    readonly = _ref.readonly;\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    isOpenPopover = _useState2[0],\n    setIsOpenPopover = _useState2[1];\n  useEffect(function () {\n    var eventBus = EventBus.getInstance();\n    var unsubscribe = eventBus.subscribe(INTERNAL_EVENT.OPEN_SEARCH_REPLACE_MODAL, function () {\n      return setIsOpenPopover(true);\n    });\n    return function () {\n      return unsubscribe();\n    };\n  }, [isOpenPopover]);\n  var onMouseDown = useCallback(function () {\n    setIsOpenPopover(!isOpenPopover);\n  }, [isOpenPopover]);\n  var articleContainer = document.querySelector('.sdoc-article-container');\n  var articleContainerSize = useMemo(function () {\n    var articleContainer = document.querySelector('.sdoc-article-container');\n    if (!articleContainer) return null;\n    var offsetHeight = articleContainer.offsetHeight,\n      offsetWidth = articleContainer.offsetWidth,\n      clientHeight = articleContainer.clientHeight;\n    return {\n      offsetHeight: offsetHeight,\n      offsetWidth: offsetWidth,\n      clientHeight: clientHeight\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isOpenPopover]);\n  var renderCanvasses = useMemo(function () {\n    if (!isOpenPopover) return false;\n    var generateCount = Math.ceil(articleContainerSize.offsetHeight / 5000);\n    var canvasList = [];\n    for (var index = 0; index < generateCount; index++) {\n      var top = index * 5000;\n      canvasList.push( /*#__PURE__*/React.createElement(\"canvas\", {\n        key: 'sdoc-find-search-' + index,\n        id: \"sdoc-find-search-\".concat(index),\n        className: \"sdoc-find-search-highlight-canvas\",\n        width: articleContainerSize.offsetWidth,\n        height: 5000,\n        style: {\n          top: top\n        }\n      }));\n    }\n    return canvasList;\n  }, [articleContainerSize, isOpenPopover]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(MenuItem, Object.assign({\n    isRichEditor: isRichEditor,\n    className: className,\n    disabled: false,\n    isActive: isOpenPopover,\n    onMouseDown: onMouseDown\n  }, menuConfig)), isOpenPopover && /*#__PURE__*/React.createElement(SearchReplacePopover, {\n    editor: editor,\n    readonly: readonly,\n    isOpen: isOpenPopover,\n    closePopover: onMouseDown\n  }), isOpenPopover && createPortal( /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: articleContainerSize.clientHeight\n    },\n    className: \"sdoc-search-highlight-container\"\n  }, renderCanvasses), articleContainer));\n};\nexport default SearchReplaceMenu;","map":{"version":3,"names":["React","useCallback","useEffect","useMemo","useState","createPortal","MenuItem","MENUS_CONFIG_MAP","SEARCH_REPLACE","SearchReplacePopover","EventBus","INTERNAL_EVENT","menuConfig","SearchReplaceMenu","_ref","isRichEditor","className","editor","readonly","_useState","_useState2","_slicedToArray","isOpenPopover","setIsOpenPopover","eventBus","getInstance","unsubscribe","subscribe","OPEN_SEARCH_REPLACE_MODAL","onMouseDown","articleContainer","document","querySelector","articleContainerSize","offsetHeight","offsetWidth","clientHeight","renderCanvasses","generateCount","Math","ceil","canvasList","index","top","push","createElement","key","id","concat","width","height","style","Fragment","Object","assign","disabled","isActive","isOpen","closePopover"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/plugins/search-replace/menu/index.js"],"sourcesContent":["import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { MenuItem } from '../../../commons';\nimport { MENUS_CONFIG_MAP } from '../../../constants';\nimport { SEARCH_REPLACE } from '../../../constants/menus-config';\nimport SearchReplacePopover from '../popover';\nimport EventBus from '../../../../utils/event-bus';\nimport { INTERNAL_EVENT } from '../../../../constants';\nimport './index.css';\nconst menuConfig = MENUS_CONFIG_MAP[SEARCH_REPLACE];\nconst SearchReplaceMenu = _ref => {\n  let {\n    isRichEditor,\n    className,\n    editor,\n    readonly\n  } = _ref;\n  const [isOpenPopover, setIsOpenPopover] = useState(false);\n  useEffect(() => {\n    const eventBus = EventBus.getInstance();\n    const unsubscribe = eventBus.subscribe(INTERNAL_EVENT.OPEN_SEARCH_REPLACE_MODAL, () => setIsOpenPopover(true));\n    return () => unsubscribe();\n  }, [isOpenPopover]);\n  const onMouseDown = useCallback(() => {\n    setIsOpenPopover(!isOpenPopover);\n  }, [isOpenPopover]);\n  const articleContainer = document.querySelector('.sdoc-article-container');\n  const articleContainerSize = useMemo(() => {\n    const articleContainer = document.querySelector('.sdoc-article-container');\n    if (!articleContainer) return null;\n    const {\n      offsetHeight,\n      offsetWidth,\n      clientHeight\n    } = articleContainer;\n    return {\n      offsetHeight,\n      offsetWidth,\n      clientHeight\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isOpenPopover]);\n  const renderCanvasses = useMemo(() => {\n    if (!isOpenPopover) return false;\n    const generateCount = Math.ceil(articleContainerSize.offsetHeight / 5000);\n    const canvasList = [];\n    for (let index = 0; index < generateCount; index++) {\n      const top = index * 5000;\n      canvasList.push( /*#__PURE__*/React.createElement(\"canvas\", {\n        key: 'sdoc-find-search-' + index,\n        id: \"sdoc-find-search-\".concat(index),\n        className: \"sdoc-find-search-highlight-canvas\",\n        width: articleContainerSize.offsetWidth,\n        height: 5000,\n        style: {\n          top\n        }\n      }));\n    }\n    return canvasList;\n  }, [articleContainerSize, isOpenPopover]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(MenuItem, Object.assign({\n    isRichEditor: isRichEditor,\n    className: className,\n    disabled: false,\n    isActive: isOpenPopover,\n    onMouseDown: onMouseDown\n  }, menuConfig)), isOpenPopover && /*#__PURE__*/React.createElement(SearchReplacePopover, {\n    editor: editor,\n    readonly: readonly,\n    isOpen: isOpenPopover,\n    closePopover: onMouseDown\n  }), isOpenPopover && createPortal( /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: articleContainerSize.clientHeight\n    },\n    className: \"sdoc-search-highlight-container\"\n  }, renderCanvasses), articleContainer));\n};\nexport default SearchReplaceMenu;"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,WAAW,EAAEC,SAAS,EAAEC,OAAO,EAAEC,QAAQ,QAAQ,OAAO;AACxE,SAASC,YAAY,QAAQ,WAAW;AACxC,SAASC,QAAQ,QAAQ,kBAAkB;AAC3C,SAASC,gBAAgB,QAAQ,oBAAoB;AACrD,SAASC,cAAc,QAAQ,iCAAiC;AAChE,OAAOC,oBAAoB,MAAM,YAAY;AAC7C,OAAOC,QAAQ,MAAM,6BAA6B;AAClD,SAASC,cAAc,QAAQ,uBAAuB;AACtD,OAAO,aAAa;AACpB,IAAMC,UAAU,GAAGL,gBAAgB,CAACC,cAAc,CAAC;AACnD,IAAMK,iBAAiB,GAAG,SAApBA,iBAAiBA,CAAGC,IAAI,EAAI;EAChC,IACEC,YAAY,GAIVD,IAAI,CAJNC,YAAY;IACZC,SAAS,GAGPF,IAAI,CAHNE,SAAS;IACTC,MAAM,GAEJH,IAAI,CAFNG,MAAM;IACNC,QAAQ,GACNJ,IAAI,CADNI,QAAQ;EAEV,IAAAC,SAAA,GAA0Cf,QAAQ,CAAC,KAAK,CAAC;IAAAgB,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAAlDG,aAAa,GAAAF,UAAA;IAAEG,gBAAgB,GAAAH,UAAA;EACtClB,SAAS,CAAC,YAAM;IACd,IAAMsB,QAAQ,GAAGd,QAAQ,CAACe,WAAW,CAAC,CAAC;IACvC,IAAMC,WAAW,GAAGF,QAAQ,CAACG,SAAS,CAAChB,cAAc,CAACiB,yBAAyB,EAAE;MAAA,OAAML,gBAAgB,CAAC,IAAI,CAAC;IAAA,EAAC;IAC9G,OAAO;MAAA,OAAMG,WAAW,CAAC,CAAC;IAAA;EAC5B,CAAC,EAAE,CAACJ,aAAa,CAAC,CAAC;EACnB,IAAMO,WAAW,GAAG5B,WAAW,CAAC,YAAM;IACpCsB,gBAAgB,CAAC,CAACD,aAAa,CAAC;EAClC,CAAC,EAAE,CAACA,aAAa,CAAC,CAAC;EACnB,IAAMQ,gBAAgB,GAAGC,QAAQ,CAACC,aAAa,CAAC,yBAAyB,CAAC;EAC1E,IAAMC,oBAAoB,GAAG9B,OAAO,CAAC,YAAM;IACzC,IAAM2B,gBAAgB,GAAGC,QAAQ,CAACC,aAAa,CAAC,yBAAyB,CAAC;IAC1E,IAAI,CAACF,gBAAgB,EAAE,OAAO,IAAI;IAClC,IACEI,YAAY,GAGVJ,gBAAgB,CAHlBI,YAAY;MACZC,WAAW,GAETL,gBAAgB,CAFlBK,WAAW;MACXC,YAAY,GACVN,gBAAgB,CADlBM,YAAY;IAEd,OAAO;MACLF,YAAY,EAAZA,YAAY;MACZC,WAAW,EAAXA,WAAW;MACXC,YAAY,EAAZA;IACF,CAAC;IACD;EACF,CAAC,EAAE,CAACd,aAAa,CAAC,CAAC;EACnB,IAAMe,eAAe,GAAGlC,OAAO,CAAC,YAAM;IACpC,IAAI,CAACmB,aAAa,EAAE,OAAO,KAAK;IAChC,IAAMgB,aAAa,GAAGC,IAAI,CAACC,IAAI,CAACP,oBAAoB,CAACC,YAAY,GAAG,IAAI,CAAC;IACzE,IAAMO,UAAU,GAAG,EAAE;IACrB,KAAK,IAAIC,KAAK,GAAG,CAAC,EAAEA,KAAK,GAAGJ,aAAa,EAAEI,KAAK,EAAE,EAAE;MAClD,IAAMC,GAAG,GAAGD,KAAK,GAAG,IAAI;MACxBD,UAAU,CAACG,IAAI,EAAE,aAAa5C,KAAK,CAAC6C,aAAa,CAAC,QAAQ,EAAE;QAC1DC,GAAG,EAAE,mBAAmB,GAAGJ,KAAK;QAChCK,EAAE,EAAE,mBAAmB,CAACC,MAAM,CAACN,KAAK,CAAC;QACrC1B,SAAS,EAAE,mCAAmC;QAC9CiC,KAAK,EAAEhB,oBAAoB,CAACE,WAAW;QACvCe,MAAM,EAAE,IAAI;QACZC,KAAK,EAAE;UACLR,GAAG,EAAHA;QACF;MACF,CAAC,CAAC,CAAC;IACL;IACA,OAAOF,UAAU;EACnB,CAAC,EAAE,CAACR,oBAAoB,EAAEX,aAAa,CAAC,CAAC;EACzC,OAAO,aAAatB,KAAK,CAAC6C,aAAa,CAAC7C,KAAK,CAACoD,QAAQ,EAAE,IAAI,EAAE,aAAapD,KAAK,CAAC6C,aAAa,CAACvC,QAAQ,EAAE+C,MAAM,CAACC,MAAM,CAAC;IACrHvC,YAAY,EAAEA,YAAY;IAC1BC,SAAS,EAAEA,SAAS;IACpBuC,QAAQ,EAAE,KAAK;IACfC,QAAQ,EAAElC,aAAa;IACvBO,WAAW,EAAEA;EACf,CAAC,EAAEjB,UAAU,CAAC,CAAC,EAAEU,aAAa,IAAI,aAAatB,KAAK,CAAC6C,aAAa,CAACpC,oBAAoB,EAAE;IACvFQ,MAAM,EAAEA,MAAM;IACdC,QAAQ,EAAEA,QAAQ;IAClBuC,MAAM,EAAEnC,aAAa;IACrBoC,YAAY,EAAE7B;EAChB,CAAC,CAAC,EAAEP,aAAa,IAAIjB,YAAY,EAAE,aAAaL,KAAK,CAAC6C,aAAa,CAAC,KAAK,EAAE;IACzEM,KAAK,EAAE;MACLD,MAAM,EAAEjB,oBAAoB,CAACG;IAC/B,CAAC;IACDpB,SAAS,EAAE;EACb,CAAC,EAAEqB,eAAe,CAAC,EAAEP,gBAAgB,CAAC,CAAC;AACzC,CAAC;AACD,eAAejB,iBAAiB"},"metadata":{},"sourceType":"module","externalDependencies":[]}