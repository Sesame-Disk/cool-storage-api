{"ast":null,"code":"import _objectSpread from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component,Fragment}from'react';import{Button}from'reactstrap';import{Utils}from'../../../utils/utils';import{seafileAPI}from'../../../utils/seafile-api';import{gettext}from'../../../utils/constants';import AddOrUpdateTermDialog from'../../../components/dialog/sysadmin-dialog/sysadmin-add-or-update-term-dialog';import ModalPortal from'../../../components/modal-portal';import toaster from'../../../components/toast';import MainPanelTopbar from'../main-panel-topbar';import Content from'./content';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TermsAndConditions=/*#__PURE__*/function(_Component){_inherits(TermsAndConditions,_Component);var _super=_createSuper(TermsAndConditions);function TermsAndConditions(props){var _this;_classCallCheck(this,TermsAndConditions);_this=_super.call(this,props);_this.toggleAddTermDialog=function(){_this.setState({isAddTermDialogOpen:!_this.state.isAddTermDialogOpen});};_this.addTerm=function(name,versionNumber,text,isActive){seafileAPI.sysAdminAddTermAndCondition(name,versionNumber,text,isActive).then(function(res){// After adding the terms, you need to refresh the page.\nlocation.reload();}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.updateTerm=function(termID,name,versionNumber,text,isActive){seafileAPI.sysAdminUpdateTermAndCondition(termID,name,versionNumber,text,isActive).then(function(res){var termList=_this.state.termList.map(function(item){if(item.id==termID){return res.data;}else{return item;}});_this.setState({termList:termList});toaster.success(gettext('Update succeeded.'));}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.deleteTerm=function(termID){seafileAPI.sysAdminDeleteTermAndCondition(termID).then(function(res){var termList=_this.state.termList.filter(function(item){return item.id!=termID;});_this.setState({termList:termList});toaster.success(gettext('Successfully deleted 1 item.'));}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.state={loading:true,errorMsg:'',termList:[],isAddTermDialogOpen:false};return _this;}_createClass(TermsAndConditions,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;seafileAPI.sysAdminListTermsAndConditions().then(function(res){_this2.setState({termList:res.data.term_and_condition_list,loading:false});}).catch(function(error){_this2.setState({loading:false,errorMsg:Utils.getErrorMsg(error,true)// true: show login tip if 403\n});});}},{key:\"render\",value:function render(){var _this$state=this.state,termList=_this$state.termList,isAddTermDialogOpen=_this$state.isAddTermDialogOpen;return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(MainPanelTopbar,_objectSpread(_objectSpread({},this.props),{},{children:/*#__PURE__*/_jsx(Button,{className:\"btn btn-secondary operation-item\",onClick:this.toggleAddTermDialog,children:gettext('Add')})})),/*#__PURE__*/_jsx(\"div\",{className:\"main-panel-center flex-row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"cur-view-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cur-view-path\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"sf-heading\",children:gettext('Terms and Conditions')})}),/*#__PURE__*/_jsx(\"div\",{className:\"cur-view-content\",children:/*#__PURE__*/_jsx(Content,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:termList,deleteTerm:this.deleteTerm,updateTerm:this.updateTerm})})]})}),isAddTermDialogOpen&&/*#__PURE__*/_jsx(ModalPortal,{children:/*#__PURE__*/_jsx(AddOrUpdateTermDialog,{isUpdate:false,addTerm:this.addTerm,toggle:this.toggleAddTermDialog})})]});}}]);return TermsAndConditions;}(Component);export default TermsAndConditions;","map":{"version":3,"names":["React","Component","Fragment","Button","Utils","seafileAPI","gettext","AddOrUpdateTermDialog","ModalPortal","toaster","MainPanelTopbar","Content","jsx","_jsx","jsxs","_jsxs","TermsAndConditions","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","toggleAddTermDialog","setState","isAddTermDialogOpen","state","addTerm","name","versionNumber","text","isActive","sysAdminAddTermAndCondition","then","res","location","reload","catch","error","errMessage","getErrorMsg","danger","updateTerm","termID","sysAdminUpdateTermAndCondition","termList","map","item","id","data","success","deleteTerm","sysAdminDeleteTermAndCondition","filter","loading","errorMsg","_createClass","key","value","componentDidMount","_this2","sysAdminListTermsAndConditions","term_and_condition_list","render","_this$state","children","_objectSpread","className","onClick","items","isUpdate","toggle"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/pages/sys-admin/terms-and-conditions/terms-and-conditions.js"],"sourcesContent":["import React, { Component, Fragment } from 'react';\nimport { Button } from 'reactstrap';\nimport { Utils } from '../../../utils/utils';\nimport { seafileAPI } from '../../../utils/seafile-api';\nimport { gettext } from '../../../utils/constants';\nimport AddOrUpdateTermDialog from '../../../components/dialog/sysadmin-dialog/sysadmin-add-or-update-term-dialog';\nimport ModalPortal from '../../../components/modal-portal';\nimport toaster from '../../../components/toast';\nimport MainPanelTopbar from '../main-panel-topbar';\nimport Content from './content';\n\nclass TermsAndConditions extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      termList: [],\n      isAddTermDialogOpen: false,\n    };\n  }\n\n  toggleAddTermDialog = () => {\n    this.setState({isAddTermDialogOpen: !this.state.isAddTermDialogOpen});\n  };\n\n  componentDidMount () {\n    seafileAPI.sysAdminListTermsAndConditions().then((res) => {\n      this.setState({\n        termList: res.data.term_and_condition_list,\n        loading: false,\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  addTerm = (name, versionNumber, text, isActive) => {\n    seafileAPI.sysAdminAddTermAndCondition(name, versionNumber, text, isActive).then(res => {\n      // After adding the terms, you need to refresh the page.\n      location.reload();\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  updateTerm = (termID, name, versionNumber, text, isActive) => {\n    seafileAPI.sysAdminUpdateTermAndCondition(termID, name, versionNumber, text, isActive).then(res => {\n      let termList = this.state.termList.map(item => {\n        if (item.id == termID) {\n          return res.data;\n        } else {\n          return item;\n        }\n      });\n      this.setState({termList: termList});\n      toaster.success(gettext('Update succeeded.'));\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  deleteTerm = (termID) => {\n    seafileAPI.sysAdminDeleteTermAndCondition(termID).then(res => {\n      let termList = this.state.termList.filter(item => item.id != termID);\n      this.setState({termList: termList});\n      toaster.success(gettext('Successfully deleted 1 item.'));\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  render() {\n    let { termList, isAddTermDialogOpen } = this.state;\n    return (\n      <Fragment>\n        <MainPanelTopbar {...this.props}>\n          <Button className=\"btn btn-secondary operation-item\" onClick={this.toggleAddTermDialog}>{gettext('Add')}</Button>\n        </MainPanelTopbar>\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading\">{gettext('Terms and Conditions')}</h3>\n            </div>\n            <div className=\"cur-view-content\">\n              <Content\n                loading={this.state.loading}\n                errorMsg={this.state.errorMsg}\n                items={termList}\n                deleteTerm={this.deleteTerm}\n                updateTerm={this.updateTerm}\n              />\n            </div>\n          </div>\n        </div>\n        {isAddTermDialogOpen &&\n        <ModalPortal>\n          <AddOrUpdateTermDialog\n            isUpdate={false}\n            addTerm={this.addTerm}\n            toggle={this.toggleAddTermDialog}\n          />\n        </ModalPortal>\n        }\n      </Fragment>\n    );\n  }\n}\n\nexport default TermsAndConditions;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}