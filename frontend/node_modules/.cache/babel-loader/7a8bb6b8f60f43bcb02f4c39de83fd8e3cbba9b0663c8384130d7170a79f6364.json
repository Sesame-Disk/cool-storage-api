{"ast":null,"code":"import _toConsumableArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _classCallCheck from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport React from 'react';\nimport Lightbox from '@seafile/react-image-lightbox';\nimport { getImageURL } from '../helpers';\nimport '@seafile/react-image-lightbox/style.css';\nvar ImagePreviewer = /*#__PURE__*/function (_React$Component) {\n  _inherits(ImagePreviewer, _React$Component);\n  var _super = _createSuper(ImagePreviewer);\n  function ImagePreviewer(props) {\n    var _this;\n    _classCallCheck(this, ImagePreviewer);\n    _this = _super.call(this, props);\n    _defineProperty(_assertThisInitialized(_this), \"getImageNodes\", function (nodes) {\n      var nodeIndex = 0;\n      var list = [];\n      while (nodes && nodeIndex <= nodes.length - 1) {\n        var currentNode = nodes[nodeIndex];\n        if (currentNode.type === 'image') {\n          var url = getImageURL(currentNode.data.src);\n          url && list.push(url);\n        } else {\n          list.push.apply(list, _toConsumableArray(_this.getImageNodes(currentNode.children)));\n        }\n        nodeIndex++;\n      }\n      return list;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"moveToPrevImage\", function () {\n      _this.setState(function (prevState) {\n        return {\n          imageIndex: (prevState.imageIndex + _this.images.length - 1) % _this.images.length\n        };\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"moveToNextImage\", function () {\n      _this.setState(function (prevState) {\n        return {\n          imageIndex: (prevState.imageIndex + 1) % _this.images.length\n        };\n      });\n    });\n    var editor = props.editor,\n      imageUrl = props.imageUrl;\n    _this.images = _this.getImageNodes(editor.children);\n    _this.state = {\n      imageIndex: _this.images.findIndex(function (item) {\n        return item === imageUrl;\n      })\n    };\n    return _this;\n  }\n  _createClass(ImagePreviewer, [{\n    key: \"render\",\n    value: function render() {\n      var imageIndex = this.state.imageIndex;\n      var imageItemsLength = this.images.length;\n      var mainSrc = this.images[imageIndex] || '';\n      var imageTitle = '';\n      try {\n        imageTitle = mainSrc ? decodeURI(mainSrc.slice(mainSrc.lastIndexOf('/') + 1)) : '';\n      } catch (error) {\n        // eslint-disable-next-line no-console\n        console.log(error);\n      }\n      var imageTitleEl = /*#__PURE__*/React.createElement(\"span\", {\n        className: \"d-flex\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"text-truncate\"\n      }, imageTitle), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"flex-shrink-0\"\n      }, \"(\", imageIndex + 1, \"/\", this.images.length, \")\"));\n      return /*#__PURE__*/React.createElement(Lightbox, {\n        wrapperClassName: \"sf-editor-image-previewer\",\n        imageTitle: imageTitleEl,\n        mainSrc: mainSrc,\n        toolbarButtons: [],\n        nextSrc: this.images[(imageIndex + 1) % imageItemsLength],\n        prevSrc: this.images[(imageIndex + imageItemsLength - 1) % imageItemsLength],\n        onCloseRequest: this.props.toggleImagePreviewer,\n        onMovePrevRequest: this.moveToPrevImage,\n        onMoveNextRequest: this.moveToNextImage,\n        reactModalProps: {\n          shouldReturnFocusAfterClose: false\n        }\n      });\n    }\n  }]);\n  return ImagePreviewer;\n}(React.Component);\nexport default ImagePreviewer;","map":{"version":3,"names":["_defineProperty","React","Lightbox","getImageURL","ImagePreviewer","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","_assertThisInitialized","nodes","nodeIndex","list","length","currentNode","type","url","data","src","push","apply","_toConsumableArray","getImageNodes","children","setState","prevState","imageIndex","images","editor","imageUrl","state","findIndex","item","_createClass","key","value","render","imageItemsLength","mainSrc","imageTitle","decodeURI","slice","lastIndexOf","error","console","log","imageTitleEl","createElement","className","wrapperClassName","toolbarButtons","nextSrc","prevSrc","onCloseRequest","toggleImagePreviewer","onMovePrevRequest","moveToPrevImage","onMoveNextRequest","moveToNextImage","reactModalProps","shouldReturnFocusAfterClose","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/plugins/image/dialogs/image-previewer.js"],"sourcesContent":["import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport React from 'react';\nimport Lightbox from '@seafile/react-image-lightbox';\nimport { getImageURL } from '../helpers';\nimport '@seafile/react-image-lightbox/style.css';\nclass ImagePreviewer extends React.Component {\n  constructor(props) {\n    super(props);\n    _defineProperty(this, \"getImageNodes\", nodes => {\n      let nodeIndex = 0;\n      const list = [];\n      while (nodes && nodeIndex <= nodes.length - 1) {\n        const currentNode = nodes[nodeIndex];\n        if (currentNode.type === 'image') {\n          const url = getImageURL(currentNode.data.src);\n          url && list.push(url);\n        } else {\n          list.push(...this.getImageNodes(currentNode.children));\n        }\n        nodeIndex++;\n      }\n      return list;\n    });\n    _defineProperty(this, \"moveToPrevImage\", () => {\n      this.setState(prevState => ({\n        imageIndex: (prevState.imageIndex + this.images.length - 1) % this.images.length\n      }));\n    });\n    _defineProperty(this, \"moveToNextImage\", () => {\n      this.setState(prevState => ({\n        imageIndex: (prevState.imageIndex + 1) % this.images.length\n      }));\n    });\n    const {\n      editor,\n      imageUrl\n    } = props;\n    this.images = this.getImageNodes(editor.children);\n    this.state = {\n      imageIndex: this.images.findIndex(item => item === imageUrl)\n    };\n  }\n  render() {\n    const {\n      imageIndex\n    } = this.state;\n    const imageItemsLength = this.images.length;\n    const mainSrc = this.images[imageIndex] || '';\n    let imageTitle = '';\n    try {\n      imageTitle = mainSrc ? decodeURI(mainSrc.slice(mainSrc.lastIndexOf('/') + 1)) : '';\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.log(error);\n    }\n    const imageTitleEl = /*#__PURE__*/React.createElement(\"span\", {\n      className: \"d-flex\"\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"text-truncate\"\n    }, imageTitle), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"flex-shrink-0\"\n    }, \"(\", imageIndex + 1, \"/\", this.images.length, \")\"));\n    return /*#__PURE__*/React.createElement(Lightbox, {\n      wrapperClassName: \"sf-editor-image-previewer\",\n      imageTitle: imageTitleEl,\n      mainSrc: mainSrc,\n      toolbarButtons: [],\n      nextSrc: this.images[(imageIndex + 1) % imageItemsLength],\n      prevSrc: this.images[(imageIndex + imageItemsLength - 1) % imageItemsLength],\n      onCloseRequest: this.props.toggleImagePreviewer,\n      onMovePrevRequest: this.moveToPrevImage,\n      onMoveNextRequest: this.moveToNextImage,\n      reactModalProps: {\n        shouldReturnFocusAfterClose: false\n      }\n    });\n  }\n}\nexport default ImagePreviewer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}