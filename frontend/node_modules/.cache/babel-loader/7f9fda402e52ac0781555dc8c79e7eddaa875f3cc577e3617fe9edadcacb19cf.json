{"ast":null,"code":"import _regeneratorRuntime from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport React, { useCallback, useEffect, useLayoutEffect, useRef, useState } from 'react';\nimport dayjs from 'dayjs';\nimport EventBus from '../../../utils/event-bus';\nimport useCommentList from '../../hooks/comment-hooks/use-comment-list';\nimport CommentItemWrapper from '../comment-item-wrapper';\nimport GlobalCommentHeader from './global-comment-header';\nimport GlobalCommentBodyHeader from './global-comment-body-header';\nimport { DOC_COMMENT_ELEMENT_ID } from '../../constants';\nimport context from '../../../../context';\nimport { useCommentContext } from '../../hooks/comment-hooks/use-comment-context';\nimport GlobalCommentEditor from './global-comment-editor';\nimport { INTERNAL_EVENT } from '../../../constants';\nimport { getNodeById } from '../../../extension/core';\nimport './index.css';\nvar GlobalComment = function GlobalComment(_ref) {\n  var deleteUnseenNotifications = _ref.deleteUnseenNotifications,\n    editor = _ref.editor;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    activeComment = _useState2[0],\n    setActiveComment = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    isShowCommentList = _useState4[0],\n    setShowCommentList = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    showEditor = _useState6[0],\n    setShowEditor = _useState6[1];\n  var _useState7 = useState({}),\n    _useState8 = _slicedToArray(_useState7, 2),\n    draggerStyle = _useState8[0],\n    setDraggerStyle = _useState8[1];\n  var _useState9 = useState(false),\n    _useState10 = _slicedToArray(_useState9, 2),\n    isScrollDisplayed = _useState10[0],\n    setIsScrollDisplayed = _useState10[1];\n  var commentRef = useRef(null);\n  var contentRef = useRef(null);\n  var commentDrawerRef = useRef(null);\n  var isResizingRef = useRef(false);\n  var commentResizeHandler = useRef(null);\n  var _useCommentList = useCommentList(),\n    commentList = _useCommentList.commentList,\n    commentType = _useCommentList.commentType,\n    setCommentType = _useCommentList.setCommentType;\n  var setArticleContainerStyle = useCallback(function () {\n    var eventBus = EventBus.getInstance();\n    eventBus.dispatch(INTERNAL_EVENT.OUTLINE_STATE_CHANGED, {\n      scrollIntoArticle: true\n    });\n  }, []);\n  useEffect(function () {\n    if (isShowCommentList) {\n      setArticleContainerStyle();\n    }\n  }, [isShowCommentList, setArticleContainerStyle]);\n  var toggle = useCallback(function () {\n    if (isShowCommentList) {\n      setActiveComment(null);\n      setShowCommentList(false);\n      setShowEditor(false);\n      return;\n    }\n    setShowCommentList(true);\n  }, [isShowCommentList]);\n  var handleHideDragger = useCallback(function (event) {\n    if (isResizingRef.current) return;\n    setDraggerStyle({\n      display: 'none'\n    });\n  }, []);\n  var handleResizeEnd = useCallback(function (e) {\n    isResizingRef.current = false;\n    document.removeEventListener('mouseup', handleResizeEnd);\n    handleHideDragger();\n  }, [handleHideDragger]);\n  var detectScroll = useCallback(function () {\n    if (!contentRef.current) return;\n    var contentContainer = contentRef.current;\n    var isShowScroll = contentContainer.scrollHeight > contentContainer.clientHeight;\n    setIsScrollDisplayed(isShowScroll);\n  }, []);\n  var handleResizing = useCallback(function (e) {\n    var commentDrawer = commentDrawerRef.current;\n    if (isResizingRef.current && commentDrawer) {\n      console.log('999', 999);\n      var width = commentDrawer.offsetWidth - e.movementX;\n      // Limit the width of the comment drawer\n      width = Math.min(width, 620);\n      width = Math.max(width, 360);\n      commentDrawer.style.width = \"\".concat(width, \"px\");\n      var isShrink = e.movementX > 0;\n      setArticleContainerStyle({\n        width: width,\n        isShrink: isShrink\n      });\n      detectScroll();\n    }\n  }, [detectScroll, setArticleContainerStyle]);\n  var handleResizeStart = useCallback(function (e) {\n    isResizingRef.current = true;\n    document.addEventListener('mouseup', handleResizeEnd);\n    document.addEventListener('mousemove', handleResizing);\n  }, [handleResizeEnd, handleResizing]);\n  useEffect(function () {\n    var eventBus = EventBus.getInstance();\n    var unsubscribe = eventBus.subscribe(INTERNAL_EVENT.COMMENT_LIST_CLICK, toggle);\n    return function () {\n      unsubscribe();\n      document.removeEventListener('mousemove', handleResizing);\n      eventBus.dispatch(INTERNAL_EVENT.OUTLINE_STATE_CHANGED);\n    };\n  }, [handleResizing, toggle]);\n  useEffect(function () {\n    detectScroll();\n  }, [commentList, detectScroll, isShowCommentList]);\n  var updateScrollPosition = useCallback(function () {\n    var resolvedDom = document.querySelector('.sdoc-resolved');\n    contentRef.current.scrollTo({\n      top: resolvedDom.offsetTop,\n      behavior: 'smooth'\n    });\n  }, []);\n  var hiddenComment = useCallback(function () {\n    setActiveComment(null);\n  }, []);\n  var _onCommentClick = useCallback(function (comment, element) {\n    if (activeComment && activeComment.id === comment.id) return;\n    setActiveComment(comment);\n    deleteUnseenNotifications && deleteUnseenNotifications(comment);\n    if (comment.detail.element_id === DOC_COMMENT_ELEMENT_ID) return;\n    if (!element) return;\n  }, [activeComment, deleteUnseenNotifications]);\n  var _useCommentContext = useCommentContext(),\n    dispatch = _useCommentContext.dispatch;\n  var insertComment = useCallback( /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(elementId, comment) {\n      var res, returnComment, newComment;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return context.insertComment(comment);\n          case 2:\n            res = _context.sent;\n            returnComment = res.data.comment;\n            newComment = _objectSpread(_objectSpread({}, comment), {}, {\n              id: returnComment.id,\n              user_name: returnComment.user_name,\n              avatar_url: returnComment.avatar_url,\n              replies: []\n            });\n            dispatch({\n              type: 'INSERT_COMMENT',\n              payload: {\n                element_id: elementId,\n                comment: newComment\n              }\n            });\n            setShowEditor(false);\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }));\n    return function (_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), [dispatch]);\n  var insertDocComment = useCallback(function (commentDetail) {\n    var user = context.getUserInfo();\n    var elementId = DOC_COMMENT_ELEMENT_ID;\n    var time = dayjs().format('YYYY-MM-DD HH:mm:ss');\n    var comment = {\n      comment: commentDetail,\n      detail: {\n        element_id: elementId,\n        comment: commentDetail\n      },\n      author: user.username,\n      updated_at: time\n    };\n    insertComment(elementId, comment);\n    detectScroll();\n  }, [detectScroll, insertComment]);\n  var toggleGlobalCommentEditor = useCallback(function () {\n    setShowEditor(!showEditor);\n    setActiveComment(null);\n  }, [showEditor]);\n  var hiddenCommentEditor = useCallback(function () {\n    setShowEditor(false);\n  }, []);\n  var handleDisplayDragger = useCallback(function (event) {\n    if (isShowCommentList) {\n      var pageY = event.pageY;\n      var _commentResizeHandler = commentResizeHandler.current.getBoundingClientRect(),\n        top = _commentResizeHandler.top;\n      // 15 is the half height of the dragger\n      var topSize = pageY - top - 15;\n      setDraggerStyle({\n        top: \"\".concat(topSize, \"px\"),\n        display: 'block'\n      });\n    }\n  }, [isShowCommentList]);\n  var isClickCommentPanelBody = useCallback(function (event) {\n    if (contentRef.current && contentRef.current.contains(event.target)) return true;\n    return false;\n  }, []);\n  if (!isShowCommentList) return null;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-comment-drawer\",\n    ref: commentDrawerRef\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    ref: commentResizeHandler,\n    className: \"sdoc-comment-resize-handler\",\n    onMouseDown: handleResizeStart,\n    onMouseLeave: handleHideDragger,\n    onMouseMove: handleDisplayDragger\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: draggerStyle,\n    className: \"sdoc-comment-move-dragger\"\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    ref: commentRef,\n    className: \"comments-panel-wrapper\"\n  }, /*#__PURE__*/React.createElement(GlobalCommentHeader, {\n    toggle: toggle,\n    toggleGlobalCommentEditor: toggleGlobalCommentEditor\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"comments-panel-body\"\n  }, /*#__PURE__*/React.createElement(GlobalCommentBodyHeader, {\n    commentList: commentList,\n    commentType: commentType,\n    setCommentType: setCommentType\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    ref: contentRef,\n    className: \"comments-panel-body__content\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"global-comment-list-container\",\n    className: \"sdoc-comment-list-container\"\n  }, Array.isArray(commentList) && commentList.map(function (comment) {\n    var elementId = comment.detail.element_id;\n    var element = elementId !== DOC_COMMENT_ELEMENT_ID ? getNodeById(editor.children, elementId) : null;\n    var isActive = activeComment && activeComment.id === comment.id;\n    return /*#__PURE__*/React.createElement(CommentItemWrapper, {\n      key: comment.id,\n      element: element,\n      container: \"global-comment-list-container\",\n      comment: comment,\n      isActive: isActive,\n      onCommentClick: function onCommentClick(comment) {\n        return _onCommentClick(comment, element);\n      },\n      hiddenComment: hiddenComment,\n      updateScrollPosition: updateScrollPosition,\n      isClickCommentPanelBody: isClickCommentPanelBody,\n      editor: editor\n    });\n  }))), showEditor && /*#__PURE__*/React.createElement(GlobalCommentEditor, {\n    isScrollDisplayed: isScrollDisplayed,\n    isClickCommentPanelBody: isClickCommentPanelBody,\n    hiddenCommentEditor: hiddenCommentEditor,\n    insertDocComment: insertDocComment\n  }))));\n};\nexport default GlobalComment;","map":{"version":3,"names":["_objectSpread","React","useCallback","useEffect","useLayoutEffect","useRef","useState","dayjs","EventBus","useCommentList","CommentItemWrapper","GlobalCommentHeader","GlobalCommentBodyHeader","DOC_COMMENT_ELEMENT_ID","context","useCommentContext","GlobalCommentEditor","INTERNAL_EVENT","getNodeById","GlobalComment","_ref","deleteUnseenNotifications","editor","_useState","_useState2","_slicedToArray","activeComment","setActiveComment","_useState3","_useState4","isShowCommentList","setShowCommentList","_useState5","_useState6","showEditor","setShowEditor","_useState7","_useState8","draggerStyle","setDraggerStyle","_useState9","_useState10","isScrollDisplayed","setIsScrollDisplayed","commentRef","contentRef","commentDrawerRef","isResizingRef","commentResizeHandler","_useCommentList","commentList","commentType","setCommentType","setArticleContainerStyle","eventBus","getInstance","dispatch","OUTLINE_STATE_CHANGED","scrollIntoArticle","toggle","handleHideDragger","event","current","display","handleResizeEnd","e","document","removeEventListener","detectScroll","contentContainer","isShowScroll","scrollHeight","clientHeight","handleResizing","commentDrawer","console","log","width","offsetWidth","movementX","Math","min","max","style","concat","isShrink","handleResizeStart","addEventListener","unsubscribe","subscribe","COMMENT_LIST_CLICK","updateScrollPosition","resolvedDom","querySelector","scrollTo","top","offsetTop","behavior","hiddenComment","onCommentClick","comment","element","id","detail","element_id","_useCommentContext","insertComment","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","elementId","res","returnComment","newComment","wrap","_callee$","_context","prev","next","sent","data","user_name","avatar_url","replies","type","payload","stop","_x","_x2","apply","arguments","insertDocComment","commentDetail","user","getUserInfo","time","format","author","username","updated_at","toggleGlobalCommentEditor","hiddenCommentEditor","handleDisplayDragger","pageY","_commentResizeHandler","getBoundingClientRect","topSize","isClickCommentPanelBody","contains","target","createElement","className","ref","onMouseDown","onMouseLeave","onMouseMove","Array","isArray","map","children","isActive","key","container"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/comment/components/global-comment/index.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport React, { useCallback, useEffect, useLayoutEffect, useRef, useState } from 'react';\nimport dayjs from 'dayjs';\nimport EventBus from '../../../utils/event-bus';\nimport useCommentList from '../../hooks/comment-hooks/use-comment-list';\nimport CommentItemWrapper from '../comment-item-wrapper';\nimport GlobalCommentHeader from './global-comment-header';\nimport GlobalCommentBodyHeader from './global-comment-body-header';\nimport { DOC_COMMENT_ELEMENT_ID } from '../../constants';\nimport context from '../../../../context';\nimport { useCommentContext } from '../../hooks/comment-hooks/use-comment-context';\nimport GlobalCommentEditor from './global-comment-editor';\nimport { INTERNAL_EVENT } from '../../../constants';\nimport { getNodeById } from '../../../extension/core';\nimport './index.css';\nconst GlobalComment = _ref => {\n  let {\n    deleteUnseenNotifications,\n    editor\n  } = _ref;\n  const [activeComment, setActiveComment] = useState(null);\n  const [isShowCommentList, setShowCommentList] = useState(false);\n  const [showEditor, setShowEditor] = useState(false);\n  const [draggerStyle, setDraggerStyle] = useState({});\n  const [isScrollDisplayed, setIsScrollDisplayed] = useState(false);\n  const commentRef = useRef(null);\n  const contentRef = useRef(null);\n  const commentDrawerRef = useRef(null);\n  const isResizingRef = useRef(false);\n  const commentResizeHandler = useRef(null);\n  const {\n    commentList,\n    commentType,\n    setCommentType\n  } = useCommentList();\n  const setArticleContainerStyle = useCallback(() => {\n    const eventBus = EventBus.getInstance();\n    eventBus.dispatch(INTERNAL_EVENT.OUTLINE_STATE_CHANGED, {\n      scrollIntoArticle: true\n    });\n  }, []);\n  useEffect(() => {\n    if (isShowCommentList) {\n      setArticleContainerStyle();\n    }\n  }, [isShowCommentList, setArticleContainerStyle]);\n  const toggle = useCallback(() => {\n    if (isShowCommentList) {\n      setActiveComment(null);\n      setShowCommentList(false);\n      setShowEditor(false);\n      return;\n    }\n    setShowCommentList(true);\n  }, [isShowCommentList]);\n  const handleHideDragger = useCallback(event => {\n    if (isResizingRef.current) return;\n    setDraggerStyle({\n      display: 'none'\n    });\n  }, []);\n  const handleResizeEnd = useCallback(e => {\n    isResizingRef.current = false;\n    document.removeEventListener('mouseup', handleResizeEnd);\n    handleHideDragger();\n  }, [handleHideDragger]);\n  const detectScroll = useCallback(() => {\n    if (!contentRef.current) return;\n    const contentContainer = contentRef.current;\n    const isShowScroll = contentContainer.scrollHeight > contentContainer.clientHeight;\n    setIsScrollDisplayed(isShowScroll);\n  }, []);\n  const handleResizing = useCallback(e => {\n    const commentDrawer = commentDrawerRef.current;\n    if (isResizingRef.current && commentDrawer) {\n      console.log('999', 999);\n      let width = commentDrawer.offsetWidth - e.movementX;\n      // Limit the width of the comment drawer\n      width = Math.min(width, 620);\n      width = Math.max(width, 360);\n      commentDrawer.style.width = \"\".concat(width, \"px\");\n      const isShrink = e.movementX > 0;\n      setArticleContainerStyle({\n        width,\n        isShrink\n      });\n      detectScroll();\n    }\n  }, [detectScroll, setArticleContainerStyle]);\n  const handleResizeStart = useCallback(e => {\n    isResizingRef.current = true;\n    document.addEventListener('mouseup', handleResizeEnd);\n    document.addEventListener('mousemove', handleResizing);\n  }, [handleResizeEnd, handleResizing]);\n  useEffect(() => {\n    const eventBus = EventBus.getInstance();\n    const unsubscribe = eventBus.subscribe(INTERNAL_EVENT.COMMENT_LIST_CLICK, toggle);\n    return () => {\n      unsubscribe();\n      document.removeEventListener('mousemove', handleResizing);\n      eventBus.dispatch(INTERNAL_EVENT.OUTLINE_STATE_CHANGED);\n    };\n  }, [handleResizing, toggle]);\n  useEffect(() => {\n    detectScroll();\n  }, [commentList, detectScroll, isShowCommentList]);\n  const updateScrollPosition = useCallback(() => {\n    const resolvedDom = document.querySelector('.sdoc-resolved');\n    contentRef.current.scrollTo({\n      top: resolvedDom.offsetTop,\n      behavior: 'smooth'\n    });\n  }, []);\n  const hiddenComment = useCallback(() => {\n    setActiveComment(null);\n  }, []);\n  const onCommentClick = useCallback((comment, element) => {\n    if (activeComment && activeComment.id === comment.id) return;\n    setActiveComment(comment);\n    deleteUnseenNotifications && deleteUnseenNotifications(comment);\n    if (comment.detail.element_id === DOC_COMMENT_ELEMENT_ID) return;\n    if (!element) return;\n  }, [activeComment, deleteUnseenNotifications]);\n  const {\n    dispatch\n  } = useCommentContext();\n  const insertComment = useCallback(async (elementId, comment) => {\n    const res = await context.insertComment(comment);\n    const {\n      comment: returnComment\n    } = res.data;\n    const newComment = _objectSpread(_objectSpread({}, comment), {}, {\n      id: returnComment.id,\n      user_name: returnComment.user_name,\n      avatar_url: returnComment.avatar_url,\n      replies: []\n    });\n    dispatch({\n      type: 'INSERT_COMMENT',\n      payload: {\n        element_id: elementId,\n        comment: newComment\n      }\n    });\n    setShowEditor(false);\n  }, [dispatch]);\n  const insertDocComment = useCallback(commentDetail => {\n    const user = context.getUserInfo();\n    const elementId = DOC_COMMENT_ELEMENT_ID;\n    const time = dayjs().format('YYYY-MM-DD HH:mm:ss');\n    const comment = {\n      comment: commentDetail,\n      detail: {\n        element_id: elementId,\n        comment: commentDetail\n      },\n      author: user.username,\n      updated_at: time\n    };\n    insertComment(elementId, comment);\n    detectScroll();\n  }, [detectScroll, insertComment]);\n  const toggleGlobalCommentEditor = useCallback(() => {\n    setShowEditor(!showEditor);\n    setActiveComment(null);\n  }, [showEditor]);\n  const hiddenCommentEditor = useCallback(() => {\n    setShowEditor(false);\n  }, []);\n  const handleDisplayDragger = useCallback(event => {\n    if (isShowCommentList) {\n      const {\n        pageY\n      } = event;\n      const {\n        top\n      } = commentResizeHandler.current.getBoundingClientRect();\n      // 15 is the half height of the dragger\n      const topSize = pageY - top - 15;\n      setDraggerStyle({\n        top: \"\".concat(topSize, \"px\"),\n        display: 'block'\n      });\n    }\n  }, [isShowCommentList]);\n  const isClickCommentPanelBody = useCallback(event => {\n    if (contentRef.current && contentRef.current.contains(event.target)) return true;\n    return false;\n  }, []);\n  if (!isShowCommentList) return null;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-comment-drawer\",\n    ref: commentDrawerRef\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    ref: commentResizeHandler,\n    className: \"sdoc-comment-resize-handler\",\n    onMouseDown: handleResizeStart,\n    onMouseLeave: handleHideDragger,\n    onMouseMove: handleDisplayDragger\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: draggerStyle,\n    className: \"sdoc-comment-move-dragger\"\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    ref: commentRef,\n    className: \"comments-panel-wrapper\"\n  }, /*#__PURE__*/React.createElement(GlobalCommentHeader, {\n    toggle: toggle,\n    toggleGlobalCommentEditor: toggleGlobalCommentEditor\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"comments-panel-body\"\n  }, /*#__PURE__*/React.createElement(GlobalCommentBodyHeader, {\n    commentList: commentList,\n    commentType: commentType,\n    setCommentType: setCommentType\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    ref: contentRef,\n    className: \"comments-panel-body__content\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"global-comment-list-container\",\n    className: \"sdoc-comment-list-container\"\n  }, Array.isArray(commentList) && commentList.map(comment => {\n    const elementId = comment.detail.element_id;\n    const element = elementId !== DOC_COMMENT_ELEMENT_ID ? getNodeById(editor.children, elementId) : null;\n    const isActive = activeComment && activeComment.id === comment.id;\n    return /*#__PURE__*/React.createElement(CommentItemWrapper, {\n      key: comment.id,\n      element: element,\n      container: \"global-comment-list-container\",\n      comment: comment,\n      isActive: isActive,\n      onCommentClick: comment => onCommentClick(comment, element),\n      hiddenComment: hiddenComment,\n      updateScrollPosition: updateScrollPosition,\n      isClickCommentPanelBody: isClickCommentPanelBody,\n      editor: editor\n    });\n  }))), showEditor && /*#__PURE__*/React.createElement(GlobalCommentEditor, {\n    isScrollDisplayed: isScrollDisplayed,\n    isClickCommentPanelBody: isClickCommentPanelBody,\n    hiddenCommentEditor: hiddenCommentEditor,\n    insertDocComment: insertDocComment\n  }))));\n};\nexport default GlobalComment;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}