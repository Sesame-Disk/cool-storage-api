{"ast":null,"code":"import _createClass from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _classCallCheck from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Editor } from '@seafile/slate';\nimport { getEventTransfer } from '../../../utils';\nimport { KeyCodes } from '../../../constants';\nimport { createNotify, generatorNotificationKey } from './notification-utils';\nimport { focusEditor, findPath } from '../../extension/core';\nimport { ELEMENT_TYPE } from '../../extension/constants';\nexport var searchCollaborators = function searchCollaborators(collaborators, searchValue) {\n  var validSearchValue = searchValue ? searchValue.trim().toLowerCase() : '';\n  var validCollaborators = Array.isArray(collaborators) && collaborators.length > 0 ? collaborators : [];\n  if (!validSearchValue) return validCollaborators;\n  return validCollaborators.filter(function (collaborator) {\n    var name = collaborator.name,\n      _collaborator$name_pi = collaborator.name_pinyin,\n      name_pinyin = _collaborator$name_pi === void 0 ? '' : _collaborator$name_pi;\n    if (name.toString().toLowerCase().indexOf(validSearchValue) > -1) return true;\n    if (!name_pinyin) return false;\n    var validNamePinyin = name_pinyin.toString().toLowerCase();\n    var validSearchPinyinValue = validSearchValue.replace(/ |'/g, '');\n\n    // complete: For example, seatable can be retrieved when searching for sea.\n    if (validNamePinyin.indexOf(validSearchPinyinValue) > -1) return true;\n    if (validNamePinyin.replace(/'/g, '').indexOf(validSearchPinyinValue) > -1) return true;\n    var validNamePinyinList = validNamePinyin.split('\\'');\n    // acronym: For example, sea table can be retrieved when searching for st.\n    var namePinyinAcronym = validNamePinyinList.map(function (item) {\n      return item && item.trim() ? item.trim().slice(0, 1) : '';\n    });\n    if (namePinyinAcronym.join('').indexOf(validSearchPinyinValue) > -1) return true;\n    return false;\n  });\n};\n\n// Mailto, file, tel, callto, sms, cid, xmpp, etc. are not support\nvar ALLOWED_URL_REG = /((http|https):\\/\\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|])/g;\n// export const textToHtml = (text) => {\n//   if (!text) return '';\n//   return text.replace(ALLOWED_URL_REG, '<a href=\"$1\" target=\"_blank\" class=' + COMMENT_URL_CLASSNAME + '>$1</a>');\n// };\n\nexport var convertComment = function convertComment(value) {\n  return value.replaceAll('<', '&lt;').replaceAll('>', '&gt;');\n};\nexport var checkMentionOperation = function checkMentionOperation(event) {\n  var keyCode = event.keyCode;\n  var Escape = KeyCodes.Escape,\n    LeftArrow = KeyCodes.LeftArrow,\n    RightArrow = KeyCodes.RightArrow;\n  if (keyCode === Escape || keyCode === LeftArrow || keyCode === RightArrow) return false;\n  return true;\n};\nvar CommentUtilities = /*#__PURE__*/_createClass(function CommentUtilities() {\n  var _this = this;\n  _classCallCheck(this, CommentUtilities);\n  _defineProperty(this, \"onInsertElement\", function (_ref) {\n    var commentRef = _ref.commentRef,\n      selection = _ref.selection,\n      range = _ref.range,\n      content = _ref.content,\n      nodeType = _ref.nodeType;\n    if (range) {\n      selection.removeAllRanges();\n      selection.addRange(range);\n    }\n    return _this.createHtmlElement({\n      commentRef: commentRef,\n      selection: selection,\n      range: range,\n      content: content,\n      nodeType: nodeType\n    });\n  });\n  _defineProperty(this, \"getHtmlElement\", function (nodeType, content) {\n    switch (nodeType) {\n      case 'image':\n        {\n          var parentElement = document.createElement('div');\n          parentElement.className = 'image-container';\n          parentElement.contentEditable = 'false';\n          var imageContainer = document.createElement('img');\n          imageContainer.src = content;\n          imageContainer.height = 60;\n          parentElement.appendChild(imageContainer);\n          return parentElement.outerHTML;\n        }\n      default:\n        {\n          return '';\n        }\n    }\n  });\n  _defineProperty(this, \"createHtmlElement\", function (_ref2) {\n    var commentRef = _ref2.commentRef,\n      selection = _ref2.selection,\n      range = _ref2.range,\n      content = _ref2.content,\n      nodeType = _ref2.nodeType;\n    var spanNode1;\n    var spanNode2;\n    var imageContainer;\n    if (nodeType === 'image') {\n      spanNode1 = document.createElement('div');\n      spanNode1.className = 'image-container';\n      spanNode1.contentEditable = 'false';\n      imageContainer = document.createElement('img');\n      imageContainer.src = content;\n      imageContainer.height = 60;\n      spanNode1.appendChild(imageContainer);\n      spanNode2 = document.createElement('span');\n      spanNode2.innerHTML = ' ';\n    }\n    if (nodeType === 'collaborator') {\n      spanNode1 = document.createElement('span');\n      spanNode2 = document.createElement('span');\n      spanNode1.className = 'at-text';\n      spanNode1.innerHTML = \"@\".concat(content.name);\n      spanNode2.innerHTML = '&nbsp;';\n    }\n    var frag = document.createDocumentFragment();\n    frag.appendChild(spanNode1);\n    var lastNode = frag.appendChild(spanNode2);\n    if (range) {\n      range.insertNode(frag);\n    } else {\n      commentRef.current.appendChild(frag);\n      range = selection.getRangeAt(0);\n    }\n    if (lastNode) {\n      range = range.cloneRange();\n      range.setStartAfter(lastNode);\n      range.collapse(true);\n      selection.removeAllRanges();\n      selection.addRange(range);\n    }\n    return range;\n  });\n  _defineProperty(this, \"onSelectParticipant\", function (_ref3) {\n    var selection = _ref3.selection,\n      range = _ref3.range,\n      participant = _ref3.participant,\n      callBack = _ref3.callBack,\n      commentRef = _ref3.commentRef;\n    if (range) {\n      // delete '@xxx';\n      selection.removeAllRanges();\n      selection.addRange(range);\n      var textNode = range.startContainer;\n      var atIndex = _this.getAtIndexWithAnchorPosition(range.startOffset, textNode.data);\n      if (atIndex > -1) {\n        range.setStart(textNode, atIndex);\n        range.setEnd(textNode, range.endOffset);\n        range.deleteContents();\n      }\n    }\n    var newRange = _this.createHtmlElement({\n      selection: selection,\n      range: range,\n      content: participant,\n      nodeType: 'collaborator',\n      commentRef: commentRef\n    });\n    if (callBack) {\n      callBack();\n    }\n    if (commentRef.current) {\n      commentRef.current.focus();\n    }\n    return newRange;\n  });\n  /**\n   * get the index of '@' from anchor position.\n   * @param {*} anchorPosition '@text|anchor position|'\n   * @param {*} text '@abc'\n   * @returns index\n   * e.g. '@abc|anchor position|' // 0\n   *      '@123 @|anchor position| @abc' // 5\n   */\n  _defineProperty(this, \"getAtIndexWithAnchorPosition\", function (anchorPosition, text) {\n    var atIndex = -1;\n    for (var i = anchorPosition - 1; i > -1; i--) {\n      if (text[i] === '@') {\n        atIndex = i;\n        break;\n      }\n    }\n    return atIndex;\n  });\n  _defineProperty(this, \"onPaste\", function (event, callBack) {\n    event.stopPropagation();\n    var cliperData = getEventTransfer(event);\n    if (cliperData.files) {\n      var file = cliperData.files[0];\n      var isImage = /image/i.test(file.type);\n      if (isImage) {\n        event.preventDefault();\n        if (callBack) {\n          callBack(cliperData.files);\n        }\n      }\n    } else {\n      event.preventDefault();\n      var text = cliperData.text;\n      if (document.queryCommandSupported('insertText')) {\n        document.execCommand('insertText', false, text);\n      } else {\n        document.execCommand('paste', false, text);\n      }\n    }\n  });\n});\nexport var focusToCommentElement = function focusToCommentElement(editor, element) {\n  var path = findPath(editor, element);\n  var endOfFirstNode = Editor.end(editor, path);\n  var startOfFirstNode = Editor.start(editor, path);\n  var range = {\n    anchor: [ELEMENT_TYPE.LIST_ITEM, ELEMENT_TYPE.ORDERED_LIST, ELEMENT_TYPE.UNORDERED_LIST].includes(element.type) ? startOfFirstNode : endOfFirstNode,\n    focus: endOfFirstNode\n  };\n  focusEditor(editor, range);\n};\nexport { CommentUtilities, createNotify, generatorNotificationKey };","map":{"version":3,"names":["_defineProperty","Editor","getEventTransfer","KeyCodes","createNotify","generatorNotificationKey","focusEditor","findPath","ELEMENT_TYPE","searchCollaborators","collaborators","searchValue","validSearchValue","trim","toLowerCase","validCollaborators","Array","isArray","length","filter","collaborator","name","_collaborator$name_pi","name_pinyin","toString","indexOf","validNamePinyin","validSearchPinyinValue","replace","validNamePinyinList","split","namePinyinAcronym","map","item","slice","join","ALLOWED_URL_REG","convertComment","value","replaceAll","checkMentionOperation","event","keyCode","Escape","LeftArrow","RightArrow","CommentUtilities","_createClass","_this","_classCallCheck","_ref","commentRef","selection","range","content","nodeType","removeAllRanges","addRange","createHtmlElement","parentElement","document","createElement","className","contentEditable","imageContainer","src","height","appendChild","outerHTML","_ref2","spanNode1","spanNode2","innerHTML","concat","frag","createDocumentFragment","lastNode","insertNode","current","getRangeAt","cloneRange","setStartAfter","collapse","_ref3","participant","callBack","textNode","startContainer","atIndex","getAtIndexWithAnchorPosition","startOffset","data","setStart","setEnd","endOffset","deleteContents","newRange","focus","anchorPosition","text","i","stopPropagation","cliperData","files","file","isImage","test","type","preventDefault","queryCommandSupported","execCommand","focusToCommentElement","editor","element","path","endOfFirstNode","end","startOfFirstNode","start","anchor","LIST_ITEM","ORDERED_LIST","UNORDERED_LIST","includes"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/comment/utils/index.js"],"sourcesContent":["import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Editor } from '@seafile/slate';\nimport { getEventTransfer } from '../../../utils';\nimport { KeyCodes } from '../../../constants';\nimport { createNotify, generatorNotificationKey } from './notification-utils';\nimport { focusEditor, findPath } from '../../extension/core';\nimport { ELEMENT_TYPE } from '../../extension/constants';\nexport const searchCollaborators = (collaborators, searchValue) => {\n  const validSearchValue = searchValue ? searchValue.trim().toLowerCase() : '';\n  const validCollaborators = Array.isArray(collaborators) && collaborators.length > 0 ? collaborators : [];\n  if (!validSearchValue) return validCollaborators;\n  return validCollaborators.filter(collaborator => {\n    const {\n      name,\n      name_pinyin = ''\n    } = collaborator;\n    if (name.toString().toLowerCase().indexOf(validSearchValue) > -1) return true;\n    if (!name_pinyin) return false;\n    const validNamePinyin = name_pinyin.toString().toLowerCase();\n    const validSearchPinyinValue = validSearchValue.replace(/ |'/g, '');\n\n    // complete: For example, seatable can be retrieved when searching for sea.\n    if (validNamePinyin.indexOf(validSearchPinyinValue) > -1) return true;\n    if (validNamePinyin.replace(/'/g, '').indexOf(validSearchPinyinValue) > -1) return true;\n    const validNamePinyinList = validNamePinyin.split('\\'');\n    // acronym: For example, sea table can be retrieved when searching for st.\n    const namePinyinAcronym = validNamePinyinList.map(item => item && item.trim() ? item.trim().slice(0, 1) : '');\n    if (namePinyinAcronym.join('').indexOf(validSearchPinyinValue) > -1) return true;\n    return false;\n  });\n};\n\n// Mailto, file, tel, callto, sms, cid, xmpp, etc. are not support\nconst ALLOWED_URL_REG = /((http|https):\\/\\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|])/g;\n// export const textToHtml = (text) => {\n//   if (!text) return '';\n//   return text.replace(ALLOWED_URL_REG, '<a href=\"$1\" target=\"_blank\" class=' + COMMENT_URL_CLASSNAME + '>$1</a>');\n// };\n\nexport const convertComment = value => {\n  return value.replaceAll('<', '&lt;').replaceAll('>', '&gt;');\n};\nexport const checkMentionOperation = event => {\n  const {\n    keyCode\n  } = event;\n  const {\n    Escape,\n    LeftArrow,\n    RightArrow\n  } = KeyCodes;\n  if (keyCode === Escape || keyCode === LeftArrow || keyCode === RightArrow) return false;\n  return true;\n};\nclass CommentUtilities {\n  constructor() {\n    _defineProperty(this, \"onInsertElement\", _ref => {\n      let {\n        commentRef,\n        selection,\n        range,\n        content,\n        nodeType\n      } = _ref;\n      if (range) {\n        selection.removeAllRanges();\n        selection.addRange(range);\n      }\n      return this.createHtmlElement({\n        commentRef,\n        selection,\n        range,\n        content,\n        nodeType\n      });\n    });\n    _defineProperty(this, \"getHtmlElement\", (nodeType, content) => {\n      switch (nodeType) {\n        case 'image':\n          {\n            let parentElement = document.createElement('div');\n            parentElement.className = 'image-container';\n            parentElement.contentEditable = 'false';\n            let imageContainer = document.createElement('img');\n            imageContainer.src = content;\n            imageContainer.height = 60;\n            parentElement.appendChild(imageContainer);\n            return parentElement.outerHTML;\n          }\n        default:\n          {\n            return '';\n          }\n      }\n    });\n    _defineProperty(this, \"createHtmlElement\", _ref2 => {\n      let {\n        commentRef,\n        selection,\n        range,\n        content,\n        nodeType\n      } = _ref2;\n      let spanNode1;\n      let spanNode2;\n      let imageContainer;\n      if (nodeType === 'image') {\n        spanNode1 = document.createElement('div');\n        spanNode1.className = 'image-container';\n        spanNode1.contentEditable = 'false';\n        imageContainer = document.createElement('img');\n        imageContainer.src = content;\n        imageContainer.height = 60;\n        spanNode1.appendChild(imageContainer);\n        spanNode2 = document.createElement('span');\n        spanNode2.innerHTML = ' ';\n      }\n      if (nodeType === 'collaborator') {\n        spanNode1 = document.createElement('span');\n        spanNode2 = document.createElement('span');\n        spanNode1.className = 'at-text';\n        spanNode1.innerHTML = \"@\".concat(content.name);\n        spanNode2.innerHTML = '&nbsp;';\n      }\n      let frag = document.createDocumentFragment();\n      frag.appendChild(spanNode1);\n      const lastNode = frag.appendChild(spanNode2);\n      if (range) {\n        range.insertNode(frag);\n      } else {\n        commentRef.current.appendChild(frag);\n        range = selection.getRangeAt(0);\n      }\n      if (lastNode) {\n        range = range.cloneRange();\n        range.setStartAfter(lastNode);\n        range.collapse(true);\n        selection.removeAllRanges();\n        selection.addRange(range);\n      }\n      return range;\n    });\n    _defineProperty(this, \"onSelectParticipant\", _ref3 => {\n      let {\n        selection,\n        range,\n        participant,\n        callBack,\n        commentRef\n      } = _ref3;\n      if (range) {\n        // delete '@xxx';\n        selection.removeAllRanges();\n        selection.addRange(range);\n        const textNode = range.startContainer;\n        const atIndex = this.getAtIndexWithAnchorPosition(range.startOffset, textNode.data);\n        if (atIndex > -1) {\n          range.setStart(textNode, atIndex);\n          range.setEnd(textNode, range.endOffset);\n          range.deleteContents();\n        }\n      }\n      let newRange = this.createHtmlElement({\n        selection,\n        range,\n        content: participant,\n        nodeType: 'collaborator',\n        commentRef\n      });\n      if (callBack) {\n        callBack();\n      }\n      if (commentRef.current) {\n        commentRef.current.focus();\n      }\n      return newRange;\n    });\n    /**\n     * get the index of '@' from anchor position.\n     * @param {*} anchorPosition '@text|anchor position|'\n     * @param {*} text '@abc'\n     * @returns index\n     * e.g. '@abc|anchor position|' // 0\n     *      '@123 @|anchor position| @abc' // 5\n     */\n    _defineProperty(this, \"getAtIndexWithAnchorPosition\", (anchorPosition, text) => {\n      let atIndex = -1;\n      for (let i = anchorPosition - 1; i > -1; i--) {\n        if (text[i] === '@') {\n          atIndex = i;\n          break;\n        }\n      }\n      return atIndex;\n    });\n    _defineProperty(this, \"onPaste\", (event, callBack) => {\n      event.stopPropagation();\n      let cliperData = getEventTransfer(event);\n      if (cliperData.files) {\n        let file = cliperData.files[0];\n        let isImage = /image/i.test(file.type);\n        if (isImage) {\n          event.preventDefault();\n          if (callBack) {\n            callBack(cliperData.files);\n          }\n        }\n      } else {\n        event.preventDefault();\n        let text = cliperData.text;\n        if (document.queryCommandSupported('insertText')) {\n          document.execCommand('insertText', false, text);\n        } else {\n          document.execCommand('paste', false, text);\n        }\n      }\n    });\n  }\n}\nexport const focusToCommentElement = (editor, element) => {\n  const path = findPath(editor, element);\n  const endOfFirstNode = Editor.end(editor, path);\n  const startOfFirstNode = Editor.start(editor, path);\n  const range = {\n    anchor: [ELEMENT_TYPE.LIST_ITEM, ELEMENT_TYPE.ORDERED_LIST, ELEMENT_TYPE.UNORDERED_LIST].includes(element.type) ? startOfFirstNode : endOfFirstNode,\n    focus: endOfFirstNode\n  };\n  focusEditor(editor, range);\n};\nexport { CommentUtilities, createNotify, generatorNotificationKey };"],"mappings":";;AAAA,OAAOA,eAAe,MAAM,2CAA2C;AACvE,SAASC,MAAM,QAAQ,gBAAgB;AACvC,SAASC,gBAAgB,QAAQ,gBAAgB;AACjD,SAASC,QAAQ,QAAQ,oBAAoB;AAC7C,SAASC,YAAY,EAAEC,wBAAwB,QAAQ,sBAAsB;AAC7E,SAASC,WAAW,EAAEC,QAAQ,QAAQ,sBAAsB;AAC5D,SAASC,YAAY,QAAQ,2BAA2B;AACxD,OAAO,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAmBA,CAAIC,aAAa,EAAEC,WAAW,EAAK;EACjE,IAAMC,gBAAgB,GAAGD,WAAW,GAAGA,WAAW,CAACE,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAG,EAAE;EAC5E,IAAMC,kBAAkB,GAAGC,KAAK,CAACC,OAAO,CAACP,aAAa,CAAC,IAAIA,aAAa,CAACQ,MAAM,GAAG,CAAC,GAAGR,aAAa,GAAG,EAAE;EACxG,IAAI,CAACE,gBAAgB,EAAE,OAAOG,kBAAkB;EAChD,OAAOA,kBAAkB,CAACI,MAAM,CAAC,UAAAC,YAAY,EAAI;IAC/C,IACEC,IAAI,GAEFD,YAAY,CAFdC,IAAI;MAAAC,qBAAA,GAEFF,YAAY,CADdG,WAAW;MAAXA,WAAW,GAAAD,qBAAA,cAAG,EAAE,GAAAA,qBAAA;IAElB,IAAID,IAAI,CAACG,QAAQ,CAAC,CAAC,CAACV,WAAW,CAAC,CAAC,CAACW,OAAO,CAACb,gBAAgB,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,IAAI;IAC7E,IAAI,CAACW,WAAW,EAAE,OAAO,KAAK;IAC9B,IAAMG,eAAe,GAAGH,WAAW,CAACC,QAAQ,CAAC,CAAC,CAACV,WAAW,CAAC,CAAC;IAC5D,IAAMa,sBAAsB,GAAGf,gBAAgB,CAACgB,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC;;IAEnE;IACA,IAAIF,eAAe,CAACD,OAAO,CAACE,sBAAsB,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,IAAI;IACrE,IAAID,eAAe,CAACE,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CAACH,OAAO,CAACE,sBAAsB,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,IAAI;IACvF,IAAME,mBAAmB,GAAGH,eAAe,CAACI,KAAK,CAAC,IAAI,CAAC;IACvD;IACA,IAAMC,iBAAiB,GAAGF,mBAAmB,CAACG,GAAG,CAAC,UAAAC,IAAI;MAAA,OAAIA,IAAI,IAAIA,IAAI,CAACpB,IAAI,CAAC,CAAC,GAAGoB,IAAI,CAACpB,IAAI,CAAC,CAAC,CAACqB,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,EAAE;IAAA,EAAC;IAC7G,IAAIH,iBAAiB,CAACI,IAAI,CAAC,EAAE,CAAC,CAACV,OAAO,CAACE,sBAAsB,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,IAAI;IAChF,OAAO,KAAK;EACd,CAAC,CAAC;AACJ,CAAC;;AAED;AACA,IAAMS,eAAe,GAAG,yEAAyE;AACjG;AACA;AACA;AACA;;AAEA,OAAO,IAAMC,cAAc,GAAG,SAAjBA,cAAcA,CAAGC,KAAK,EAAI;EACrC,OAAOA,KAAK,CAACC,UAAU,CAAC,GAAG,EAAE,MAAM,CAAC,CAACA,UAAU,CAAC,GAAG,EAAE,MAAM,CAAC;AAC9D,CAAC;AACD,OAAO,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAqBA,CAAGC,KAAK,EAAI;EAC5C,IACEC,OAAO,GACLD,KAAK,CADPC,OAAO;EAET,IACEC,MAAM,GAGJxC,QAAQ,CAHVwC,MAAM;IACNC,SAAS,GAEPzC,QAAQ,CAFVyC,SAAS;IACTC,UAAU,GACR1C,QAAQ,CADV0C,UAAU;EAEZ,IAAIH,OAAO,KAAKC,MAAM,IAAID,OAAO,KAAKE,SAAS,IAAIF,OAAO,KAAKG,UAAU,EAAE,OAAO,KAAK;EACvF,OAAO,IAAI;AACb,CAAC;AAAC,IACIC,gBAAgB,gBAAAC,YAAA,CACpB,SAAAD,iBAAA,EAAc;EAAA,IAAAE,KAAA;EAAAC,eAAA,OAAAH,gBAAA;EACZ9C,eAAe,CAAC,IAAI,EAAE,iBAAiB,EAAE,UAAAkD,IAAI,EAAI;IAC/C,IACEC,UAAU,GAKRD,IAAI,CALNC,UAAU;MACVC,SAAS,GAIPF,IAAI,CAJNE,SAAS;MACTC,KAAK,GAGHH,IAAI,CAHNG,KAAK;MACLC,OAAO,GAELJ,IAAI,CAFNI,OAAO;MACPC,QAAQ,GACNL,IAAI,CADNK,QAAQ;IAEV,IAAIF,KAAK,EAAE;MACTD,SAAS,CAACI,eAAe,CAAC,CAAC;MAC3BJ,SAAS,CAACK,QAAQ,CAACJ,KAAK,CAAC;IAC3B;IACA,OAAOL,KAAI,CAACU,iBAAiB,CAAC;MAC5BP,UAAU,EAAVA,UAAU;MACVC,SAAS,EAATA,SAAS;MACTC,KAAK,EAALA,KAAK;MACLC,OAAO,EAAPA,OAAO;MACPC,QAAQ,EAARA;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;EACFvD,eAAe,CAAC,IAAI,EAAE,gBAAgB,EAAE,UAACuD,QAAQ,EAAED,OAAO,EAAK;IAC7D,QAAQC,QAAQ;MACd,KAAK,OAAO;QACV;UACE,IAAII,aAAa,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;UACjDF,aAAa,CAACG,SAAS,GAAG,iBAAiB;UAC3CH,aAAa,CAACI,eAAe,GAAG,OAAO;UACvC,IAAIC,cAAc,GAAGJ,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;UAClDG,cAAc,CAACC,GAAG,GAAGX,OAAO;UAC5BU,cAAc,CAACE,MAAM,GAAG,EAAE;UAC1BP,aAAa,CAACQ,WAAW,CAACH,cAAc,CAAC;UACzC,OAAOL,aAAa,CAACS,SAAS;QAChC;MACF;QACE;UACE,OAAO,EAAE;QACX;IACJ;EACF,CAAC,CAAC;EACFpE,eAAe,CAAC,IAAI,EAAE,mBAAmB,EAAE,UAAAqE,KAAK,EAAI;IAClD,IACElB,UAAU,GAKRkB,KAAK,CALPlB,UAAU;MACVC,SAAS,GAIPiB,KAAK,CAJPjB,SAAS;MACTC,KAAK,GAGHgB,KAAK,CAHPhB,KAAK;MACLC,OAAO,GAELe,KAAK,CAFPf,OAAO;MACPC,QAAQ,GACNc,KAAK,CADPd,QAAQ;IAEV,IAAIe,SAAS;IACb,IAAIC,SAAS;IACb,IAAIP,cAAc;IAClB,IAAIT,QAAQ,KAAK,OAAO,EAAE;MACxBe,SAAS,GAAGV,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MACzCS,SAAS,CAACR,SAAS,GAAG,iBAAiB;MACvCQ,SAAS,CAACP,eAAe,GAAG,OAAO;MACnCC,cAAc,GAAGJ,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MAC9CG,cAAc,CAACC,GAAG,GAAGX,OAAO;MAC5BU,cAAc,CAACE,MAAM,GAAG,EAAE;MAC1BI,SAAS,CAACH,WAAW,CAACH,cAAc,CAAC;MACrCO,SAAS,GAAGX,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC;MAC1CU,SAAS,CAACC,SAAS,GAAG,GAAG;IAC3B;IACA,IAAIjB,QAAQ,KAAK,cAAc,EAAE;MAC/Be,SAAS,GAAGV,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC;MAC1CU,SAAS,GAAGX,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC;MAC1CS,SAAS,CAACR,SAAS,GAAG,SAAS;MAC/BQ,SAAS,CAACE,SAAS,GAAG,GAAG,CAACC,MAAM,CAACnB,OAAO,CAACjC,IAAI,CAAC;MAC9CkD,SAAS,CAACC,SAAS,GAAG,QAAQ;IAChC;IACA,IAAIE,IAAI,GAAGd,QAAQ,CAACe,sBAAsB,CAAC,CAAC;IAC5CD,IAAI,CAACP,WAAW,CAACG,SAAS,CAAC;IAC3B,IAAMM,QAAQ,GAAGF,IAAI,CAACP,WAAW,CAACI,SAAS,CAAC;IAC5C,IAAIlB,KAAK,EAAE;MACTA,KAAK,CAACwB,UAAU,CAACH,IAAI,CAAC;IACxB,CAAC,MAAM;MACLvB,UAAU,CAAC2B,OAAO,CAACX,WAAW,CAACO,IAAI,CAAC;MACpCrB,KAAK,GAAGD,SAAS,CAAC2B,UAAU,CAAC,CAAC,CAAC;IACjC;IACA,IAAIH,QAAQ,EAAE;MACZvB,KAAK,GAAGA,KAAK,CAAC2B,UAAU,CAAC,CAAC;MAC1B3B,KAAK,CAAC4B,aAAa,CAACL,QAAQ,CAAC;MAC7BvB,KAAK,CAAC6B,QAAQ,CAAC,IAAI,CAAC;MACpB9B,SAAS,CAACI,eAAe,CAAC,CAAC;MAC3BJ,SAAS,CAACK,QAAQ,CAACJ,KAAK,CAAC;IAC3B;IACA,OAAOA,KAAK;EACd,CAAC,CAAC;EACFrD,eAAe,CAAC,IAAI,EAAE,qBAAqB,EAAE,UAAAmF,KAAK,EAAI;IACpD,IACE/B,SAAS,GAKP+B,KAAK,CALP/B,SAAS;MACTC,KAAK,GAIH8B,KAAK,CAJP9B,KAAK;MACL+B,WAAW,GAGTD,KAAK,CAHPC,WAAW;MACXC,QAAQ,GAENF,KAAK,CAFPE,QAAQ;MACRlC,UAAU,GACRgC,KAAK,CADPhC,UAAU;IAEZ,IAAIE,KAAK,EAAE;MACT;MACAD,SAAS,CAACI,eAAe,CAAC,CAAC;MAC3BJ,SAAS,CAACK,QAAQ,CAACJ,KAAK,CAAC;MACzB,IAAMiC,QAAQ,GAAGjC,KAAK,CAACkC,cAAc;MACrC,IAAMC,OAAO,GAAGxC,KAAI,CAACyC,4BAA4B,CAACpC,KAAK,CAACqC,WAAW,EAAEJ,QAAQ,CAACK,IAAI,CAAC;MACnF,IAAIH,OAAO,GAAG,CAAC,CAAC,EAAE;QAChBnC,KAAK,CAACuC,QAAQ,CAACN,QAAQ,EAAEE,OAAO,CAAC;QACjCnC,KAAK,CAACwC,MAAM,CAACP,QAAQ,EAAEjC,KAAK,CAACyC,SAAS,CAAC;QACvCzC,KAAK,CAAC0C,cAAc,CAAC,CAAC;MACxB;IACF;IACA,IAAIC,QAAQ,GAAGhD,KAAI,CAACU,iBAAiB,CAAC;MACpCN,SAAS,EAATA,SAAS;MACTC,KAAK,EAALA,KAAK;MACLC,OAAO,EAAE8B,WAAW;MACpB7B,QAAQ,EAAE,cAAc;MACxBJ,UAAU,EAAVA;IACF,CAAC,CAAC;IACF,IAAIkC,QAAQ,EAAE;MACZA,QAAQ,CAAC,CAAC;IACZ;IACA,IAAIlC,UAAU,CAAC2B,OAAO,EAAE;MACtB3B,UAAU,CAAC2B,OAAO,CAACmB,KAAK,CAAC,CAAC;IAC5B;IACA,OAAOD,QAAQ;EACjB,CAAC,CAAC;EACF;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EACIhG,eAAe,CAAC,IAAI,EAAE,8BAA8B,EAAE,UAACkG,cAAc,EAAEC,IAAI,EAAK;IAC9E,IAAIX,OAAO,GAAG,CAAC,CAAC;IAChB,KAAK,IAAIY,CAAC,GAAGF,cAAc,GAAG,CAAC,EAAEE,CAAC,GAAG,CAAC,CAAC,EAAEA,CAAC,EAAE,EAAE;MAC5C,IAAID,IAAI,CAACC,CAAC,CAAC,KAAK,GAAG,EAAE;QACnBZ,OAAO,GAAGY,CAAC;QACX;MACF;IACF;IACA,OAAOZ,OAAO;EAChB,CAAC,CAAC;EACFxF,eAAe,CAAC,IAAI,EAAE,SAAS,EAAE,UAACyC,KAAK,EAAE4C,QAAQ,EAAK;IACpD5C,KAAK,CAAC4D,eAAe,CAAC,CAAC;IACvB,IAAIC,UAAU,GAAGpG,gBAAgB,CAACuC,KAAK,CAAC;IACxC,IAAI6D,UAAU,CAACC,KAAK,EAAE;MACpB,IAAIC,IAAI,GAAGF,UAAU,CAACC,KAAK,CAAC,CAAC,CAAC;MAC9B,IAAIE,OAAO,GAAG,QAAQ,CAACC,IAAI,CAACF,IAAI,CAACG,IAAI,CAAC;MACtC,IAAIF,OAAO,EAAE;QACXhE,KAAK,CAACmE,cAAc,CAAC,CAAC;QACtB,IAAIvB,QAAQ,EAAE;UACZA,QAAQ,CAACiB,UAAU,CAACC,KAAK,CAAC;QAC5B;MACF;IACF,CAAC,MAAM;MACL9D,KAAK,CAACmE,cAAc,CAAC,CAAC;MACtB,IAAIT,IAAI,GAAGG,UAAU,CAACH,IAAI;MAC1B,IAAIvC,QAAQ,CAACiD,qBAAqB,CAAC,YAAY,CAAC,EAAE;QAChDjD,QAAQ,CAACkD,WAAW,CAAC,YAAY,EAAE,KAAK,EAAEX,IAAI,CAAC;MACjD,CAAC,MAAM;QACLvC,QAAQ,CAACkD,WAAW,CAAC,OAAO,EAAE,KAAK,EAAEX,IAAI,CAAC;MAC5C;IACF;EACF,CAAC,CAAC;AACJ,CAAC;AAEH,OAAO,IAAMY,qBAAqB,GAAG,SAAxBA,qBAAqBA,CAAIC,MAAM,EAAEC,OAAO,EAAK;EACxD,IAAMC,IAAI,GAAG3G,QAAQ,CAACyG,MAAM,EAAEC,OAAO,CAAC;EACtC,IAAME,cAAc,GAAGlH,MAAM,CAACmH,GAAG,CAACJ,MAAM,EAAEE,IAAI,CAAC;EAC/C,IAAMG,gBAAgB,GAAGpH,MAAM,CAACqH,KAAK,CAACN,MAAM,EAAEE,IAAI,CAAC;EACnD,IAAM7D,KAAK,GAAG;IACZkE,MAAM,EAAE,CAAC/G,YAAY,CAACgH,SAAS,EAAEhH,YAAY,CAACiH,YAAY,EAAEjH,YAAY,CAACkH,cAAc,CAAC,CAACC,QAAQ,CAACV,OAAO,CAACN,IAAI,CAAC,GAAGU,gBAAgB,GAAGF,cAAc;IACnJlB,KAAK,EAAEkB;EACT,CAAC;EACD7G,WAAW,CAAC0G,MAAM,EAAE3D,KAAK,CAAC;AAC5B,CAAC;AACD,SAASP,gBAAgB,EAAE1C,YAAY,EAAEC,wBAAwB"},"metadata":{},"sourceType":"module","externalDependencies":[]}