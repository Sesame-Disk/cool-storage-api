{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{Button,Modal,ModalHeader,ModalBody,ModalFooter,Input,InputGroupAddon,InputGroup}from'reactstrap';import{gettext,orgID}from'../../utils/constants';import{seafileAPI}from'../../utils/seafile-api';import{Utils}from'../../utils/utils';import toaster from'../toast';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SetGroupQuotaDialog=/*#__PURE__*/function(_React$Component){_inherits(SetGroupQuotaDialog,_React$Component);var _super=_createSuper(SetGroupQuotaDialog);function SetGroupQuotaDialog(props){var _this;_classCallCheck(this,SetGroupQuotaDialog);_this=_super.call(this,props);_this.setGroupQuota=function(){var myReg=/^[1-9]\\d*$/im;var quota=_this.state.quota;if(quota.length&&myReg.test(quota)||quota==-2){_this.setState({errMessage:''});var newQuota=_this.state.quota==-2?_this.state.quota:_this.state.quota*1000000;seafileAPI.orgAdminSetGroupQuota(orgID,_this.props.groupID,newQuota).then(function(res){_this.props.toggle();_this.props.onDepartChanged();}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});}else{var err=gettext('Quota is invalid.');_this.setState({errMessage:err});}};_this.handleChange=function(e){var quota=e.target.value.trim();_this.setState({quota:quota});};_this.handleKeyDown=function(e){if(e.key==='Enter'){_this.setGroupQuota();e.preventDefault();}};_this.state={quota:'',errMessage:''};return _this;}_createClass(SetGroupQuotaDialog,[{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(Modal,{isOpen:true,toggle:this.props.toggle,autoFocus:false,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:this.props.toggle,children:gettext('Set Quota')}),/*#__PURE__*/_jsxs(ModalBody,{children:[/*#__PURE__*/_jsxs(InputGroup,{children:[/*#__PURE__*/_jsx(Input,{onKeyDown:this.handleKeyDown,value:this.state.quota,onChange:this.handleChange,autoFocus:true}),/*#__PURE__*/_jsx(InputGroupAddon,{addonType:\"append\",children:'MB'})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"tip\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{children:gettext('An integer that is greater than 0 or equal to -2.')}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{children:gettext('Tip: -2 means no limit.')})]}),this.state.errMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:this.state.errMessage})]}),/*#__PURE__*/_jsx(ModalFooter,{children:/*#__PURE__*/_jsx(Button,{color:\"primary\",onClick:this.setGroupQuota,children:gettext('Submit')})})]});}}]);return SetGroupQuotaDialog;}(React.Component);export default SetGroupQuotaDialog;","map":{"version":3,"names":["React","Button","Modal","ModalHeader","ModalBody","ModalFooter","Input","InputGroupAddon","InputGroup","gettext","orgID","seafileAPI","Utils","toaster","jsx","_jsx","jsxs","_jsxs","SetGroupQuotaDialog","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","setGroupQuota","myReg","quota","state","length","test","setState","errMessage","newQuota","orgAdminSetGroupQuota","groupID","then","res","toggle","onDepartChanged","catch","error","getErrorMsg","danger","err","handleChange","e","target","value","trim","handleKeyDown","key","preventDefault","_createClass","render","isOpen","autoFocus","children","onKeyDown","onChange","addonType","className","color","onClick","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/org-set-group-quota-dialog.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Input, InputGroupAddon, InputGroup } from 'reactstrap';\nimport { gettext, orgID } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  toggle: PropTypes.func.isRequired,\n  groupID: PropTypes.number.isRequired,\n  onDepartChanged: PropTypes.func.isRequired,\n};\n\nclass SetGroupQuotaDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      quota: '',\n      errMessage: '',\n    };\n  }\n\n  setGroupQuota = () => {\n    const myReg = /^[1-9]\\d*$/im;\n    let quota = this.state.quota;\n    if ((quota.length && myReg.test(quota)) || quota == -2) {\n      this.setState({ errMessage: '' });\n      let newQuota = this.state.quota == -2 ? this.state.quota : this.state.quota * 1000000;\n      seafileAPI.orgAdminSetGroupQuota(orgID, this.props.groupID, newQuota).then((res) => {\n        this.props.toggle();\n        this.props.onDepartChanged();\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      const err = gettext('Quota is invalid.');\n      this.setState({ errMessage: err });\n    }\n  };\n\n  handleChange = (e) => {\n    const quota = e.target.value.trim();\n    this.setState({ quota: quota });\n  };\n\n  handleKeyDown = (e) => {\n    if (e.key === 'Enter') {\n      this.setGroupQuota();\n      e.preventDefault();\n    }\n  };\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggle} autoFocus={false}>\n        <ModalHeader toggle={this.props.toggle}>{gettext('Set Quota')}</ModalHeader>\n        <ModalBody>\n          <InputGroup>\n            <Input\n              onKeyDown={this.handleKeyDown}\n              value={this.state.quota}\n              onChange={this.handleChange}\n              autoFocus={true}\n            />\n            <InputGroupAddon addonType=\"append\">{'MB'}</InputGroupAddon>\n          </InputGroup>\n          <p className=\"tip\">\n            <br/><span>{gettext('An integer that is greater than 0 or equal to -2.')}</span><br/>\n            <span>{gettext('Tip: -2 means no limit.')}</span>\n          </p>\n          { this.state.errMessage && <p className=\"error\">{this.state.errMessage}</p> }\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"primary\" onClick={this.setGroupQuota}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nSetGroupQuotaDialog.propTypes = propTypes;\n\nexport default SetGroupQuotaDialog;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}