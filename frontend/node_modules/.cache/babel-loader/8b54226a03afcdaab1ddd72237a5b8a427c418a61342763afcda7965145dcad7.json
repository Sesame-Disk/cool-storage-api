{"ast":null,"code":"import _objectSpread from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component,Fragment}from'react';import{Form,FormGroup,Input,Label,Col}from'reactstrap';import{Utils}from'../../../utils/utils';import{seafileAPI}from'../../../utils/seafile-api';import{gettext}from'../../../utils/constants';import toaster from'../../../components/toast';import MainPanelTopbar from'../main-panel-topbar';import Content from'./groups-content';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SearchGroups=/*#__PURE__*/function(_Component){_inherits(SearchGroups,_Component);var _super=_createSuper(SearchGroups);function SearchGroups(props){var _this;_classCallCheck(this,SearchGroups);_this=_super.call(this,props);_this.getGroups=function(){var name=_this.state.name;seafileAPI.sysAdminSearchGroups(name).then(function(res){_this.setState({loading:false,groupList:res.data.group_list});}).catch(function(error){_this.setState({loading:false,errorMsg:Utils.getErrorMsg(error,true)// true: show login tip if 403\n});});};_this.deleteGroup=function(groupID){seafileAPI.sysAdminDismissGroupByID(groupID).then(function(res){var newGroupList=_this.state.groupList.filter(function(item){return item.id!=groupID;});_this.setState({groupList:newGroupList});toaster.success(gettext('Successfully deleted 1 item.'));}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.transferGroup=function(groupID,receiverEmail){seafileAPI.sysAdminTransferGroup(receiverEmail,groupID).then(function(res){var newGroupList=_this.state.groupList.map(function(item){if(item.id==groupID){item=res.data;}return item;});_this.setState({groupList:newGroupList});toaster.success(gettext('Successfully transferred the group.'));}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.handleNameInputChange=function(e){_this.setState({name:e.target.value},_this.checkSubmitBtnActive);};_this.checkSubmitBtnActive=function(){var name=_this.state.name;_this.setState({isSubmitBtnActive:name.trim()});};_this.handleKeyDown=function(e){if(e.keyCode===13){var isSubmitBtnActive=_this.state.isSubmitBtnActive;if(isSubmitBtnActive){_this.getGroups();}}};_this.state={name:'',isSubmitBtnActive:false,loading:true,errorMsg:'',groupList:[],pageInfo:null};return _this;}_createClass(SearchGroups,[{key:\"componentDidMount\",value:function componentDidMount(){var params=new URL(document.location).searchParams;this.setState({name:params.get('name')||''},this.getGroups);}},{key:\"render\",value:function render(){var _this$state=this.state,name=_this$state.name,isSubmitBtnActive=_this$state.isSubmitBtnActive;return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(MainPanelTopbar,_objectSpread({},this.props)),/*#__PURE__*/_jsx(\"div\",{className:\"main-panel-center flex-row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"cur-view-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cur-view-path\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"sf-heading\",children:gettext('Groups')})}),/*#__PURE__*/_jsxs(\"div\",{className:\"cur-view-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 mb-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"border-bottom font-weight-normal mb-2 pb-1\",children:gettext('Search Groups')}),/*#__PURE__*/_jsx(\"p\",{className:\"text-secondary small\",children:gettext('Tip: you can search by keyword in name.')}),/*#__PURE__*/_jsxs(Form,{tag:'div',children:[/*#__PURE__*/_jsxs(FormGroup,{row:true,children:[/*#__PURE__*/_jsx(Label,{for:\"name\",sm:1,children:gettext('Name')}),/*#__PURE__*/_jsx(Col,{sm:5,children:/*#__PURE__*/_jsx(Input,{type:\"text\",name:\"name\",id:\"name\",value:name,onChange:this.handleNameInputChange,onKeyDown:this.handleKeyDown})})]}),/*#__PURE__*/_jsx(FormGroup,{row:true,children:/*#__PURE__*/_jsx(Col,{sm:{size:5,offset:1},children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-primary\",disabled:!isSubmitBtnActive,onClick:this.getGroups,children:gettext('Submit')})})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 mb-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"border-bottom font-weight-normal mb-2 pb-1\",children:gettext('Result')}),/*#__PURE__*/_jsx(Content,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.groupList,deleteGroup:this.deleteGroup,transferGroup:this.transferGroup})]})]})]})})]});}}]);return SearchGroups;}(Component);export default SearchGroups;","map":{"version":3,"names":["React","Component","Fragment","Form","FormGroup","Input","Label","Col","Utils","seafileAPI","gettext","toaster","MainPanelTopbar","Content","jsx","_jsx","jsxs","_jsxs","SearchGroups","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","getGroups","name","state","sysAdminSearchGroups","then","res","setState","loading","groupList","data","group_list","catch","error","errorMsg","getErrorMsg","deleteGroup","groupID","sysAdminDismissGroupByID","newGroupList","filter","item","id","success","errMessage","danger","transferGroup","receiverEmail","sysAdminTransferGroup","map","handleNameInputChange","e","target","value","checkSubmitBtnActive","isSubmitBtnActive","trim","handleKeyDown","keyCode","pageInfo","_createClass","key","componentDidMount","params","URL","document","location","searchParams","get","render","_this$state","children","_objectSpread","className","tag","row","for","sm","type","onChange","onKeyDown","size","offset","disabled","onClick","items"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/pages/sys-admin/groups/search-groups.js"],"sourcesContent":["import React, { Component, Fragment } from 'react';\nimport { Form, FormGroup, Input, Label, Col } from 'reactstrap';\nimport { Utils } from '../../../utils/utils';\nimport { seafileAPI } from '../../../utils/seafile-api';\nimport { gettext } from '../../../utils/constants';\nimport toaster from '../../../components/toast';\nimport MainPanelTopbar from '../main-panel-topbar';\nimport Content from './groups-content';\n\nclass SearchGroups extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: '',\n      isSubmitBtnActive: false,\n      loading: true,\n      errorMsg: '',\n      groupList: [],\n      pageInfo: null\n    };\n  }\n\n  componentDidMount () {\n    let params = (new URL(document.location)).searchParams;\n    this.setState({\n      name: params.get('name') || ''\n    }, this.getGroups);\n  }\n\n  getGroups = () => {\n    const { name } = this.state;\n    seafileAPI.sysAdminSearchGroups(name).then((res) => {\n      this.setState({\n        loading: false,\n        groupList: res.data.group_list\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  };\n\n  deleteGroup = (groupID) => {\n    seafileAPI.sysAdminDismissGroupByID(groupID).then(res => {\n      let newGroupList = this.state.groupList.filter(item => {\n        return item.id != groupID;\n      });\n      this.setState({\n        groupList: newGroupList\n      });\n      toaster.success(gettext('Successfully deleted 1 item.'));\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  transferGroup = (groupID, receiverEmail) => {\n    seafileAPI.sysAdminTransferGroup(receiverEmail, groupID).then(res => {\n      let newGroupList = this.state.groupList.map(item => {\n        if (item.id == groupID) {\n          item = res.data;\n        }\n        return item;\n      });\n      this.setState({\n        groupList: newGroupList\n      });\n      toaster.success(gettext('Successfully transferred the group.'));\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  handleNameInputChange = (e) => {\n    this.setState({\n      name: e.target.value\n    }, this.checkSubmitBtnActive);\n  };\n\n  checkSubmitBtnActive = () => {\n    const { name } = this.state;\n    this.setState({\n      isSubmitBtnActive: name.trim()\n    });\n  };\n\n  handleKeyDown = (e) => {\n    if (e.keyCode === 13) {\n      const { isSubmitBtnActive } = this.state;\n      if (isSubmitBtnActive) {\n        this.getGroups();\n      }\n    }\n  };\n\n  render() {\n    const { name, isSubmitBtnActive } = this.state;\n\n    return (\n      <Fragment>\n        <MainPanelTopbar {...this.props} />\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading\">{gettext('Groups')}</h3>\n            </div>\n            <div className=\"cur-view-content\">\n              <div className=\"mt-4 mb-6\">\n                <h4 className=\"border-bottom font-weight-normal mb-2 pb-1\">{gettext('Search Groups')}</h4>\n                <p className=\"text-secondary small\">{gettext('Tip: you can search by keyword in name.')}</p>\n                <Form tag={'div'}>\n                  <FormGroup row>\n                    <Label for=\"name\" sm={1}>{gettext('Name')}</Label>\n                    <Col sm={5}>\n                      <Input type=\"text\" name=\"name\" id=\"name\" value={name} onChange={this.handleNameInputChange} onKeyDown={this.handleKeyDown} />\n                    </Col>\n                  </FormGroup>\n                  <FormGroup row>\n                    <Col sm={{size: 5, offset: 1}}>\n                      <button className=\"btn btn-outline-primary\" disabled={!isSubmitBtnActive} onClick={this.getGroups}>{gettext('Submit')}</button>\n                    </Col>\n                  </FormGroup>\n                </Form>\n              </div>\n              <div className=\"mt-4 mb-6\">\n                <h4 className=\"border-bottom font-weight-normal mb-2 pb-1\">{gettext('Result')}</h4>\n                <Content\n                  loading={this.state.loading}\n                  errorMsg={this.state.errorMsg}\n                  items={this.state.groupList}\n                  deleteGroup={this.deleteGroup}\n                  transferGroup={this.transferGroup}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nexport default SearchGroups;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}