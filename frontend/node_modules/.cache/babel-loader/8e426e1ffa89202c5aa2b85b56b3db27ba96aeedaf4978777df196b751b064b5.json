{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component,Fragment}from'react';import Nav from'./org-users-nav';import OrgAdminList from'./org-admin-list';import MainPanelTopbar from'./main-panel-topbar';import AddOrgAdminDialog from'../../components/dialog/org-add-admin-dialog';import ModalPortal from'../../components/modal-portal';import toaster from'../../components/toast';import{seafileAPI}from'../../utils/seafile-api';import OrgUserInfo from'../../models/org-user';import{gettext,orgID}from'../../utils/constants';import{Utils}from'../../utils/utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var OrgUsers=/*#__PURE__*/function(_Component){_inherits(OrgUsers,_Component);var _super=_createSuper(OrgUsers);function OrgUsers(props){var _this;_classCallCheck(this,OrgUsers);_this=_super.call(this,props);_this.toggleAddOrgAdmin=function(){_this.setState({isShowAddOrgAdminDialog:!_this.state.isShowAddOrgAdminDialog});};_this.initOrgAdmin=function(){seafileAPI.orgAdminListOrgUsers(orgID,true).then(function(res){var userList=res.data.user_list.map(function(item){return new OrgUserInfo(item);});_this.setState({orgAdminUsers:userList});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.toggleOrgAdminDelete=function(email,username){seafileAPI.orgAdminDeleteOrgUser(orgID,email).then(function(res){_this.setState({orgAdminUsers:_this.state.orgAdminUsers.filter(function(item){return item.email!=email;})});var msg=gettext('Deleted user %s');msg=msg.replace('%s',username);toaster.success(msg);}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.toggleRevokeAdmin=function(email){seafileAPI.orgAdminSetOrgAdmin(orgID,email,false).then(function(res){_this.setState({orgAdminUsers:_this.state.orgAdminUsers.filter(function(item){return item.email!=email;})});var msg=gettext('Successfully revoke the admin permission of %s');msg=msg.replace('%s',res.data.name);toaster.success(msg);}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.onAddedOrgAdmin=function(userInfo){_this.state.orgAdminUsers.unshift(userInfo);_this.setState({orgAdminUsers:_this.state.orgAdminUsers});var msg=gettext('Successfully set %s as admin.');msg=msg.replace('%s',userInfo.email);toaster.success(msg);_this.toggleAddOrgAdmin();};_this.changeStatus=function(email,isActive){seafileAPI.orgAdminChangeOrgUserStatus(orgID,email,isActive).then(function(res){var users=_this.state.orgAdminUsers.map(function(item){if(item.email==email){item['is_active']=res.data['is_active'];}return item;});_this.setState({orgAdminUsers:users});toaster.success(gettext('Edit succeeded.'));}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.state={orgAdminUsers:[],isShowAddOrgAdminDialog:false};return _this;}_createClass(OrgUsers,[{key:\"render\",value:function render(){var topBtn='btn btn-secondary operation-item';var topbarChildren;topbarChildren=/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{className:topBtn,title:gettext('Add admin'),onClick:this.toggleAddOrgAdmin,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus-square text-secondary mr-1\"}),gettext('Add admin')]}),this.state.isShowAddOrgAdminDialog&&/*#__PURE__*/_jsx(ModalPortal,{children:/*#__PURE__*/_jsx(AddOrgAdminDialog,{toggle:this.toggleAddOrgAdmin,onAddedOrgAdmin:this.onAddedOrgAdmin})})]});return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(MainPanelTopbar,{children:topbarChildren}),/*#__PURE__*/_jsx(\"div\",{className:\"main-panel-center flex-row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"cur-view-container\",children:[/*#__PURE__*/_jsx(Nav,{currentItem:\"admins\"}),/*#__PURE__*/_jsx(OrgAdminList,{currentTab:\"admins\",toggleDelete:this.toggleOrgAdminDelete,toggleRevokeAdmin:this.toggleRevokeAdmin,orgAdminUsers:this.state.orgAdminUsers,initOrgAdmin:this.initOrgAdmin,changeStatus:this.changeStatus})]})})]});}}]);return OrgUsers;}(Component);export default OrgUsers;","map":{"version":3,"names":["React","Component","Fragment","Nav","OrgAdminList","MainPanelTopbar","AddOrgAdminDialog","ModalPortal","toaster","seafileAPI","OrgUserInfo","gettext","orgID","Utils","jsx","_jsx","jsxs","_jsxs","OrgUsers","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","toggleAddOrgAdmin","setState","isShowAddOrgAdminDialog","state","initOrgAdmin","orgAdminListOrgUsers","then","res","userList","data","user_list","map","item","orgAdminUsers","catch","error","errMessage","getErrorMsg","danger","toggleOrgAdminDelete","email","username","orgAdminDeleteOrgUser","filter","msg","replace","success","toggleRevokeAdmin","orgAdminSetOrgAdmin","name","onAddedOrgAdmin","userInfo","unshift","changeStatus","isActive","orgAdminChangeOrgUserStatus","users","_createClass","key","value","render","topBtn","topbarChildren","children","className","title","onClick","toggle","currentItem","currentTab","toggleDelete"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/pages/org-admin/org-users-admins.js"],"sourcesContent":["import React, { Component, Fragment } from 'react';\nimport Nav from './org-users-nav';\nimport OrgAdminList from './org-admin-list';\nimport MainPanelTopbar from './main-panel-topbar';\nimport AddOrgAdminDialog from '../../components/dialog/org-add-admin-dialog';\nimport ModalPortal from '../../components/modal-portal';\nimport toaster from '../../components/toast';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport OrgUserInfo from '../../models/org-user';\nimport { gettext, orgID } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nclass OrgUsers extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      orgAdminUsers: [],\n      isShowAddOrgAdminDialog: false\n    };\n  }\n\n  toggleAddOrgAdmin = () => {\n    this.setState({isShowAddOrgAdminDialog: !this.state.isShowAddOrgAdminDialog});\n  };\n\n  initOrgAdmin = () => {\n    seafileAPI.orgAdminListOrgUsers(orgID, true).then(res => {\n      let userList = res.data.user_list.map(item => {\n        return new OrgUserInfo(item);\n      });\n      this.setState({orgAdminUsers: userList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  toggleOrgAdminDelete = (email, username) => {\n    seafileAPI.orgAdminDeleteOrgUser(orgID, email).then(res => {\n      this.setState({\n        orgAdminUsers: this.state.orgAdminUsers.filter(item => item.email != email)\n      });\n      let msg = gettext('Deleted user %s');\n      msg = msg.replace('%s', username);\n      toaster.success(msg);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  toggleRevokeAdmin = (email) => {\n    seafileAPI.orgAdminSetOrgAdmin(orgID, email, false).then(res => {\n      this.setState({\n        orgAdminUsers: this.state.orgAdminUsers.filter(item => item.email != email)\n      });\n      let msg = gettext('Successfully revoke the admin permission of %s');\n      msg = msg.replace('%s', res.data.name);\n      toaster.success(msg);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  onAddedOrgAdmin = (userInfo) => {\n    this.state.orgAdminUsers.unshift(userInfo);\n    this.setState({\n      orgAdminUsers: this.state.orgAdminUsers\n    });\n    let msg = gettext('Successfully set %s as admin.');\n    msg = msg.replace('%s', userInfo.email);\n    toaster.success(msg);\n    this.toggleAddOrgAdmin();\n  };\n\n  changeStatus = (email, isActive) => {\n    seafileAPI.orgAdminChangeOrgUserStatus(orgID, email, isActive).then(res => {\n      let users = this.state.orgAdminUsers.map(item => {\n        if (item.email == email) {\n          item['is_active']= res.data['is_active'];\n        }\n        return item;\n      });\n      this.setState({orgAdminUsers: users});\n      toaster.success(gettext('Edit succeeded.'));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  render() {\n    const topBtn = 'btn btn-secondary operation-item';\n    let topbarChildren;\n    topbarChildren = (\n      <Fragment>\n        <button className={topBtn} title={gettext('Add admin')} onClick={this.toggleAddOrgAdmin}>\n          <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('Add admin')}\n        </button>\n        {this.state.isShowAddOrgAdminDialog &&\n        <ModalPortal>\n          <AddOrgAdminDialog toggle={this.toggleAddOrgAdmin} onAddedOrgAdmin={this.onAddedOrgAdmin}/>\n        </ModalPortal>\n        }\n      </Fragment>\n    );\n\n    return (\n      <Fragment>\n        <MainPanelTopbar children={topbarChildren}/>\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <Nav currentItem=\"admins\" />\n            <OrgAdminList\n              currentTab=\"admins\"\n              toggleDelete={this.toggleOrgAdminDelete}\n              toggleRevokeAdmin={this.toggleRevokeAdmin}\n              orgAdminUsers={this.state.orgAdminUsers}\n              initOrgAdmin={this.initOrgAdmin}\n              changeStatus={this.changeStatus}\n            />\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nexport default OrgUsers;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}