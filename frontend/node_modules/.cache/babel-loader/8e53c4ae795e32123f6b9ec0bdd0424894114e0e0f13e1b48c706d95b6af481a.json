{"ast":null,"code":"import _objectSpread from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Fragment}from'react';import moment from'moment';import{seafileAPI}from'../../../utils/seafile-api';import MainPanelTopbar from'../main-panel-topbar';import ModalPortal from'../../../components/modal-portal';import AddDepartDialog from'../../../components/dialog/sysadmin-dialog/sysadmin-add-department-dialog';import{gettext,lang}from'../../../utils/constants';import GroupItem from'./group-item';import'../../../css/org-department-item.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";moment.locale(lang);var DepartmentList=/*#__PURE__*/function(_React$Component){_inherits(DepartmentList,_React$Component);var _super=_createSuper(DepartmentList);function DepartmentList(props){var _this;_classCallCheck(this,DepartmentList);_this=_super.call(this,props);_this.onFreezedItem=function(){_this.setState({isItemFreezed:true});};_this.onUnfreezedItem=function(){_this.setState({isItemFreezed:false});};_this.listDepartments=function(){seafileAPI.sysAdminListAllDepartments().then(function(res){_this.setState({groups:res.data.data});});};_this.toggleAddDepartDialog=function(){_this.setState({isShowAddDepartDialog:!_this.state.isShowAddDepartDialog});};_this.onDepartmentNameChanged=function(dept){_this.setState({groups:_this.state.groups.map(function(item){if(item.id==dept.id){item.name=dept.name;}return item;})});};_this.onAddNewDepartment=function(newDepartment){var groups=_this.state.groups;groups.unshift(newDepartment);_this.setState({groups:groups});};_this.onDeleteDepartment=function(id){var groups=_this.state.groups;_this.setState({groups:groups.filter(function(item){return item.id!=id;})});};_this.onSetDepartmentQuota=function(target){var groups=_this.state.groups;_this.setState({groups:groups.map(function(item){if(item.id==target.id){item.quota=target.quota;}return item;})});};_this.state={groups:null,groupID:'',isShowAddDepartDialog:false,isItemFreezed:false};return _this;}_createClass(DepartmentList,[{key:\"componentDidMount\",value:function componentDidMount(){this.listDepartments();}},{key:\"render\",value:function render(){var _this2=this;var groups=this.state.groups;var topbarChildren=/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary operation-item\",title:gettext('New Department'),onClick:this.toggleAddDepartDialog,children:gettext('New Department')}),this.state.isShowAddDepartDialog&&/*#__PURE__*/_jsx(ModalPortal,{children:/*#__PURE__*/_jsx(AddDepartDialog,{onAddNewDepartment:this.onAddNewDepartment,groupID:this.state.groupID,toggle:this.toggleAddDepartDialog})})]});return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(MainPanelTopbar,_objectSpread(_objectSpread({},this.props),{},{children:topbarChildren})),/*#__PURE__*/_jsx(\"div\",{className:\"main-panel-center flex-row h-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"cur-view-container o-auto\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cur-view-path\",children:/*#__PURE__*/_jsx(\"div\",{className:\"fleft\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"sf-heading\",children:gettext('Departments')})})}),/*#__PURE__*/_jsx(\"div\",{className:\"cur-view-content\",children:groups&&groups.length>0?/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{width:\"40%\",children:gettext('Name')}),/*#__PURE__*/_jsx(\"th\",{width:\"25%\",children:gettext('Created At')}),/*#__PURE__*/_jsx(\"th\",{width:\"20%\",children:gettext('Quota')}),/*#__PURE__*/_jsx(\"th\",{width:\"15%\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:groups.map(function(group,index){return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(GroupItem,{group:group,isItemFreezed:_this2.state.isItemFreezed,onFreezedItem:_this2.onFreezedItem,onUnfreezedItem:_this2.onUnfreezedItem,onDepartmentNameChanged:_this2.onDepartmentNameChanged,onDeleteDepartment:_this2.onDeleteDepartment,onSetDepartmentQuota:_this2.onSetDepartmentQuota})},group.id);})})]}):/*#__PURE__*/_jsx(\"p\",{className:\"no-group\",children:gettext('No departments')})})]})})]});}}]);return DepartmentList;}(React.Component);export default DepartmentList;","map":{"version":3,"names":["React","Fragment","moment","seafileAPI","MainPanelTopbar","ModalPortal","AddDepartDialog","gettext","lang","GroupItem","jsx","_jsx","jsxs","_jsxs","locale","DepartmentList","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","onFreezedItem","setState","isItemFreezed","onUnfreezedItem","listDepartments","sysAdminListAllDepartments","then","res","groups","data","toggleAddDepartDialog","isShowAddDepartDialog","state","onDepartmentNameChanged","dept","map","item","id","name","onAddNewDepartment","newDepartment","unshift","onDeleteDepartment","filter","onSetDepartmentQuota","target","quota","groupID","_createClass","key","value","componentDidMount","render","_this2","topbarChildren","children","className","title","onClick","toggle","_objectSpread","length","width","group","index","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/pages/sys-admin/departments/department-list.js"],"sourcesContent":["import React, { Fragment } from 'react';\nimport moment from 'moment';\nimport { seafileAPI } from '../../../utils/seafile-api';\nimport MainPanelTopbar from '../main-panel-topbar';\nimport ModalPortal from '../../../components/modal-portal';\nimport AddDepartDialog from '../../../components/dialog/sysadmin-dialog/sysadmin-add-department-dialog';\nimport { gettext, lang } from '../../../utils/constants';\nimport GroupItem from './group-item';\nimport '../../../css/org-department-item.css';\n\nmoment.locale(lang);\n\nclass DepartmentList extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      groups: null,\n      groupID: '',\n      isShowAddDepartDialog: false,\n      isItemFreezed: false\n    };\n  }\n\n  componentDidMount() {\n    this.listDepartments();\n  }\n\n  onFreezedItem = () => {\n    this.setState({isItemFreezed: true});\n  };\n\n  onUnfreezedItem = () => {\n    this.setState({isItemFreezed: false});\n  };\n\n  listDepartments = () => {\n    seafileAPI.sysAdminListAllDepartments().then(res => {\n      this.setState({ groups: res.data.data });\n    });\n  };\n\n  toggleAddDepartDialog = () => {\n    this.setState({ isShowAddDepartDialog: !this.state.isShowAddDepartDialog });\n  };\n\n  onDepartmentNameChanged = (dept) => {\n    this.setState({\n      groups: this.state.groups.map(item => {\n        if (item.id == dept.id) {\n          item.name = dept.name;\n        }\n        return item;\n      })\n    });\n  };\n\n  onAddNewDepartment = (newDepartment) => {\n    const { groups } = this.state;\n    groups.unshift(newDepartment);\n    this.setState({\n      groups: groups\n    });\n  };\n\n  onDeleteDepartment = (id) => {\n    const { groups } = this.state;\n    this.setState({\n      groups: groups.filter((item) => item.id != id)\n    });\n  };\n\n  onSetDepartmentQuota = (target) => {\n    const { groups } = this.state;\n    this.setState({\n      groups: groups.map((item) => {\n        if (item.id == target.id) {\n          item.quota = target.quota;\n        }\n        return item;\n      })\n    });\n  };\n\n  render() {\n    const groups = this.state.groups;\n    const topbarChildren = (\n      <Fragment>\n        <button className='btn btn-secondary operation-item' title={gettext('New Department')} onClick={this.toggleAddDepartDialog}>{gettext('New Department')}\n        </button>\n        {this.state.isShowAddDepartDialog && (\n          <ModalPortal>\n            <AddDepartDialog\n              onAddNewDepartment={this.onAddNewDepartment}\n              groupID={this.state.groupID}\n              toggle={this.toggleAddDepartDialog}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n    return (\n      <Fragment>\n        <MainPanelTopbar {...this.props}>\n          {topbarChildren}\n        </MainPanelTopbar>\n        <div className=\"main-panel-center flex-row h-100\">\n          <div className=\"cur-view-container o-auto\">\n            <div className=\"cur-view-path\">\n              <div className=\"fleft\">\n                <h3 className=\"sf-heading\">{gettext('Departments')}</h3>\n              </div>\n            </div>\n            <div className=\"cur-view-content\">\n              {groups && groups.length > 0 ?\n                <table>\n                  <thead>\n                    <tr>\n                      <th width=\"40%\">{gettext('Name')}</th>\n                      <th width=\"25%\">{gettext('Created At')}</th>\n                      <th width=\"20%\">{gettext('Quota')}</th>\n                      <th width=\"15%\"></th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {groups.map((group, index) => {\n                      return(\n                        <Fragment key={group.id}>\n                          <GroupItem\n                            group={group}\n                            isItemFreezed={this.state.isItemFreezed}\n                            onFreezedItem={this.onFreezedItem}\n                            onUnfreezedItem={this.onUnfreezedItem}\n                            onDepartmentNameChanged={this.onDepartmentNameChanged}\n                            onDeleteDepartment={this.onDeleteDepartment}\n                            onSetDepartmentQuota={this.onSetDepartmentQuota}\n                          />\n                        </Fragment>\n                      );\n                    })}\n                  </tbody>\n                </table>\n                :\n                <p className=\"no-group\">{gettext('No departments')}</p>\n              }\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nexport default DepartmentList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}