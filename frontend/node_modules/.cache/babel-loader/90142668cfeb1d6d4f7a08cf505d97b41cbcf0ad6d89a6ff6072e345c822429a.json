{"ast":null,"code":"import { Transforms, Node, Editor } from '@seafile/slate';\nimport { FILE_LINK } from '../../constants';\nvar withFileLink = function withFileLink(editor) {\n  var isInline = editor.isInline,\n    deleteBackward = editor.deleteBackward;\n  var newEditor = editor;\n\n  // Rewrite isInline\n  newEditor.isInline = function (elem) {\n    var type = elem.type;\n    if (type === FILE_LINK) {\n      return true;\n    }\n    return isInline(elem);\n  };\n  newEditor.deleteBackward = function (unit) {\n    var selection = newEditor.selection;\n    if (selection === null) {\n      return deleteBackward(unit);\n    }\n\n    // Delete file link node\n    var nodeEntry = Editor.node(newEditor, newEditor.selection);\n    if (nodeEntry && Node.string(nodeEntry[0]).length === 0) {\n      var beforePath = nodeEntry[1];\n      beforePath.splice(-1, 1, Math.max(nodeEntry[1].at(-1) - 1, 0));\n      var beforeNodeEntry = Editor.node(newEditor, beforePath);\n      if (beforeNodeEntry && beforeNodeEntry[0].type === FILE_LINK) {\n        Transforms.delete(newEditor, {\n          at: beforeNodeEntry[1]\n        });\n        return;\n      }\n      return deleteBackward(unit);\n    }\n    return deleteBackward(unit);\n  };\n  return newEditor;\n};\nexport default withFileLink;","map":{"version":3,"names":["Transforms","Node","Editor","FILE_LINK","withFileLink","editor","isInline","deleteBackward","newEditor","elem","type","unit","selection","nodeEntry","node","string","length","beforePath","splice","Math","max","at","beforeNodeEntry","delete"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/plugins/file-link/plugin.js"],"sourcesContent":["import { Transforms, Node, Editor } from '@seafile/slate';\nimport { FILE_LINK } from '../../constants';\nconst withFileLink = editor => {\n  const {\n    isInline,\n    deleteBackward\n  } = editor;\n  const newEditor = editor;\n\n  // Rewrite isInline\n  newEditor.isInline = elem => {\n    const {\n      type\n    } = elem;\n    if (type === FILE_LINK) {\n      return true;\n    }\n    return isInline(elem);\n  };\n  newEditor.deleteBackward = unit => {\n    const {\n      selection\n    } = newEditor;\n    if (selection === null) {\n      return deleteBackward(unit);\n    }\n\n    // Delete file link node\n    const nodeEntry = Editor.node(newEditor, newEditor.selection);\n    if (nodeEntry && Node.string(nodeEntry[0]).length === 0) {\n      const beforePath = nodeEntry[1];\n      beforePath.splice(-1, 1, Math.max(nodeEntry[1].at(-1) - 1, 0));\n      const beforeNodeEntry = Editor.node(newEditor, beforePath);\n      if (beforeNodeEntry && beforeNodeEntry[0].type === FILE_LINK) {\n        Transforms.delete(newEditor, {\n          at: beforeNodeEntry[1]\n        });\n        return;\n      }\n      return deleteBackward(unit);\n    }\n    return deleteBackward(unit);\n  };\n  return newEditor;\n};\nexport default withFileLink;"],"mappings":"AAAA,SAASA,UAAU,EAAEC,IAAI,EAAEC,MAAM,QAAQ,gBAAgB;AACzD,SAASC,SAAS,QAAQ,iBAAiB;AAC3C,IAAMC,YAAY,GAAG,SAAfA,YAAYA,CAAGC,MAAM,EAAI;EAC7B,IACEC,QAAQ,GAEND,MAAM,CAFRC,QAAQ;IACRC,cAAc,GACZF,MAAM,CADRE,cAAc;EAEhB,IAAMC,SAAS,GAAGH,MAAM;;EAExB;EACAG,SAAS,CAACF,QAAQ,GAAG,UAAAG,IAAI,EAAI;IAC3B,IACEC,IAAI,GACFD,IAAI,CADNC,IAAI;IAEN,IAAIA,IAAI,KAAKP,SAAS,EAAE;MACtB,OAAO,IAAI;IACb;IACA,OAAOG,QAAQ,CAACG,IAAI,CAAC;EACvB,CAAC;EACDD,SAAS,CAACD,cAAc,GAAG,UAAAI,IAAI,EAAI;IACjC,IACEC,SAAS,GACPJ,SAAS,CADXI,SAAS;IAEX,IAAIA,SAAS,KAAK,IAAI,EAAE;MACtB,OAAOL,cAAc,CAACI,IAAI,CAAC;IAC7B;;IAEA;IACA,IAAME,SAAS,GAAGX,MAAM,CAACY,IAAI,CAACN,SAAS,EAAEA,SAAS,CAACI,SAAS,CAAC;IAC7D,IAAIC,SAAS,IAAIZ,IAAI,CAACc,MAAM,CAACF,SAAS,CAAC,CAAC,CAAC,CAAC,CAACG,MAAM,KAAK,CAAC,EAAE;MACvD,IAAMC,UAAU,GAAGJ,SAAS,CAAC,CAAC,CAAC;MAC/BI,UAAU,CAACC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,EAAEC,IAAI,CAACC,GAAG,CAACP,SAAS,CAAC,CAAC,CAAC,CAACQ,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;MAC9D,IAAMC,eAAe,GAAGpB,MAAM,CAACY,IAAI,CAACN,SAAS,EAAES,UAAU,CAAC;MAC1D,IAAIK,eAAe,IAAIA,eAAe,CAAC,CAAC,CAAC,CAACZ,IAAI,KAAKP,SAAS,EAAE;QAC5DH,UAAU,CAACuB,MAAM,CAACf,SAAS,EAAE;UAC3Ba,EAAE,EAAEC,eAAe,CAAC,CAAC;QACvB,CAAC,CAAC;QACF;MACF;MACA,OAAOf,cAAc,CAACI,IAAI,CAAC;IAC7B;IACA,OAAOJ,cAAc,CAACI,IAAI,CAAC;EAC7B,CAAC;EACD,OAAOH,SAAS;AAClB,CAAC;AACD,eAAeJ,YAAY"},"metadata":{},"sourceType":"module","externalDependencies":[]}