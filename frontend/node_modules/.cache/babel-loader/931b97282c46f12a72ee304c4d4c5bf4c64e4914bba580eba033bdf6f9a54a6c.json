{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{Utils}from'../../utils/utils';import{gettext}from'../../utils/constants';import{seafileAPI}from'../../utils/seafile-api';import{Modal,ModalHeader,ModalBody,ModalFooter,Input,Button}from'reactstrap';import toaster from'../toast';import Loading from'../loading';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var InvitePeopleDialog=/*#__PURE__*/function(_React$Component){_inherits(InvitePeopleDialog,_React$Component);var _super=_createSuper(InvitePeopleDialog);function InvitePeopleDialog(props){var _this;_classCallCheck(this,InvitePeopleDialog);_this=_super.call(this,props);_this.handleInputChange=function(e){var emails=e.target.value;_this.setState({emails:emails});if(_this.state.errorMsg){_this.setState({errorMsg:''});}};_this.handleKeyDown=function(e){if(e.keyCode===13){e.preventDefault();_this.handleSubmitInvite();}};_this.handleSubmitInvite=function(){var emails=_this.state.emails.trim();if(!emails){_this.setState({errorMsg:gettext('It is required.')});return false;}var emailsArray=[];emails=emails.split(',');for(var i=0,len=emails.length;i<len;i++){var email=emails[i].trim();if(email){emailsArray.push(email);}}if(!emailsArray.length){_this.setState({errorMsg:gettext('Email is invalid.')});return false;}_this.setState({isSubmitting:true});seafileAPI.invitePeople(emailsArray).then(function(res){_this.props.toggleDialog();var success=res.data.success;if(success.length){var successMsg='';if(success.length==1){successMsg=gettext('Successfully invited %(email).').replace('%(email)',success[0].accepter);}else{successMsg=gettext('Successfully invited %(email) and %(num) other people.').replace('%(email)',success[0].accepter).replace('%(num)',success.length-1);}toaster.success(successMsg);_this.props.onInvitePeople(success);}var failed=res.data.failed;if(failed.length){for(var _i=0,_len=failed.length;_i<_len;_i++){var failedMsg=failed[_i].email+': '+failed[_i].error_msg;toaster.danger(failedMsg);}}}).catch(function(error){var errorMsg=Utils.getErrorMsg(error);toaster.danger(errorMsg);_this.props.toggleDialog();});};_this.state={emails:'',errorMsg:'',isSubmitting:false};return _this;}_createClass(InvitePeopleDialog,[{key:\"render\",value:function render(){var isSubmitting=this.state.isSubmitting;return/*#__PURE__*/_jsxs(Modal,{isOpen:true,toggle:this.props.toggleDialog,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:this.props.toggleDialog,children:gettext('Invite Guest')}),/*#__PURE__*/_jsxs(ModalBody,{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"emails\",children:gettext('Emails')}),/*#__PURE__*/_jsx(Input,{type:\"text\",id:\"emails\",placeholder:gettext('Emails, separated by \\',\\''),value:this.state.emails,onChange:this.handleInputChange,onKeyDown:this.handleKeyDown}),/*#__PURE__*/_jsx(\"p\",{className:\"error mt-2\",children:this.state.errorMsg})]}),/*#__PURE__*/_jsxs(ModalFooter,{children:[/*#__PURE__*/_jsx(Button,{color:\"secondary\",onClick:this.props.toggleDialog,children:gettext('Cancel')}),/*#__PURE__*/_jsx(Button,{className:\"submit-btn\",color:\"primary\",onClick:this.handleSubmitInvite,disabled:isSubmitting,children:isSubmitting?/*#__PURE__*/_jsx(Loading,{}):gettext('Submit')})]})]});}}]);return InvitePeopleDialog;}(React.Component);export default InvitePeopleDialog;","map":{"version":3,"names":["React","Utils","gettext","seafileAPI","Modal","ModalHeader","ModalBody","ModalFooter","Input","Button","toaster","Loading","jsx","_jsx","jsxs","_jsxs","InvitePeopleDialog","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","handleInputChange","e","emails","target","value","setState","state","errorMsg","handleKeyDown","keyCode","preventDefault","handleSubmitInvite","trim","emailsArray","split","i","len","length","email","push","isSubmitting","invitePeople","then","res","toggleDialog","success","data","successMsg","replace","accepter","onInvitePeople","failed","failedMsg","error_msg","danger","catch","error","getErrorMsg","_createClass","key","render","isOpen","toggle","children","htmlFor","type","id","placeholder","onChange","onKeyDown","className","color","onClick","disabled","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/invite-people-dialog.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Utils } from '../../utils/utils';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Input, Button } from 'reactstrap';\nimport toaster from '../toast';\nimport Loading from '../loading';\n\nconst InvitePeopleDialogPropTypes = {\n  onInvitePeople: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n};\n\nclass InvitePeopleDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      emails: '',\n      errorMsg: '',\n      isSubmitting: false\n    };\n  }\n\n  handleInputChange = (e) => {\n    let emails = e.target.value;\n    this.setState({\n      emails: emails\n    });\n    if (this.state.errorMsg) {\n      this.setState({\n        errorMsg: ''\n      });\n    }\n  };\n\n  handleKeyDown = (e) => {\n    if (e.keyCode === 13) {\n      e.preventDefault();\n      this.handleSubmitInvite();\n    }\n  };\n\n  handleSubmitInvite = () => {\n    let emails = this.state.emails.trim();\n    if (!emails) {\n      this.setState({\n        errorMsg: gettext('It is required.')\n      });\n      return false;\n    }\n\n    let emailsArray = [];\n    emails = emails.split(',');\n    for (let i = 0, len = emails.length; i < len; i++) {\n      let email = emails[i].trim();\n      if (email) {\n        emailsArray.push(email);\n      }\n    }\n\n    if (!emailsArray.length) {\n      this.setState({\n        errorMsg: gettext('Email is invalid.')\n      });\n      return false;\n    }\n\n    this.setState({\n      isSubmitting: true\n    });\n    seafileAPI.invitePeople(emailsArray).then((res) => {\n      this.props.toggleDialog();\n      const success = res.data.success;\n      if (success.length) {\n        let successMsg = '';\n        if (success.length == 1) {\n          successMsg = gettext('Successfully invited %(email).')\n            .replace('%(email)', success[0].accepter);\n        } else {\n          successMsg = gettext('Successfully invited %(email) and %(num) other people.')\n            .replace('%(email)', success[0].accepter)\n            .replace('%(num)', success.length - 1);\n        }\n        toaster.success(successMsg);\n        this.props.onInvitePeople(success);\n      }\n      const failed = res.data.failed;\n      if (failed.length) {\n        for (let i = 0, len = failed.length; i < len; i++) {\n          let failedMsg = failed[i].email + ': ' + failed[i].error_msg;\n          toaster.danger(failedMsg);\n        }\n      }\n    }).catch((error) => {\n      const errorMsg = Utils.getErrorMsg(error);\n      toaster.danger(errorMsg);\n      this.props.toggleDialog();\n    });\n  };\n\n  render() {\n    const { isSubmitting } = this.state;\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalHeader toggle={this.props.toggleDialog}>{gettext('Invite Guest')}</ModalHeader>\n        <ModalBody>\n          <label htmlFor=\"emails\">{gettext('Emails')}</label>\n          <Input\n            type=\"text\"\n            id=\"emails\"\n            placeholder={gettext('Emails, separated by \\',\\'')}\n            value={this.state.emails}\n            onChange={this.handleInputChange}\n            onKeyDown={this.handleKeyDown}\n          />\n          <p className=\"error mt-2\">{this.state.errorMsg}</p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</Button>\n          <Button className=\"submit-btn\" color=\"primary\" onClick={this.handleSubmitInvite} disabled={isSubmitting}>{isSubmitting ? <Loading /> : gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nInvitePeopleDialog.propTypes = InvitePeopleDialogPropTypes;\n\nexport default InvitePeopleDialog;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}