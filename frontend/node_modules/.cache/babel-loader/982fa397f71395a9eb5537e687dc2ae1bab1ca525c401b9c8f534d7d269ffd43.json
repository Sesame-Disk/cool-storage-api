{"ast":null,"code":"import _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport React, { useRef, useState, useEffect, useLayoutEffect } from 'react';\nimport { useSlateStatic } from '@seafile/slate-react';\nimport { useTableRootContext } from '../hooks';\nimport { TABLE_CELL_MIN_WIDTH } from '../../constants';\nimport { focusClosestCellWhenJustifyCellSize, getTableColumns, updateColumnWidth } from '../../helpers';\nimport { eventStopPropagation, getMouseDownInfo, getMouseMoveInfo, registerResizeEvents, unregisterResizeEvents } from '../../../../../utils/mouse-event';\nvar FirstColumnResizeHandler = function FirstColumnResizeHandler(_ref) {\n  var column = _ref.column,\n    initLeft = _ref.left,\n    table = _ref.table,\n    cellIndex = _ref.cellIndex,\n    rowBottoms = _ref.rowBottoms,\n    hideResizeHandlers = _ref.hideResizeHandlers,\n    mouseDownEvent = _ref.mouseDownEvent,\n    adjustingCell = _ref.adjustingCell,\n    isDraggingResizeHandler = _ref.isDraggingResizeHandler;\n  var editor = useSlateStatic();\n  var resizeHandler = useRef(null);\n  var _useState = useState(initLeft),\n    _useState2 = _slicedToArray(_useState, 2),\n    left = _useState2[0],\n    setLeft = _useState2[1];\n  var _useState3 = useState({}),\n    _useState4 = _slicedToArray(_useState3, 2),\n    mouseDownInfo = _useState4[0],\n    setMouseDownInfo = _useState4[1];\n  var _useState5 = useState({}),\n    _useState6 = _slicedToArray(_useState5, 2),\n    style = _useState6[0],\n    setStyle = _useState6[1];\n  var width = column.width;\n  var tableRootScrollContainer = useTableRootContext();\n  useLayoutEffect(function () {\n    var mouseDownInfo = getMouseDownInfo(mouseDownEvent, tableRootScrollContainer);\n    var _tableRootScrollConta = tableRootScrollContainer.getBoundingClientRect(),\n      top = _tableRootScrollConta.top;\n    setStyle({\n      left: mouseDownInfo.positionX - 2,\n      height: tableRootScrollContainer.clientHeight,\n      top: top\n    });\n    setMouseDownInfo(mouseDownInfo);\n  }, [mouseDownEvent, tableRootScrollContainer]);\n  useEffect(function () {\n    if (!isDraggingResizeHandler) return;\n    var onMouseMove = function onMouseMove(event) {\n      eventStopPropagation(event);\n      var mouseMoveInfo = getMouseMoveInfo(event, mouseDownInfo, tableRootScrollContainer);\n      var newWidth = width - mouseMoveInfo.displacementX;\n      if (newWidth < TABLE_CELL_MIN_WIDTH) return;\n      var left = initLeft - mouseMoveInfo.displacementX;\n      var _tableRootScrollConta2 = tableRootScrollContainer.getBoundingClientRect(),\n        top = _tableRootScrollConta2.top;\n      setStyle({\n        left: event.clientX - 2,\n        height: tableRootScrollContainer.clientHeight,\n        top: top\n      });\n      setLeft(left);\n    };\n    var onMouseUp = function onMouseUp(event) {\n      eventStopPropagation(event);\n      setStyle({});\n      var columns = getTableColumns(editor, table);\n      var newColumns = columns.slice(0);\n      var column = newColumns[cellIndex];\n      var newWidth = width + left - initLeft;\n      newColumns[cellIndex] = _objectSpread(_objectSpread({}, column), {}, {\n        width: newWidth\n      });\n      updateColumnWidth(editor, table, newColumns);\n      focusClosestCellWhenJustifyCellSize(editor, adjustingCell);\n      hideResizeHandlers();\n    };\n    registerResizeEvents({\n      'mousemove': onMouseMove,\n      'mouseup': onMouseUp\n    });\n    return function () {\n      unregisterResizeEvents({\n        'mousemove': onMouseMove,\n        'mouseup': onMouseUp\n      });\n    };\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isDraggingResizeHandler, mouseDownInfo, left, width, column, editor, table, cellIndex, initLeft, rowBottoms]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"table-cell-width-just resizing position-fixed\",\n    contentEditable: false,\n    style: style,\n    ref: resizeHandler\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"table-cell-width-just-color-tip\"\n  }));\n};\nexport default FirstColumnResizeHandler;","map":{"version":3,"names":["_objectSpread","React","useRef","useState","useEffect","useLayoutEffect","useSlateStatic","useTableRootContext","TABLE_CELL_MIN_WIDTH","focusClosestCellWhenJustifyCellSize","getTableColumns","updateColumnWidth","eventStopPropagation","getMouseDownInfo","getMouseMoveInfo","registerResizeEvents","unregisterResizeEvents","FirstColumnResizeHandler","_ref","column","initLeft","left","table","cellIndex","rowBottoms","hideResizeHandlers","mouseDownEvent","adjustingCell","isDraggingResizeHandler","editor","resizeHandler","_useState","_useState2","_slicedToArray","setLeft","_useState3","_useState4","mouseDownInfo","setMouseDownInfo","_useState5","_useState6","style","setStyle","width","tableRootScrollContainer","_tableRootScrollConta","getBoundingClientRect","top","positionX","height","clientHeight","onMouseMove","event","mouseMoveInfo","newWidth","displacementX","_tableRootScrollConta2","clientX","onMouseUp","columns","newColumns","slice","createElement","className","contentEditable","ref"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/plugins/table/render/resize-handlers/first-column-left-resize-handler.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport React, { useRef, useState, useEffect, useLayoutEffect } from 'react';\nimport { useSlateStatic } from '@seafile/slate-react';\nimport { useTableRootContext } from '../hooks';\nimport { TABLE_CELL_MIN_WIDTH } from '../../constants';\nimport { focusClosestCellWhenJustifyCellSize, getTableColumns, updateColumnWidth } from '../../helpers';\nimport { eventStopPropagation, getMouseDownInfo, getMouseMoveInfo, registerResizeEvents, unregisterResizeEvents } from '../../../../../utils/mouse-event';\nconst FirstColumnResizeHandler = _ref => {\n  let {\n    column,\n    left: initLeft,\n    table,\n    cellIndex,\n    rowBottoms,\n    hideResizeHandlers,\n    mouseDownEvent,\n    adjustingCell,\n    isDraggingResizeHandler\n  } = _ref;\n  const editor = useSlateStatic();\n  const resizeHandler = useRef(null);\n  const [left, setLeft] = useState(initLeft);\n  const [mouseDownInfo, setMouseDownInfo] = useState({});\n  const [style, setStyle] = useState({});\n  const width = column.width;\n  const tableRootScrollContainer = useTableRootContext();\n  useLayoutEffect(() => {\n    const mouseDownInfo = getMouseDownInfo(mouseDownEvent, tableRootScrollContainer);\n    const {\n      top\n    } = tableRootScrollContainer.getBoundingClientRect();\n    setStyle({\n      left: mouseDownInfo.positionX - 2,\n      height: tableRootScrollContainer.clientHeight,\n      top\n    });\n    setMouseDownInfo(mouseDownInfo);\n  }, [mouseDownEvent, tableRootScrollContainer]);\n  useEffect(() => {\n    if (!isDraggingResizeHandler) return;\n    const onMouseMove = event => {\n      eventStopPropagation(event);\n      const mouseMoveInfo = getMouseMoveInfo(event, mouseDownInfo, tableRootScrollContainer);\n      const newWidth = width - mouseMoveInfo.displacementX;\n      if (newWidth < TABLE_CELL_MIN_WIDTH) return;\n      const left = initLeft - mouseMoveInfo.displacementX;\n      const {\n        top\n      } = tableRootScrollContainer.getBoundingClientRect();\n      setStyle({\n        left: event.clientX - 2,\n        height: tableRootScrollContainer.clientHeight,\n        top\n      });\n      setLeft(left);\n    };\n    const onMouseUp = event => {\n      eventStopPropagation(event);\n      setStyle({});\n      const columns = getTableColumns(editor, table);\n      const newColumns = columns.slice(0);\n      const column = newColumns[cellIndex];\n      const newWidth = width + left - initLeft;\n      newColumns[cellIndex] = _objectSpread(_objectSpread({}, column), {}, {\n        width: newWidth\n      });\n      updateColumnWidth(editor, table, newColumns);\n      focusClosestCellWhenJustifyCellSize(editor, adjustingCell);\n      hideResizeHandlers();\n    };\n    registerResizeEvents({\n      'mousemove': onMouseMove,\n      'mouseup': onMouseUp\n    });\n    return () => {\n      unregisterResizeEvents({\n        'mousemove': onMouseMove,\n        'mouseup': onMouseUp\n      });\n    };\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isDraggingResizeHandler, mouseDownInfo, left, width, column, editor, table, cellIndex, initLeft, rowBottoms]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"table-cell-width-just resizing position-fixed\",\n    contentEditable: false,\n    style: style,\n    ref: resizeHandler\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"table-cell-width-just-color-tip\"\n  }));\n};\nexport default FirstColumnResizeHandler;"],"mappings":";AAAA,OAAOA,aAAa,MAAM,0CAA0C;AACpE,OAAOC,KAAK,IAAIC,MAAM,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,eAAe,QAAQ,OAAO;AAC3E,SAASC,cAAc,QAAQ,sBAAsB;AACrD,SAASC,mBAAmB,QAAQ,UAAU;AAC9C,SAASC,oBAAoB,QAAQ,iBAAiB;AACtD,SAASC,mCAAmC,EAAEC,eAAe,EAAEC,iBAAiB,QAAQ,eAAe;AACvG,SAASC,oBAAoB,EAAEC,gBAAgB,EAAEC,gBAAgB,EAAEC,oBAAoB,EAAEC,sBAAsB,QAAQ,kCAAkC;AACzJ,IAAMC,wBAAwB,GAAG,SAA3BA,wBAAwBA,CAAGC,IAAI,EAAI;EACvC,IACEC,MAAM,GASJD,IAAI,CATNC,MAAM;IACAC,QAAQ,GAQZF,IAAI,CARNG,IAAI;IACJC,KAAK,GAOHJ,IAAI,CAPNI,KAAK;IACLC,SAAS,GAMPL,IAAI,CANNK,SAAS;IACTC,UAAU,GAKRN,IAAI,CALNM,UAAU;IACVC,kBAAkB,GAIhBP,IAAI,CAJNO,kBAAkB;IAClBC,cAAc,GAGZR,IAAI,CAHNQ,cAAc;IACdC,aAAa,GAEXT,IAAI,CAFNS,aAAa;IACbC,uBAAuB,GACrBV,IAAI,CADNU,uBAAuB;EAEzB,IAAMC,MAAM,GAAGvB,cAAc,CAAC,CAAC;EAC/B,IAAMwB,aAAa,GAAG5B,MAAM,CAAC,IAAI,CAAC;EAClC,IAAA6B,SAAA,GAAwB5B,QAAQ,CAACiB,QAAQ,CAAC;IAAAY,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAAnCV,IAAI,GAAAW,UAAA;IAAEE,OAAO,GAAAF,UAAA;EACpB,IAAAG,UAAA,GAA0ChC,QAAQ,CAAC,CAAC,CAAC,CAAC;IAAAiC,UAAA,GAAAH,cAAA,CAAAE,UAAA;IAA/CE,aAAa,GAAAD,UAAA;IAAEE,gBAAgB,GAAAF,UAAA;EACtC,IAAAG,UAAA,GAA0BpC,QAAQ,CAAC,CAAC,CAAC,CAAC;IAAAqC,UAAA,GAAAP,cAAA,CAAAM,UAAA;IAA/BE,KAAK,GAAAD,UAAA;IAAEE,QAAQ,GAAAF,UAAA;EACtB,IAAMG,KAAK,GAAGxB,MAAM,CAACwB,KAAK;EAC1B,IAAMC,wBAAwB,GAAGrC,mBAAmB,CAAC,CAAC;EACtDF,eAAe,CAAC,YAAM;IACpB,IAAMgC,aAAa,GAAGxB,gBAAgB,CAACa,cAAc,EAAEkB,wBAAwB,CAAC;IAChF,IAAAC,qBAAA,GAEID,wBAAwB,CAACE,qBAAqB,CAAC,CAAC;MADlDC,GAAG,GAAAF,qBAAA,CAAHE,GAAG;IAELL,QAAQ,CAAC;MACPrB,IAAI,EAAEgB,aAAa,CAACW,SAAS,GAAG,CAAC;MACjCC,MAAM,EAAEL,wBAAwB,CAACM,YAAY;MAC7CH,GAAG,EAAHA;IACF,CAAC,CAAC;IACFT,gBAAgB,CAACD,aAAa,CAAC;EACjC,CAAC,EAAE,CAACX,cAAc,EAAEkB,wBAAwB,CAAC,CAAC;EAC9CxC,SAAS,CAAC,YAAM;IACd,IAAI,CAACwB,uBAAuB,EAAE;IAC9B,IAAMuB,WAAW,GAAG,SAAdA,WAAWA,CAAGC,KAAK,EAAI;MAC3BxC,oBAAoB,CAACwC,KAAK,CAAC;MAC3B,IAAMC,aAAa,GAAGvC,gBAAgB,CAACsC,KAAK,EAAEf,aAAa,EAAEO,wBAAwB,CAAC;MACtF,IAAMU,QAAQ,GAAGX,KAAK,GAAGU,aAAa,CAACE,aAAa;MACpD,IAAID,QAAQ,GAAG9C,oBAAoB,EAAE;MACrC,IAAMa,IAAI,GAAGD,QAAQ,GAAGiC,aAAa,CAACE,aAAa;MACnD,IAAAC,sBAAA,GAEIZ,wBAAwB,CAACE,qBAAqB,CAAC,CAAC;QADlDC,GAAG,GAAAS,sBAAA,CAAHT,GAAG;MAELL,QAAQ,CAAC;QACPrB,IAAI,EAAE+B,KAAK,CAACK,OAAO,GAAG,CAAC;QACvBR,MAAM,EAAEL,wBAAwB,CAACM,YAAY;QAC7CH,GAAG,EAAHA;MACF,CAAC,CAAC;MACFb,OAAO,CAACb,IAAI,CAAC;IACf,CAAC;IACD,IAAMqC,SAAS,GAAG,SAAZA,SAASA,CAAGN,KAAK,EAAI;MACzBxC,oBAAoB,CAACwC,KAAK,CAAC;MAC3BV,QAAQ,CAAC,CAAC,CAAC,CAAC;MACZ,IAAMiB,OAAO,GAAGjD,eAAe,CAACmB,MAAM,EAAEP,KAAK,CAAC;MAC9C,IAAMsC,UAAU,GAAGD,OAAO,CAACE,KAAK,CAAC,CAAC,CAAC;MACnC,IAAM1C,MAAM,GAAGyC,UAAU,CAACrC,SAAS,CAAC;MACpC,IAAM+B,QAAQ,GAAGX,KAAK,GAAGtB,IAAI,GAAGD,QAAQ;MACxCwC,UAAU,CAACrC,SAAS,CAAC,GAAGvB,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,EAAEmB,MAAM,CAAC,EAAE,CAAC,CAAC,EAAE;QACnEwB,KAAK,EAAEW;MACT,CAAC,CAAC;MACF3C,iBAAiB,CAACkB,MAAM,EAAEP,KAAK,EAAEsC,UAAU,CAAC;MAC5CnD,mCAAmC,CAACoB,MAAM,EAAEF,aAAa,CAAC;MAC1DF,kBAAkB,CAAC,CAAC;IACtB,CAAC;IACDV,oBAAoB,CAAC;MACnB,WAAW,EAAEoC,WAAW;MACxB,SAAS,EAAEO;IACb,CAAC,CAAC;IACF,OAAO,YAAM;MACX1C,sBAAsB,CAAC;QACrB,WAAW,EAAEmC,WAAW;QACxB,SAAS,EAAEO;MACb,CAAC,CAAC;IACJ,CAAC;;IAED;EACF,CAAC,EAAE,CAAC9B,uBAAuB,EAAES,aAAa,EAAEhB,IAAI,EAAEsB,KAAK,EAAExB,MAAM,EAAEU,MAAM,EAAEP,KAAK,EAAEC,SAAS,EAAEH,QAAQ,EAAEI,UAAU,CAAC,CAAC;EACjH,OAAO,aAAavB,KAAK,CAAC6D,aAAa,CAAC,KAAK,EAAE;IAC7CC,SAAS,EAAE,+CAA+C;IAC1DC,eAAe,EAAE,KAAK;IACtBvB,KAAK,EAAEA,KAAK;IACZwB,GAAG,EAAEnC;EACP,CAAC,EAAE,aAAa7B,KAAK,CAAC6D,aAAa,CAAC,KAAK,EAAE;IACzCC,SAAS,EAAE;EACb,CAAC,CAAC,CAAC;AACL,CAAC;AACD,eAAe9C,wBAAwB"},"metadata":{},"sourceType":"module","externalDependencies":[]}