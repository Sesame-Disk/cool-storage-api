{"ast":null,"code":"import _regeneratorRuntime from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { useCallback, useEffect } from 'react';\nimport context from '../../../../context';\nimport EventBus from '../../../utils/event-bus';\nimport { EXTERNAL_EVENT } from '../../../../constants';\nexport var useCommentsMount = function useCommentsMount(dispatch) {\n  var request = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n    var res, comments;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          dispatch({\n            type: 'FETCHING_STATE'\n          });\n          _context.prev = 1;\n          _context.next = 4;\n          return context.listComments();\n        case 4:\n          res = _context.sent;\n          comments = res.data.comments;\n          dispatch({\n            type: 'RECEIVE_STATE',\n            payload: comments\n          });\n          _context.next = 13;\n          break;\n        case 9:\n          _context.prev = 9;\n          _context.t0 = _context[\"catch\"](1);\n          console.log(_context.t0);\n          dispatch({\n            type: 'FETCHING_ERROR'\n          });\n        case 13:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee, null, [[1, 9]]);\n  })), []);\n  var reRequest = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n    var res, comments;\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          dispatch({\n            type: 'REFETCHING_STATE'\n          });\n          _context2.prev = 1;\n          _context2.next = 4;\n          return context.listComments();\n        case 4:\n          res = _context2.sent;\n          comments = res.data.comments;\n          dispatch({\n            type: 'RECEIVE_STATE',\n            payload: comments\n          });\n          _context2.next = 12;\n          break;\n        case 9:\n          _context2.prev = 9;\n          _context2.t0 = _context2[\"catch\"](1);\n          console.log(_context2.t0);\n          // dispatch({type: 'FETCHING_ERROR'});\n        case 12:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2, null, [[1, 9]]);\n  })), []);\n  useEffect(function () {\n    request();\n    var eventBus = EventBus.getInstance();\n    var unsubscribeNewNotification = eventBus.subscribe(EXTERNAL_EVENT.NEW_NOTIFICATION, reRequest);\n    return function () {\n      unsubscribeNewNotification();\n    };\n  }, [request, reRequest]);\n};","map":{"version":3,"names":["useCallback","useEffect","context","EventBus","EXTERNAL_EVENT","useCommentsMount","dispatch","request","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","comments","wrap","_callee$","_context","prev","next","type","listComments","sent","data","payload","t0","console","log","stop","reRequest","_callee2","_callee2$","_context2","eventBus","getInstance","unsubscribeNewNotification","subscribe","NEW_NOTIFICATION"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/comment/hooks/comment-hooks/use-comment-mount.js"],"sourcesContent":["import { useCallback, useEffect } from 'react';\nimport context from '../../../../context';\nimport EventBus from '../../../utils/event-bus';\nimport { EXTERNAL_EVENT } from '../../../../constants';\nexport const useCommentsMount = dispatch => {\n  const request = useCallback(async () => {\n    dispatch({\n      type: 'FETCHING_STATE'\n    });\n    try {\n      const res = await context.listComments();\n      const comments = res.data.comments;\n      dispatch({\n        type: 'RECEIVE_STATE',\n        payload: comments\n      });\n    } catch (error) {\n      console.log(error);\n      dispatch({\n        type: 'FETCHING_ERROR'\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const reRequest = useCallback(async () => {\n    dispatch({\n      type: 'REFETCHING_STATE'\n    });\n    try {\n      const res = await context.listComments();\n      const comments = res.data.comments;\n      dispatch({\n        type: 'RECEIVE_STATE',\n        payload: comments\n      });\n    } catch (error) {\n      console.log(error);\n      // dispatch({type: 'FETCHING_ERROR'});\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(() => {\n    request();\n    const eventBus = EventBus.getInstance();\n    const unsubscribeNewNotification = eventBus.subscribe(EXTERNAL_EVENT.NEW_NOTIFICATION, reRequest);\n    return () => {\n      unsubscribeNewNotification();\n    };\n  }, [request, reRequest]);\n};"],"mappings":";;AAAA,SAASA,WAAW,EAAEC,SAAS,QAAQ,OAAO;AAC9C,OAAOC,OAAO,MAAM,qBAAqB;AACzC,OAAOC,QAAQ,MAAM,0BAA0B;AAC/C,SAASC,cAAc,QAAQ,uBAAuB;AACtD,OAAO,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAgBA,CAAGC,QAAQ,EAAI;EAC1C,IAAMC,OAAO,GAAGP,WAAW,eAAAQ,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAC,SAAAC,QAAA;IAAA,IAAAC,GAAA,EAAAC,QAAA;IAAA,OAAAJ,mBAAA,GAAAK,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;QAAA;UAC1BZ,QAAQ,CAAC;YACPa,IAAI,EAAE;UACR,CAAC,CAAC;UAACH,QAAA,CAAAC,IAAA;UAAAD,QAAA,CAAAE,IAAA;UAAA,OAEiBhB,OAAO,CAACkB,YAAY,CAAC,CAAC;QAAA;UAAlCR,GAAG,GAAAI,QAAA,CAAAK,IAAA;UACHR,QAAQ,GAAGD,GAAG,CAACU,IAAI,CAACT,QAAQ;UAClCP,QAAQ,CAAC;YACPa,IAAI,EAAE,eAAe;YACrBI,OAAO,EAAEV;UACX,CAAC,CAAC;UAACG,QAAA,CAAAE,IAAA;UAAA;QAAA;UAAAF,QAAA,CAAAC,IAAA;UAAAD,QAAA,CAAAQ,EAAA,GAAAR,QAAA;UAEHS,OAAO,CAACC,GAAG,CAAAV,QAAA,CAAAQ,EAAM,CAAC;UAClBlB,QAAQ,CAAC;YACPa,IAAI,EAAE;UACR,CAAC,CAAC;QAAC;QAAA;UAAA,OAAAH,QAAA,CAAAW,IAAA;MAAA;IAAA,GAAAhB,OAAA;EAAA,CAGN,IAAE,EAAE,CAAC;EACN,IAAMiB,SAAS,GAAG5B,WAAW,eAAAQ,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAC,SAAAmB,SAAA;IAAA,IAAAjB,GAAA,EAAAC,QAAA;IAAA,OAAAJ,mBAAA,GAAAK,IAAA,UAAAgB,UAAAC,SAAA;MAAA,kBAAAA,SAAA,CAAAd,IAAA,GAAAc,SAAA,CAAAb,IAAA;QAAA;UAC5BZ,QAAQ,CAAC;YACPa,IAAI,EAAE;UACR,CAAC,CAAC;UAACY,SAAA,CAAAd,IAAA;UAAAc,SAAA,CAAAb,IAAA;UAAA,OAEiBhB,OAAO,CAACkB,YAAY,CAAC,CAAC;QAAA;UAAlCR,GAAG,GAAAmB,SAAA,CAAAV,IAAA;UACHR,QAAQ,GAAGD,GAAG,CAACU,IAAI,CAACT,QAAQ;UAClCP,QAAQ,CAAC;YACPa,IAAI,EAAE,eAAe;YACrBI,OAAO,EAAEV;UACX,CAAC,CAAC;UAACkB,SAAA,CAAAb,IAAA;UAAA;QAAA;UAAAa,SAAA,CAAAd,IAAA;UAAAc,SAAA,CAAAP,EAAA,GAAAO,SAAA;UAEHN,OAAO,CAACC,GAAG,CAAAK,SAAA,CAAAP,EAAM,CAAC;UAClB;QAAA;QAAA;UAAA,OAAAO,SAAA,CAAAJ,IAAA;MAAA;IAAA,GAAAE,QAAA;EAAA,CAGH,IAAE,EAAE,CAAC;EACN5B,SAAS,CAAC,YAAM;IACdM,OAAO,CAAC,CAAC;IACT,IAAMyB,QAAQ,GAAG7B,QAAQ,CAAC8B,WAAW,CAAC,CAAC;IACvC,IAAMC,0BAA0B,GAAGF,QAAQ,CAACG,SAAS,CAAC/B,cAAc,CAACgC,gBAAgB,EAAER,SAAS,CAAC;IACjG,OAAO,YAAM;MACXM,0BAA0B,CAAC,CAAC;IAC9B,CAAC;EACH,CAAC,EAAE,CAAC3B,OAAO,EAAEqB,SAAS,CAAC,CAAC;AAC1B,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}