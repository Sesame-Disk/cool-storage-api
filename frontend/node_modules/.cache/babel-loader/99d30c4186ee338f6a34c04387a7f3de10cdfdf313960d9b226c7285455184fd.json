{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/slicedToArray.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.movedListItemUp = void 0;\nvar _slate = require(\"slate\");\nvar _core = require(\"../../../core\");\nvar _queries = require(\"../queries\");\nvar _moveListItemsToList = require(\"./move-list-items-to-list\");\nvar _unwrapList = require(\"./unwrap-list\");\nvar _elementTypes = require(\"../../../constants/element-types\");\nvar movedListItemUp = function movedListItemUp(editor, _ref) {\n  var list = _ref.list,\n    listItem = _ref.listItem;\n  var move = function move() {\n    var _list = _slicedToArray(list, 2),\n      listNode = _list[0],\n      listPath = _list[1];\n    var _listItem = _slicedToArray(listItem, 2),\n      liNode = _listItem[0],\n      liPath = _listItem[1];\n\n    // Get above node of list item\n    var liParent = (0, _core.getAboveNode)(editor, {\n      at: listPath,\n      match: {\n        type: [_elementTypes.LIST_ITEM]\n      }\n    });\n\n    // Current list is the top hierarchy list, list[ol] > 'li', since there is no parent.\n    if (!liParent) {\n      var _toListPath = null;\n      try {\n        _toListPath = _slate.Path.next(listPath);\n      } catch (err) {\n        return;\n      }\n      var isHasLiChild = (0, _queries.hasListChild)(liNode);\n      var isNotLastChild = !(0, _core.isLastChild)(list, liPath);\n      if (isHasLiChild || isNotLastChild) {\n        // Create a new sibling node\n        var _list2 = (0, _core.generateElement)(listNode.type, {\n          childrenOrText: []\n        });\n        _slate.Transforms.insertNodes(editor, _list2, {\n          at: _toListPath\n        });\n      }\n\n      // If contains child nodes, move the child nodes to the newly created node\n      if (isHasLiChild) {\n        var toListNode = (0, _core.getNode)(editor, _toListPath);\n        if (!toListNode) return;\n        (0, _moveListItemsToList.moveListItemsToList)(editor, {\n          formListItem: listItem,\n          toList: [toListNode, _toListPath]\n        });\n      }\n\n      // If not last child, move the next siblings to the newly created node\n      if (isNotLastChild) {\n        var _toListNode = (0, _core.getNode)(editor, _toListPath);\n        if (!_toListNode) return;\n        (0, _moveListItemsToList.moveListItemsToList)(editor, {\n          fromList: list,\n          fromStartIndex: liPath[liPath.length - 1] + 1,\n          toList: [_toListNode, _toListPath],\n          deleteFromList: false\n        });\n      }\n\n      // unwrap the list\n      (0, _unwrapList.unwrapList)(editor, {\n        at: liPath.concat(0)\n      });\n      return true;\n    }\n\n    // If parent exists, the current list is a child list, li > list[ol] > 'li'.\n    var _liParent = _slicedToArray(liParent, 2),\n      liParentPath = _liParent[1];\n    // is last: false\n    // li > list[ol] > li\n    //               > li\n    var toListPath = liPath.concat([1]);\n    if (!(0, _core.isLastChild)(list, liPath)) {\n      // Here is a trick.\n      // First, move the sibling node of the current node to the child node of the current node \"ol\".\n      // Second, move the child node of the current node to the sibling node of the current node.\n      if (!(0, _queries.hasListChild)(liNode)) {\n        var _list3 = (0, _core.generateElement)(listNode.type, {\n          childrenOrText: []\n        });\n        _slate.Transforms.insertNodes(editor, _list3, {\n          at: toListPath\n        });\n      }\n      var _toListNode2 = (0, _core.getNode)(editor, toListPath);\n      if (!_toListNode2) return;\n\n      // Move next siblings to li sublist\n      (0, _moveListItemsToList.moveListItemsToList)(editor, {\n        fromListItem: liParent,\n        toList: [_toListNode2, toListPath],\n        fromStartIndex: liPath[liPath.length - 1] + 1,\n        deleteFromList: false\n      });\n    }\n\n    // is last: true\n    // li > list[ol] > li\n    var movedUpLiPath = _slate.Path.next(liParentPath);\n    _slate.Transforms.moveNodes(editor, {\n      at: liPath,\n      to: movedUpLiPath\n    });\n    return true;\n  };\n  var moved = false;\n  _slate.Editor.withoutNormalizing(editor, function () {\n    moved = move();\n  });\n  return moved;\n};\nexports.movedListItemUp = movedListItemUp;","map":{"version":3,"names":["_slicedToArray","require","default","Object","defineProperty","exports","value","movedListItemUp","_slate","_core","_queries","_moveListItemsToList","_unwrapList","_elementTypes","editor","_ref","list","listItem","move","_list","listNode","listPath","_listItem","liNode","liPath","liParent","getAboveNode","at","match","type","LIST_ITEM","toListPath","Path","next","err","isHasLiChild","hasListChild","isNotLastChild","isLastChild","generateElement","childrenOrText","Transforms","insertNodes","toListNode","getNode","moveListItemsToList","formListItem","toList","fromList","fromStartIndex","length","deleteFromList","unwrapList","concat","_liParent","liParentPath","fromListItem","movedUpLiPath","moveNodes","to","moved","Editor","withoutNormalizing"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/seafile-editor/dist/extension/plugins/list/transforms/move-list-item-up.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.movedListItemUp = void 0;\nvar _slate = require(\"slate\");\nvar _core = require(\"../../../core\");\nvar _queries = require(\"../queries\");\nvar _moveListItemsToList = require(\"./move-list-items-to-list\");\nvar _unwrapList = require(\"./unwrap-list\");\nvar _elementTypes = require(\"../../../constants/element-types\");\nconst movedListItemUp = (editor, _ref) => {\n  let {\n    list,\n    listItem\n  } = _ref;\n  const move = () => {\n    const [listNode, listPath] = list;\n    const [liNode, liPath] = listItem;\n\n    // Get above node of list item\n    const liParent = (0, _core.getAboveNode)(editor, {\n      at: listPath,\n      match: {\n        type: [_elementTypes.LIST_ITEM]\n      }\n    });\n\n    // Current list is the top hierarchy list, list[ol] > 'li', since there is no parent.\n    if (!liParent) {\n      let toListPath = null;\n      try {\n        toListPath = _slate.Path.next(listPath);\n      } catch (err) {\n        return;\n      }\n      const isHasLiChild = (0, _queries.hasListChild)(liNode);\n      const isNotLastChild = !(0, _core.isLastChild)(list, liPath);\n      if (isHasLiChild || isNotLastChild) {\n        // Create a new sibling node\n        const list = (0, _core.generateElement)(listNode.type, {\n          childrenOrText: []\n        });\n        _slate.Transforms.insertNodes(editor, list, {\n          at: toListPath\n        });\n      }\n\n      // If contains child nodes, move the child nodes to the newly created node\n      if (isHasLiChild) {\n        const toListNode = (0, _core.getNode)(editor, toListPath);\n        if (!toListNode) return;\n        (0, _moveListItemsToList.moveListItemsToList)(editor, {\n          formListItem: listItem,\n          toList: [toListNode, toListPath]\n        });\n      }\n\n      // If not last child, move the next siblings to the newly created node\n      if (isNotLastChild) {\n        const toListNode = (0, _core.getNode)(editor, toListPath);\n        if (!toListNode) return;\n        (0, _moveListItemsToList.moveListItemsToList)(editor, {\n          fromList: list,\n          fromStartIndex: liPath[liPath.length - 1] + 1,\n          toList: [toListNode, toListPath],\n          deleteFromList: false\n        });\n      }\n\n      // unwrap the list\n      (0, _unwrapList.unwrapList)(editor, {\n        at: liPath.concat(0)\n      });\n      return true;\n    }\n\n    // If parent exists, the current list is a child list, li > list[ol] > 'li'.\n    const [, liParentPath] = liParent;\n    // is last: false\n    // li > list[ol] > li\n    //               > li\n    const toListPath = liPath.concat([1]);\n    if (!(0, _core.isLastChild)(list, liPath)) {\n      // Here is a trick.\n      // First, move the sibling node of the current node to the child node of the current node \"ol\".\n      // Second, move the child node of the current node to the sibling node of the current node.\n      if (!(0, _queries.hasListChild)(liNode)) {\n        const list = (0, _core.generateElement)(listNode.type, {\n          childrenOrText: []\n        });\n        _slate.Transforms.insertNodes(editor, list, {\n          at: toListPath\n        });\n      }\n      const toListNode = (0, _core.getNode)(editor, toListPath);\n      if (!toListNode) return;\n\n      // Move next siblings to li sublist\n      (0, _moveListItemsToList.moveListItemsToList)(editor, {\n        fromListItem: liParent,\n        toList: [toListNode, toListPath],\n        fromStartIndex: liPath[liPath.length - 1] + 1,\n        deleteFromList: false\n      });\n    }\n\n    // is last: true\n    // li > list[ol] > li\n    const movedUpLiPath = _slate.Path.next(liParentPath);\n    _slate.Transforms.moveNodes(editor, {\n      at: liPath,\n      to: movedUpLiPath\n    });\n    return true;\n  };\n  let moved = false;\n  _slate.Editor.withoutNormalizing(editor, () => {\n    moved = move();\n  });\n  return moved;\n};\nexports.movedListItemUp = movedListItemUp;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}