{"ast":null,"code":"import _regeneratorRuntime from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { ReactEditor } from '@seafile/slate-react';\nimport { useTranslation } from 'react-i18next';\nimport { Editor } from '@seafile/slate';\nimport classNames from 'classnames';\nimport context from '../../../../context';\nimport { LocalStorage, isEnglish } from '../../../../utils';\nimport { EXTERNAL_EVENT } from '../../../../constants';\nimport EventBus from '../../../utils/event-bus';\nimport { INTERNAL_EVENT } from '../../../constants';\nimport { SDOC_LINK } from '../../constants';\nimport toaster from '../../../../components/toast';\nimport { insertSdocFileLink, insertTextWhenRemoveFileNameCollector, removeTempInput } from '../../plugins/sdoc-link/helpers';\nimport './style.css';\nvar FileLinkInsertDialog = function FileLinkInsertDialog(_ref) {\n  var editor = _ref.editor,\n    element = _ref.element,\n    closeDialog = _ref.closeDialog;\n  var eventBus = EventBus.getInstance();\n  var historyFileWrapperRef = useRef(document.querySelector('.sdoc-history-files-wrapper'));\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    files = _useState2[0],\n    setFiles = _useState2[1];\n  var _useState3 = useState({\n      top: 0,\n      left: 0\n    }),\n    _useState4 = _slicedToArray(_useState3, 2),\n    position = _useState4[0],\n    setPosition = _useState4[1];\n  var _useState5 = useState(''),\n    _useState6 = _slicedToArray(_useState5, 2),\n    newFileName = _useState6[0],\n    setNewFileName = _useState6[1];\n  var _useTranslation = useTranslation(),\n    t = _useTranslation.t;\n  var _useState7 = useState(t('Recent_visited')),\n    _useState8 = _slicedToArray(_useState7, 2),\n    header = _useState8[0],\n    setHeader = _useState8[1];\n  var deleteInputAndInsertText = useCallback(function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    return insertTextWhenRemoveFileNameCollector.apply(void 0, [editor, element].concat(args));\n  }, [editor, element]);\n  var getPosition = useCallback(function () {\n    var selection = editor.selection;\n    var nodeEntry = Editor.node(editor, selection);\n    var domNode = ReactEditor.toDOMNode(editor, nodeEntry[0]);\n    if (domNode) {\n      var topGap = 20;\n      var leftGap = 5;\n      var _domNode$getBoundingC = domNode.getBoundingClientRect(),\n        top = _domNode$getBoundingC.top,\n        left = _domNode$getBoundingC.left;\n      var popoverTop = top + topGap;\n      var popoverLeft = left + leftGap;\n      // Insert gap between the popover and the selected node\n      // file item height 32px, header height 32px, add button height 32px, margin-top 8px, max-height 306px\n      var popoverHeight = Math.min(files.length * 32 + 32 * 3 + 8, 300);\n      // Insert gap between the popover and the selected node\n      var popoverBottomY = top + popoverHeight + topGap;\n      var viewportHeight = window.innerHeight;\n      if (popoverBottomY > viewportHeight) {\n        // 8px for the gap between the popover and the bottom of the viewport\n        var counterTopGap = 8;\n        popoverTop = top - popoverHeight - counterTopGap;\n      }\n      setPosition({\n        top: popoverTop,\n        left: popoverLeft\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [files]);\n  var onClick = useCallback(function (e) {\n    var _historyFileWrapperRe, _historyFileWrapperRe2;\n    var isClickInside = (_historyFileWrapperRe = historyFileWrapperRef.current) === null || _historyFileWrapperRe === void 0 ? void 0 : (_historyFileWrapperRe2 = _historyFileWrapperRe.contains) === null || _historyFileWrapperRe2 === void 0 ? void 0 : _historyFileWrapperRe2.call(_historyFileWrapperRe, e.target);\n    if (isClickInside) return;\n    deleteInputAndInsertText();\n    closeDialog();\n  }, [closeDialog, deleteInputAndInsertText]);\n  var onScroll = useCallback(function (e) {\n    getPosition();\n  }, [getPosition]);\n  var getHistoryFiles = useCallback(function (e) {\n    var files = LocalStorage.getItem('sdoc-recent-files') || [];\n    setFiles(files);\n  }, []);\n  useEffect(function () {\n    getHistoryFiles();\n  }, [getHistoryFiles]);\n  var onKeydown = useCallback(function (e) {\n    var key = e.key;\n    switch (key) {\n      case 'Escape':\n        deleteInputAndInsertText();\n        closeDialog();\n        break;\n      case 'ArrowRight':\n      case 'ArrowLeft':\n        deleteInputAndInsertText();\n        closeDialog();\n        break;\n      case 'ArrowUp':\n      case 'ArrowDown':\n        deleteInputAndInsertText();\n        closeDialog();\n        break;\n      default:\n        break;\n    }\n  }, [closeDialog, deleteInputAndInsertText]);\n  var onInsertLink = useCallback(function (params) {\n    insertSdocFileLink(editor, params.data.obj_name, params.data.doc_uuid);\n    removeTempInput();\n  }, [editor]);\n  useEffect(function () {\n    getPosition();\n    var sdocScrollContainer = document.getElementById('sdoc-scroll-container');\n    document.addEventListener('click', onClick);\n    document.addEventListener('keydown', onKeydown);\n    sdocScrollContainer.addEventListener('scroll', onScroll);\n    var unsubscribeInsertLink = eventBus.subscribe(EXTERNAL_EVENT.INSERT_LINK, onInsertLink);\n    var unsubscribeCloseDialog = eventBus.subscribe(INTERNAL_EVENT.CLOSE_FILE_INSET_DIALOG, closeDialog);\n    return function () {\n      sdocScrollContainer.removeEventListener('scroll', onScroll);\n      document.removeEventListener('click', onClick);\n      document.removeEventListener('keydown', onKeydown);\n      unsubscribeInsertLink();\n      unsubscribeCloseDialog();\n    };\n  }, [closeDialog, editor, eventBus, files, getPosition, onClick, onInsertLink, onKeydown, onScroll]);\n  var onSearch = useCallback( /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(searchText) {\n      var _res$data, res, newFiles;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            if (!(searchText.trim().length === 0)) {\n              _context.next = 5;\n              break;\n            }\n            setHeader(t('Recent_visited'));\n            setNewFileName('');\n            getHistoryFiles();\n            return _context.abrupt(\"return\");\n          case 5:\n            if (!(isEnglish(searchText.trim()) && searchText.length < 3)) {\n              _context.next = 10;\n              break;\n            }\n            setFiles([]);\n            setHeader(t('Enter_more_character_start_search'));\n            setNewFileName(searchText);\n            return _context.abrupt(\"return\");\n          case 10:\n            _context.prev = 10;\n            _context.next = 13;\n            return context.searchSdocFiles(searchText, 1, 10);\n          case 13:\n            res = _context.sent;\n            if (!(res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.results)) {\n              _context.next = 19;\n              break;\n            }\n            newFiles = res.data.results;\n            if (newFiles.length === 0) {\n              setHeader(t('The_document_does_not_exist'));\n              setNewFileName(searchText);\n            } else {\n              setHeader('');\n              setNewFileName('');\n            }\n            setFiles(newFiles);\n            return _context.abrupt(\"return\");\n          case 19:\n            _context.next = 24;\n            break;\n          case 21:\n            _context.prev = 21;\n            _context.t0 = _context[\"catch\"](10);\n            toaster.danger(_context.t0.message);\n          case 24:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[10, 21]]);\n    }));\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), []);\n  useEffect(function () {\n    if (!(element === null || element === void 0 ? void 0 : element.children)) return;\n    var searchText = element.children[0].text;\n    onSearch(searchText);\n  }, [element, onSearch]);\n  var onSelect = useCallback(function (fileInfo) {\n    var doc_uuid = fileInfo.doc_uuid,\n      name = fileInfo.name;\n    removeTempInput(editor, element);\n    closeDialog();\n    insertSdocFileLink(editor, name, doc_uuid);\n  }, [closeDialog, editor, element]);\n  var onShowMore = useCallback(function () {\n    eventBus.dispatch(INTERNAL_EVENT.INSERT_ELEMENT, {\n      type: SDOC_LINK,\n      insertSdocFileLinkCallback: insertSdocFileLink\n    });\n    removeTempInput(editor, element);\n  }, [editor, element, eventBus]);\n  var onCreateFile = useCallback(function () {\n    var eventBus = EventBus.getInstance();\n    eventBus.dispatch(EXTERNAL_EVENT.CREATE_SDOC_FILE, {\n      newFileName: newFileName.trim()\n    });\n  }, [newFileName]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-history-files-content popover\",\n    style: _objectSpread(_objectSpread({}, position), {}, {\n      position: 'absolute'\n    })\n  }, header.length !== 0 && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-history-files-header\"\n  }, header), /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames('sdoc-history-files', {\n      'no-header': header.length === 0\n    })\n  }, files.map(function (item) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: item.doc_uuid,\n      className: \"sdoc-history-files-item\",\n      onClick: function onClick() {\n        onSelect(item);\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"sdocfont sdoc-document\"\n    }), /*#__PURE__*/React.createElement(\"span\", null, item.name));\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-history-files-item\",\n    onClick: onShowMore\n  }, \"...\", t('More'))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-history-files-add\",\n    onClick: onCreateFile\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-append\"\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"new-file-name\"\n  }, newFileName ? t('Create_file_name_sdoc', {\n    file_name_sdoc: \"\".concat(newFileName, \".sdoc\")\n  }) : t('Create_a_new_sdoc_file'))));\n};\nexport default FileLinkInsertDialog;","map":{"version":3,"names":["_objectSpread","React","useCallback","useEffect","useRef","useState","ReactEditor","useTranslation","Editor","classNames","context","LocalStorage","isEnglish","EXTERNAL_EVENT","EventBus","INTERNAL_EVENT","SDOC_LINK","toaster","insertSdocFileLink","insertTextWhenRemoveFileNameCollector","removeTempInput","FileLinkInsertDialog","_ref","editor","element","closeDialog","eventBus","getInstance","historyFileWrapperRef","document","querySelector","_useState","_useState2","_slicedToArray","files","setFiles","_useState3","top","left","_useState4","position","setPosition","_useState5","_useState6","newFileName","setNewFileName","_useTranslation","t","_useState7","_useState8","header","setHeader","deleteInputAndInsertText","_len","arguments","length","args","Array","_key","apply","concat","getPosition","selection","nodeEntry","node","domNode","toDOMNode","topGap","leftGap","_domNode$getBoundingC","getBoundingClientRect","popoverTop","popoverLeft","popoverHeight","Math","min","popoverBottomY","viewportHeight","window","innerHeight","counterTopGap","onClick","e","_historyFileWrapperRe","_historyFileWrapperRe2","isClickInside","current","contains","call","target","onScroll","getHistoryFiles","getItem","onKeydown","key","onInsertLink","params","data","obj_name","doc_uuid","sdocScrollContainer","getElementById","addEventListener","unsubscribeInsertLink","subscribe","INSERT_LINK","unsubscribeCloseDialog","CLOSE_FILE_INSET_DIALOG","removeEventListener","onSearch","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","searchText","_res$data","res","newFiles","wrap","_callee$","_context","prev","next","trim","abrupt","searchSdocFiles","sent","results","t0","danger","message","stop","_x","children","text","onSelect","fileInfo","name","onShowMore","dispatch","INSERT_ELEMENT","type","insertSdocFileLinkCallback","onCreateFile","CREATE_SDOC_FILE","createElement","className","style","map","item","file_name_sdoc"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/commons/file-insert-dialog/index.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { ReactEditor } from '@seafile/slate-react';\nimport { useTranslation } from 'react-i18next';\nimport { Editor } from '@seafile/slate';\nimport classNames from 'classnames';\nimport context from '../../../../context';\nimport { LocalStorage, isEnglish } from '../../../../utils';\nimport { EXTERNAL_EVENT } from '../../../../constants';\nimport EventBus from '../../../utils/event-bus';\nimport { INTERNAL_EVENT } from '../../../constants';\nimport { SDOC_LINK } from '../../constants';\nimport toaster from '../../../../components/toast';\nimport { insertSdocFileLink, insertTextWhenRemoveFileNameCollector, removeTempInput } from '../../plugins/sdoc-link/helpers';\nimport './style.css';\nconst FileLinkInsertDialog = _ref => {\n  let {\n    editor,\n    element,\n    closeDialog\n  } = _ref;\n  const eventBus = EventBus.getInstance();\n  const historyFileWrapperRef = useRef(document.querySelector('.sdoc-history-files-wrapper'));\n  const [files, setFiles] = useState([]);\n  const [position, setPosition] = useState({\n    top: 0,\n    left: 0\n  });\n  const [newFileName, setNewFileName] = useState('');\n  const {\n    t\n  } = useTranslation();\n  const [header, setHeader] = useState(t('Recent_visited'));\n  const deleteInputAndInsertText = useCallback(function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    return insertTextWhenRemoveFileNameCollector(editor, element, ...args);\n  }, [editor, element]);\n  const getPosition = useCallback(() => {\n    const {\n      selection\n    } = editor;\n    const nodeEntry = Editor.node(editor, selection);\n    const domNode = ReactEditor.toDOMNode(editor, nodeEntry[0]);\n    if (domNode) {\n      const topGap = 20;\n      const leftGap = 5;\n      const {\n        top,\n        left\n      } = domNode.getBoundingClientRect();\n      let popoverTop = top + topGap;\n      let popoverLeft = left + leftGap;\n      // Insert gap between the popover and the selected node\n      // file item height 32px, header height 32px, add button height 32px, margin-top 8px, max-height 306px\n      const popoverHeight = Math.min(files.length * 32 + 32 * 3 + 8, 300);\n      // Insert gap between the popover and the selected node\n      const popoverBottomY = top + popoverHeight + topGap;\n      const viewportHeight = window.innerHeight;\n      if (popoverBottomY > viewportHeight) {\n        // 8px for the gap between the popover and the bottom of the viewport\n        const counterTopGap = 8;\n        popoverTop = top - popoverHeight - counterTopGap;\n      }\n      setPosition({\n        top: popoverTop,\n        left: popoverLeft\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [files]);\n  const onClick = useCallback(e => {\n    var _historyFileWrapperRe, _historyFileWrapperRe2;\n    const isClickInside = (_historyFileWrapperRe = historyFileWrapperRef.current) === null || _historyFileWrapperRe === void 0 ? void 0 : (_historyFileWrapperRe2 = _historyFileWrapperRe.contains) === null || _historyFileWrapperRe2 === void 0 ? void 0 : _historyFileWrapperRe2.call(_historyFileWrapperRe, e.target);\n    if (isClickInside) return;\n    deleteInputAndInsertText();\n    closeDialog();\n  }, [closeDialog, deleteInputAndInsertText]);\n  const onScroll = useCallback(e => {\n    getPosition();\n  }, [getPosition]);\n  const getHistoryFiles = useCallback(e => {\n    const files = LocalStorage.getItem('sdoc-recent-files') || [];\n    setFiles(files);\n  }, []);\n  useEffect(() => {\n    getHistoryFiles();\n  }, [getHistoryFiles]);\n  const onKeydown = useCallback(e => {\n    const {\n      key\n    } = e;\n    switch (key) {\n      case 'Escape':\n        deleteInputAndInsertText();\n        closeDialog();\n        break;\n      case 'ArrowRight':\n      case 'ArrowLeft':\n        deleteInputAndInsertText();\n        closeDialog();\n        break;\n      case 'ArrowUp':\n      case 'ArrowDown':\n        deleteInputAndInsertText();\n        closeDialog();\n        break;\n      default:\n        break;\n    }\n  }, [closeDialog, deleteInputAndInsertText]);\n  const onInsertLink = useCallback(params => {\n    insertSdocFileLink(editor, params.data.obj_name, params.data.doc_uuid);\n    removeTempInput();\n  }, [editor]);\n  useEffect(() => {\n    getPosition();\n    const sdocScrollContainer = document.getElementById('sdoc-scroll-container');\n    document.addEventListener('click', onClick);\n    document.addEventListener('keydown', onKeydown);\n    sdocScrollContainer.addEventListener('scroll', onScroll);\n    const unsubscribeInsertLink = eventBus.subscribe(EXTERNAL_EVENT.INSERT_LINK, onInsertLink);\n    const unsubscribeCloseDialog = eventBus.subscribe(INTERNAL_EVENT.CLOSE_FILE_INSET_DIALOG, closeDialog);\n    return () => {\n      sdocScrollContainer.removeEventListener('scroll', onScroll);\n      document.removeEventListener('click', onClick);\n      document.removeEventListener('keydown', onKeydown);\n      unsubscribeInsertLink();\n      unsubscribeCloseDialog();\n    };\n  }, [closeDialog, editor, eventBus, files, getPosition, onClick, onInsertLink, onKeydown, onScroll]);\n  const onSearch = useCallback(async searchText => {\n    // Show history files when search is empty\n    if (searchText.trim().length === 0) {\n      setHeader(t('Recent_visited'));\n      setNewFileName('');\n      getHistoryFiles();\n      return;\n    }\n\n    // Cannot be found if the search is less than three characters.\n    if (isEnglish(searchText.trim()) && searchText.length < 3) {\n      setFiles([]);\n      setHeader(t('Enter_more_character_start_search'));\n      setNewFileName(searchText);\n      return;\n    }\n    try {\n      var _res$data;\n      const res = await context.searchSdocFiles(searchText, 1, 10);\n      if (res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.results) {\n        let newFiles = res.data.results;\n        if (newFiles.length === 0) {\n          setHeader(t('The_document_does_not_exist'));\n          setNewFileName(searchText);\n        } else {\n          setHeader('');\n          setNewFileName('');\n        }\n        setFiles(newFiles);\n        return;\n      }\n    } catch (error) {\n      toaster.danger(error.message);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(() => {\n    if (!(element === null || element === void 0 ? void 0 : element.children)) return;\n    const searchText = element.children[0].text;\n    onSearch(searchText);\n  }, [element, onSearch]);\n  const onSelect = useCallback(fileInfo => {\n    const {\n      doc_uuid,\n      name\n    } = fileInfo;\n    removeTempInput(editor, element);\n    closeDialog();\n    insertSdocFileLink(editor, name, doc_uuid);\n  }, [closeDialog, editor, element]);\n  const onShowMore = useCallback(() => {\n    eventBus.dispatch(INTERNAL_EVENT.INSERT_ELEMENT, {\n      type: SDOC_LINK,\n      insertSdocFileLinkCallback: insertSdocFileLink\n    });\n    removeTempInput(editor, element);\n  }, [editor, element, eventBus]);\n  const onCreateFile = useCallback(() => {\n    const eventBus = EventBus.getInstance();\n    eventBus.dispatch(EXTERNAL_EVENT.CREATE_SDOC_FILE, {\n      newFileName: newFileName.trim()\n    });\n  }, [newFileName]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-history-files-content popover\",\n    style: _objectSpread(_objectSpread({}, position), {}, {\n      position: 'absolute'\n    })\n  }, header.length !== 0 && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-history-files-header\"\n  }, header), /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames('sdoc-history-files', {\n      'no-header': header.length === 0\n    })\n  }, files.map(item => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: item.doc_uuid,\n      className: \"sdoc-history-files-item\",\n      onClick: () => {\n        onSelect(item);\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"sdocfont sdoc-document\"\n    }), /*#__PURE__*/React.createElement(\"span\", null, item.name));\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-history-files-item\",\n    onClick: onShowMore\n  }, \"...\", t('More'))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-history-files-add\",\n    onClick: onCreateFile\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"sdocfont sdoc-append\"\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"new-file-name\"\n  }, newFileName ? t('Create_file_name_sdoc', {\n    file_name_sdoc: \"\".concat(newFileName, \".sdoc\")\n  }) : t('Create_a_new_sdoc_file'))));\n};\nexport default FileLinkInsertDialog;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}