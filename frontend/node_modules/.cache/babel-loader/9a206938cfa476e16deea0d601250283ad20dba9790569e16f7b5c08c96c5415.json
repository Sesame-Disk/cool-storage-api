{"ast":null,"code":"import _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport ObjectUtils from './object-utils';\nimport deepCopy from 'deep-copy';\nimport context from '../../context';\nimport { generateDefaultText } from '../../basic-sdk/extension/core/utils/index';\nimport { CLIPBOARD_ORIGIN_SDOC_KEY, ELEMENT_TYPE } from '../extension/constants';\nimport { normalizeTableELement } from '../extension/plugins/table/helpers';\nexport var normalizeChildren = function normalizeChildren(children) {\n  // text\n  if (!Array.isArray(children)) return children;\n\n  // element\n  if (Array.isArray(children) && children.length === 0) return [generateDefaultText()];\n  return children.map(function (child) {\n    // child is text\n    if (ObjectUtils.hasProperty(child, 'text') && !ObjectUtils.hasProperty(child, 'children')) {\n      return child;\n    }\n    // To resolve the issue that the children is not assigned to the new object\n    if (!Object.getOwnPropertyDescriptor(child, 'children').writable) {\n      child = deepCopy(child);\n    }\n    // child is element\n    child.children = normalizeChildren(child.children);\n    return child;\n  });\n};\nexport var normalizeCopyNodes = function normalizeCopyNodes(editor, elements) {\n  if (!Array.isArray(elements) || elements.length === 0) return [];\n  return elements.map(function (element) {\n    if (element.type === ELEMENT_TYPE.TABLE) {\n      return normalizeTableELement(editor, element);\n    }\n    return element;\n  });\n};\nexport var setOriginSdocKey = function setOriginSdocKey(event) {\n  var docUuid = context.getSetting('docUuid');\n  event.clipboardData.setData(\"text/\".concat(CLIPBOARD_ORIGIN_SDOC_KEY), docUuid);\n};\nexport var getSlateFragmentAttribute = function getSlateFragmentAttribute(dataTransfer) {\n  var catchSlateFragment = /data-slate-fragment=\"(.+?)\"/m;\n  var htmlData = dataTransfer.getData('text/html');\n  var _ref = htmlData.match(catchSlateFragment) || [],\n    _ref2 = _slicedToArray(_ref, 2),\n    fragment = _ref2[1];\n  return fragment;\n};","map":{"version":3,"names":["ObjectUtils","deepCopy","context","generateDefaultText","CLIPBOARD_ORIGIN_SDOC_KEY","ELEMENT_TYPE","normalizeTableELement","normalizeChildren","children","Array","isArray","length","map","child","hasProperty","Object","getOwnPropertyDescriptor","writable","normalizeCopyNodes","editor","elements","element","type","TABLE","setOriginSdocKey","event","docUuid","getSetting","clipboardData","setData","concat","getSlateFragmentAttribute","dataTransfer","catchSlateFragment","htmlData","getData","_ref","match","_ref2","_slicedToArray","fragment"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/utils/document-utils.js"],"sourcesContent":["import ObjectUtils from './object-utils';\nimport deepCopy from 'deep-copy';\nimport context from '../../context';\nimport { generateDefaultText } from '../../basic-sdk/extension/core/utils/index';\nimport { CLIPBOARD_ORIGIN_SDOC_KEY, ELEMENT_TYPE } from '../extension/constants';\nimport { normalizeTableELement } from '../extension/plugins/table/helpers';\nexport const normalizeChildren = children => {\n  // text\n  if (!Array.isArray(children)) return children;\n\n  // element\n  if (Array.isArray(children) && children.length === 0) return [generateDefaultText()];\n  return children.map(child => {\n    // child is text\n    if (ObjectUtils.hasProperty(child, 'text') && !ObjectUtils.hasProperty(child, 'children')) {\n      return child;\n    }\n    // To resolve the issue that the children is not assigned to the new object\n    if (!Object.getOwnPropertyDescriptor(child, 'children').writable) {\n      child = deepCopy(child);\n    }\n    // child is element\n    child.children = normalizeChildren(child.children);\n    return child;\n  });\n};\nexport const normalizeCopyNodes = (editor, elements) => {\n  if (!Array.isArray(elements) || elements.length === 0) return [];\n  return elements.map(element => {\n    if (element.type === ELEMENT_TYPE.TABLE) {\n      return normalizeTableELement(editor, element);\n    }\n    return element;\n  });\n};\nexport const setOriginSdocKey = event => {\n  const docUuid = context.getSetting('docUuid');\n  event.clipboardData.setData(\"text/\".concat(CLIPBOARD_ORIGIN_SDOC_KEY), docUuid);\n};\nexport const getSlateFragmentAttribute = dataTransfer => {\n  const catchSlateFragment = /data-slate-fragment=\"(.+?)\"/m;\n  const htmlData = dataTransfer.getData('text/html');\n  const [, fragment] = htmlData.match(catchSlateFragment) || [];\n  return fragment;\n};"],"mappings":";AAAA,OAAOA,WAAW,MAAM,gBAAgB;AACxC,OAAOC,QAAQ,MAAM,WAAW;AAChC,OAAOC,OAAO,MAAM,eAAe;AACnC,SAASC,mBAAmB,QAAQ,4CAA4C;AAChF,SAASC,yBAAyB,EAAEC,YAAY,QAAQ,wBAAwB;AAChF,SAASC,qBAAqB,QAAQ,oCAAoC;AAC1E,OAAO,IAAMC,iBAAiB,GAAG,SAApBA,iBAAiBA,CAAGC,QAAQ,EAAI;EAC3C;EACA,IAAI,CAACC,KAAK,CAACC,OAAO,CAACF,QAAQ,CAAC,EAAE,OAAOA,QAAQ;;EAE7C;EACA,IAAIC,KAAK,CAACC,OAAO,CAACF,QAAQ,CAAC,IAAIA,QAAQ,CAACG,MAAM,KAAK,CAAC,EAAE,OAAO,CAACR,mBAAmB,CAAC,CAAC,CAAC;EACpF,OAAOK,QAAQ,CAACI,GAAG,CAAC,UAAAC,KAAK,EAAI;IAC3B;IACA,IAAIb,WAAW,CAACc,WAAW,CAACD,KAAK,EAAE,MAAM,CAAC,IAAI,CAACb,WAAW,CAACc,WAAW,CAACD,KAAK,EAAE,UAAU,CAAC,EAAE;MACzF,OAAOA,KAAK;IACd;IACA;IACA,IAAI,CAACE,MAAM,CAACC,wBAAwB,CAACH,KAAK,EAAE,UAAU,CAAC,CAACI,QAAQ,EAAE;MAChEJ,KAAK,GAAGZ,QAAQ,CAACY,KAAK,CAAC;IACzB;IACA;IACAA,KAAK,CAACL,QAAQ,GAAGD,iBAAiB,CAACM,KAAK,CAACL,QAAQ,CAAC;IAClD,OAAOK,KAAK;EACd,CAAC,CAAC;AACJ,CAAC;AACD,OAAO,IAAMK,kBAAkB,GAAG,SAArBA,kBAAkBA,CAAIC,MAAM,EAAEC,QAAQ,EAAK;EACtD,IAAI,CAACX,KAAK,CAACC,OAAO,CAACU,QAAQ,CAAC,IAAIA,QAAQ,CAACT,MAAM,KAAK,CAAC,EAAE,OAAO,EAAE;EAChE,OAAOS,QAAQ,CAACR,GAAG,CAAC,UAAAS,OAAO,EAAI;IAC7B,IAAIA,OAAO,CAACC,IAAI,KAAKjB,YAAY,CAACkB,KAAK,EAAE;MACvC,OAAOjB,qBAAqB,CAACa,MAAM,EAAEE,OAAO,CAAC;IAC/C;IACA,OAAOA,OAAO;EAChB,CAAC,CAAC;AACJ,CAAC;AACD,OAAO,IAAMG,gBAAgB,GAAG,SAAnBA,gBAAgBA,CAAGC,KAAK,EAAI;EACvC,IAAMC,OAAO,GAAGxB,OAAO,CAACyB,UAAU,CAAC,SAAS,CAAC;EAC7CF,KAAK,CAACG,aAAa,CAACC,OAAO,CAAC,OAAO,CAACC,MAAM,CAAC1B,yBAAyB,CAAC,EAAEsB,OAAO,CAAC;AACjF,CAAC;AACD,OAAO,IAAMK,yBAAyB,GAAG,SAA5BA,yBAAyBA,CAAGC,YAAY,EAAI;EACvD,IAAMC,kBAAkB,GAAG,8BAA8B;EACzD,IAAMC,QAAQ,GAAGF,YAAY,CAACG,OAAO,CAAC,WAAW,CAAC;EAClD,IAAAC,IAAA,GAAqBF,QAAQ,CAACG,KAAK,CAACJ,kBAAkB,CAAC,IAAI,EAAE;IAAAK,KAAA,GAAAC,cAAA,CAAAH,IAAA;IAApDI,QAAQ,GAAAF,KAAA;EACjB,OAAOE,QAAQ;AACjB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}