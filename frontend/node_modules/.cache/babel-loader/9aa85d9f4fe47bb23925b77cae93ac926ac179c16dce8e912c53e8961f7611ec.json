{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{Modal,ModalHeader,ModalBody,ModalFooter}from'reactstrap';import CreatableSelect from'react-select/creatable';import{gettext}from'../../utils/constants';import{seafileAPI}from'../../utils/seafile-api';import{Utils}from'../../utils/utils';import toaster from'../toast';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UpdateRepoCommitLabels=/*#__PURE__*/function(_React$Component){_inherits(UpdateRepoCommitLabels,_React$Component);var _super=_createSuper(UpdateRepoCommitLabels);function UpdateRepoCommitLabels(props){var _this;_classCallCheck(this,UpdateRepoCommitLabels);_this=_super.call(this,props);_this.handleInputChange=function(value){_this.setState({inputValue:value});};_this.formSubmit=function(){var inputValue=_this.state.inputValue;var labels=inputValue.map(function(item,index){return item.value;}).join(',');var _this$props=_this.props,repoID=_this$props.repoID,commitID=_this$props.commitID;_this.setState({submitBtnDisabled:true});seafileAPI.updateRepoCommitLabels(repoID,commitID,labels).then(function(res){_this.props.updateCommitLabels(res.data.revisionTags.map(function(item,index){return item.tag;}));_this.props.toggleDialog();toaster.success(gettext('Successfully edited labels.'));}).catch(function(error){var errorMsg=Utils.getErrorMsg(error);_this.setState({formErrorMsg:errorMsg,submitBtnDisabled:false});});};_this.state={inputValue:_this.props.commitLabels.map(function(item,index){return{label:item,value:item};}),submitBtnDisabled:false};return _this;}_createClass(UpdateRepoCommitLabels,[{key:\"render\",value:function render(){var formErrorMsg=this.state.formErrorMsg;return/*#__PURE__*/_jsxs(Modal,{isOpen:true,centered:true,toggle:this.props.toggleDialog,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:this.props.toggleDialog,children:gettext('Edit labels')}),/*#__PURE__*/_jsx(ModalBody,{children:/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(CreatableSelect,{defaultValue:this.props.commitLabels.map(function(item,index){return{label:item,value:item};}),isMulti:true,onChange:this.handleInputChange,placeholder:\"\"}),formErrorMsg&&/*#__PURE__*/_jsx(\"p\",{className:\"error m-0 mt-2\",children:formErrorMsg})]})}),/*#__PURE__*/_jsx(ModalFooter,{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit,children:gettext('Submit')})})]});}}]);return UpdateRepoCommitLabels;}(React.Component);export default UpdateRepoCommitLabels;","map":{"version":3,"names":["React","Modal","ModalHeader","ModalBody","ModalFooter","CreatableSelect","gettext","seafileAPI","Utils","toaster","jsx","_jsx","jsxs","_jsxs","UpdateRepoCommitLabels","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","handleInputChange","value","setState","inputValue","formSubmit","state","labels","map","item","index","join","_this$props","repoID","commitID","submitBtnDisabled","updateRepoCommitLabels","then","res","updateCommitLabels","data","revisionTags","tag","toggleDialog","success","catch","error","errorMsg","getErrorMsg","formErrorMsg","commitLabels","label","_createClass","key","render","isOpen","centered","toggle","children","Fragment","defaultValue","isMulti","onChange","placeholder","className","disabled","onClick","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/edit-repo-commit-labels.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport CreatableSelect from 'react-select/creatable';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  commitID: PropTypes.string.isRequired,\n  commitLabels: PropTypes.array.isRequired,\n  updateCommitLabels: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass UpdateRepoCommitLabels extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      inputValue: this.props.commitLabels.map((item, index) => {\n        return {label: item, value: item};\n      }),\n      submitBtnDisabled: false\n    };\n  }\n\n  handleInputChange = (value) => {\n    this.setState({\n      inputValue: value\n    });\n  };\n\n  formSubmit = () => {\n    const inputValue = this.state.inputValue;\n    const labels = inputValue.map((item, index) => item.value).join(',');\n    const {repoID, commitID} = this.props;\n\n    this.setState({\n      submitBtnDisabled: true\n    });\n\n    seafileAPI.updateRepoCommitLabels(repoID, commitID, labels).then((res) => {\n      this.props.updateCommitLabels(res.data.revisionTags.map((item, index) => item.tag));\n      this.props.toggleDialog();\n      toaster.success(gettext('Successfully edited labels.'));\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        formErrorMsg: errorMsg,\n        submitBtnDisabled: false\n      });\n    });\n  };\n\n  render() {\n    const { formErrorMsg } = this.state;\n    return (\n      <Modal isOpen={true} centered={true} toggle={this.props.toggleDialog}>\n        <ModalHeader toggle={this.props.toggleDialog}>{gettext('Edit labels')}</ModalHeader>\n        <ModalBody>\n          <React.Fragment>\n            <CreatableSelect\n              defaultValue={this.props.commitLabels.map((item, index) => { return {label: item, value: item}; })}\n              isMulti={true}\n              onChange={this.handleInputChange}\n              placeholder=''\n            />\n            {formErrorMsg && <p className=\"error m-0 mt-2\">{formErrorMsg}</p>}\n          </React.Fragment>\n        </ModalBody>\n        <ModalFooter>\n          <button className=\"btn btn-primary\" disabled={this.state.submitBtnDisabled} onClick={this.formSubmit}>{gettext('Submit')}</button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nUpdateRepoCommitLabels.propTypes = propTypes;\n\nexport default UpdateRepoCommitLabels;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}