{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{gettext}from'../../utils/constants';import Select from'react-select';import{MenuSelectStyle}from'../common/select';import'../../css/select-editor.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SelectEditor=/*#__PURE__*/function(_React$Component){_inherits(SelectEditor,_React$Component);var _super=_createSuper(SelectEditor);function SelectEditor(props){var _this;_classCallCheck(this,SelectEditor);_this=_super.call(this,props);_this.setOptions=function(){_this.options=[];var options=_this.props.options;for(var i=0,length=options.length;i<length;i++){var option={};option.value=options[i];if(!options[i].length){// it's ''. for example, intitution option in 'system admin - users' page can be ''.\noption.label=/*#__PURE__*/_jsx(\"div\",{style:{minHeight:'1em'}});}else{option.label=/*#__PURE__*/_jsxs(\"div\",{children:[_this.props.translateOption(options[i]),_this.props.translateExplanation&&/*#__PURE__*/_jsx(\"div\",{className:\"permission-editor-explanation\",children:_this.props.translateExplanation(options[i])})]});}_this.options.push(option);}var enableAddCustomPermission=_this.props.enableAddCustomPermission;if(enableAddCustomPermission){var _option={value:gettext('Add custom permission'),isDisabled:true,label:/*#__PURE__*/_jsxs(\"div\",{className:\"permission-editor-btn-add-custom-permission\",onClick:_this.props.onAddCustomPermissionToggle,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-plus\"}),/*#__PURE__*/_jsx(\"span\",{children:gettext('Add custom permission')})]})};_this.options.push(_option);}_this.setState({options:_this.options});};_this.onEditPermission=function(e){e.preventDefault();e.nativeEvent.stopImmediatePropagation();_this.setState({isEditing:true});_this.props.toggleItemFreezed&&_this.props.toggleItemFreezed(true);};_this.onOptionChanged=function(e){var permission=e.value;if(permission!==_this.props.currentOption){_this.props.onOptionChanged(permission);}_this.setState({isEditing:false});_this.props.toggleItemFreezed&&_this.props.toggleItemFreezed(false);};_this.onSelectHandler=function(e){e.nativeEvent.stopImmediatePropagation();};_this.onMenuClose=function(){_this.setState({isEditing:false});_this.props.toggleItemFreezed&&_this.props.toggleItemFreezed(false);};_this.state={isEditing:props.isEditing,options:[]};_this.options=[];return _this;}_createClass(SelectEditor,[{key:\"componentDidMount\",value:function componentDidMount(){this.setOptions();}},{key:\"UNSAFE_componentWillReceiveProps\",value:function UNSAFE_componentWillReceiveProps(){this.setOptions();}},{key:\"render\",value:function render(){var _this$props=this.props,currentOption=_this$props.currentOption,isTextMode=_this$props.isTextMode;// scence1: isTextMode (text)editor-icon --> select\n// scence2: !isTextMode select\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"permission-editor\",onClick:this.onSelectHandler,children:[(!isTextMode||this.state.isEditing)&&/*#__PURE__*/_jsx(Select,{options:this.state.options,className:\"permission-editor-select\",classNamePrefix:\"permission-editor\",placeholder:this.props.translateOption(currentOption),value:currentOption,onChange:this.onOptionChanged,captureMenuScroll:false,menuPlacement:\"auto\",menuPosition:'fixed',menuPortalTarget:document.querySelector('#wrapper'),styles:MenuSelectStyle,onMenuClose:this.onMenuClose,autoFocus:this.props.autoFocus,menuShouldScrollIntoView:true}),isTextMode&&!this.state.isEditing&&/*#__PURE__*/_jsxs(\"div\",{children:[this.props.translateOption(currentOption),this.props.isEditIconShow&&/*#__PURE__*/_jsx(\"a\",{href:\"#\",role:\"button\",\"aria-label\":gettext('Edit'),title:gettext('Edit'),className:\"fa fa-pencil-alt attr-action-icon\",onClick:this.onEditPermission})]})]});}}]);return SelectEditor;}(React.Component);SelectEditor.defaultProps={enableAddCustomPermission:false,isEditing:false,autoFocus:false};export default SelectEditor;","map":{"version":3,"names":["React","gettext","Select","MenuSelectStyle","jsx","_jsx","jsxs","_jsxs","SelectEditor","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","setOptions","options","i","length","option","value","label","style","minHeight","children","translateOption","translateExplanation","className","push","enableAddCustomPermission","isDisabled","onClick","onAddCustomPermissionToggle","setState","onEditPermission","e","preventDefault","nativeEvent","stopImmediatePropagation","isEditing","toggleItemFreezed","onOptionChanged","permission","currentOption","onSelectHandler","onMenuClose","state","_createClass","key","componentDidMount","UNSAFE_componentWillReceiveProps","render","_this$props","isTextMode","classNamePrefix","placeholder","onChange","captureMenuScroll","menuPlacement","menuPosition","menuPortalTarget","document","querySelector","styles","autoFocus","menuShouldScrollIntoView","isEditIconShow","href","role","title","Component","defaultProps"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/select-editor/select-editor.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport Select from 'react-select';\nimport { MenuSelectStyle } from '../common/select';\nimport '../../css/select-editor.css';\n\nconst propTypes = {\n  isTextMode: PropTypes.bool.isRequired, // there will be two mode. first: text and select. second: just select\n  isEditing: PropTypes.bool,\n  isEditIconShow: PropTypes.bool.isRequired,\n  autoFocus: PropTypes.bool,\n  options: PropTypes.array.isRequired,\n  currentOption: PropTypes.string.isRequired,\n  translateOption: PropTypes.func.isRequired,\n  translateExplanation: PropTypes.func,\n  onOptionChanged: PropTypes.func.isRequired,\n  toggleItemFreezed: PropTypes.func,\n  enableAddCustomPermission: PropTypes.bool,\n  onAddCustomPermissionToggle: PropTypes.func,\n};\n\nclass SelectEditor extends React.Component {\n\n  static defaultProps = {\n    enableAddCustomPermission: false,\n    isEditing: false,\n    autoFocus: false,\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isEditing: props.isEditing,\n      options: []\n    };\n    this.options = [];\n  }\n\n  componentDidMount() {\n    this.setOptions();\n  }\n\n  setOptions = () => {\n    this.options = [];\n    const options = this.props.options;\n    for (let i = 0, length = options.length; i < length; i++) {\n      let option = {};\n      option.value = options[i];\n      if (!options[i].length) { // it's ''. for example, intitution option in 'system admin - users' page can be ''.\n        option.label = <div style={{minHeight: '1em'}}></div>;\n      } else {\n        option.label = <div>{this.props.translateOption(options[i])}{ this.props.translateExplanation && <div className=\"permission-editor-explanation\">{this.props.translateExplanation(options[i])}</div>}</div>;\n      }\n      this.options.push(option);\n    }\n\n    const { enableAddCustomPermission } = this.props;\n    if (enableAddCustomPermission) {\n      const option = {\n        value: gettext('Add custom permission'),\n        isDisabled: true,\n        label: (\n          <div className=\"permission-editor-btn-add-custom-permission\" onClick={this.props.onAddCustomPermissionToggle}>\n            <i className=\"fa fa-plus\"></i>\n            <span>{gettext('Add custom permission')}</span>\n          </div>\n        )\n      };\n      this.options.push(option);\n    }\n\n    this.setState({\n      options: this.options\n    });\n  };\n\n  UNSAFE_componentWillReceiveProps() {\n    this.setOptions();\n  }\n\n  onEditPermission = (e) => {\n    e.preventDefault();\n    e.nativeEvent.stopImmediatePropagation();\n    this.setState({isEditing: true});\n    this.props.toggleItemFreezed && this.props.toggleItemFreezed(true);\n  };\n\n  onOptionChanged = (e) => {\n    let permission = e.value;\n    if (permission !== this.props.currentOption) {\n      this.props.onOptionChanged(permission);\n    }\n    this.setState({isEditing: false});\n    this.props.toggleItemFreezed && this.props.toggleItemFreezed(false);\n  };\n\n  onSelectHandler = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n  };\n\n  onMenuClose = () => {\n    this.setState({isEditing: false});\n    this.props.toggleItemFreezed && this.props.toggleItemFreezed(false);\n  };\n\n  render() {\n    let { currentOption, isTextMode } = this.props;\n    // scence1: isTextMode (text)editor-icon --> select\n    // scence2: !isTextMode select\n    return (\n      <div className=\"permission-editor\" onClick={this.onSelectHandler}>\n        {(!isTextMode || this.state.isEditing) &&\n          <Select\n            options={this.state.options}\n            className=\"permission-editor-select\"\n            classNamePrefix=\"permission-editor\"\n            placeholder={this.props.translateOption(currentOption)}\n            value={currentOption}\n            onChange={this.onOptionChanged}\n            captureMenuScroll={false}\n            menuPlacement=\"auto\"\n            menuPosition={'fixed'}\n            menuPortalTarget={document.querySelector('#wrapper')}\n            styles={MenuSelectStyle}\n            onMenuClose={this.onMenuClose}\n            autoFocus={this.props.autoFocus}\n            menuShouldScrollIntoView\n          />\n        }\n        {(isTextMode && !this.state.isEditing) &&\n          <div>\n            {this.props.translateOption(currentOption)}\n            {this.props.isEditIconShow && (\n              <a href=\"#\"\n                role=\"button\"\n                aria-label={gettext('Edit')}\n                title={gettext('Edit')}\n                className=\"fa fa-pencil-alt attr-action-icon\"\n                onClick={this.onEditPermission}>\n              </a>\n            )}\n          </div>\n        }\n      </div>\n    );\n  }\n}\n\nSelectEditor.propTypes = propTypes;\n\nexport default SelectEditor;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}