{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component,Fragment}from'react';import classNames from'classnames';import{Dropdown,DropdownItem,DropdownMenu,DropdownToggle}from'reactstrap';import{gettext,isPro}from'../../../utils/constants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var DingtalkDepartmentsTreeNode=/*#__PURE__*/function(_Component){_inherits(DingtalkDepartmentsTreeNode,_Component);var _super=_createSuper(DingtalkDepartmentsTreeNode);function DingtalkDepartmentsTreeNode(props){var _this;_classCallCheck(this,DingtalkDepartmentsTreeNode);_this=_super.call(this,props);_this.toggleChildren=function(e){e.preventDefault();e.stopPropagation();_this.setState({isChildrenShow:!_this.state.isChildrenShow});};_this.dropdownToggle=function(e){e.stopPropagation();_this.setState({dropdownOpen:!_this.state.dropdownOpen});};_this.onMouseEnter=function(){_this.setState({active:true});};_this.onMouseLeave=function(){if(_this.state.dropdownOpen)return;_this.setState({active:false});};_this.importDepartmentDialogToggle=function(depart){_this.setState({active:false});_this.props.importDepartmentDialogToggle(depart);};_this.renderTreeNodes=function(departmentsTree){if(departmentsTree.length>0){return departmentsTree.map(function(department){return/*#__PURE__*/_jsx(DingtalkDepartmentsTreeNode,{department:department,isChildrenShow:_this.state.isChildrenShow,onChangeDepartment:_this.props.onChangeDepartment,checkedDepartmentId:_this.props.checkedDepartmentId,importDepartmentDialogToggle:_this.importDepartmentDialogToggle},department.id);});}};_this.changeDept=function(departmentID){var _this$props=_this.props,department=_this$props.department,checkedDepartmentId=_this$props.checkedDepartmentId;_this.props.onChangeDepartment(departmentID);if(checkedDepartmentId===department.id&&!_this.state.isChildrenShow){_this.setState({isChildrenShow:true});}};_this.state={isChildrenShow:false,dropdownOpen:false,active:false};return _this;}_createClass(DingtalkDepartmentsTreeNode,[{key:\"componentDidMount\",value:function componentDidMount(){if(this.props.index===0){this.setState({isChildrenShow:true});this.props.onChangeDepartment(this.props.department.id);}}},{key:\"render\",value:function render(){var _this2=this;var _this$props2=this.props,isChildrenShow=_this$props2.isChildrenShow,department=_this$props2.department,checkedDepartmentId=_this$props2.checkedDepartmentId;var toggleClass=classNames({'folder-toggle-icon fa fa-caret-down':department.children&&this.state.isChildrenShow,'folder-toggle-icon fa fa-caret-right':department.children&&!this.state.isChildrenShow});var nodeInnerClass=classNames({'tree-node-inner':true,'tree-node-inner-hover':this.state.active,'tree-node-hight-light':checkedDepartmentId===department.id});return/*#__PURE__*/_jsxs(Fragment,{children:[isChildrenShow&&/*#__PURE__*/_jsxs(\"div\",{className:nodeInnerClass,onClick:function onClick(){return _this2.changeDept(department.id);},onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[/*#__PURE__*/_jsx(\"span\",{className:\"tree-node-icon\",onClick:function onClick(e){return _this2.toggleChildren(e);},children:/*#__PURE__*/_jsx(\"i\",{className:toggleClass})}),/*#__PURE__*/_jsx(\"span\",{className:\"tree-node-text\",children:department.name}),isPro&&/*#__PURE__*/_jsxs(Dropdown,{isOpen:this.state.dropdownOpen,toggle:function toggle(e){return _this2.dropdownToggle(e);},direction:\"down\",style:this.state.active?{}:{opacity:0},children:[/*#__PURE__*/_jsx(DropdownToggle,{tag:\"i\",className:\"fa fa-ellipsis-v cursor-pointer attr-action-icon\",title:gettext('More operations'),\"aria-label\":gettext('More operations'),\"data-toggle\":\"dropdown\",\"aria-expanded\":this.state.dropdownOpen}),/*#__PURE__*/_jsx(DropdownMenu,{className:\"drop-list\",right:true,children:/*#__PURE__*/_jsx(DropdownItem,{onClick:this.importDepartmentDialogToggle.bind(this,department),id:department.id,children:'导入部门'})})]})]}),this.state.isChildrenShow&&/*#__PURE__*/_jsx(\"div\",{className:\"department-children\",children:department.children&&this.renderTreeNodes(department.children)})]});}}]);return DingtalkDepartmentsTreeNode;}(Component);export default DingtalkDepartmentsTreeNode;","map":{"version":3,"names":["React","Component","Fragment","classNames","Dropdown","DropdownItem","DropdownMenu","DropdownToggle","gettext","isPro","jsx","_jsx","jsxs","_jsxs","DingtalkDepartmentsTreeNode","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","toggleChildren","e","preventDefault","stopPropagation","setState","isChildrenShow","state","dropdownToggle","dropdownOpen","onMouseEnter","active","onMouseLeave","importDepartmentDialogToggle","depart","renderTreeNodes","departmentsTree","length","map","department","onChangeDepartment","checkedDepartmentId","id","changeDept","departmentID","_this$props","_createClass","key","value","componentDidMount","index","render","_this2","_this$props2","toggleClass","children","nodeInnerClass","className","onClick","name","isOpen","toggle","direction","style","opacity","tag","title","right","bind"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/pages/sys-admin/dingtalk/dingtalk-departments-tree-node.js"],"sourcesContent":["import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { Dropdown, DropdownItem, DropdownMenu, DropdownToggle } from 'reactstrap';\nimport { gettext, isPro } from '../../../utils/constants';\n\nconst DingtalkDepartmentsTreeNodePropTypes = {\n  index: PropTypes.number,\n  department: PropTypes.object.isRequired,\n  isChildrenShow: PropTypes.bool.isRequired,\n  onChangeDepartment: PropTypes.func.isRequired,\n  checkedDepartmentId: PropTypes.number.isRequired,\n  importDepartmentDialogToggle: PropTypes.func.isRequired,\n};\n\nclass DingtalkDepartmentsTreeNode extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isChildrenShow: false,\n      dropdownOpen: false,\n      active: false,\n    };\n  }\n\n  toggleChildren = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    this.setState({\n      isChildrenShow: !this.state.isChildrenShow,\n    });\n  };\n\n  dropdownToggle = (e) => {\n    e.stopPropagation();\n    this.setState({ dropdownOpen: !this.state.dropdownOpen });\n  };\n\n  onMouseEnter = () => {\n    this.setState({ active: true });\n  };\n\n  onMouseLeave = () => {\n    if (this.state.dropdownOpen) return;\n    this.setState({ active: false });\n  };\n\n  importDepartmentDialogToggle = (depart) => {\n    this.setState({ active: false });\n    this.props.importDepartmentDialogToggle(depart);\n  };\n\n  componentDidMount() {\n    if (this.props.index === 0) {\n      this.setState({ isChildrenShow: true });\n      this.props.onChangeDepartment(this.props.department.id);\n    }\n  }\n\n  renderTreeNodes = (departmentsTree) => {\n    if (departmentsTree.length > 0) {\n      return departmentsTree.map((department) => {\n        return (\n          <DingtalkDepartmentsTreeNode\n            key={department.id}\n            department={department}\n            isChildrenShow={this.state.isChildrenShow}\n            onChangeDepartment={this.props.onChangeDepartment}\n            checkedDepartmentId={this.props.checkedDepartmentId}\n            importDepartmentDialogToggle={this.importDepartmentDialogToggle}\n          />\n        );\n      });\n    }\n  };\n\n  changeDept = (departmentID) => {\n    const { department, checkedDepartmentId } = this.props;\n    this.props.onChangeDepartment(departmentID);\n    if (checkedDepartmentId === department.id && !this.state.isChildrenShow) {\n      this.setState({ isChildrenShow: true });\n    }\n  };\n\n  render() {\n    const { isChildrenShow, department, checkedDepartmentId } = this.props;\n    let toggleClass = classNames({\n      'folder-toggle-icon fa fa-caret-down': department.children && this.state.isChildrenShow,\n      'folder-toggle-icon fa fa-caret-right': department.children && !this.state.isChildrenShow,\n    });\n    let nodeInnerClass = classNames({\n      'tree-node-inner': true,\n      'tree-node-inner-hover': this.state.active,\n      'tree-node-hight-light': checkedDepartmentId === department.id\n    });\n    return (\n      <Fragment>\n        {isChildrenShow &&\n          <div\n            className={nodeInnerClass}\n            onClick={() => this.changeDept(department.id)}\n            onMouseEnter={this.onMouseEnter}\n            onMouseLeave={this.onMouseLeave}\n          >\n            <span className=\"tree-node-icon\" onClick={(e) => this.toggleChildren(e)}>\n              <i className={toggleClass}></i>\n            </span>\n            <span className=\"tree-node-text\">{department.name}</span>\n            {isPro &&\n            <Dropdown\n              isOpen={this.state.dropdownOpen}\n              toggle={(e) => this.dropdownToggle(e)}\n              direction=\"down\"\n              style={this.state.active ? {} : { opacity: 0 }}\n            >\n              <DropdownToggle\n                tag='i'\n                className='fa fa-ellipsis-v cursor-pointer attr-action-icon'\n                title={gettext('More operations')}\n                aria-label={gettext('More operations')}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.dropdownOpen}\n              >\n              </DropdownToggle>\n              <DropdownMenu className=\"drop-list\" right={true}>\n                <DropdownItem\n                  onClick={this.importDepartmentDialogToggle.bind(this, department)}\n                  id={department.id}\n                >{'导入部门'}</DropdownItem>\n              </DropdownMenu>\n            </Dropdown>\n            }\n          </div>\n        }\n        {this.state.isChildrenShow &&\n          <div className=\"department-children\">\n            {department.children && this.renderTreeNodes(department.children)}\n          </div>\n        }\n      </Fragment>\n    );\n  }\n}\n\nDingtalkDepartmentsTreeNode.propTypes = DingtalkDepartmentsTreeNodePropTypes;\n\nexport default DingtalkDepartmentsTreeNode;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}