{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import copy from'copy-to-clipboard';import moment from'moment';import{Button,Form,FormGroup,Label,Input,InputGroup,InputGroupAddon,Alert}from'reactstrap';import{gettext,shareLinkForceUsePassword,shareLinkPasswordMinLength,shareLinkPasswordStrengthLevel,canSendShareLinkEmail,uploadLinkExpireDaysMin,uploadLinkExpireDaysMax,uploadLinkExpireDaysDefault}from'../../utils/constants';import{seafileAPI}from'../../utils/seafile-api';import{Utils}from'../../utils/utils';import UploadLink from'../../models/upload-link';import toaster from'../toast';import SendLink from'../send-link';import SharedLink from'../shared-link';import SetLinkExpiration from'../set-link-expiration';import{EvalProFunc,EvalQuotaUploadLinks}from'../../services/ad';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var inputWidth=Utils.isDesktop()?250:210;var GenerateUploadLink=/*#__PURE__*/function(_React$Component){_inherits(GenerateUploadLink,_React$Component);var _super=_createSuper(GenerateUploadLink);function GenerateUploadLink(props){var _this;_classCallCheck(this,GenerateUploadLink);_this=_super.call(this,props);_this.getUploadLink=function(){var path=_this.props.itemPath;var repoID=_this.props.repoID;seafileAPI.getUploadLink(repoID,path).then(function(res){if(res.data.length!==0){var sharedUploadInfo=new UploadLink(res.data[0]);_this.setState({sharedUploadInfo:sharedUploadInfo});}}).catch(function(err){var errMsg=Utils.getErrorMsg(err,true);if(!err.response||err.response.status!==403){toaster.danger(errMsg);}_this.props.closeShareDialog();});};_this.addPassword=function(){_this.setState({showPasswordInput:!_this.state.showPasswordInput,password:'',passwordnew:'',errorInfo:''});};_this.togglePasswordVisible=function(){_this.setState({passwordVisible:!_this.state.passwordVisible});};_this.generatePassword=function(){var val=Utils.generatePassword(shareLinkPasswordMinLength);_this.setState({password:val,passwordnew:val});};_this.inputPassword=function(e){_this.setState({password:e.target.value});};_this.inputPasswordNew=function(e){_this.setState({passwordnew:e.target.value});};_this.toggleStoredPasswordVisible=function(){_this.setState({storedPasswordVisible:!_this.state.storedPasswordVisible});};_this.generateUploadLink=function(){var isValid=_this.validateParamsInput();if(isValid){_this.setState({errorInfo:''});var _this$props=_this.props,itemPath=_this$props.itemPath,repoID=_this$props.repoID;var _this$state=_this.state,password=_this$state.password,isExpireChecked=_this$state.isExpireChecked,expType=_this$state.expType,expireDays=_this$state.expireDays,expDate=_this$state.expDate;var expirationTime='';if(isExpireChecked){if(expType=='by-days'){expirationTime=moment().add(parseInt(expireDays),'days').format();}else{expirationTime=expDate.format();}}seafileAPI.createUploadLink(repoID,itemPath,password,expirationTime).then(function(res){var sharedUploadInfo=new UploadLink(res.data);_this.setState({sharedUploadInfo:sharedUploadInfo});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});}};_this.validateParamsInput=function(){var _this$state2=_this.state,showPasswordInput=_this$state2.showPasswordInput,password=_this$state2.password,passwordnew=_this$state2.passwordnew,isExpireChecked=_this$state2.isExpireChecked,expType=_this$state2.expType,expireDays=_this$state2.expireDays,expDate=_this$state2.expDate;// check password params\nif(showPasswordInput){if(password.length===0){_this.setState({errorInfo:gettext('Please enter a password.')});return false;}if(password.length<shareLinkPasswordMinLength){_this.setState({errorInfo:gettext('The password is too short.')});return false;}if(password!==passwordnew){_this.setState({errorInfo:gettext('Passwords don\\'t match')});return false;}if(Utils.getStrengthLevel(password)<shareLinkPasswordStrengthLevel){_this.setState({errorInfo:gettext('The password is too weak. It should include at least {passwordStrengthLevel} of the following: number, upper letter, lower letter and other symbols.').replace('{passwordStrengthLevel}',shareLinkPasswordStrengthLevel)});return false;}}if(isExpireChecked){if(expType=='by-date'){if(!expDate){_this.setState({errorInfo:gettext('Please select an expiration time')});return false;}return true;}var reg=/^\\d+$/;if(!expireDays){_this.setState({errorInfo:gettext('Please enter days')});return false;}if(!reg.test(expireDays)){_this.setState({errorInfo:gettext('Please enter a non-negative integer')});return false;}_this.setState({expireDays:parseInt(expireDays)});}return true;};_this.onExpireChecked=function(e){_this.setState({isExpireChecked:e.target.checked});};_this.setExpType=function(e){_this.setState({expType:e.target.value});};_this.onExpDateChanged=function(value){_this.setState({expDate:value});};_this.onExpireDaysChanged=function(e){var day=e.target.value.trim();_this.setState({expireDays:day});};_this.onCopyUploadLink=function(){var uploadLink=_this.state.sharedUploadInfo.link;copy(uploadLink);toaster.success(gettext('Upload link is copied to the clipboard.'));_this.props.closeShareDialog();};_this.handleMouseOverExpirationEditIcon=function(){_this.setState({isExpirationEditIconShow:true});};_this.handleMouseOutExpirationEditIcon=function(){_this.setState({isExpirationEditIconShow:false});};_this.editExpirationToggle=function(){_this.setState({isEditingExpiration:!_this.state.isEditingExpiration});};_this.updateExpiration=function(e){e.preventDefault();e.nativeEvent.stopImmediatePropagation();var _this$state3=_this.state,expType=_this$state3.expType,expireDays=_this$state3.expireDays,expDate=_this$state3.expDate;var expirationTime='';if(expType=='by-days'){expirationTime=moment().add(parseInt(expireDays),'days').format();}else{expirationTime=expDate.format();}seafileAPI.updateUploadLink(_this.state.sharedUploadInfo.token,expirationTime).then(function(res){var sharedUploadInfo=new UploadLink(res.data);_this.setState({sharedUploadInfo:sharedUploadInfo,isEditingExpiration:false});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.deleteUploadLink=function(){var sharedUploadInfo=_this.state.sharedUploadInfo;seafileAPI.deleteUploadLink(sharedUploadInfo.token).then(function(){_this.setState({showPasswordInput:shareLinkForceUsePassword?true:false,expireDays:_this.defaultExpireDays,expDate:null,isExpireChecked:!_this.isExpireDaysNoLimit,password:'',passwordnew:'',sharedUploadInfo:null});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.toggleSendLink=function(){_this.setState({isSendLinkShown:!_this.state.isSendLinkShown});};_this.isExpireDaysNoLimit=uploadLinkExpireDaysMin===0&&uploadLinkExpireDaysMax===0&&uploadLinkExpireDaysDefault==0;_this.defaultExpireDays=_this.isExpireDaysNoLimit?'':uploadLinkExpireDaysDefault;_this.state={showPasswordInput:shareLinkForceUsePassword?true:false,passwordVisible:false,password:'',passwordnew:'',storedPasswordVisible:false,sharedUploadInfo:null,isSendLinkShown:false,isExpireChecked:!_this.isExpireDaysNoLimit,isExpirationEditIconShow:false,isEditingExpiration:false,expType:'by-days',expireDays:_this.defaultExpireDays,expDate:null};return _this;}_createClass(GenerateUploadLink,[{key:\"componentDidMount\",value:function componentDidMount(){this.getUploadLink();}},{key:\"render\",value:function render(){var isSendLinkShown=this.state.isSendLinkShown;var passwordLengthTip=gettext('(at least {passwordMinLength} characters and includes {passwordStrengthLevel} of the following: number, upper letter, lower letter and other symbols)');passwordLengthTip=passwordLengthTip.replace('{passwordMinLength}',shareLinkPasswordMinLength).replace('{passwordStrengthLevel}',shareLinkPasswordStrengthLevel);if(this.state.sharedUploadInfo){var sharedUploadInfo=this.state.sharedUploadInfo;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Form,{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(\"dt\",{className:\"text-secondary font-weight-normal\",children:gettext('Upload Link:')}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsx(SharedLink,{link:sharedUploadInfo.link,linkExpired:sharedUploadInfo.is_expired,copyLink:this.onCopyUploadLink})})]}),sharedUploadInfo.password&&/*#__PURE__*/_jsxs(FormGroup,{className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"dt\",{className:\"text-secondary font-weight-normal\",children:gettext('Password:')}),/*#__PURE__*/_jsx(\"dd\",{className:\"d-flex\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"stored-password\",className:\"border-0 mr-1\",type:\"text\",value:this.state.storedPasswordVisible?sharedUploadInfo.password:'****************************************',readOnly:true,size:Math.max(sharedUploadInfo.password.length,10)}),/*#__PURE__*/_jsx(\"span\",{tabIndex:\"0\",role:\"button\",\"aria-label\":this.state.storedPasswordVisible?gettext('Hide'):gettext('Show'),onKeyDown:this.onIconKeyDown,onClick:this.toggleStoredPasswordVisible,className:\"eye-icon fas \".concat(this.state.storedPasswordVisible?'fa-eye':'fa-eye-slash')})]})})]}),sharedUploadInfo.expire_date&&/*#__PURE__*/_jsxs(FormGroup,{className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"dt\",{className:\"text-secondary font-weight-normal\",children:gettext('Expiration Date:')}),!this.state.isEditingExpiration&&/*#__PURE__*/_jsxs(\"dd\",{style:{width:'250px'},onMouseEnter:this.handleMouseOverExpirationEditIcon,onMouseLeave:this.handleMouseOutExpirationEditIcon,children:[moment(sharedUploadInfo.expire_date).format('YYYY-MM-DD HH:mm:ss'),this.state.isExpirationEditIconShow&&/*#__PURE__*/_jsx(\"a\",{href:\"#\",role:\"button\",\"aria-label\":gettext('Edit'),title:gettext('Edit'),className:\"fa fa-pencil-alt attr-action-icon\",onClick:EvalProFunc(this.editExpirationToggle)})]}),this.state.isEditingExpiration&&/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(SetLinkExpiration,{minDays:uploadLinkExpireDaysMin,maxDays:uploadLinkExpireDaysMax,defaultDays:uploadLinkExpireDaysDefault,expType:this.state.expType,setExpType:this.setExpType,expireDays:this.state.expireDays,onExpireDaysChanged:this.onExpireDaysChanged,expDate:this.state.expDate,onExpDateChanged:this.onExpDateChanged}),/*#__PURE__*/_jsxs(\"div\",{className:this.state.expType=='by-days'?'mt-2':'mt-3',children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary mr-2\",onClick:this.updateExpiration,children:gettext('Update')}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:this.editExpirationToggle,children:gettext('Cancel')})]})]})]})]}),canSendShareLinkEmail&&!isSendLinkShown&&/*#__PURE__*/_jsx(Button,{onClick:this.toggleSendLink,className:\"mr-2\",children:gettext('Send')}),!isSendLinkShown&&/*#__PURE__*/_jsx(Button,{onClick:this.deleteUploadLink,children:gettext('Delete')}),isSendLinkShown&&/*#__PURE__*/_jsx(SendLink,{linkType:\"uploadLink\",token:sharedUploadInfo.token,toggleSendLink:this.toggleSendLink,closeShareDialog:this.props.closeShareDialog})]});}return/*#__PURE__*/_jsxs(Form,{className:\"generate-upload-link\",children:[/*#__PURE__*/_jsxs(FormGroup,{check:true,children:[/*#__PURE__*/_jsx(Label,{check:true,children:shareLinkForceUsePassword?/*#__PURE__*/_jsxs(Label,{check:true,children:[/*#__PURE__*/_jsx(Input,{type:\"checkbox\",checked:true,readOnly:true,disabled:true}),/*#__PURE__*/_jsx(\"span\",{children:gettext('Add password protection')})]}):/*#__PURE__*/_jsxs(Label,{check:true,children:[/*#__PURE__*/_jsx(Input,{type:\"checkbox\",onChange:this.addPassword}),/*#__PURE__*/_jsx(\"span\",{children:gettext('Add password protection')})]})}),this.state.showPasswordInput&&/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(Label,{for:\"passwd\",children:gettext('Password')}),/*#__PURE__*/_jsx(\"span\",{className:\"tip\",children:passwordLengthTip}),/*#__PURE__*/_jsxs(InputGroup,{style:{width:inputWidth},children:[/*#__PURE__*/_jsx(Input,{id:\"passwd\",type:this.state.passwordVisible?'text':'password',value:this.state.password||'',onChange:this.inputPassword}),/*#__PURE__*/_jsxs(InputGroupAddon,{addonType:\"append\",children:[/*#__PURE__*/_jsx(Button,{onClick:this.togglePasswordVisible,children:/*#__PURE__*/_jsx(\"i\",{className:\"link-operation-icon fas \".concat(this.state.passwordVisible?'fa-eye':'fa-eye-slash')})}),/*#__PURE__*/_jsx(Button,{onClick:this.generatePassword,children:/*#__PURE__*/_jsx(\"i\",{className:\"link-operation-icon fas fa-magic\"})})]})]})]}),/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(Label,{for:\"passwd-again\",children:gettext('Password again')}),/*#__PURE__*/_jsx(Input,{id:\"passwd-again\",style:{width:inputWidth},type:this.state.passwordVisible?'text':'password',value:this.state.passwordnew||'',onChange:this.inputPasswordNew})]})]})]}),/*#__PURE__*/_jsxs(FormGroup,{check:true,children:[/*#__PURE__*/_jsxs(Label,{check:true,children:[this.isExpireDaysNoLimit?/*#__PURE__*/_jsx(Input,{type:\"checkbox\",onChange:this.onExpireChecked}):/*#__PURE__*/_jsx(Input,{type:\"checkbox\",checked:true,readOnly:true,disabled:true}),/*#__PURE__*/_jsx(\"span\",{children:gettext('Add auto expiration')})]}),this.state.isExpireChecked&&/*#__PURE__*/_jsx(\"div\",{className:\"ml-4\",children:/*#__PURE__*/_jsx(SetLinkExpiration,{minDays:uploadLinkExpireDaysMin,maxDays:uploadLinkExpireDaysMax,defaultDays:uploadLinkExpireDaysDefault,expType:this.state.expType,setExpType:this.setExpType,expireDays:this.state.expireDays,onExpireDaysChanged:this.onExpireDaysChanged,expDate:this.state.expDate,onExpDateChanged:this.onExpDateChanged})})]}),this.state.errorInfo&&/*#__PURE__*/_jsx(Alert,{color:\"danger\",className:\"mt-2\",children:this.state.errorInfo}),/*#__PURE__*/_jsx(Button,{className:\"generate-link-btn\",onClick:EvalQuotaUploadLinks(this.generateUploadLink),children:gettext('Generate')})]});}}]);return GenerateUploadLink;}(React.Component);export default GenerateUploadLink;","map":{"version":3,"names":["React","copy","moment","Button","Form","FormGroup","Label","Input","InputGroup","InputGroupAddon","Alert","gettext","shareLinkForceUsePassword","shareLinkPasswordMinLength","shareLinkPasswordStrengthLevel","canSendShareLinkEmail","uploadLinkExpireDaysMin","uploadLinkExpireDaysMax","uploadLinkExpireDaysDefault","seafileAPI","Utils","UploadLink","toaster","SendLink","SharedLink","SetLinkExpiration","EvalProFunc","EvalQuotaUploadLinks","jsx","_jsx","jsxs","_jsxs","inputWidth","isDesktop","GenerateUploadLink","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","getUploadLink","path","itemPath","repoID","then","res","data","length","sharedUploadInfo","setState","catch","err","errMsg","getErrorMsg","response","status","danger","closeShareDialog","addPassword","showPasswordInput","state","password","passwordnew","errorInfo","togglePasswordVisible","passwordVisible","generatePassword","val","inputPassword","e","target","value","inputPasswordNew","toggleStoredPasswordVisible","storedPasswordVisible","generateUploadLink","isValid","validateParamsInput","_this$props","_this$state","isExpireChecked","expType","expireDays","expDate","expirationTime","add","parseInt","format","createUploadLink","error","errMessage","_this$state2","getStrengthLevel","replace","reg","test","onExpireChecked","checked","setExpType","onExpDateChanged","onExpireDaysChanged","day","trim","onCopyUploadLink","uploadLink","link","success","handleMouseOverExpirationEditIcon","isExpirationEditIconShow","handleMouseOutExpirationEditIcon","editExpirationToggle","isEditingExpiration","updateExpiration","preventDefault","nativeEvent","stopImmediatePropagation","_this$state3","updateUploadLink","token","deleteUploadLink","defaultExpireDays","isExpireDaysNoLimit","toggleSendLink","isSendLinkShown","_createClass","key","componentDidMount","render","passwordLengthTip","children","className","linkExpired","is_expired","copyLink","id","type","readOnly","size","Math","max","tabIndex","role","onKeyDown","onIconKeyDown","onClick","concat","expire_date","style","width","onMouseEnter","onMouseLeave","href","title","minDays","maxDays","defaultDays","linkType","check","disabled","onChange","for","addonType","color","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/generate-upload-link.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport copy from 'copy-to-clipboard';\nimport moment from 'moment';\nimport { Button, Form, FormGroup, Label, Input, InputGroup, InputGroupAddon, Alert } from 'reactstrap';\nimport { gettext, shareLinkForceUsePassword, shareLinkPasswordMinLength, shareLinkPasswordStrengthLevel, canSendShareLinkEmail, uploadLinkExpireDaysMin, uploadLinkExpireDaysMax, uploadLinkExpireDaysDefault } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport UploadLink from '../../models/upload-link';\nimport toaster from '../toast';\nimport SendLink from '../send-link';\nimport SharedLink from '../shared-link';\nimport SetLinkExpiration from '../set-link-expiration';\nimport { EvalProFunc, EvalQuotaUploadLinks } from '../../services/ad';\n\nconst propTypes = {\n  itemPath: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  closeShareDialog: PropTypes.func.isRequired,\n};\n\nconst inputWidth = Utils.isDesktop() ? 250 : 210;\n\nclass GenerateUploadLink extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.isExpireDaysNoLimit = (uploadLinkExpireDaysMin === 0 && uploadLinkExpireDaysMax === 0 && uploadLinkExpireDaysDefault == 0);\n    this.defaultExpireDays = this.isExpireDaysNoLimit ? '' : uploadLinkExpireDaysDefault;\n\n    this.state = {\n      showPasswordInput: shareLinkForceUsePassword ? true : false,\n      passwordVisible: false,\n      password: '',\n      passwordnew: '',\n      storedPasswordVisible: false,\n      sharedUploadInfo: null,\n      isSendLinkShown: false,\n      isExpireChecked: !this.isExpireDaysNoLimit,\n      isExpirationEditIconShow: false,\n      isEditingExpiration: false,\n      expType: 'by-days',\n      expireDays: this.defaultExpireDays,\n      expDate: null\n    };\n  }\n\n  componentDidMount() {\n    this.getUploadLink();\n  }\n\n  getUploadLink = () => {\n    let path = this.props.itemPath;\n    let repoID = this.props.repoID;\n    seafileAPI.getUploadLink(repoID, path).then((res) => {\n      if (res.data.length !== 0) {\n        let sharedUploadInfo = new UploadLink(res.data[0]);\n        this.setState({ sharedUploadInfo: sharedUploadInfo });\n      }\n    }).catch((err) => {\n      let errMsg = Utils.getErrorMsg(err, true);\n      if (!err.response || err.response.status !== 403) {\n        toaster.danger(errMsg);\n      }\n      this.props.closeShareDialog();\n    });\n  };\n\n  addPassword = () => {\n    this.setState({\n      showPasswordInput: !this.state.showPasswordInput,\n      password: '',\n      passwordnew: '',\n      errorInfo: ''\n    });\n  };\n\n  togglePasswordVisible = () => {\n    this.setState({\n      passwordVisible: !this.state.passwordVisible\n    });\n  };\n\n  generatePassword = () => {\n    let val = Utils.generatePassword(shareLinkPasswordMinLength);\n    this.setState({\n      password: val,\n      passwordnew: val\n    });\n  };\n\n  inputPassword = (e) => {\n    this.setState({\n      password: e.target.value\n    });\n  };\n\n  inputPasswordNew = (e) => {\n    this.setState({\n      passwordnew: e.target.value\n    });\n  };\n\n  toggleStoredPasswordVisible = () => {\n    this.setState({\n      storedPasswordVisible: !this.state.storedPasswordVisible\n    });\n  };\n\n  generateUploadLink = () => {\n    let isValid = this.validateParamsInput();\n    if (isValid) {\n      this.setState({ errorInfo: '' });\n\n      let { itemPath, repoID } = this.props;\n      let { password, isExpireChecked, expType, expireDays, expDate } = this.state;\n\n      let expirationTime = '';\n      if (isExpireChecked) {\n        if (expType == 'by-days') {\n          expirationTime = moment().add(parseInt(expireDays), 'days').format();\n        } else {\n          expirationTime = expDate.format();\n        }\n      }\n\n      seafileAPI.createUploadLink(repoID, itemPath, password, expirationTime).then((res) => {\n        let sharedUploadInfo = new UploadLink(res.data);\n        this.setState({ sharedUploadInfo: sharedUploadInfo });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  };\n\n  validateParamsInput = () => {\n    let { showPasswordInput, password, passwordnew, isExpireChecked, expType, expireDays, expDate } = this.state;\n\n    // check password params\n    if (showPasswordInput) {\n      if (password.length === 0) {\n        this.setState({ errorInfo: gettext('Please enter a password.') });\n        return false;\n      }\n      if (password.length < shareLinkPasswordMinLength) {\n        this.setState({ errorInfo: gettext('The password is too short.') });\n        return false;\n      }\n      if (password !== passwordnew) {\n        this.setState({ errorInfo: gettext('Passwords don\\'t match') });\n        return false;\n      }\n      if (Utils.getStrengthLevel(password) < shareLinkPasswordStrengthLevel) {\n        this.setState({ errorInfo: gettext('The password is too weak. It should include at least {passwordStrengthLevel} of the following: number, upper letter, lower letter and other symbols.').replace('{passwordStrengthLevel}', shareLinkPasswordStrengthLevel) });\n        return false;\n      }\n    }\n\n    if (isExpireChecked) {\n      if (expType == 'by-date') {\n        if (!expDate) {\n          this.setState({ errorInfo: gettext('Please select an expiration time') });\n          return false;\n        }\n        return true;\n      }\n\n      let reg = /^\\d+$/;\n      if (!expireDays) {\n        this.setState({ errorInfo: gettext('Please enter days') });\n        return false;\n      }\n      if (!reg.test(expireDays)) {\n        this.setState({ errorInfo: gettext('Please enter a non-negative integer') });\n        return false;\n      }\n      this.setState({ expireDays: parseInt(expireDays) });\n    }\n    return true;\n  };\n\n  onExpireChecked = (e) => {\n    this.setState({ isExpireChecked: e.target.checked });\n  };\n\n  setExpType = (e) => {\n    this.setState({\n      expType: e.target.value\n    });\n  };\n\n  onExpDateChanged = (value) => {\n    this.setState({\n      expDate: value\n    });\n  };\n\n  onExpireDaysChanged = (e) => {\n    let day = e.target.value.trim();\n    this.setState({ expireDays: day });\n  };\n\n  onCopyUploadLink = () => {\n    let uploadLink = this.state.sharedUploadInfo.link;\n    copy(uploadLink);\n    toaster.success(gettext('Upload link is copied to the clipboard.'));\n    this.props.closeShareDialog();\n  };\n\n  handleMouseOverExpirationEditIcon = () => {\n    this.setState({ isExpirationEditIconShow: true });\n  };\n\n  handleMouseOutExpirationEditIcon = () => {\n    this.setState({ isExpirationEditIconShow: false });\n  };\n\n  editExpirationToggle = () => {\n    this.setState({ isEditingExpiration: !this.state.isEditingExpiration });\n  };\n\n  updateExpiration = (e) => {\n\n    e.preventDefault();\n    e.nativeEvent.stopImmediatePropagation();\n\n    let { expType, expireDays, expDate } = this.state;\n\n    let expirationTime = '';\n    if (expType == 'by-days') {\n      expirationTime = moment().add(parseInt(expireDays), 'days').format();\n    } else {\n      expirationTime = expDate.format();\n    }\n\n    seafileAPI.updateUploadLink(this.state.sharedUploadInfo.token, expirationTime).then((res) => {\n      let sharedUploadInfo = new UploadLink(res.data);\n      this.setState({\n        sharedUploadInfo: sharedUploadInfo,\n        isEditingExpiration: false,\n      });\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  deleteUploadLink = () => {\n    let sharedUploadInfo = this.state.sharedUploadInfo;\n    seafileAPI.deleteUploadLink(sharedUploadInfo.token).then(() => {\n      this.setState({\n        showPasswordInput: shareLinkForceUsePassword ? true : false,\n        expireDays: this.defaultExpireDays,\n        expDate: null,\n        isExpireChecked: !this.isExpireDaysNoLimit,\n        password: '',\n        passwordnew: '',\n        sharedUploadInfo: null,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  toggleSendLink = () => {\n    this.setState({\n      isSendLinkShown: !this.state.isSendLinkShown\n    });\n  };\n\n  render() {\n\n    const { isSendLinkShown } = this.state;\n\n    let passwordLengthTip = gettext('(at least {passwordMinLength} characters and includes {passwordStrengthLevel} of the following: number, upper letter, lower letter and other symbols)');\n    passwordLengthTip = passwordLengthTip.replace('{passwordMinLength}', shareLinkPasswordMinLength)\n      .replace('{passwordStrengthLevel}', shareLinkPasswordStrengthLevel);\n\n    if (this.state.sharedUploadInfo) {\n      let sharedUploadInfo = this.state.sharedUploadInfo;\n      return (\n        <div>\n          <Form className=\"mb-4\">\n            <FormGroup>\n              <dt className=\"text-secondary font-weight-normal\">{gettext('Upload Link:')}</dt>\n              <dd>\n                <SharedLink\n                  link={sharedUploadInfo.link}\n                  linkExpired={sharedUploadInfo.is_expired}\n                  copyLink={this.onCopyUploadLink}\n                />\n              </dd>\n            </FormGroup>\n\n            {sharedUploadInfo.password && (\n              <FormGroup className=\"mb-0\">\n                <dt className=\"text-secondary font-weight-normal\">{gettext('Password:')}</dt>\n                <dd className=\"d-flex\">\n                  <div className=\"d-flex align-items-center\">\n                    <input id=\"stored-password\" className=\"border-0 mr-1\" type=\"text\" value={this.state.storedPasswordVisible ? sharedUploadInfo.password : '****************************************'} readOnly={true} size={Math.max(sharedUploadInfo.password.length, 10)} />\n                    <span tabIndex=\"0\" role=\"button\" aria-label={this.state.storedPasswordVisible ? gettext('Hide') : gettext('Show')} onKeyDown={this.onIconKeyDown} onClick={this.toggleStoredPasswordVisible} className={`eye-icon fas ${this.state.storedPasswordVisible ? 'fa-eye' : 'fa-eye-slash'}`}></span>\n                  </div>\n                </dd>\n              </FormGroup>\n            )}\n\n            {sharedUploadInfo.expire_date && (\n              <FormGroup className=\"mb-0\">\n                <dt className=\"text-secondary font-weight-normal\">{gettext('Expiration Date:')}</dt>\n                {!this.state.isEditingExpiration &&\n                  <dd style={{ width: '250px' }} onMouseEnter={this.handleMouseOverExpirationEditIcon} onMouseLeave={this.handleMouseOutExpirationEditIcon}>\n                    {moment(sharedUploadInfo.expire_date).format('YYYY-MM-DD HH:mm:ss')}\n                    {this.state.isExpirationEditIconShow && (\n                      <a href=\"#\"\n                        role=\"button\"\n                        aria-label={gettext('Edit')}\n                        title={gettext('Edit')}\n                        className=\"fa fa-pencil-alt attr-action-icon\"\n                        onClick={EvalProFunc(this.editExpirationToggle)}>\n                      </a>\n                    )}\n                  </dd>\n                }\n                {this.state.isEditingExpiration &&\n                  <div className=\"ml-4\">\n                    <SetLinkExpiration\n                      minDays={uploadLinkExpireDaysMin}\n                      maxDays={uploadLinkExpireDaysMax}\n                      defaultDays={uploadLinkExpireDaysDefault}\n                      expType={this.state.expType}\n                      setExpType={this.setExpType}\n                      expireDays={this.state.expireDays}\n                      onExpireDaysChanged={this.onExpireDaysChanged}\n                      expDate={this.state.expDate}\n                      onExpDateChanged={this.onExpDateChanged}\n                    />\n                    <div className={this.state.expType == 'by-days' ? 'mt-2' : 'mt-3'}>\n                      <button className=\"btn btn-primary mr-2\" onClick={this.updateExpiration}>{gettext('Update')}</button>\n                      <button className=\"btn btn-secondary\" onClick={this.editExpirationToggle}>{gettext('Cancel')}</button>\n                    </div>\n                  </div>\n                }\n              </FormGroup>\n            )}\n          </Form>\n          {canSendShareLinkEmail && !isSendLinkShown && <Button onClick={this.toggleSendLink} className=\"mr-2\">{gettext('Send')}</Button>}\n          {!isSendLinkShown && <Button onClick={this.deleteUploadLink}>{gettext('Delete')}</Button>}\n          {isSendLinkShown &&\n            <SendLink\n              linkType='uploadLink'\n              token={sharedUploadInfo.token}\n              toggleSendLink={this.toggleSendLink}\n              closeShareDialog={this.props.closeShareDialog}\n            />\n          }\n        </div>\n      );\n    }\n    return (\n      <Form className=\"generate-upload-link\">\n        <FormGroup check>\n          <Label check>\n            {shareLinkForceUsePassword ? (\n              <Label check>\n                <Input type=\"checkbox\" checked readOnly disabled />\n                <span>{gettext('Add password protection')}</span>\n              </Label>\n            ) : (\n              <Label check>\n                <Input type=\"checkbox\" onChange={this.addPassword} />\n                <span>{gettext('Add password protection')}</span>\n              </Label>\n            )}\n          </Label>\n          {this.state.showPasswordInput &&\n            <div className=\"ml-4\">\n              <FormGroup>\n                <Label for=\"passwd\">{gettext('Password')}</Label>\n                <span className=\"tip\">{passwordLengthTip}</span>\n                <InputGroup style={{ width: inputWidth }}>\n                  <Input id=\"passwd\" type={this.state.passwordVisible ? 'text' : 'password'} value={this.state.password || ''} onChange={this.inputPassword} />\n                  <InputGroupAddon addonType=\"append\">\n                    <Button onClick={this.togglePasswordVisible}><i className={`link-operation-icon fas ${this.state.passwordVisible ? 'fa-eye' : 'fa-eye-slash'}`}></i></Button>\n                    <Button onClick={this.generatePassword}><i className=\"link-operation-icon fas fa-magic\"></i></Button>\n                  </InputGroupAddon>\n                </InputGroup>\n              </FormGroup>\n              <FormGroup>\n                <Label for=\"passwd-again\">{gettext('Password again')}</Label>\n                <Input id=\"passwd-again\" style={{ width: inputWidth }} type={this.state.passwordVisible ? 'text' : 'password'} value={this.state.passwordnew || ''} onChange={this.inputPasswordNew} />\n              </FormGroup>\n            </div>\n          }\n        </FormGroup>\n        <FormGroup check>\n          <Label check>\n            {this.isExpireDaysNoLimit ? (\n              <Input type=\"checkbox\" onChange={this.onExpireChecked} />\n            ) : (\n              <Input type=\"checkbox\" checked readOnly disabled />\n            )}\n            <span>{gettext('Add auto expiration')}</span>\n          </Label>\n          {this.state.isExpireChecked &&\n            <div className=\"ml-4\">\n              <SetLinkExpiration\n                minDays={uploadLinkExpireDaysMin}\n                maxDays={uploadLinkExpireDaysMax}\n                defaultDays={uploadLinkExpireDaysDefault}\n                expType={this.state.expType}\n                setExpType={this.setExpType}\n                expireDays={this.state.expireDays}\n                onExpireDaysChanged={this.onExpireDaysChanged}\n                expDate={this.state.expDate}\n                onExpDateChanged={this.onExpDateChanged}\n              />\n            </div>\n          }\n        </FormGroup>\n        {this.state.errorInfo && <Alert color=\"danger\" className=\"mt-2\">{this.state.errorInfo}</Alert>}\n        <Button className=\"generate-link-btn\" onClick={EvalQuotaUploadLinks(this.generateUploadLink)}>{gettext('Generate')}</Button>\n      </Form>\n    );\n  }\n}\n\nGenerateUploadLink.propTypes = propTypes;\n\nexport default GenerateUploadLink;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}