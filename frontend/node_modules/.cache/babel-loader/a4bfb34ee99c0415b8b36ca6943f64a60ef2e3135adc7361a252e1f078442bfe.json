{"ast":null,"code":"import React, { useCallback } from 'react';\nimport { useCommentContext } from './hooks/comment-hooks/use-comment-context';\nimport { useNotificationContext } from './hooks/notification-hooks';\nimport { EditorComment, GlobalComment } from './components';\nimport { generatorNotificationKey } from './utils';\nimport context from '../../context';\nimport { DOC_NOTIFICATION_REDUCER_TYPE } from './constants';\nvar CommentWrapper = function CommentWrapper(_ref) {\n  var type = _ref.type,\n    editor = _ref.editor;\n  var _useCommentContext = useCommentContext(),\n    commentsInfo = _useCommentContext.commentsInfo;\n  var _useNotificationConte = useNotificationContext(),\n    notificationsInfo = _useNotificationConte.notificationsInfo,\n    notificationDispatch = _useNotificationConte.dispatch;\n  var deleteUnseenNotifications = useCallback(function (comment) {\n    var unseenCommentIds = [];\n    var unseenNotificationKeys = [];\n    var commentNotificationKey = generatorNotificationKey(comment.id);\n    var commentNotification = notificationsInfo.notifications_map[commentNotificationKey];\n    if (commentNotification) {\n      unseenNotificationKeys.push(commentNotification.key);\n      unseenCommentIds.push(commentNotification.id);\n    }\n    Array.isArray(comment.replies) && comment.replies.forEach(function (reply) {\n      var replyNotificationKey = generatorNotificationKey(reply.comment_id, reply.id);\n      var replyNotification = notificationsInfo.notifications_map[replyNotificationKey];\n      if (replyNotification) {\n        unseenNotificationKeys.push(replyNotification.key);\n        unseenCommentIds.push(replyNotification.id);\n      }\n    });\n    context.deleteUnseenNotifications(unseenCommentIds).then(function (res) {\n      notificationDispatch({\n        type: DOC_NOTIFICATION_REDUCER_TYPE.DEL,\n        payload: unseenNotificationKeys\n      });\n    }).catch(function (error) {\n      //\n    });\n  }, [notificationDispatch, notificationsInfo.notifications_map]);\n  var _context$getSettings = context.getSettings('isFreezed'),\n    isFreezed = _context$getSettings.isFreezed;\n  if (commentsInfo.isFetching) return null;\n  return /*#__PURE__*/React.createElement(React.Fragment, null, type === 'editor' && !isFreezed && /*#__PURE__*/React.createElement(EditorComment, {\n    deleteUnseenNotifications: deleteUnseenNotifications,\n    editor: editor\n  }), type === 'global' && /*#__PURE__*/React.createElement(GlobalComment, {\n    deleteUnseenNotifications: deleteUnseenNotifications,\n    editor: editor\n  }));\n};\nexport default CommentWrapper;","map":{"version":3,"names":["React","useCallback","useCommentContext","useNotificationContext","EditorComment","GlobalComment","generatorNotificationKey","context","DOC_NOTIFICATION_REDUCER_TYPE","CommentWrapper","_ref","type","editor","_useCommentContext","commentsInfo","_useNotificationConte","notificationsInfo","notificationDispatch","dispatch","deleteUnseenNotifications","comment","unseenCommentIds","unseenNotificationKeys","commentNotificationKey","id","commentNotification","notifications_map","push","key","Array","isArray","replies","forEach","reply","replyNotificationKey","comment_id","replyNotification","then","res","DEL","payload","catch","error","_context$getSettings","getSettings","isFreezed","isFetching","createElement","Fragment"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/comment/index.js"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { useCommentContext } from './hooks/comment-hooks/use-comment-context';\nimport { useNotificationContext } from './hooks/notification-hooks';\nimport { EditorComment, GlobalComment } from './components';\nimport { generatorNotificationKey } from './utils';\nimport context from '../../context';\nimport { DOC_NOTIFICATION_REDUCER_TYPE } from './constants';\nconst CommentWrapper = _ref => {\n  let {\n    type,\n    editor\n  } = _ref;\n  const {\n    commentsInfo\n  } = useCommentContext();\n  const {\n    notificationsInfo,\n    dispatch: notificationDispatch\n  } = useNotificationContext();\n  const deleteUnseenNotifications = useCallback(comment => {\n    let unseenCommentIds = [];\n    let unseenNotificationKeys = [];\n    const commentNotificationKey = generatorNotificationKey(comment.id);\n    const commentNotification = notificationsInfo.notifications_map[commentNotificationKey];\n    if (commentNotification) {\n      unseenNotificationKeys.push(commentNotification.key);\n      unseenCommentIds.push(commentNotification.id);\n    }\n    Array.isArray(comment.replies) && comment.replies.forEach(reply => {\n      const replyNotificationKey = generatorNotificationKey(reply.comment_id, reply.id);\n      const replyNotification = notificationsInfo.notifications_map[replyNotificationKey];\n      if (replyNotification) {\n        unseenNotificationKeys.push(replyNotification.key);\n        unseenCommentIds.push(replyNotification.id);\n      }\n    });\n    context.deleteUnseenNotifications(unseenCommentIds).then(res => {\n      notificationDispatch({\n        type: DOC_NOTIFICATION_REDUCER_TYPE.DEL,\n        payload: unseenNotificationKeys\n      });\n    }).catch(error => {\n      //\n    });\n  }, [notificationDispatch, notificationsInfo.notifications_map]);\n  const {\n    isFreezed\n  } = context.getSettings('isFreezed');\n  if (commentsInfo.isFetching) return null;\n  return /*#__PURE__*/React.createElement(React.Fragment, null, type === 'editor' && !isFreezed && /*#__PURE__*/React.createElement(EditorComment, {\n    deleteUnseenNotifications: deleteUnseenNotifications,\n    editor: editor\n  }), type === 'global' && /*#__PURE__*/React.createElement(GlobalComment, {\n    deleteUnseenNotifications: deleteUnseenNotifications,\n    editor: editor\n  }));\n};\nexport default CommentWrapper;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}