{"ast":null,"code":"import _regeneratorRuntime from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport React from 'react';\nimport { withTranslation } from 'react-i18next';\nimport { SDocViewer } from '../basic-sdk';\nimport context from '../context';\nimport Loading from '../components/loading';\nimport Layout, { Header, Content } from '../layout';\nimport { generateDefaultDocContent, isMobile } from '../utils';\nimport ErrorBoundary from './error-boundary';\nimport '../assets/css/simple-viewer.css';\nvar SimpleViewer = /*#__PURE__*/function (_React$Component) {\n  _inherits(SimpleViewer, _React$Component);\n  var _super = _createSuper(SimpleViewer);\n  function SimpleViewer(props) {\n    var _this;\n    _classCallCheck(this, SimpleViewer);\n    _this = _super.call(this, props);\n    _this.state = {\n      isContextInit: false,\n      errorMessage: null,\n      document: null\n    };\n    _this.config = null;\n    return _this;\n  }\n  _createClass(SimpleViewer, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var contentRes, result;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              context.initApi();\n              _context.prev = 1;\n              _context.next = 4;\n              return context.getFileContent();\n            case 4:\n              contentRes = _context.sent;\n              result = contentRes.data || generateDefaultDocContent();\n              if (result && !result.children) {\n                result = {\n                  version: 0,\n                  children: result.content\n                };\n              }\n              this.setState({\n                isContextInit: true,\n                document: result\n              });\n              _context.next = 14;\n              break;\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](1);\n              // eslint-disable-next-line\n              console.log(_context.t0);\n              this.setState({\n                isContextInit: true,\n                errorMessage: 'Load_doc_content_error',\n                document: null\n              });\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[1, 10]]);\n      }));\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n        isContextInit = _this$state.isContextInit,\n        errorMessage = _this$state.errorMessage,\n        document = _this$state.document;\n      var t = this.props.t;\n      if (!isContextInit) {\n        return /*#__PURE__*/React.createElement(Loading, null);\n      }\n      if (errorMessage) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: \"d-flex justify-content-center\"\n        }, t(errorMessage));\n      }\n      var _context$getSettings = context.getSettings(),\n        docName = _context$getSettings.docName,\n        sharePermissionText = _context$getSettings.sharePermissionText,\n        downloadURL = _context$getSettings.downloadURL;\n      if (isMobile) {\n        return /*#__PURE__*/React.createElement(ErrorBoundary, null, /*#__PURE__*/React.createElement(Layout, null, /*#__PURE__*/React.createElement(Header, null, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"doc-info\"\n        }, /*#__PURE__*/React.createElement(\"h2\", {\n          className: \"doc-name my-0\"\n        }, docName), sharePermissionText && /*#__PURE__*/React.createElement(\"span\", {\n          className: \"sdoc-share-permission ml-2\"\n        }, sharePermissionText)), /*#__PURE__*/React.createElement(\"div\", {\n          className: \"doc-ops\"\n        }, downloadURL && /*#__PURE__*/React.createElement(\"a\", {\n          href: downloadURL,\n          className: \"op-item\"\n        }, /*#__PURE__*/React.createElement(\"i\", {\n          className: \"sdocfont sdoc-download\"\n        })))), /*#__PURE__*/React.createElement(Content, null, /*#__PURE__*/React.createElement(SDocViewer, {\n          document: document,\n          showToolbar: false,\n          showOutline: false,\n          showComment: false\n        }))));\n      }\n      return /*#__PURE__*/React.createElement(ErrorBoundary, null, /*#__PURE__*/React.createElement(Layout, null, /*#__PURE__*/React.createElement(Header, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"doc-info\"\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        className: \"doc-name my-0\"\n      }, docName), sharePermissionText && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"sdoc-share-permission ml-2\"\n      }, sharePermissionText)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"doc-ops\"\n      }, downloadURL && /*#__PURE__*/React.createElement(\"a\", {\n        href: downloadURL,\n        className: \"op-item\"\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"sdocfont sdoc-download\"\n      })))), /*#__PURE__*/React.createElement(Content, null, /*#__PURE__*/React.createElement(SDocViewer, {\n        document: document,\n        showToolbar: true,\n        showOutline: true,\n        showComment: false\n      }))));\n    }\n  }]);\n  return SimpleViewer;\n}(React.Component);\nexport default withTranslation('sdoc-editor')(SimpleViewer);","map":{"version":3,"names":["React","withTranslation","SDocViewer","context","Loading","Layout","Header","Content","generateDefaultDocContent","isMobile","ErrorBoundary","SimpleViewer","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","state","isContextInit","errorMessage","document","config","_createClass","key","value","_componentDidMount","_asyncToGenerator","_regeneratorRuntime","mark","_callee","contentRes","result","wrap","_callee$","_context","prev","next","initApi","getFileContent","sent","data","children","version","content","setState","t0","console","log","stop","componentDidMount","apply","arguments","render","_this$state","t","createElement","className","_context$getSettings","getSettings","docName","sharePermissionText","downloadURL","href","showToolbar","showOutline","showComment","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/pages/simple-viewer.js"],"sourcesContent":["import React from 'react';\nimport { withTranslation } from 'react-i18next';\nimport { SDocViewer } from '../basic-sdk';\nimport context from '../context';\nimport Loading from '../components/loading';\nimport Layout, { Header, Content } from '../layout';\nimport { generateDefaultDocContent, isMobile } from '../utils';\nimport ErrorBoundary from './error-boundary';\nimport '../assets/css/simple-viewer.css';\nclass SimpleViewer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isContextInit: false,\n      errorMessage: null,\n      document: null\n    };\n    this.config = null;\n  }\n  async componentDidMount() {\n    context.initApi();\n    try {\n      const contentRes = await context.getFileContent();\n      let result = contentRes.data || generateDefaultDocContent();\n      if (result && !result.children) {\n        result = {\n          version: 0,\n          children: result.content\n        };\n      }\n      this.setState({\n        isContextInit: true,\n        document: result\n      });\n    } catch (err) {\n      // eslint-disable-next-line\n      console.log(err);\n      this.setState({\n        isContextInit: true,\n        errorMessage: 'Load_doc_content_error',\n        document: null\n      });\n    }\n  }\n  render() {\n    const {\n      isContextInit,\n      errorMessage,\n      document\n    } = this.state;\n    const {\n      t\n    } = this.props;\n    if (!isContextInit) {\n      return /*#__PURE__*/React.createElement(Loading, null);\n    }\n    if (errorMessage) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-center\"\n      }, t(errorMessage));\n    }\n    const {\n      docName,\n      sharePermissionText,\n      downloadURL\n    } = context.getSettings();\n    if (isMobile) {\n      return /*#__PURE__*/React.createElement(ErrorBoundary, null, /*#__PURE__*/React.createElement(Layout, null, /*#__PURE__*/React.createElement(Header, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"doc-info\"\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        className: \"doc-name my-0\"\n      }, docName), sharePermissionText && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"sdoc-share-permission ml-2\"\n      }, sharePermissionText)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"doc-ops\"\n      }, downloadURL && /*#__PURE__*/React.createElement(\"a\", {\n        href: downloadURL,\n        className: \"op-item\"\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"sdocfont sdoc-download\"\n      })))), /*#__PURE__*/React.createElement(Content, null, /*#__PURE__*/React.createElement(SDocViewer, {\n        document: document,\n        showToolbar: false,\n        showOutline: false,\n        showComment: false\n      }))));\n    }\n    return /*#__PURE__*/React.createElement(ErrorBoundary, null, /*#__PURE__*/React.createElement(Layout, null, /*#__PURE__*/React.createElement(Header, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"doc-info\"\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      className: \"doc-name my-0\"\n    }, docName), sharePermissionText && /*#__PURE__*/React.createElement(\"span\", {\n      className: \"sdoc-share-permission ml-2\"\n    }, sharePermissionText)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"doc-ops\"\n    }, downloadURL && /*#__PURE__*/React.createElement(\"a\", {\n      href: downloadURL,\n      className: \"op-item\"\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"sdocfont sdoc-download\"\n    })))), /*#__PURE__*/React.createElement(Content, null, /*#__PURE__*/React.createElement(SDocViewer, {\n      document: document,\n      showToolbar: true,\n      showOutline: true,\n      showComment: false\n    }))));\n  }\n}\nexport default withTranslation('sdoc-editor')(SimpleViewer);"],"mappings":";;;;;;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,eAAe,QAAQ,eAAe;AAC/C,SAASC,UAAU,QAAQ,cAAc;AACzC,OAAOC,OAAO,MAAM,YAAY;AAChC,OAAOC,OAAO,MAAM,uBAAuB;AAC3C,OAAOC,MAAM,IAAIC,MAAM,EAAEC,OAAO,QAAQ,WAAW;AACnD,SAASC,yBAAyB,EAAEC,QAAQ,QAAQ,UAAU;AAC9D,OAAOC,aAAa,MAAM,kBAAkB;AAC5C,OAAO,iCAAiC;AAAC,IACnCC,YAAY,0BAAAC,gBAAA;EAAAC,SAAA,CAAAF,YAAA,EAAAC,gBAAA;EAAA,IAAAE,MAAA,GAAAC,YAAA,CAAAJ,YAAA;EAChB,SAAAA,aAAYK,KAAK,EAAE;IAAA,IAAAC,KAAA;IAAAC,eAAA,OAAAP,YAAA;IACjBM,KAAA,GAAAH,MAAA,CAAAK,IAAA,OAAMH,KAAK;IACXC,KAAA,CAAKG,KAAK,GAAG;MACXC,aAAa,EAAE,KAAK;MACpBC,YAAY,EAAE,IAAI;MAClBC,QAAQ,EAAE;IACZ,CAAC;IACDN,KAAA,CAAKO,MAAM,GAAG,IAAI;IAAC,OAAAP,KAAA;EACrB;EAACQ,YAAA,CAAAd,YAAA;IAAAe,GAAA;IAAAC,KAAA;MAAA,IAAAC,kBAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CACD,SAAAC,QAAA;QAAA,IAAAC,UAAA,EAAAC,MAAA;QAAA,OAAAJ,mBAAA,GAAAK,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cACEpC,OAAO,CAACqC,OAAO,CAAC,CAAC;cAACH,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAE,IAAA;cAAA,OAESpC,OAAO,CAACsC,cAAc,CAAC,CAAC;YAAA;cAA3CR,UAAU,GAAAI,QAAA,CAAAK,IAAA;cACZR,MAAM,GAAGD,UAAU,CAACU,IAAI,IAAInC,yBAAyB,CAAC,CAAC;cAC3D,IAAI0B,MAAM,IAAI,CAACA,MAAM,CAACU,QAAQ,EAAE;gBAC9BV,MAAM,GAAG;kBACPW,OAAO,EAAE,CAAC;kBACVD,QAAQ,EAAEV,MAAM,CAACY;gBACnB,CAAC;cACH;cACA,IAAI,CAACC,QAAQ,CAAC;gBACZ1B,aAAa,EAAE,IAAI;gBACnBE,QAAQ,EAAEW;cACZ,CAAC,CAAC;cAACG,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAW,EAAA,GAAAX,QAAA;cAEH;cACAY,OAAO,CAACC,GAAG,CAAAb,QAAA,CAAAW,EAAI,CAAC;cAChB,IAAI,CAACD,QAAQ,CAAC;gBACZ1B,aAAa,EAAE,IAAI;gBACnBC,YAAY,EAAE,wBAAwB;gBACtCC,QAAQ,EAAE;cACZ,CAAC,CAAC;YAAC;YAAA;cAAA,OAAAc,QAAA,CAAAc,IAAA;UAAA;QAAA,GAAAnB,OAAA;MAAA,CAEN;MAAA,SAAAoB,kBAAA;QAAA,OAAAxB,kBAAA,CAAAyB,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAAF,iBAAA;IAAA;EAAA;IAAA1B,GAAA;IAAAC,KAAA,EACD,SAAA4B,OAAA,EAAS;MACP,IAAAC,WAAA,GAII,IAAI,CAACpC,KAAK;QAHZC,aAAa,GAAAmC,WAAA,CAAbnC,aAAa;QACbC,YAAY,GAAAkC,WAAA,CAAZlC,YAAY;QACZC,QAAQ,GAAAiC,WAAA,CAARjC,QAAQ;MAEV,IACEkC,CAAC,GACC,IAAI,CAACzC,KAAK,CADZyC,CAAC;MAEH,IAAI,CAACpC,aAAa,EAAE;QAClB,OAAO,aAAarB,KAAK,CAAC0D,aAAa,CAACtD,OAAO,EAAE,IAAI,CAAC;MACxD;MACA,IAAIkB,YAAY,EAAE;QAChB,OAAO,aAAatB,KAAK,CAAC0D,aAAa,CAAC,KAAK,EAAE;UAC7CC,SAAS,EAAE;QACb,CAAC,EAAEF,CAAC,CAACnC,YAAY,CAAC,CAAC;MACrB;MACA,IAAAsC,oBAAA,GAIIzD,OAAO,CAAC0D,WAAW,CAAC,CAAC;QAHvBC,OAAO,GAAAF,oBAAA,CAAPE,OAAO;QACPC,mBAAmB,GAAAH,oBAAA,CAAnBG,mBAAmB;QACnBC,WAAW,GAAAJ,oBAAA,CAAXI,WAAW;MAEb,IAAIvD,QAAQ,EAAE;QACZ,OAAO,aAAaT,KAAK,CAAC0D,aAAa,CAAChD,aAAa,EAAE,IAAI,EAAE,aAAaV,KAAK,CAAC0D,aAAa,CAACrD,MAAM,EAAE,IAAI,EAAE,aAAaL,KAAK,CAAC0D,aAAa,CAACpD,MAAM,EAAE,IAAI,EAAE,aAAaN,KAAK,CAAC0D,aAAa,CAAC,KAAK,EAAE;UACjMC,SAAS,EAAE;QACb,CAAC,EAAE,aAAa3D,KAAK,CAAC0D,aAAa,CAAC,IAAI,EAAE;UACxCC,SAAS,EAAE;QACb,CAAC,EAAEG,OAAO,CAAC,EAAEC,mBAAmB,IAAI,aAAa/D,KAAK,CAAC0D,aAAa,CAAC,MAAM,EAAE;UAC3EC,SAAS,EAAE;QACb,CAAC,EAAEI,mBAAmB,CAAC,CAAC,EAAE,aAAa/D,KAAK,CAAC0D,aAAa,CAAC,KAAK,EAAE;UAChEC,SAAS,EAAE;QACb,CAAC,EAAEK,WAAW,IAAI,aAAahE,KAAK,CAAC0D,aAAa,CAAC,GAAG,EAAE;UACtDO,IAAI,EAAED,WAAW;UACjBL,SAAS,EAAE;QACb,CAAC,EAAE,aAAa3D,KAAK,CAAC0D,aAAa,CAAC,GAAG,EAAE;UACvCC,SAAS,EAAE;QACb,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,aAAa3D,KAAK,CAAC0D,aAAa,CAACnD,OAAO,EAAE,IAAI,EAAE,aAAaP,KAAK,CAAC0D,aAAa,CAACxD,UAAU,EAAE;UAClGqB,QAAQ,EAAEA,QAAQ;UAClB2C,WAAW,EAAE,KAAK;UAClBC,WAAW,EAAE,KAAK;UAClBC,WAAW,EAAE;QACf,CAAC,CAAC,CAAC,CAAC,CAAC;MACP;MACA,OAAO,aAAapE,KAAK,CAAC0D,aAAa,CAAChD,aAAa,EAAE,IAAI,EAAE,aAAaV,KAAK,CAAC0D,aAAa,CAACrD,MAAM,EAAE,IAAI,EAAE,aAAaL,KAAK,CAAC0D,aAAa,CAACpD,MAAM,EAAE,IAAI,EAAE,aAAaN,KAAK,CAAC0D,aAAa,CAAC,KAAK,EAAE;QACjMC,SAAS,EAAE;MACb,CAAC,EAAE,aAAa3D,KAAK,CAAC0D,aAAa,CAAC,IAAI,EAAE;QACxCC,SAAS,EAAE;MACb,CAAC,EAAEG,OAAO,CAAC,EAAEC,mBAAmB,IAAI,aAAa/D,KAAK,CAAC0D,aAAa,CAAC,MAAM,EAAE;QAC3EC,SAAS,EAAE;MACb,CAAC,EAAEI,mBAAmB,CAAC,CAAC,EAAE,aAAa/D,KAAK,CAAC0D,aAAa,CAAC,KAAK,EAAE;QAChEC,SAAS,EAAE;MACb,CAAC,EAAEK,WAAW,IAAI,aAAahE,KAAK,CAAC0D,aAAa,CAAC,GAAG,EAAE;QACtDO,IAAI,EAAED,WAAW;QACjBL,SAAS,EAAE;MACb,CAAC,EAAE,aAAa3D,KAAK,CAAC0D,aAAa,CAAC,GAAG,EAAE;QACvCC,SAAS,EAAE;MACb,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,aAAa3D,KAAK,CAAC0D,aAAa,CAACnD,OAAO,EAAE,IAAI,EAAE,aAAaP,KAAK,CAAC0D,aAAa,CAACxD,UAAU,EAAE;QAClGqB,QAAQ,EAAEA,QAAQ;QAClB2C,WAAW,EAAE,IAAI;QACjBC,WAAW,EAAE,IAAI;QACjBC,WAAW,EAAE;MACf,CAAC,CAAC,CAAC,CAAC,CAAC;IACP;EAAC;EAAA,OAAAzD,YAAA;AAAA,EAjGwBX,KAAK,CAACqE,SAAS;AAmG1C,eAAepE,eAAe,CAAC,aAAa,CAAC,CAACU,YAAY,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}