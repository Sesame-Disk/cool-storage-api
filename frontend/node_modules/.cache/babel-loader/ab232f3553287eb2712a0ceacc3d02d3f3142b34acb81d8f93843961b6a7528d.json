{"ast":null,"code":"import _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport React, { useState, useCallback, useRef, useEffect } from 'react';\nimport { ReactEditor, useSelected, useReadOnly } from '@seafile/slate-react';\nimport { Transforms, Editor } from '@seafile/slate';\nimport classNames from 'classnames';\nimport { withTranslation } from 'react-i18next';\nimport { getImageURL, handleBase64Image, selectImageWhenSelectPartial, updateImage } from './helpers';\nimport EventBus from '../../../utils/event-bus';\nimport { INTERNAL_EVENT } from '../../../constants';\nimport ImageHoverMenu from './hover-menu';\nimport { useScrollContext } from '../../../hooks/use-scroll-context';\nimport { IMAGE_BORDER_TYPE } from './constants';\nimport { ADDED_STYLE, DELETED_STYLE, IMAGE_BLOCK } from '../../constants';\nimport imagePlaceholder from '../../../assets/images/image-placeholder.png';\nvar Image = function Image(_ref) {\n  var _imageRef$current, _imageRef$current2;\n  var element = _ref.element,\n    editor = _ref.editor,\n    style = _ref.style,\n    className = _ref.className,\n    attributes = _ref.attributes,\n    children = _ref.children,\n    isSelected = _ref.isSelected,\n    t = _ref.t;\n  var data = element.data,\n    _element$border_type = element.border_type,\n    border_type = _element$border_type === void 0 ? IMAGE_BORDER_TYPE[0].type : _element$border_type;\n  var _data$show_caption = data.show_caption,\n    show_caption = _data$show_caption === void 0 ? false : _data$show_caption;\n  var path = ReactEditor.findPath(editor, element);\n  var nodeEntry = Editor.node(editor, [path[0]]);\n  var imageStyle = {\n    border: IMAGE_BORDER_TYPE.find(function (item) {\n      return item.type === border_type;\n    }).value\n  };\n  var readOnly = useReadOnly();\n  var imageRef = useRef(null);\n  var resizerRef = useRef(null);\n  var imageCaptionInputRef = useRef(null);\n  var scrollRef = useScrollContext();\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    movingWidth = _useState2[0],\n    setMovingWidth = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    isResizing = _useState4[0],\n    setIsResizing = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    isShowImagePlaceholder = _useState6[0],\n    setIsShowImagePlaceholder = _useState6[1];\n  var _useState7 = useState(false),\n    _useState8 = _slicedToArray(_useState7, 2),\n    isShowImageHoverMenu = _useState8[0],\n    setIsShowImageHoverMenu = _useState8[1];\n  var _useState9 = useState({}),\n    _useState10 = _slicedToArray(_useState9, 2),\n    menuPosition = _useState10[0],\n    setMenuPosition = _useState10[1];\n  var _useState11 = useState((data === null || data === void 0 ? void 0 : data.caption) || ''),\n    _useState12 = _slicedToArray(_useState11, 2),\n    caption = _useState12[0],\n    setCaption = _useState12[1];\n  var registerEvent = useCallback(function (eventList) {\n    eventList.forEach(function (element) {\n      document.addEventListener(element.eventName, element.event);\n    });\n  }, []);\n  var unregisterEvent = useCallback(function (eventList) {\n    eventList.forEach(function (element) {\n      document.removeEventListener(element.eventName, element.event);\n    });\n  }, []);\n  var onMouseMove = useCallback(function (event) {\n    var _resizerRef$current;\n    event.preventDefault();\n    event.stopPropagation();\n    var changeX = event.clientX - ((_resizerRef$current = resizerRef.current) === null || _resizerRef$current === void 0 ? void 0 : _resizerRef$current.getBoundingClientRect().left) - 5;\n    var imageWidth = imageRef.current.width + changeX;\n    if (imageWidth < 20) return;\n    imageRef.current.width = imageWidth;\n    setMovingWidth(imageWidth);\n  }, []);\n  var onResizeEnd = useCallback(function (event) {\n    event.preventDefault();\n    event.stopPropagation();\n    unregisterEvent([{\n      'eventName': 'mousemove',\n      'event': onMouseMove\n    }, {\n      'eventName': 'mouseup',\n      'event': onResizeEnd\n    }]);\n    var newData = _objectSpread(_objectSpread({}, element.data), {}, {\n      width: imageRef.current.width\n    });\n    updateImage(editor, newData);\n\n    // Reset hover menu position\n    setTimeout(function () {\n      setIsResizing(false);\n      setIsShowImageHoverMenu(true);\n      setPosition();\n    }, 100);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [editor, element.data, imageRef.current]);\n  var onResizeStart = useCallback(function (event) {\n    event.preventDefault();\n    event.stopPropagation();\n    setIsShowImageHoverMenu(false);\n    setIsResizing(true);\n    registerEvent([{\n      'eventName': 'mousemove',\n      'event': onMouseMove\n    }, {\n      'eventName': 'mouseup',\n      'event': onResizeEnd\n    }]);\n  }, [onMouseMove, onResizeEnd, registerEvent]);\n  var getImageStyle = useCallback(function () {\n    var imageWidth = element.data.width || '';\n    if (movingWidth) imageWidth = movingWidth;\n    return {\n      width: imageWidth\n    };\n  }, [element.data, movingWidth]);\n  var onScroll = useCallback(function () {\n    setPosition();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  var onHideImageHoverMenu = useCallback(function (e) {\n    var _imagePreviewer$;\n    if (isResizing) return;\n    var imagePreviewer = document.getElementsByClassName('sf-editor-image-previewer');\n    var isCaptionInput = e.target.id === 'sdoc-image-caption-input';\n    if (e.target === imageRef.current || ((_imagePreviewer$ = imagePreviewer[0]) === null || _imagePreviewer$ === void 0 ? void 0 : _imagePreviewer$.contains(e.target)) || isCaptionInput) return;\n    setIsShowImageHoverMenu(false);\n  }, [isResizing]);\n  useEffect(function () {\n    var observerRefValue = null;\n    if (isShowImageHoverMenu) {\n      registerEvent([{\n        'eventName': 'click',\n        'event': onHideImageHoverMenu\n      }]);\n      scrollRef.current && scrollRef.current.addEventListener('scroll', onScroll);\n      observerRefValue = scrollRef.current;\n    } else {\n      unregisterEvent([{\n        'eventName': 'click',\n        'event': onHideImageHoverMenu\n      }]);\n      scrollRef.current && scrollRef.current.removeEventListener('scroll', onScroll);\n    }\n    return function () {\n      unregisterEvent([{\n        'eventName': 'click',\n        'event': onHideImageHoverMenu\n      }]);\n      if (observerRefValue) {\n        observerRefValue.removeEventListener('scroll', onScroll);\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isShowImageHoverMenu, onHideImageHoverMenu]);\n  var setPosition = useCallback(function () {\n    if (imageRef.current) {\n      var _imageRef$current$get = imageRef.current.getBoundingClientRect(),\n        top = _imageRef$current$get.top,\n        left = _imageRef$current$get.left;\n      setMenuPosition({\n        top: top - 42,\n        left: left - 3\n      });\n    }\n  }, []);\n  var onClickImage = useCallback(function (e) {\n    setPosition();\n    setIsShowImageHoverMenu(true);\n  }, [setPosition]);\n  var reloadImage = useCallback(function () {\n    if (imageRef.current) {\n      imageRef.current['src'] = getImageURL(data.src);\n    }\n  }, [data.src]);\n  var onImageLoadError = useCallback(function () {\n    // Check is due to the image is pasted from the clipboard in base64\n    if (data.src.startsWith('data:image/jpeg;base64')) {\n      return handleBase64Image(editor, path, data);\n    }\n    setIsShowImagePlaceholder(true);\n    // External network images do not reload after failure to load\n    if (!data.src.startsWith('http')) {\n      var eventBus = EventBus.getInstance();\n      eventBus.subscribe(INTERNAL_EVENT.RELOAD_IMAGE, reloadImage);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  var onSetCaption = useCallback(function (e) {\n    var path = ReactEditor.findPath(editor, element);\n    var newData = _objectSpread(_objectSpread({}, data), {}, {\n      caption: e.target.value.trim()\n    });\n    if (path) {\n      Transforms.setNodes(editor, {\n        data: newData\n      }, {\n        at: path\n      });\n    }\n  }, [data, editor, element]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, isShowImagePlaceholder && /*#__PURE__*/React.createElement(\"span\", Object.assign({\n    className: classNames('sdoc-image-wrapper', className)\n  }, attributes, {\n    style: _objectSpread({}, style),\n    onMouseOver: function onMouseOver(e) {\n      return selectImageWhenSelectPartial(e, editor, element, isSelected);\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    ref: imageRef,\n    src: imagePlaceholder,\n    style: getImageStyle(),\n    draggable: false,\n    alt: \"\"\n  }), children), !isShowImagePlaceholder && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"span\", Object.assign({\n    \"data-id\": element.id,\n    className: classNames('sdoc-image-wrapper', className)\n  }, attributes, {\n    style: _objectSpread({}, style),\n    onMouseOver: function onMouseOver(e) {\n      return selectImageWhenSelectPartial(e, editor, element, isSelected);\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"sdoc-image-inner\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"sdoc-image-content\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    style: imageStyle\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: classNames({\n      'image-selected': isSelected\n    }),\n    onClick: onClickImage,\n    ref: imageRef,\n    src: getImageURL(data.src),\n    style: getImageStyle(),\n    draggable: false,\n    onError: onImageLoadError,\n    alt: \"\"\n  }), isSelected && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"image-resizer\",\n    ref: resizerRef,\n    onMouseDown: onResizeStart\n  }), isResizing && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"image-size\",\n    contentEditable: false\n  }, /*#__PURE__*/React.createElement(\"span\", null, t('Width'), ':', parseInt(movingWidth || ((_imageRef$current = imageRef.current) === null || _imageRef$current === void 0 ? void 0 : _imageRef$current.clientWidth))), /*#__PURE__*/React.createElement(\"span\", null, \"\\xA0\\xA0\"), /*#__PURE__*/React.createElement(\"span\", null, t('Height'), ':', imageRef.current.clientHeight))), nodeEntry[0].type === IMAGE_BLOCK && show_caption && /*#__PURE__*/React.createElement(\"input\", {\n    id: \"sdoc-image-caption-input\",\n    ref: imageCaptionInputRef,\n    className: \"sdoc-image-caption-input-wrapper\",\n    style: {\n      width: (data === null || data === void 0 ? void 0 : data.width) || ((_imageRef$current2 = imageRef.current) === null || _imageRef$current2 === void 0 ? void 0 : _imageRef$current2.clientWidth)\n    },\n    placeholder: t('Insert_caption'),\n    autoComplete: \"off\",\n    value: caption,\n    onBlur: onSetCaption,\n    onChange: function onChange(e) {\n      setCaption(e.target.value);\n    },\n    onCompositionStart: function onCompositionStart(e) {\n      e.stopPropagation();\n    }\n  }))), children), isShowImageHoverMenu && /*#__PURE__*/React.createElement(ImageHoverMenu, {\n    editor: editor,\n    menuPosition: menuPosition,\n    element: element,\n    parentNodeEntry: nodeEntry,\n    imageCaptionInputRef: imageCaptionInputRef,\n    readonly: readOnly,\n    onHideImageHoverMenu: function onHideImageHoverMenu() {\n      setIsShowImageHoverMenu(false);\n    }\n  })));\n};\nvar SdocImage = withTranslation('sdoc-editor')(Image);\nexport function renderImage(props, editor) {\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  var isSelected = useSelected();\n\n  // decorate diff-viewer\n  var element = props.element,\n    leaf = props.leaf;\n  var style = _objectSpread({}, props.style);\n  if (leaf && leaf.computed_background_color) {\n    style['backgroundColor'] = leaf.computed_background_color;\n  }\n  if (element.add || element.delete) {\n    style = Object.assign({}, style, element.add ? ADDED_STYLE : DELETED_STYLE);\n    if (style.computed_background_color) {\n      style['backgroundColor'] = style.computed_background_color;\n    }\n  }\n  return /*#__PURE__*/React.createElement(SdocImage, Object.assign({}, props, {\n    style: style,\n    editor: editor,\n    isSelected: isSelected\n  }));\n}\nexport function renderImageBlock(props, editor) {\n  var element = props.element,\n    children = props.children,\n    attributes = props.attributes;\n  var align = element.align;\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  var isSelected = useSelected();\n  var justifyContent = '';\n  if (align) {\n    justifyContent = align === 'left' ? 'start' : align === 'right' ? 'end' : align;\n  }\n  return /*#__PURE__*/React.createElement(\"div\", Object.assign({\n    className: \"sdoc-image-block-wrapper\",\n    style: {\n      display: 'flex',\n      padding: '5px 0px',\n      justifyContent: \"\".concat(justifyContent)\n    }\n  }, attributes, {\n    onMouseOver: function onMouseOver(e) {\n      return selectImageWhenSelectPartial(e, editor, element, isSelected);\n    }\n  }), children);\n}","map":{"version":3,"names":["_objectSpread","React","useState","useCallback","useRef","useEffect","ReactEditor","useSelected","useReadOnly","Transforms","Editor","classNames","withTranslation","getImageURL","handleBase64Image","selectImageWhenSelectPartial","updateImage","EventBus","INTERNAL_EVENT","ImageHoverMenu","useScrollContext","IMAGE_BORDER_TYPE","ADDED_STYLE","DELETED_STYLE","IMAGE_BLOCK","imagePlaceholder","Image","_ref","_imageRef$current","_imageRef$current2","element","editor","style","className","attributes","children","isSelected","t","data","_element$border_type","border_type","type","_data$show_caption","show_caption","path","findPath","nodeEntry","node","imageStyle","border","find","item","value","readOnly","imageRef","resizerRef","imageCaptionInputRef","scrollRef","_useState","_useState2","_slicedToArray","movingWidth","setMovingWidth","_useState3","_useState4","isResizing","setIsResizing","_useState5","_useState6","isShowImagePlaceholder","setIsShowImagePlaceholder","_useState7","_useState8","isShowImageHoverMenu","setIsShowImageHoverMenu","_useState9","_useState10","menuPosition","setMenuPosition","_useState11","caption","_useState12","setCaption","registerEvent","eventList","forEach","document","addEventListener","eventName","event","unregisterEvent","removeEventListener","onMouseMove","_resizerRef$current","preventDefault","stopPropagation","changeX","clientX","current","getBoundingClientRect","left","imageWidth","width","onResizeEnd","newData","setTimeout","setPosition","onResizeStart","getImageStyle","onScroll","onHideImageHoverMenu","e","_imagePreviewer$","imagePreviewer","getElementsByClassName","isCaptionInput","target","id","contains","observerRefValue","_imageRef$current$get","top","onClickImage","reloadImage","src","onImageLoadError","startsWith","eventBus","getInstance","subscribe","RELOAD_IMAGE","onSetCaption","trim","setNodes","at","createElement","Fragment","Object","assign","onMouseOver","ref","draggable","alt","onClick","onError","onMouseDown","contentEditable","parseInt","clientWidth","clientHeight","placeholder","autoComplete","onBlur","onChange","onCompositionStart","parentNodeEntry","readonly","SdocImage","renderImage","props","leaf","computed_background_color","add","delete","renderImageBlock","align","justifyContent","display","padding","concat"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/plugins/image/render-elem.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport React, { useState, useCallback, useRef, useEffect } from 'react';\nimport { ReactEditor, useSelected, useReadOnly } from '@seafile/slate-react';\nimport { Transforms, Editor } from '@seafile/slate';\nimport classNames from 'classnames';\nimport { withTranslation } from 'react-i18next';\nimport { getImageURL, handleBase64Image, selectImageWhenSelectPartial, updateImage } from './helpers';\nimport EventBus from '../../../utils/event-bus';\nimport { INTERNAL_EVENT } from '../../../constants';\nimport ImageHoverMenu from './hover-menu';\nimport { useScrollContext } from '../../../hooks/use-scroll-context';\nimport { IMAGE_BORDER_TYPE } from './constants';\nimport { ADDED_STYLE, DELETED_STYLE, IMAGE_BLOCK } from '../../constants';\nimport imagePlaceholder from '../../../assets/images/image-placeholder.png';\nconst Image = _ref => {\n  var _imageRef$current, _imageRef$current2;\n  let {\n    element,\n    editor,\n    style,\n    className,\n    attributes,\n    children,\n    isSelected,\n    t\n  } = _ref;\n  const {\n    data,\n    border_type = IMAGE_BORDER_TYPE[0].type\n  } = element;\n  const {\n    show_caption = false\n  } = data;\n  const path = ReactEditor.findPath(editor, element);\n  const nodeEntry = Editor.node(editor, [path[0]]);\n  const imageStyle = {\n    border: IMAGE_BORDER_TYPE.find(item => item.type === border_type).value\n  };\n  const readOnly = useReadOnly();\n  const imageRef = useRef(null);\n  const resizerRef = useRef(null);\n  const imageCaptionInputRef = useRef(null);\n  const scrollRef = useScrollContext();\n  const [movingWidth, setMovingWidth] = useState(null);\n  const [isResizing, setIsResizing] = useState(false);\n  const [isShowImagePlaceholder, setIsShowImagePlaceholder] = useState(false);\n  const [isShowImageHoverMenu, setIsShowImageHoverMenu] = useState(false);\n  const [menuPosition, setMenuPosition] = useState({});\n  const [caption, setCaption] = useState((data === null || data === void 0 ? void 0 : data.caption) || '');\n  const registerEvent = useCallback(eventList => {\n    eventList.forEach(element => {\n      document.addEventListener(element.eventName, element.event);\n    });\n  }, []);\n  const unregisterEvent = useCallback(eventList => {\n    eventList.forEach(element => {\n      document.removeEventListener(element.eventName, element.event);\n    });\n  }, []);\n  const onMouseMove = useCallback(event => {\n    var _resizerRef$current;\n    event.preventDefault();\n    event.stopPropagation();\n    const changeX = event.clientX - ((_resizerRef$current = resizerRef.current) === null || _resizerRef$current === void 0 ? void 0 : _resizerRef$current.getBoundingClientRect().left) - 5;\n    const imageWidth = imageRef.current.width + changeX;\n    if (imageWidth < 20) return;\n    imageRef.current.width = imageWidth;\n    setMovingWidth(imageWidth);\n  }, []);\n  const onResizeEnd = useCallback(event => {\n    event.preventDefault();\n    event.stopPropagation();\n    unregisterEvent([{\n      'eventName': 'mousemove',\n      'event': onMouseMove\n    }, {\n      'eventName': 'mouseup',\n      'event': onResizeEnd\n    }]);\n    const newData = _objectSpread(_objectSpread({}, element.data), {}, {\n      width: imageRef.current.width\n    });\n    updateImage(editor, newData);\n\n    // Reset hover menu position\n    setTimeout(() => {\n      setIsResizing(false);\n      setIsShowImageHoverMenu(true);\n      setPosition();\n    }, 100);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [editor, element.data, imageRef.current]);\n  const onResizeStart = useCallback(event => {\n    event.preventDefault();\n    event.stopPropagation();\n    setIsShowImageHoverMenu(false);\n    setIsResizing(true);\n    registerEvent([{\n      'eventName': 'mousemove',\n      'event': onMouseMove\n    }, {\n      'eventName': 'mouseup',\n      'event': onResizeEnd\n    }]);\n  }, [onMouseMove, onResizeEnd, registerEvent]);\n  const getImageStyle = useCallback(() => {\n    let imageWidth = element.data.width || '';\n    if (movingWidth) imageWidth = movingWidth;\n    return {\n      width: imageWidth\n    };\n  }, [element.data, movingWidth]);\n  const onScroll = useCallback(() => {\n    setPosition();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const onHideImageHoverMenu = useCallback(e => {\n    var _imagePreviewer$;\n    if (isResizing) return;\n    const imagePreviewer = document.getElementsByClassName('sf-editor-image-previewer');\n    const isCaptionInput = e.target.id === 'sdoc-image-caption-input';\n    if (e.target === imageRef.current || ((_imagePreviewer$ = imagePreviewer[0]) === null || _imagePreviewer$ === void 0 ? void 0 : _imagePreviewer$.contains(e.target)) || isCaptionInput) return;\n    setIsShowImageHoverMenu(false);\n  }, [isResizing]);\n  useEffect(() => {\n    let observerRefValue = null;\n    if (isShowImageHoverMenu) {\n      registerEvent([{\n        'eventName': 'click',\n        'event': onHideImageHoverMenu\n      }]);\n      scrollRef.current && scrollRef.current.addEventListener('scroll', onScroll);\n      observerRefValue = scrollRef.current;\n    } else {\n      unregisterEvent([{\n        'eventName': 'click',\n        'event': onHideImageHoverMenu\n      }]);\n      scrollRef.current && scrollRef.current.removeEventListener('scroll', onScroll);\n    }\n    return () => {\n      unregisterEvent([{\n        'eventName': 'click',\n        'event': onHideImageHoverMenu\n      }]);\n      if (observerRefValue) {\n        observerRefValue.removeEventListener('scroll', onScroll);\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isShowImageHoverMenu, onHideImageHoverMenu]);\n  const setPosition = useCallback(() => {\n    if (imageRef.current) {\n      const {\n        top,\n        left\n      } = imageRef.current.getBoundingClientRect();\n      setMenuPosition({\n        top: top - 42,\n        left: left - 3\n      });\n    }\n  }, []);\n  const onClickImage = useCallback(e => {\n    setPosition();\n    setIsShowImageHoverMenu(true);\n  }, [setPosition]);\n  const reloadImage = useCallback(() => {\n    if (imageRef.current) {\n      imageRef.current['src'] = getImageURL(data.src);\n    }\n  }, [data.src]);\n  const onImageLoadError = useCallback(() => {\n    // Check is due to the image is pasted from the clipboard in base64\n    if (data.src.startsWith('data:image/jpeg;base64')) {\n      return handleBase64Image(editor, path, data);\n    }\n    setIsShowImagePlaceholder(true);\n    // External network images do not reload after failure to load\n    if (!data.src.startsWith('http')) {\n      const eventBus = EventBus.getInstance();\n      eventBus.subscribe(INTERNAL_EVENT.RELOAD_IMAGE, reloadImage);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const onSetCaption = useCallback(e => {\n    const path = ReactEditor.findPath(editor, element);\n    const newData = _objectSpread(_objectSpread({}, data), {}, {\n      caption: e.target.value.trim()\n    });\n    if (path) {\n      Transforms.setNodes(editor, {\n        data: newData\n      }, {\n        at: path\n      });\n    }\n  }, [data, editor, element]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, isShowImagePlaceholder && /*#__PURE__*/React.createElement(\"span\", Object.assign({\n    className: classNames('sdoc-image-wrapper', className)\n  }, attributes, {\n    style: _objectSpread({}, style),\n    onMouseOver: e => selectImageWhenSelectPartial(e, editor, element, isSelected)\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    ref: imageRef,\n    src: imagePlaceholder,\n    style: getImageStyle(),\n    draggable: false,\n    alt: \"\"\n  }), children), !isShowImagePlaceholder && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"span\", Object.assign({\n    \"data-id\": element.id,\n    className: classNames('sdoc-image-wrapper', className)\n  }, attributes, {\n    style: _objectSpread({}, style),\n    onMouseOver: e => selectImageWhenSelectPartial(e, editor, element, isSelected)\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"sdoc-image-inner\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"sdoc-image-content\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    style: imageStyle\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: classNames({\n      'image-selected': isSelected\n    }),\n    onClick: onClickImage,\n    ref: imageRef,\n    src: getImageURL(data.src),\n    style: getImageStyle(),\n    draggable: false,\n    onError: onImageLoadError,\n    alt: \"\"\n  }), isSelected && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"image-resizer\",\n    ref: resizerRef,\n    onMouseDown: onResizeStart\n  }), isResizing && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"image-size\",\n    contentEditable: false\n  }, /*#__PURE__*/React.createElement(\"span\", null, t('Width'), ':', parseInt(movingWidth || ((_imageRef$current = imageRef.current) === null || _imageRef$current === void 0 ? void 0 : _imageRef$current.clientWidth))), /*#__PURE__*/React.createElement(\"span\", null, \"\\xA0\\xA0\"), /*#__PURE__*/React.createElement(\"span\", null, t('Height'), ':', imageRef.current.clientHeight))), nodeEntry[0].type === IMAGE_BLOCK && show_caption && /*#__PURE__*/React.createElement(\"input\", {\n    id: \"sdoc-image-caption-input\",\n    ref: imageCaptionInputRef,\n    className: \"sdoc-image-caption-input-wrapper\",\n    style: {\n      width: (data === null || data === void 0 ? void 0 : data.width) || ((_imageRef$current2 = imageRef.current) === null || _imageRef$current2 === void 0 ? void 0 : _imageRef$current2.clientWidth)\n    },\n    placeholder: t('Insert_caption'),\n    autoComplete: \"off\",\n    value: caption,\n    onBlur: onSetCaption,\n    onChange: e => {\n      setCaption(e.target.value);\n    },\n    onCompositionStart: e => {\n      e.stopPropagation();\n    }\n  }))), children), isShowImageHoverMenu && /*#__PURE__*/React.createElement(ImageHoverMenu, {\n    editor: editor,\n    menuPosition: menuPosition,\n    element: element,\n    parentNodeEntry: nodeEntry,\n    imageCaptionInputRef: imageCaptionInputRef,\n    readonly: readOnly,\n    onHideImageHoverMenu: () => {\n      setIsShowImageHoverMenu(false);\n    }\n  })));\n};\nconst SdocImage = withTranslation('sdoc-editor')(Image);\nexport function renderImage(props, editor) {\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  const isSelected = useSelected();\n\n  // decorate diff-viewer\n  const {\n    element,\n    leaf\n  } = props;\n  let style = _objectSpread({}, props.style);\n  if (leaf && leaf.computed_background_color) {\n    style['backgroundColor'] = leaf.computed_background_color;\n  }\n  if (element.add || element.delete) {\n    style = Object.assign({}, style, element.add ? ADDED_STYLE : DELETED_STYLE);\n    if (style.computed_background_color) {\n      style['backgroundColor'] = style.computed_background_color;\n    }\n  }\n  return /*#__PURE__*/React.createElement(SdocImage, Object.assign({}, props, {\n    style: style,\n    editor: editor,\n    isSelected: isSelected\n  }));\n}\nexport function renderImageBlock(props, editor) {\n  const {\n    element,\n    children,\n    attributes\n  } = props;\n  const {\n    align\n  } = element;\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  const isSelected = useSelected();\n  let justifyContent = '';\n  if (align) {\n    justifyContent = align === 'left' ? 'start' : align === 'right' ? 'end' : align;\n  }\n  return /*#__PURE__*/React.createElement(\"div\", Object.assign({\n    className: \"sdoc-image-block-wrapper\",\n    style: {\n      display: 'flex',\n      padding: '5px 0px',\n      justifyContent: \"\".concat(justifyContent)\n    }\n  }, attributes, {\n    onMouseOver: e => selectImageWhenSelectPartial(e, editor, element, isSelected)\n  }), children);\n}"],"mappings":";AAAA,OAAOA,aAAa,MAAM,0CAA0C;AACpE,OAAOC,KAAK,IAAIC,QAAQ,EAAEC,WAAW,EAAEC,MAAM,EAAEC,SAAS,QAAQ,OAAO;AACvE,SAASC,WAAW,EAAEC,WAAW,EAAEC,WAAW,QAAQ,sBAAsB;AAC5E,SAASC,UAAU,EAAEC,MAAM,QAAQ,gBAAgB;AACnD,OAAOC,UAAU,MAAM,YAAY;AACnC,SAASC,eAAe,QAAQ,eAAe;AAC/C,SAASC,WAAW,EAAEC,iBAAiB,EAAEC,4BAA4B,EAAEC,WAAW,QAAQ,WAAW;AACrG,OAAOC,QAAQ,MAAM,0BAA0B;AAC/C,SAASC,cAAc,QAAQ,oBAAoB;AACnD,OAAOC,cAAc,MAAM,cAAc;AACzC,SAASC,gBAAgB,QAAQ,mCAAmC;AACpE,SAASC,iBAAiB,QAAQ,aAAa;AAC/C,SAASC,WAAW,EAAEC,aAAa,EAAEC,WAAW,QAAQ,iBAAiB;AACzE,OAAOC,gBAAgB,MAAM,8CAA8C;AAC3E,IAAMC,KAAK,GAAG,SAARA,KAAKA,CAAGC,IAAI,EAAI;EACpB,IAAIC,iBAAiB,EAAEC,kBAAkB;EACzC,IACEC,OAAO,GAQLH,IAAI,CARNG,OAAO;IACPC,MAAM,GAOJJ,IAAI,CAPNI,MAAM;IACNC,KAAK,GAMHL,IAAI,CANNK,KAAK;IACLC,SAAS,GAKPN,IAAI,CALNM,SAAS;IACTC,UAAU,GAIRP,IAAI,CAJNO,UAAU;IACVC,QAAQ,GAGNR,IAAI,CAHNQ,QAAQ;IACRC,UAAU,GAERT,IAAI,CAFNS,UAAU;IACVC,CAAC,GACCV,IAAI,CADNU,CAAC;EAEH,IACEC,IAAI,GAEFR,OAAO,CAFTQ,IAAI;IAAAC,oBAAA,GAEFT,OAAO,CADTU,WAAW;IAAXA,WAAW,GAAAD,oBAAA,cAAGlB,iBAAiB,CAAC,CAAC,CAAC,CAACoB,IAAI,GAAAF,oBAAA;EAEzC,IAAAG,kBAAA,GAEIJ,IAAI,CADNK,YAAY;IAAZA,YAAY,GAAAD,kBAAA,cAAG,KAAK,GAAAA,kBAAA;EAEtB,IAAME,IAAI,GAAGtC,WAAW,CAACuC,QAAQ,CAACd,MAAM,EAAED,OAAO,CAAC;EAClD,IAAMgB,SAAS,GAAGpC,MAAM,CAACqC,IAAI,CAAChB,MAAM,EAAE,CAACa,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;EAChD,IAAMI,UAAU,GAAG;IACjBC,MAAM,EAAE5B,iBAAiB,CAAC6B,IAAI,CAAC,UAAAC,IAAI;MAAA,OAAIA,IAAI,CAACV,IAAI,KAAKD,WAAW;IAAA,EAAC,CAACY;EACpE,CAAC;EACD,IAAMC,QAAQ,GAAG7C,WAAW,CAAC,CAAC;EAC9B,IAAM8C,QAAQ,GAAGlD,MAAM,CAAC,IAAI,CAAC;EAC7B,IAAMmD,UAAU,GAAGnD,MAAM,CAAC,IAAI,CAAC;EAC/B,IAAMoD,oBAAoB,GAAGpD,MAAM,CAAC,IAAI,CAAC;EACzC,IAAMqD,SAAS,GAAGrC,gBAAgB,CAAC,CAAC;EACpC,IAAAsC,SAAA,GAAsCxD,QAAQ,CAAC,IAAI,CAAC;IAAAyD,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAA7CG,WAAW,GAAAF,UAAA;IAAEG,cAAc,GAAAH,UAAA;EAClC,IAAAI,UAAA,GAAoC7D,QAAQ,CAAC,KAAK,CAAC;IAAA8D,UAAA,GAAAJ,cAAA,CAAAG,UAAA;IAA5CE,UAAU,GAAAD,UAAA;IAAEE,aAAa,GAAAF,UAAA;EAChC,IAAAG,UAAA,GAA4DjE,QAAQ,CAAC,KAAK,CAAC;IAAAkE,UAAA,GAAAR,cAAA,CAAAO,UAAA;IAApEE,sBAAsB,GAAAD,UAAA;IAAEE,yBAAyB,GAAAF,UAAA;EACxD,IAAAG,UAAA,GAAwDrE,QAAQ,CAAC,KAAK,CAAC;IAAAsE,UAAA,GAAAZ,cAAA,CAAAW,UAAA;IAAhEE,oBAAoB,GAAAD,UAAA;IAAEE,uBAAuB,GAAAF,UAAA;EACpD,IAAAG,UAAA,GAAwCzE,QAAQ,CAAC,CAAC,CAAC,CAAC;IAAA0E,WAAA,GAAAhB,cAAA,CAAAe,UAAA;IAA7CE,YAAY,GAAAD,WAAA;IAAEE,eAAe,GAAAF,WAAA;EACpC,IAAAG,WAAA,GAA8B7E,QAAQ,CAAC,CAACoC,IAAI,KAAK,IAAI,IAAIA,IAAI,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,IAAI,CAAC0C,OAAO,KAAK,EAAE,CAAC;IAAAC,WAAA,GAAArB,cAAA,CAAAmB,WAAA;IAAjGC,OAAO,GAAAC,WAAA;IAAEC,UAAU,GAAAD,WAAA;EAC1B,IAAME,aAAa,GAAGhF,WAAW,CAAC,UAAAiF,SAAS,EAAI;IAC7CA,SAAS,CAACC,OAAO,CAAC,UAAAvD,OAAO,EAAI;MAC3BwD,QAAQ,CAACC,gBAAgB,CAACzD,OAAO,CAAC0D,SAAS,EAAE1D,OAAO,CAAC2D,KAAK,CAAC;IAC7D,CAAC,CAAC;EACJ,CAAC,EAAE,EAAE,CAAC;EACN,IAAMC,eAAe,GAAGvF,WAAW,CAAC,UAAAiF,SAAS,EAAI;IAC/CA,SAAS,CAACC,OAAO,CAAC,UAAAvD,OAAO,EAAI;MAC3BwD,QAAQ,CAACK,mBAAmB,CAAC7D,OAAO,CAAC0D,SAAS,EAAE1D,OAAO,CAAC2D,KAAK,CAAC;IAChE,CAAC,CAAC;EACJ,CAAC,EAAE,EAAE,CAAC;EACN,IAAMG,WAAW,GAAGzF,WAAW,CAAC,UAAAsF,KAAK,EAAI;IACvC,IAAII,mBAAmB;IACvBJ,KAAK,CAACK,cAAc,CAAC,CAAC;IACtBL,KAAK,CAACM,eAAe,CAAC,CAAC;IACvB,IAAMC,OAAO,GAAGP,KAAK,CAACQ,OAAO,IAAI,CAACJ,mBAAmB,GAAGtC,UAAU,CAAC2C,OAAO,MAAM,IAAI,IAAIL,mBAAmB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,mBAAmB,CAACM,qBAAqB,CAAC,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;IACvL,IAAMC,UAAU,GAAG/C,QAAQ,CAAC4C,OAAO,CAACI,KAAK,GAAGN,OAAO;IACnD,IAAIK,UAAU,GAAG,EAAE,EAAE;IACrB/C,QAAQ,CAAC4C,OAAO,CAACI,KAAK,GAAGD,UAAU;IACnCvC,cAAc,CAACuC,UAAU,CAAC;EAC5B,CAAC,EAAE,EAAE,CAAC;EACN,IAAME,WAAW,GAAGpG,WAAW,CAAC,UAAAsF,KAAK,EAAI;IACvCA,KAAK,CAACK,cAAc,CAAC,CAAC;IACtBL,KAAK,CAACM,eAAe,CAAC,CAAC;IACvBL,eAAe,CAAC,CAAC;MACf,WAAW,EAAE,WAAW;MACxB,OAAO,EAAEE;IACX,CAAC,EAAE;MACD,WAAW,EAAE,SAAS;MACtB,OAAO,EAAEW;IACX,CAAC,CAAC,CAAC;IACH,IAAMC,OAAO,GAAGxG,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,EAAE8B,OAAO,CAACQ,IAAI,CAAC,EAAE,CAAC,CAAC,EAAE;MACjEgE,KAAK,EAAEhD,QAAQ,CAAC4C,OAAO,CAACI;IAC1B,CAAC,CAAC;IACFtF,WAAW,CAACe,MAAM,EAAEyE,OAAO,CAAC;;IAE5B;IACAC,UAAU,CAAC,YAAM;MACfvC,aAAa,CAAC,KAAK,CAAC;MACpBQ,uBAAuB,CAAC,IAAI,CAAC;MAC7BgC,WAAW,CAAC,CAAC;IACf,CAAC,EAAE,GAAG,CAAC;IACP;EACF,CAAC,EAAE,CAAC3E,MAAM,EAAED,OAAO,CAACQ,IAAI,EAAEgB,QAAQ,CAAC4C,OAAO,CAAC,CAAC;EAC5C,IAAMS,aAAa,GAAGxG,WAAW,CAAC,UAAAsF,KAAK,EAAI;IACzCA,KAAK,CAACK,cAAc,CAAC,CAAC;IACtBL,KAAK,CAACM,eAAe,CAAC,CAAC;IACvBrB,uBAAuB,CAAC,KAAK,CAAC;IAC9BR,aAAa,CAAC,IAAI,CAAC;IACnBiB,aAAa,CAAC,CAAC;MACb,WAAW,EAAE,WAAW;MACxB,OAAO,EAAES;IACX,CAAC,EAAE;MACD,WAAW,EAAE,SAAS;MACtB,OAAO,EAAEW;IACX,CAAC,CAAC,CAAC;EACL,CAAC,EAAE,CAACX,WAAW,EAAEW,WAAW,EAAEpB,aAAa,CAAC,CAAC;EAC7C,IAAMyB,aAAa,GAAGzG,WAAW,CAAC,YAAM;IACtC,IAAIkG,UAAU,GAAGvE,OAAO,CAACQ,IAAI,CAACgE,KAAK,IAAI,EAAE;IACzC,IAAIzC,WAAW,EAAEwC,UAAU,GAAGxC,WAAW;IACzC,OAAO;MACLyC,KAAK,EAAED;IACT,CAAC;EACH,CAAC,EAAE,CAACvE,OAAO,CAACQ,IAAI,EAAEuB,WAAW,CAAC,CAAC;EAC/B,IAAMgD,QAAQ,GAAG1G,WAAW,CAAC,YAAM;IACjCuG,WAAW,CAAC,CAAC;IACb;EACF,CAAC,EAAE,EAAE,CAAC;EACN,IAAMI,oBAAoB,GAAG3G,WAAW,CAAC,UAAA4G,CAAC,EAAI;IAC5C,IAAIC,gBAAgB;IACpB,IAAI/C,UAAU,EAAE;IAChB,IAAMgD,cAAc,GAAG3B,QAAQ,CAAC4B,sBAAsB,CAAC,2BAA2B,CAAC;IACnF,IAAMC,cAAc,GAAGJ,CAAC,CAACK,MAAM,CAACC,EAAE,KAAK,0BAA0B;IACjE,IAAIN,CAAC,CAACK,MAAM,KAAK9D,QAAQ,CAAC4C,OAAO,KAAK,CAACc,gBAAgB,GAAGC,cAAc,CAAC,CAAC,CAAC,MAAM,IAAI,IAAID,gBAAgB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,gBAAgB,CAACM,QAAQ,CAACP,CAAC,CAACK,MAAM,CAAC,CAAC,IAAID,cAAc,EAAE;IACxLzC,uBAAuB,CAAC,KAAK,CAAC;EAChC,CAAC,EAAE,CAACT,UAAU,CAAC,CAAC;EAChB5D,SAAS,CAAC,YAAM;IACd,IAAIkH,gBAAgB,GAAG,IAAI;IAC3B,IAAI9C,oBAAoB,EAAE;MACxBU,aAAa,CAAC,CAAC;QACb,WAAW,EAAE,OAAO;QACpB,OAAO,EAAE2B;MACX,CAAC,CAAC,CAAC;MACHrD,SAAS,CAACyC,OAAO,IAAIzC,SAAS,CAACyC,OAAO,CAACX,gBAAgB,CAAC,QAAQ,EAAEsB,QAAQ,CAAC;MAC3EU,gBAAgB,GAAG9D,SAAS,CAACyC,OAAO;IACtC,CAAC,MAAM;MACLR,eAAe,CAAC,CAAC;QACf,WAAW,EAAE,OAAO;QACpB,OAAO,EAAEoB;MACX,CAAC,CAAC,CAAC;MACHrD,SAAS,CAACyC,OAAO,IAAIzC,SAAS,CAACyC,OAAO,CAACP,mBAAmB,CAAC,QAAQ,EAAEkB,QAAQ,CAAC;IAChF;IACA,OAAO,YAAM;MACXnB,eAAe,CAAC,CAAC;QACf,WAAW,EAAE,OAAO;QACpB,OAAO,EAAEoB;MACX,CAAC,CAAC,CAAC;MACH,IAAIS,gBAAgB,EAAE;QACpBA,gBAAgB,CAAC5B,mBAAmB,CAAC,QAAQ,EAAEkB,QAAQ,CAAC;MAC1D;IACF,CAAC;IACD;EACF,CAAC,EAAE,CAACpC,oBAAoB,EAAEqC,oBAAoB,CAAC,CAAC;EAChD,IAAMJ,WAAW,GAAGvG,WAAW,CAAC,YAAM;IACpC,IAAImD,QAAQ,CAAC4C,OAAO,EAAE;MACpB,IAAAsB,qBAAA,GAGIlE,QAAQ,CAAC4C,OAAO,CAACC,qBAAqB,CAAC,CAAC;QAF1CsB,GAAG,GAAAD,qBAAA,CAAHC,GAAG;QACHrB,IAAI,GAAAoB,qBAAA,CAAJpB,IAAI;MAENtB,eAAe,CAAC;QACd2C,GAAG,EAAEA,GAAG,GAAG,EAAE;QACbrB,IAAI,EAAEA,IAAI,GAAG;MACf,CAAC,CAAC;IACJ;EACF,CAAC,EAAE,EAAE,CAAC;EACN,IAAMsB,YAAY,GAAGvH,WAAW,CAAC,UAAA4G,CAAC,EAAI;IACpCL,WAAW,CAAC,CAAC;IACbhC,uBAAuB,CAAC,IAAI,CAAC;EAC/B,CAAC,EAAE,CAACgC,WAAW,CAAC,CAAC;EACjB,IAAMiB,WAAW,GAAGxH,WAAW,CAAC,YAAM;IACpC,IAAImD,QAAQ,CAAC4C,OAAO,EAAE;MACpB5C,QAAQ,CAAC4C,OAAO,CAAC,KAAK,CAAC,GAAGrF,WAAW,CAACyB,IAAI,CAACsF,GAAG,CAAC;IACjD;EACF,CAAC,EAAE,CAACtF,IAAI,CAACsF,GAAG,CAAC,CAAC;EACd,IAAMC,gBAAgB,GAAG1H,WAAW,CAAC,YAAM;IACzC;IACA,IAAImC,IAAI,CAACsF,GAAG,CAACE,UAAU,CAAC,wBAAwB,CAAC,EAAE;MACjD,OAAOhH,iBAAiB,CAACiB,MAAM,EAAEa,IAAI,EAAEN,IAAI,CAAC;IAC9C;IACAgC,yBAAyB,CAAC,IAAI,CAAC;IAC/B;IACA,IAAI,CAAChC,IAAI,CAACsF,GAAG,CAACE,UAAU,CAAC,MAAM,CAAC,EAAE;MAChC,IAAMC,QAAQ,GAAG9G,QAAQ,CAAC+G,WAAW,CAAC,CAAC;MACvCD,QAAQ,CAACE,SAAS,CAAC/G,cAAc,CAACgH,YAAY,EAAEP,WAAW,CAAC;IAC9D;IACA;EACF,CAAC,EAAE,EAAE,CAAC;EACN,IAAMQ,YAAY,GAAGhI,WAAW,CAAC,UAAA4G,CAAC,EAAI;IACpC,IAAMnE,IAAI,GAAGtC,WAAW,CAACuC,QAAQ,CAACd,MAAM,EAAED,OAAO,CAAC;IAClD,IAAM0E,OAAO,GAAGxG,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,EAAEsC,IAAI,CAAC,EAAE,CAAC,CAAC,EAAE;MACzD0C,OAAO,EAAE+B,CAAC,CAACK,MAAM,CAAChE,KAAK,CAACgF,IAAI,CAAC;IAC/B,CAAC,CAAC;IACF,IAAIxF,IAAI,EAAE;MACRnC,UAAU,CAAC4H,QAAQ,CAACtG,MAAM,EAAE;QAC1BO,IAAI,EAAEkE;MACR,CAAC,EAAE;QACD8B,EAAE,EAAE1F;MACN,CAAC,CAAC;IACJ;EACF,CAAC,EAAE,CAACN,IAAI,EAAEP,MAAM,EAAED,OAAO,CAAC,CAAC;EAC3B,OAAO,aAAa7B,KAAK,CAACsI,aAAa,CAACtI,KAAK,CAACuI,QAAQ,EAAE,IAAI,EAAEnE,sBAAsB,IAAI,aAAapE,KAAK,CAACsI,aAAa,CAAC,MAAM,EAAEE,MAAM,CAACC,MAAM,CAAC;IAC7IzG,SAAS,EAAEtB,UAAU,CAAC,oBAAoB,EAAEsB,SAAS;EACvD,CAAC,EAAEC,UAAU,EAAE;IACbF,KAAK,EAAEhC,aAAa,CAAC,CAAC,CAAC,EAAEgC,KAAK,CAAC;IAC/B2G,WAAW,EAAE,SAAAA,YAAA5B,CAAC;MAAA,OAAIhG,4BAA4B,CAACgG,CAAC,EAAEhF,MAAM,EAAED,OAAO,EAAEM,UAAU,CAAC;IAAA;EAChF,CAAC,CAAC,EAAE,aAAanC,KAAK,CAACsI,aAAa,CAAC,KAAK,EAAE;IAC1CK,GAAG,EAAEtF,QAAQ;IACbsE,GAAG,EAAEnG,gBAAgB;IACrBO,KAAK,EAAE4E,aAAa,CAAC,CAAC;IACtBiC,SAAS,EAAE,KAAK;IAChBC,GAAG,EAAE;EACP,CAAC,CAAC,EAAE3G,QAAQ,CAAC,EAAE,CAACkC,sBAAsB,IAAI,aAAapE,KAAK,CAACsI,aAAa,CAACtI,KAAK,CAACuI,QAAQ,EAAE,IAAI,EAAE,aAAavI,KAAK,CAACsI,aAAa,CAAC,MAAM,EAAEE,MAAM,CAACC,MAAM,CAAC;IACtJ,SAAS,EAAE5G,OAAO,CAACuF,EAAE;IACrBpF,SAAS,EAAEtB,UAAU,CAAC,oBAAoB,EAAEsB,SAAS;EACvD,CAAC,EAAEC,UAAU,EAAE;IACbF,KAAK,EAAEhC,aAAa,CAAC,CAAC,CAAC,EAAEgC,KAAK,CAAC;IAC/B2G,WAAW,EAAE,SAAAA,YAAA5B,CAAC;MAAA,OAAIhG,4BAA4B,CAACgG,CAAC,EAAEhF,MAAM,EAAED,OAAO,EAAEM,UAAU,CAAC;IAAA;EAChF,CAAC,CAAC,EAAE,aAAanC,KAAK,CAACsI,aAAa,CAAC,MAAM,EAAE;IAC3CtG,SAAS,EAAE;EACb,CAAC,EAAE,aAAahC,KAAK,CAACsI,aAAa,CAAC,MAAM,EAAE;IAC1CtG,SAAS,EAAE;EACb,CAAC,EAAE,aAAahC,KAAK,CAACsI,aAAa,CAAC,MAAM,EAAE;IAC1CvG,KAAK,EAAEgB;EACT,CAAC,EAAE,aAAa/C,KAAK,CAACsI,aAAa,CAAC,KAAK,EAAE;IACzCtG,SAAS,EAAEtB,UAAU,CAAC;MACpB,gBAAgB,EAAEyB;IACpB,CAAC,CAAC;IACF2G,OAAO,EAAErB,YAAY;IACrBkB,GAAG,EAAEtF,QAAQ;IACbsE,GAAG,EAAE/G,WAAW,CAACyB,IAAI,CAACsF,GAAG,CAAC;IAC1B5F,KAAK,EAAE4E,aAAa,CAAC,CAAC;IACtBiC,SAAS,EAAE,KAAK;IAChBG,OAAO,EAAEnB,gBAAgB;IACzBiB,GAAG,EAAE;EACP,CAAC,CAAC,EAAE1G,UAAU,IAAI,aAAanC,KAAK,CAACsI,aAAa,CAAC,MAAM,EAAE;IACzDtG,SAAS,EAAE,eAAe;IAC1B2G,GAAG,EAAErF,UAAU;IACf0F,WAAW,EAAEtC;EACf,CAAC,CAAC,EAAE1C,UAAU,IAAI,aAAahE,KAAK,CAACsI,aAAa,CAAC,MAAM,EAAE;IACzDtG,SAAS,EAAE,YAAY;IACvBiH,eAAe,EAAE;EACnB,CAAC,EAAE,aAAajJ,KAAK,CAACsI,aAAa,CAAC,MAAM,EAAE,IAAI,EAAElG,CAAC,CAAC,OAAO,CAAC,EAAE,GAAG,EAAE8G,QAAQ,CAACtF,WAAW,KAAK,CAACjC,iBAAiB,GAAG0B,QAAQ,CAAC4C,OAAO,MAAM,IAAI,IAAItE,iBAAiB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,iBAAiB,CAACwH,WAAW,CAAC,CAAC,CAAC,EAAE,aAAanJ,KAAK,CAACsI,aAAa,CAAC,MAAM,EAAE,IAAI,EAAE,UAAU,CAAC,EAAE,aAAatI,KAAK,CAACsI,aAAa,CAAC,MAAM,EAAE,IAAI,EAAElG,CAAC,CAAC,QAAQ,CAAC,EAAE,GAAG,EAAEiB,QAAQ,CAAC4C,OAAO,CAACmD,YAAY,CAAC,CAAC,CAAC,EAAEvG,SAAS,CAAC,CAAC,CAAC,CAACL,IAAI,KAAKjB,WAAW,IAAImB,YAAY,IAAI,aAAa1C,KAAK,CAACsI,aAAa,CAAC,OAAO,EAAE;IACrdlB,EAAE,EAAE,0BAA0B;IAC9BuB,GAAG,EAAEpF,oBAAoB;IACzBvB,SAAS,EAAE,kCAAkC;IAC7CD,KAAK,EAAE;MACLsE,KAAK,EAAE,CAAChE,IAAI,KAAK,IAAI,IAAIA,IAAI,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,IAAI,CAACgE,KAAK,MAAM,CAACzE,kBAAkB,GAAGyB,QAAQ,CAAC4C,OAAO,MAAM,IAAI,IAAIrE,kBAAkB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,kBAAkB,CAACuH,WAAW;IACjM,CAAC;IACDE,WAAW,EAAEjH,CAAC,CAAC,gBAAgB,CAAC;IAChCkH,YAAY,EAAE,KAAK;IACnBnG,KAAK,EAAE4B,OAAO;IACdwE,MAAM,EAAErB,YAAY;IACpBsB,QAAQ,EAAE,SAAAA,SAAA1C,CAAC,EAAI;MACb7B,UAAU,CAAC6B,CAAC,CAACK,MAAM,CAAChE,KAAK,CAAC;IAC5B,CAAC;IACDsG,kBAAkB,EAAE,SAAAA,mBAAA3C,CAAC,EAAI;MACvBA,CAAC,CAAChB,eAAe,CAAC,CAAC;IACrB;EACF,CAAC,CAAC,CAAC,CAAC,EAAE5D,QAAQ,CAAC,EAAEsC,oBAAoB,IAAI,aAAaxE,KAAK,CAACsI,aAAa,CAACpH,cAAc,EAAE;IACxFY,MAAM,EAAEA,MAAM;IACd8C,YAAY,EAAEA,YAAY;IAC1B/C,OAAO,EAAEA,OAAO;IAChB6H,eAAe,EAAE7G,SAAS;IAC1BU,oBAAoB,EAAEA,oBAAoB;IAC1CoG,QAAQ,EAAEvG,QAAQ;IAClByD,oBAAoB,EAAE,SAAAA,qBAAA,EAAM;MAC1BpC,uBAAuB,CAAC,KAAK,CAAC;IAChC;EACF,CAAC,CAAC,CAAC,CAAC;AACN,CAAC;AACD,IAAMmF,SAAS,GAAGjJ,eAAe,CAAC,aAAa,CAAC,CAACc,KAAK,CAAC;AACvD,OAAO,SAASoI,WAAWA,CAACC,KAAK,EAAEhI,MAAM,EAAE;EACzC;EACA,IAAMK,UAAU,GAAG7B,WAAW,CAAC,CAAC;;EAEhC;EACA,IACEuB,OAAO,GAELiI,KAAK,CAFPjI,OAAO;IACPkI,IAAI,GACFD,KAAK,CADPC,IAAI;EAEN,IAAIhI,KAAK,GAAGhC,aAAa,CAAC,CAAC,CAAC,EAAE+J,KAAK,CAAC/H,KAAK,CAAC;EAC1C,IAAIgI,IAAI,IAAIA,IAAI,CAACC,yBAAyB,EAAE;IAC1CjI,KAAK,CAAC,iBAAiB,CAAC,GAAGgI,IAAI,CAACC,yBAAyB;EAC3D;EACA,IAAInI,OAAO,CAACoI,GAAG,IAAIpI,OAAO,CAACqI,MAAM,EAAE;IACjCnI,KAAK,GAAGyG,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,EAAE1G,KAAK,EAAEF,OAAO,CAACoI,GAAG,GAAG5I,WAAW,GAAGC,aAAa,CAAC;IAC3E,IAAIS,KAAK,CAACiI,yBAAyB,EAAE;MACnCjI,KAAK,CAAC,iBAAiB,CAAC,GAAGA,KAAK,CAACiI,yBAAyB;IAC5D;EACF;EACA,OAAO,aAAahK,KAAK,CAACsI,aAAa,CAACsB,SAAS,EAAEpB,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,EAAEqB,KAAK,EAAE;IAC1E/H,KAAK,EAAEA,KAAK;IACZD,MAAM,EAAEA,MAAM;IACdK,UAAU,EAAEA;EACd,CAAC,CAAC,CAAC;AACL;AACA,OAAO,SAASgI,gBAAgBA,CAACL,KAAK,EAAEhI,MAAM,EAAE;EAC9C,IACED,OAAO,GAGLiI,KAAK,CAHPjI,OAAO;IACPK,QAAQ,GAEN4H,KAAK,CAFP5H,QAAQ;IACRD,UAAU,GACR6H,KAAK,CADP7H,UAAU;EAEZ,IACEmI,KAAK,GACHvI,OAAO,CADTuI,KAAK;EAEP;EACA,IAAMjI,UAAU,GAAG7B,WAAW,CAAC,CAAC;EAChC,IAAI+J,cAAc,GAAG,EAAE;EACvB,IAAID,KAAK,EAAE;IACTC,cAAc,GAAGD,KAAK,KAAK,MAAM,GAAG,OAAO,GAAGA,KAAK,KAAK,OAAO,GAAG,KAAK,GAAGA,KAAK;EACjF;EACA,OAAO,aAAapK,KAAK,CAACsI,aAAa,CAAC,KAAK,EAAEE,MAAM,CAACC,MAAM,CAAC;IAC3DzG,SAAS,EAAE,0BAA0B;IACrCD,KAAK,EAAE;MACLuI,OAAO,EAAE,MAAM;MACfC,OAAO,EAAE,SAAS;MAClBF,cAAc,EAAE,EAAE,CAACG,MAAM,CAACH,cAAc;IAC1C;EACF,CAAC,EAAEpI,UAAU,EAAE;IACbyG,WAAW,EAAE,SAAAA,YAAA5B,CAAC;MAAA,OAAIhG,4BAA4B,CAACgG,CAAC,EAAEhF,MAAM,EAAED,OAAO,EAAEM,UAAU,CAAC;IAAA;EAChF,CAAC,CAAC,EAAED,QAAQ,CAAC;AACf"},"metadata":{},"sourceType":"module","externalDependencies":[]}