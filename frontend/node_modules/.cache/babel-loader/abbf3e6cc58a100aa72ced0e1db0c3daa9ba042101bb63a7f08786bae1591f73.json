{"ast":null,"code":"import _objectSpread from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component,Fragment}from'react';import{gettext,siteRoot}from'../../utils/constants';import{seafileAPI}from'../../utils/seafile-api';import toaster from'../../components/toast';import moment from'moment';import MainPanelTopbar from'./main-panel-topbar';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AbuseReports=/*#__PURE__*/function(_Component){_inherits(AbuseReports,_Component);var _super=_createSuper(AbuseReports);function AbuseReports(props){var _this;_classCallCheck(this,AbuseReports);_this=_super.call(this,props);_this.listAbuseReports=function(){seafileAPI.sysAdminListAbuseReports().then(function(res){_this.setState({abuseReportList:res.data.abuse_report_list});}).catch(function(error){_this.handleError(error);});};_this.updateAbuseReport=function(handled,abuseReportId){seafileAPI.sysAdminUpdateAbuseReport(handled,abuseReportId).then(function(res){var abuseReportList=_this.state.abuseReportList.map(function(item,index){if(item.id===abuseReportId){item.handled=res.data.handled;}return item;});_this.setState({abuseReportList:abuseReportList});}).catch(function(error){_this.handleError(error);});};_this.handleError=function(e){if(e.response){toaster.danger(e.response.data.error_msg||e.response.data.detail||gettext('Error'),{duration:3});}else{toaster.danger(gettext('Please check the network.'),{duration:3});}};_this.state={abuseReportList:[]};return _this;}_createClass(AbuseReports,[{key:\"componentDidMount\",value:function componentDidMount(){this.listAbuseReports();}},{key:\"render\",value:function render(){var _this2=this;var AbuseReportList=this.state.abuseReportList.map(function(item,index){var handled=(!item.handled).toString();var abuseReportId=item.id;var fileUrl=siteRoot+'lib/'+item.repo_id+'/file'+item.file_path;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:item.repo_name}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"a\",{href:fileUrl,target:\"_blank\",rel:\"noreferrer\",children:item.file_path})}),/*#__PURE__*/_jsx(\"td\",{children:item.reporter}),/*#__PURE__*/_jsx(\"td\",{children:item.abuse_type}),/*#__PURE__*/_jsx(\"td\",{children:item.description}),/*#__PURE__*/_jsx(\"td\",{children:moment(item.time).format('YYYY-MM-DD')}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"p\",{onClick:_this2.updateAbuseReport.bind(_this2,handled,abuseReportId),className:\"op-target ellipsis ellipsis-op-target cursor-pointer\",children:gettext(item.handled.toString())})})]},index);});return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(MainPanelTopbar,_objectSpread({},this.props)),/*#__PURE__*/_jsx(\"div\",{className:\"main-panel-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"cur-view-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cur-view-path\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"sf-heading\",children:gettext('Abuse Reports')})}),/*#__PURE__*/_jsx(\"div\",{className:\"cur-view-content\",children:/*#__PURE__*/_jsxs(\"table\",{className:'table-hover',children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{width:\"20%\",children:gettext('Library')}),/*#__PURE__*/_jsx(\"th\",{width:\"20%\",children:gettext('File')}),/*#__PURE__*/_jsx(\"th\",{width:\"10%\",children:gettext('Reporter')}),/*#__PURE__*/_jsx(\"th\",{width:\"15%\",children:gettext('Abuse Type')}),/*#__PURE__*/_jsx(\"th\",{width:\"20%\",children:gettext('Description')}),/*#__PURE__*/_jsx(\"th\",{width:\"10%\",children:gettext('Time')}),/*#__PURE__*/_jsx(\"th\",{width:\"5%\",children:gettext('Handled')})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:AbuseReportList})]})})]})})]});}}]);return AbuseReports;}(Component);export default AbuseReports;","map":{"version":3,"names":["React","Component","Fragment","gettext","siteRoot","seafileAPI","toaster","moment","MainPanelTopbar","jsx","_jsx","jsxs","_jsxs","AbuseReports","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","listAbuseReports","sysAdminListAbuseReports","then","res","setState","abuseReportList","data","abuse_report_list","catch","error","handleError","updateAbuseReport","handled","abuseReportId","sysAdminUpdateAbuseReport","state","map","item","index","id","e","response","danger","error_msg","detail","duration","_createClass","key","value","componentDidMount","render","_this2","AbuseReportList","toString","fileUrl","repo_id","file_path","children","repo_name","href","target","rel","reporter","abuse_type","description","time","format","onClick","bind","className","_objectSpread","width"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/pages/sys-admin/abuse-reports.js"],"sourcesContent":["import React, { Component, Fragment } from 'react';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport toaster from '../../components/toast';\nimport moment from 'moment';\nimport MainPanelTopbar from './main-panel-topbar';\n\nclass AbuseReports extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      abuseReportList: [],\n    };\n  }\n\n  listAbuseReports = () => {\n    seafileAPI.sysAdminListAbuseReports().then((res) => {\n      this.setState({\n        abuseReportList: res.data.abuse_report_list,\n      });\n    }).catch((error) => {\n      this.handleError(error);\n    });\n  };\n\n  updateAbuseReport = (handled, abuseReportId) => {\n    seafileAPI.sysAdminUpdateAbuseReport(handled, abuseReportId).then((res) => {\n      const abuseReportList = this.state.abuseReportList.map((item, index) => {\n        if (item.id === abuseReportId) {\n          item.handled = res.data.handled;\n        }\n        return item;\n      });\n      this.setState({\n        abuseReportList: abuseReportList,\n      });\n    }).catch((error) => {\n      this.handleError(error);\n    });\n  };\n\n  handleError = (e) => {\n    if (e.response) {\n      toaster.danger(e.response.data.error_msg || e.response.data.detail || gettext('Error'), {duration: 3});\n    } else {\n      toaster.danger(gettext('Please check the network.'), {duration: 3});\n    }\n  };\n\n  componentDidMount() {\n    this.listAbuseReports();\n  }\n\n  render() {\n    const AbuseReportList = this.state.abuseReportList.map((item, index) => {\n      const handled = (!item.handled).toString();\n      const abuseReportId = item.id;\n      const fileUrl = siteRoot + 'lib/' + item.repo_id + '/file' + item.file_path;\n      return (\n        <tr key={index}>\n          <td>{item.repo_name}</td>\n          <td><a href={fileUrl} target=\"_blank\" rel=\"noreferrer\">{item.file_path}</a></td>\n          <td>{item.reporter}</td>\n          <td>{item.abuse_type}</td>\n          <td>{item.description}</td>\n          <td>{moment(item.time).format('YYYY-MM-DD')}</td>\n          <td><p onClick={this.updateAbuseReport.bind(this, handled, abuseReportId)}\n            className=\"op-target ellipsis ellipsis-op-target cursor-pointer\"\n          >{gettext(item.handled.toString())}</p></td>\n        </tr>\n      );\n    });\n\n    return (\n      <Fragment>\n        <MainPanelTopbar {...this.props} />\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading\">{gettext('Abuse Reports')}</h3>\n            </div>\n            <div className=\"cur-view-content\">\n              <table className={'table-hover'}>\n                <thead>\n                  <tr>\n                    <th width=\"20%\">{gettext('Library')}</th>\n                    <th width=\"20%\">{gettext('File')}</th>\n                    <th width=\"10%\">{gettext('Reporter')}</th>\n                    <th width=\"15%\">{gettext('Abuse Type')}</th>\n                    <th width=\"20%\">{gettext('Description')}</th>\n                    <th width=\"10%\">{gettext('Time')}</th>\n                    <th width=\"5%\">{gettext('Handled')}</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {AbuseReportList}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nexport default AbuseReports;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}