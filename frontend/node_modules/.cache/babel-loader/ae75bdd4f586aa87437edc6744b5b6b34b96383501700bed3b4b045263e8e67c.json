{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{Button,Form,FormGroup,Label}from'reactstrap';import{seafileAPI}from'../utils/seafile-api';import{gettext}from'../utils/constants';import{Utils}from'../utils/utils';import toaster from'./toast';import{EvalProFunc}from'../services/ad';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SendLink=/*#__PURE__*/function(_React$Component){_inherits(SendLink,_React$Component);var _super=_createSuper(SendLink);function SendLink(props){var _this;_classCallCheck(this,SendLink);_this=_super.call(this,props);_this.handleEmailsInputChange=function(e){_this.setState({emails:e.target.value});};_this.handleMsgInputChange=function(e){_this.setState({msg:e.target.value});};_this.sendLink=function(){var _this$state=_this.state,emails=_this$state.emails,msg=_this$state.msg;if(!emails.trim()){_this.setState({errorMsg:gettext('Please input at least an email.')});return;}_this.setState({btnDisabled:true,sending:true});var _this$props=_this.props,token=_this$props.token,linkType=_this$props.linkType;var request=linkType=='uploadLink'?seafileAPI.sendUploadLink(token,emails.trim(),msg.trim()):seafileAPI.sendShareLink(token,emails.trim(),msg.trim());request.then(function(res){_this.props.closeShareDialog();var _res$data=res.data,success=_res$data.success,failed=_res$data.failed;if(success.length){var feedbackMsg=gettext('Successfully sent to {placeholder}').replace('{placeholder}',success.join(', '));toaster.success(feedbackMsg);}if(failed.length){failed.forEach(function(item){var feedbackMsg=gettext('Failed to send to {email_placeholder}: {errorMsg_placeholder}').replace('{email_placeholder}',item.email).replace('{errorMsg_placeholder}',item.error_msg);toaster.warning(feedbackMsg);});}}).catch(function(error){var errorMsg=Utils.getErrorMsg(error);_this.setState({btnDisabled:false,sending:false,errorMsg:errorMsg});});};_this.state={emails:'',msg:'',errorMsg:'',btnDisabled:false,sending:false};return _this;}_createClass(SendLink,[{key:\"render\",value:function render(){var _this$state2=this.state,emails=_this$state2.emails,msg=_this$state2.msg,errorMsg=_this$state2.errorMsg,btnDisabled=_this$state2.btnDisabled,sending=_this$state2.sending;return/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"emails\",className:\"text-secondary font-weight-normal\",children:gettext('Send to:')}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"emails\",className:\"form-control w-75\",value:emails,onChange:this.handleEmailsInputChange,placeholder:gettext('Emails, separated by \\',\\'')})]}),/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"msg\",className:\"text-secondary font-weight-normal\",children:gettext('Message (optional):')}),/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control w-75\",id:\"msg\",value:msg,onChange:this.handleMsgInputChange})]}),errorMsg&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:errorMsg}),/*#__PURE__*/_jsx(Button,{color:\"primary\",onClick:EvalProFunc(this.sendLink),disabled:btnDisabled,className:\"mr-2\",children:gettext('Send')}),/*#__PURE__*/_jsx(Button,{color:\"secondary\",onClick:this.props.toggleSendLink,children:gettext('Cancel')}),sending&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-2\",children:gettext('Sending...')})]});}}]);return SendLink;}(React.Component);export default SendLink;","map":{"version":3,"names":["React","Button","Form","FormGroup","Label","seafileAPI","gettext","Utils","toaster","EvalProFunc","jsx","_jsx","jsxs","_jsxs","SendLink","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","handleEmailsInputChange","e","setState","emails","target","value","handleMsgInputChange","msg","sendLink","_this$state","state","trim","errorMsg","btnDisabled","sending","_this$props","token","linkType","request","sendUploadLink","sendShareLink","then","res","closeShareDialog","_res$data","data","success","failed","length","feedbackMsg","replace","join","forEach","item","email","error_msg","warning","catch","error","getErrorMsg","_createClass","key","render","_this$state2","children","htmlFor","className","type","id","onChange","placeholder","color","onClick","disabled","toggleSendLink","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/send-link.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Form, FormGroup, Label } from 'reactstrap';\nimport { seafileAPI } from '../utils/seafile-api';\nimport { gettext } from '../utils/constants';\nimport { Utils } from '../utils/utils';\nimport toaster from './toast';\nimport { EvalProFunc } from '../services/ad';\n\nconst propTypes = {\n  token: PropTypes.string.isRequired,\n  linkType: PropTypes.string.isRequired,\n  toggleSendLink: PropTypes.func.isRequired,\n  closeShareDialog: PropTypes.func.isRequired\n};\n\nclass SendLink extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      emails: '',\n      msg: '',\n      errorMsg: '',\n      btnDisabled: false,\n      sending: false\n    };\n  }\n\n  handleEmailsInputChange = (e) => {\n    this.setState({\n      emails: e.target.value\n    });\n  };\n\n  handleMsgInputChange = (e) => {\n    this.setState({\n      msg: e.target.value\n    });\n  };\n\n  sendLink = () => {\n    const { emails, msg } = this.state;\n    if (!emails.trim()) {\n      this.setState({\n        errorMsg: gettext('Please input at least an email.')\n      });\n      return;\n    }\n\n    this.setState({\n      btnDisabled: true,\n      sending: true\n    });\n\n    const { token, linkType } = this.props;\n    const request = linkType == 'uploadLink' ?\n      seafileAPI.sendUploadLink(token, emails.trim(), msg.trim()) :\n      seafileAPI.sendShareLink(token, emails.trim(), msg.trim());\n    request.then((res) => {\n      this.props.closeShareDialog();\n      const { success, failed } = res.data;\n      if (success.length) {\n        const feedbackMsg = gettext('Successfully sent to {placeholder}')\n          .replace('{placeholder}', success.join(', '));\n        toaster.success(feedbackMsg);\n      }\n      if (failed.length) {\n        failed.forEach((item) => {\n          const feedbackMsg = gettext('Failed to send to {email_placeholder}: {errorMsg_placeholder}')\n            .replace('{email_placeholder}', item.email)\n            .replace('{errorMsg_placeholder}', item.error_msg);\n          toaster.warning(feedbackMsg);\n        });\n      }\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        btnDisabled: false,\n        sending: false,\n        errorMsg: errorMsg\n      });\n    });\n  };\n\n  render() {\n    const { emails, msg, errorMsg, btnDisabled, sending } = this.state;\n    return (\n      <Form>\n        <FormGroup>\n          <Label htmlFor=\"emails\" className=\"text-secondary font-weight-normal\">{gettext('Send to:')}</Label>\n          <input\n            type=\"text\"\n            id=\"emails\"\n            className=\"form-control w-75\"\n            value={emails}\n            onChange={this.handleEmailsInputChange}\n            placeholder={gettext('Emails, separated by \\',\\'')}\n          />\n        </FormGroup>\n        <FormGroup>\n          <Label htmlFor=\"msg\" className=\"text-secondary font-weight-normal\">{gettext('Message (optional):')}</Label>\n          <textarea\n            className=\"form-control w-75\"\n            id=\"msg\"\n            value={msg}\n            onChange={this.handleMsgInputChange}\n          ></textarea>\n        </FormGroup>\n        {errorMsg && <p className=\"error\">{errorMsg}</p>}\n        <Button color=\"primary\" onClick={EvalProFunc(this.sendLink)} disabled={btnDisabled} className=\"mr-2\">{gettext('Send')}</Button>\n        <Button color=\"secondary\" onClick={this.props.toggleSendLink}>{gettext('Cancel')}</Button>\n        {sending && <p className=\"mt-2\">{gettext('Sending...')}</p>}\n      </Form>\n    );\n  }\n}\n\nSendLink.propTypes = propTypes;\n\nexport default SendLink;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}