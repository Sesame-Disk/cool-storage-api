{"ast":null,"code":"import _slicedToArray from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useCallback,useEffect,useState}from'react';import{useLocation}from'@gatsbyjs/reach-router';import Loading from'../../../components/loading';import{gettext}from'../../../utils/constants';import CommonOperationConfirmationDialog from'../../../components/dialog/common-operation-confirmation-dialog';import UserItem from'../user-list/user-item';import instAdminAPI from'../api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UserListSearch=function UserListSearch(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),userList=_useState4[0],setUserList=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),deleteUser=_useState6[0],setDeleteUser=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),deleteMessage=_useState8[0],setDeleteMessage=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isShowDeleteUserDialog=_useState10[0],setIsShowDeleteDialog=_useState10[1];var location=useLocation();useEffect(function(){var params=new URLSearchParams(location.search);var q=params.get('query');instAdminAPI.searchInstitutionUsers(q).then(function(res){var user_list=res.data.user_list;setUserList(user_list);setIsLoading(false);});},[location.search]);var deleteInstUserToggle=useCallback(function(user){if(user){var _deleteMessage=gettext('Are you sure you want to delete {placeholder} ?').replace('{placeholder}',user.name);setDeleteUser(user);setDeleteMessage(_deleteMessage);}setIsShowDeleteDialog(!isShowDeleteUserDialog);},[isShowDeleteUserDialog]);var deleteInstUser=useCallback(function(){instAdminAPI.deleteInstitutionUser(deleteUser.email).then(function(res){var newUserList=userList.filter(function(item){return item.email!==deleteUser.email;});setUserList(newUserList);});},[deleteUser===null||deleteUser===void 0?void 0:deleteUser.email,userList]);var updateInstUserStatus=useCallback(function(user){var is_active=user.is_active?false:true;instAdminAPI.updateInstitutionUserStatus(user.email,is_active).then(function(res){var newUserList=userList.map(function(item){if(item.email===user.email){item.is_active=is_active;}return item;});setUserList(newUserList);});},[userList]);if(isLoading){return/*#__PURE__*/_jsx(Loading,{});}return/*#__PURE__*/_jsxs(\"div\",{className:\"cur-view-content\",children:[/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"th\",{width:\"36%\",children:[gettext('Email'),\" / \",gettext('Name'),\" / \",gettext('Contact Email')]}),/*#__PURE__*/_jsx(\"th\",{width:\"12%\",children:gettext('Status')}),/*#__PURE__*/_jsx(\"th\",{width:\"16%\",children:gettext('Space Used')}),/*#__PURE__*/_jsxs(\"th\",{width:\"22%\",children:[gettext('Create At'),\" / \",gettext('Last Login')]}),/*#__PURE__*/_jsx(\"th\",{width:\"14%\",children:gettext('Operations')})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:userList.map(function(user){return/*#__PURE__*/_jsx(UserItem,{user:user,deleteInstUser:deleteInstUserToggle,updateInstUserStatus:updateInstUserStatus},user.email);})})]}),isShowDeleteUserDialog&&/*#__PURE__*/_jsx(CommonOperationConfirmationDialog,{title:gettext('Delete User'),message:deleteMessage,executeOperation:deleteInstUser,confirmBtnText:gettext('Delete'),toggleDialog:deleteInstUserToggle})]});};export default UserListSearch;","map":{"version":3,"names":["React","useCallback","useEffect","useState","useLocation","Loading","gettext","CommonOperationConfirmationDialog","UserItem","instAdminAPI","jsx","_jsx","jsxs","_jsxs","UserListSearch","_useState","_useState2","_slicedToArray","isLoading","setIsLoading","_useState3","_useState4","userList","setUserList","_useState5","_useState6","deleteUser","setDeleteUser","_useState7","_useState8","deleteMessage","setDeleteMessage","_useState9","_useState10","isShowDeleteUserDialog","setIsShowDeleteDialog","location","params","URLSearchParams","search","q","get","searchInstitutionUsers","then","res","user_list","data","deleteInstUserToggle","user","replace","name","deleteInstUser","deleteInstitutionUser","email","newUserList","filter","item","updateInstUserStatus","is_active","updateInstitutionUserStatus","map","className","children","width","title","message","executeOperation","confirmBtnText","toggleDialog"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/pages/institution-admin/user-list-search/index.js"],"sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport { useLocation } from '@gatsbyjs/reach-router';\nimport Loading from '../../../components/loading';\nimport { gettext } from '../../../utils/constants';\nimport CommonOperationConfirmationDialog from '../../../components/dialog/common-operation-confirmation-dialog';\nimport UserItem from '../user-list/user-item';\nimport instAdminAPI from '../api';\n\nconst UserListSearch = () => {\n  const [isLoading, setIsLoading] = useState(true);\n  const [userList, setUserList] = useState([]);\n  const [deleteUser, setDeleteUser] = useState(null);\n  const [deleteMessage, setDeleteMessage] = useState('');\n  const [isShowDeleteUserDialog, setIsShowDeleteDialog] = useState(false);\n\n  const location = useLocation();\n\n  useEffect(() => {\n    const params = new URLSearchParams(location.search);\n    const q = params.get('query');\n    instAdminAPI.searchInstitutionUsers(q).then(res => {\n      const { user_list } = res.data;\n      setUserList(user_list);\n      setIsLoading(false);\n    });\n  }, [location.search]);\n\n  const deleteInstUserToggle = useCallback((user) => {\n    if (user) {\n      const deleteMessage = gettext('Are you sure you want to delete {placeholder} ?').replace('{placeholder}', user.name);\n      setDeleteUser(user);\n      setDeleteMessage(deleteMessage);\n    }\n    setIsShowDeleteDialog(!isShowDeleteUserDialog);\n  }, [isShowDeleteUserDialog]);\n\n  const deleteInstUser = useCallback(() => {\n    instAdminAPI.deleteInstitutionUser(deleteUser.email).then(res => {\n      const newUserList = userList.filter(item => item.email !== deleteUser.email);\n      setUserList(newUserList);\n    });\n  }, [deleteUser?.email, userList]);\n\n  const updateInstUserStatus = useCallback((user) => {\n    const is_active = user.is_active ? false : true;\n    instAdminAPI.updateInstitutionUserStatus(user.email, is_active).then(res => {\n      const newUserList = userList.map(item => {\n        if (item.email === user.email) {\n          item.is_active = is_active;\n        }\n        return item;\n      });\n      setUserList(newUserList);\n    });\n  }, [userList]);\n\n\n  if (isLoading) {\n    return <Loading />;\n  }\n\n  return (\n    <div className=\"cur-view-content\">\n      <table>\n        <thead>\n          <tr>\n            <th width=\"36%\">{gettext('Email')} / {gettext('Name')} / {gettext('Contact Email')}</th>\n            <th width=\"12%\">{gettext('Status')}</th>\n            <th width=\"16%\">{gettext('Space Used')}</th>\n            <th width=\"22%\">{gettext('Create At')} / {gettext('Last Login')}</th>\n            <th width=\"14%\">{gettext('Operations')}</th>\n          </tr>\n        </thead>\n        <tbody>\n          {userList.map((user) => {\n            return (\n              <UserItem\n                key={user.email}\n                user={user}\n                deleteInstUser={deleteInstUserToggle}\n                updateInstUserStatus={updateInstUserStatus}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n      {isShowDeleteUserDialog && (\n        <CommonOperationConfirmationDialog\n          title={gettext('Delete User')}\n          message={deleteMessage}\n          executeOperation={deleteInstUser}\n          confirmBtnText={gettext('Delete')}\n          toggleDialog={deleteInstUserToggle}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default UserListSearch;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}