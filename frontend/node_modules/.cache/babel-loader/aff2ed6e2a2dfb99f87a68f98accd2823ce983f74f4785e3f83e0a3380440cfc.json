{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{seafileAPI}from'../../utils/seafile-api';import{Utils}from'../../utils/utils';import toaster from'../toast';import'../../css/repo-tag.css';import{jsx as _jsx}from\"react/jsx-runtime\";var TagName=/*#__PURE__*/function(_React$Component){_inherits(TagName,_React$Component);var _super=_createSuper(TagName);function TagName(props){var _this;_classCallCheck(this,TagName);_this=_super.call(this,props);_this.toggleMode=function(){_this.setState({isEditing:!_this.state.isEditing},function(){if(_this.state.isEditing){_this.input.current.focus();}});};_this.updateTagName=function(e){var newName=e.target.value;var _this$props=_this.props,repoID=_this$props.repoID,tag=_this$props.tag;var id=tag.id,color=tag.color;seafileAPI.updateRepoTag(repoID,id,newName,color).then(function(){_this.setState({tagName:newName});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.onInputKeyDown=function(e){if(e.key=='Enter'){_this.toggleMode();_this.updateTagName(e);}else if(e.key=='Escape'){e.nativeEvent.stopImmediatePropagation();_this.toggleMode();}};_this.onInputBlur=function(e){_this.toggleMode();_this.updateTagName(e);};_this.state={tagName:_this.props.tag.name,isEditing:false};_this.input=/*#__PURE__*/React.createRef();return _this;}_createClass(TagName,[{key:\"UNSAFE_componentWillReceiveProps\",value:function UNSAFE_componentWillReceiveProps(nextProps){if(nextProps.tag.name!==this.props.tag.name){this.setState({tagName:nextProps.tag.name});}}},{key:\"render\",value:function render(){var _this$state=this.state,isEditing=_this$state.isEditing,tagName=_this$state.tagName;return/*#__PURE__*/_jsx(\"div\",{className:\"mx-2 flex-fill d-flex\",children:isEditing?/*#__PURE__*/_jsx(\"input\",{type:\"text\",ref:this.input,defaultValue:tagName,onBlur:this.onInputBlur,onKeyDown:this.onInputKeyDown,className:\"flex-fill form-control-sm form-control\"}):/*#__PURE__*/_jsx(\"span\",{onClick:this.toggleMode,className:\"cursor-pointer flex-fill\",children:tagName})});}}]);return TagName;}(React.Component);export default TagName;","map":{"version":3,"names":["React","seafileAPI","Utils","toaster","jsx","_jsx","TagName","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","toggleMode","setState","isEditing","state","input","current","focus","updateTagName","e","newName","target","value","_this$props","repoID","tag","id","color","updateRepoTag","then","tagName","catch","error","errMessage","getErrorMsg","danger","onInputKeyDown","key","nativeEvent","stopImmediatePropagation","onInputBlur","name","createRef","_createClass","UNSAFE_componentWillReceiveProps","nextProps","render","_this$state","className","children","type","ref","defaultValue","onBlur","onKeyDown","onClick","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/tag-name.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nimport '../../css/repo-tag.css';\n\nconst tagNamePropTypes = {\n  tag: PropTypes.object.isRequired,\n  repoID: PropTypes.string.isRequired\n};\n\nclass TagName extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      tagName: this.props.tag.name,\n      isEditing: false\n    };\n    this.input = React.createRef();\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (nextProps.tag.name !== this.props.tag.name) {\n      this.setState({\n        tagName: nextProps.tag.name,\n      });\n    }\n  }\n\n  toggleMode = () => {\n    this.setState({\n      isEditing: !this.state.isEditing\n    }, () => {\n      if (this.state.isEditing) {\n        this.input.current.focus();\n      }\n    });\n  };\n\n  updateTagName = (e) => {\n    const newName = e.target.value;\n    const { repoID, tag } = this.props;\n    const { id, color } = tag;\n    seafileAPI.updateRepoTag(repoID, id, newName, color).then(() => {\n      this.setState({\n        tagName: newName\n      });\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  onInputKeyDown = (e) => {\n    if (e.key == 'Enter') {\n      this.toggleMode();\n      this.updateTagName(e);\n    }\n    else if (e.key == 'Escape') {\n      e.nativeEvent.stopImmediatePropagation();\n      this.toggleMode();\n    }\n  };\n\n  onInputBlur = (e) => {\n    this.toggleMode();\n    this.updateTagName(e);\n  };\n\n  render() {\n    const { isEditing, tagName } = this.state;\n    return (\n      <div className=\"mx-2 flex-fill d-flex\">\n        {isEditing ?\n          <input\n            type=\"text\"\n            ref={this.input}\n            defaultValue={tagName}\n            onBlur={this.onInputBlur}\n            onKeyDown={this.onInputKeyDown}\n            className=\"flex-fill form-control-sm form-control\"\n          /> :\n          <span\n            onClick={this.toggleMode}\n            className=\"cursor-pointer flex-fill\"\n          >{tagName}</span>\n        }\n      </div>\n    );\n  }\n}\n\nTagName.propTypes = tagNamePropTypes;\n\nexport default TagName;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}