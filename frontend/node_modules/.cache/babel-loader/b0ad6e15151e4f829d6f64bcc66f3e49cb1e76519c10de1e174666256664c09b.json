{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{Modal,ModalBody}from'reactstrap';import{Utils}from'../../utils/utils';import CustomPermission from'../../models/custom-permission';import Loading from'../loading';import toaster from'../toast';import{seafileAPI}from'../../utils/seafile-api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PermSelect=/*#__PURE__*/function(_React$Component){_inherits(PermSelect,_React$Component);var _super=_createSuper(PermSelect);function PermSelect(props){var _this;_classCallCheck(this,PermSelect);_this=_super.call(this,props);_this.listCustomPermissions=function(){var repoID=_this.props.repoID;seafileAPI.listCustomPermissions(repoID).then(function(res){var permissions=res.data.permission_list;var customPermissions=permissions.map(function(item){return new CustomPermission(item);});_this.setState({isLoading:false,customPermissions:customPermissions});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);_this.setState({isLoading:false});});};_this.switchOption=function(e){if(!e.target.checked){return;}var currentOption=e.target.value;_this.setState({currentOption:currentOption});_this.props.changePerm(currentOption);_this.props.toggleDialog();};_this.translatePermission=function(permission){var value=Utils.sharePerms(permission);if(!value){var customPermissions=_this.state.customPermissions;var item=customPermissions.find(function(item){return item.id+''===permission;});value=item&&item.name;}return value;};_this.translateExplanation=function(explanation){var value=Utils.sharePermsExplanation(explanation);if(!value){var customPermissions=_this.state.customPermissions;var item=customPermissions.find(function(item){return item.id+''===explanation;});value=item&&item.description;}return value;};_this.getPermissions=function(){var permissions=_this.props.permissions;var newPermissions=permissions.slice();var customPermissions=_this.state.customPermissions;if(!_this.customPermissions){if(customPermissions.length>0){customPermissions.forEach(function(item){newPermissions.push(item.id+'');});}_this.customPermissions=newPermissions;}return _this.customPermissions;};_this.state={isLoading:true,currentOption:_this.props.currentPerm,customPermissions:[]};_this.customPermissions=null;return _this;}_createClass(PermSelect,[{key:\"componentDidMount\",value:function componentDidMount(){if(this.props.repoID){this.listCustomPermissions();}else{this.setState({isLoading:false});}}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,isLoading=_this$state.isLoading,currentOption=_this$state.currentOption;var permissions=[];if(!isLoading){permissions=this.getPermissions();}return/*#__PURE__*/_jsx(Modal,{isOpen:true,toggle:this.props.toggleDialog,children:/*#__PURE__*/_jsxs(ModalBody,{style:{maxHeight:'400px',overflow:'auto'},children:[isLoading&&/*#__PURE__*/_jsx(Loading,{}),!isLoading&&permissions.map(function(item,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"option-\".concat(index),className:\"mt-1\",type:\"radio\",name:\"permission\",value:item,checked:currentOption==item,onChange:_this2.switchOption}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"option-\".concat(index),className:\"ml-2\",children:[_this2.translatePermission(item),/*#__PURE__*/_jsx(\"p\",{className:\"text-secondary small m-0\",children:_this2.translateExplanation(item)})]})]},index);})]})});}}]);return PermSelect;}(React.Component);export default PermSelect;","map":{"version":3,"names":["React","Modal","ModalBody","Utils","CustomPermission","Loading","toaster","seafileAPI","jsx","_jsx","jsxs","_jsxs","PermSelect","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","listCustomPermissions","repoID","then","res","permissions","data","permission_list","customPermissions","map","item","setState","isLoading","catch","error","errMessage","getErrorMsg","danger","switchOption","e","target","checked","currentOption","value","changePerm","toggleDialog","translatePermission","permission","sharePerms","state","find","id","name","translateExplanation","explanation","sharePermsExplanation","description","getPermissions","newPermissions","slice","length","forEach","push","currentPerm","_createClass","key","componentDidMount","render","_this2","_this$state","isOpen","toggle","children","style","maxHeight","overflow","index","className","concat","type","onChange","htmlFor","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/perm-select.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { Utils } from '../../utils/utils';\nimport CustomPermission from '../../models/custom-permission';\nimport Loading from '../loading';\nimport toaster from '../toast';\nimport { seafileAPI } from '../../utils/seafile-api';\n\nconst propTypes = {\n  repoID: PropTypes.string,\n  currentPerm: PropTypes.string.isRequired,\n  permissions: PropTypes.array.isRequired,\n  changePerm: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass PermSelect extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isLoading: true,\n      currentOption: this.props.currentPerm,\n      customPermissions: []\n    };\n\n    this.customPermissions = null;\n  }\n\n  componentDidMount() {\n    if (this.props.repoID) {\n      this.listCustomPermissions();\n    } else {\n      this.setState({isLoading: false});\n    }\n  }\n\n  listCustomPermissions = () => {\n    const { repoID } = this.props;\n    seafileAPI.listCustomPermissions(repoID).then(res => {\n      const { permission_list: permissions } = res.data;\n      const customPermissions = permissions.map(item => new CustomPermission(item));\n      this.setState({\n        isLoading: false,\n        customPermissions: customPermissions\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n      this.setState({isLoading: false});\n    });\n  };\n\n  switchOption = (e) => {\n    if (!e.target.checked) {\n      return;\n    }\n\n    const currentOption = e.target.value;\n    this.setState({\n      currentOption: currentOption\n    });\n\n    this.props.changePerm(currentOption);\n    this.props.toggleDialog();\n  };\n\n  translatePermission = (permission) => {\n    let value = Utils.sharePerms(permission);\n    if (!value) {\n      const { customPermissions } = this.state;\n      const item = customPermissions.find(item => item.id + '' === permission);\n      value = item && item.name;\n    }\n    return value;\n  };\n\n  translateExplanation = (explanation) => {\n    let value = Utils.sharePermsExplanation(explanation);\n    if (!value) {\n      const { customPermissions } = this.state;\n      const item = customPermissions.find(item => item.id + '' === explanation);\n      value = item && item.description;\n    }\n    return value;\n  };\n\n  getPermissions = () => {\n    const { permissions } = this.props;\n    let newPermissions = permissions.slice();\n    const { customPermissions } = this.state;\n    if (!this.customPermissions) {\n      if (customPermissions.length > 0) {\n        customPermissions.forEach(item => {\n          newPermissions.push(item.id + '');\n        });\n      }\n      this.customPermissions = newPermissions;\n    }\n    return this.customPermissions;\n  };\n\n\n  render() {\n    const { isLoading, currentOption } = this.state;\n    let permissions = [];\n    if (!isLoading) {\n      permissions = this.getPermissions();\n    }\n\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalBody style={{maxHeight: '400px', overflow: 'auto'}}>\n          {isLoading && <Loading />}\n          {!isLoading && permissions.map((item, index) => {\n            return (\n              <div className=\"d-flex\" key={index}>\n                <input id={`option-${index}`} className=\"mt-1\" type=\"radio\" name=\"permission\" value={item} checked={currentOption == item} onChange={this.switchOption} />\n                <label htmlFor={`option-${index}`} className=\"ml-2\">\n                  {this.translatePermission(item)}\n                  <p className=\"text-secondary small m-0\">\n                    {this.translateExplanation(item)}\n                  </p>\n                </label>\n              </div>\n            );\n          })}\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nPermSelect.propTypes = propTypes;\n\nexport default PermSelect;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}