{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _isHotkey = _interopRequireDefault(require(\"is-hotkey\"));\nvar _helpers = require(\"../helpers\");\nvar _onTabHandle = require(\"./on-tab-handle\");\nvar _insertBreakList = require(\"./insert-break-list\");\nvar _insertFragmentList = require(\"./insert-fragment-list\");\nvar _normalizeList = require(\"./normalize-list\");\nvar _constant = require(\"../constant\");\nvar _shortcut = require(\"./shortcut\");\nvar _queries = require(\"../queries\");\nvar _core = require(\"../../../core\");\nvar _transforms = require(\"../transforms\");\nvar _elementTypes = require(\"../../../constants/element-types\");\nvar withList = function withList(editor) {\n  var insertBreak = editor.insertBreak,\n    onHotKeyDown = editor.onHotKeyDown,\n    deleteBackward = editor.deleteBackward,\n    insertText = editor.insertText;\n  var newEditor = editor;\n  newEditor.insertBreak = function () {\n    if ((0, _insertBreakList.insertBreakList)(editor)) return;\n    insertBreak();\n    return;\n  };\n  newEditor.deleteBackward = function (unit) {\n    var selection = newEditor.selection;\n    if (selection === null) {\n      deleteBackward(unit);\n      return;\n    }\n    var res = (0, _queries.getListItemEntry)(editor, {});\n    if (res && (0, _core.isSelectionAtBlockStart)(editor, {\n      match: function match(node) {\n        return node.type === _elementTypes.LIST_ITEM;\n      }\n    })) {\n      var list = res.list,\n        listItem = res.listItem;\n      if ((0, _core.isFirstNode)(list[0], listItem[0]) && !(0, _queries.isListNested)(editor, list[1])) {\n        (0, _transforms.unwrapList)(editor);\n        return;\n      }\n    }\n    // nothing todo\n    deleteBackward(unit);\n  };\n  newEditor.insertText = function (text) {\n    var isPreventInsert = (0, _shortcut.handleShortcut)(newEditor, text);\n    if (isPreventInsert) return;\n    return insertText(text);\n  };\n  newEditor.onHotKeyDown = function (event) {\n    var activeListType = (0, _helpers.getActiveListType)(editor);\n    var isListActive = _constant.LIST_TYPES.includes(activeListType);\n    if (isListActive) {\n      if ((0, _isHotkey.default)(['tab', 'shift+tab'], event)) {\n        if ((0, _onTabHandle.handleTab)(newEditor, event)) return true;\n      }\n      if ((0, _isHotkey.default)('shift+enter', event)) {\n        event.preventDefault();\n        return true;\n      }\n    }\n    return onHotKeyDown && onHotKeyDown(event);\n  };\n  newEditor.insertFragment = (0, _insertFragmentList.insertFragmentList)(newEditor);\n  newEditor.normalizeNode = (0, _normalizeList.normalizeList)(newEditor);\n  return newEditor;\n};\nvar _default = exports.default = withList;","map":{"version":3,"names":["_interopRequireDefault","require","default","Object","defineProperty","exports","value","_isHotkey","_helpers","_onTabHandle","_insertBreakList","_insertFragmentList","_normalizeList","_constant","_shortcut","_queries","_core","_transforms","_elementTypes","withList","editor","insertBreak","onHotKeyDown","deleteBackward","insertText","newEditor","insertBreakList","unit","selection","res","getListItemEntry","isSelectionAtBlockStart","match","node","type","LIST_ITEM","list","listItem","isFirstNode","isListNested","unwrapList","text","isPreventInsert","handleShortcut","event","activeListType","getActiveListType","isListActive","LIST_TYPES","includes","handleTab","preventDefault","insertFragment","insertFragmentList","normalizeNode","normalizeList","_default"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/seafile-editor/dist/extension/plugins/list/plugin/index.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _isHotkey = _interopRequireDefault(require(\"is-hotkey\"));\nvar _helpers = require(\"../helpers\");\nvar _onTabHandle = require(\"./on-tab-handle\");\nvar _insertBreakList = require(\"./insert-break-list\");\nvar _insertFragmentList = require(\"./insert-fragment-list\");\nvar _normalizeList = require(\"./normalize-list\");\nvar _constant = require(\"../constant\");\nvar _shortcut = require(\"./shortcut\");\nvar _queries = require(\"../queries\");\nvar _core = require(\"../../../core\");\nvar _transforms = require(\"../transforms\");\nvar _elementTypes = require(\"../../../constants/element-types\");\nconst withList = editor => {\n  const {\n    insertBreak,\n    onHotKeyDown,\n    deleteBackward,\n    insertText\n  } = editor;\n  const newEditor = editor;\n  newEditor.insertBreak = () => {\n    if ((0, _insertBreakList.insertBreakList)(editor)) return;\n    insertBreak();\n    return;\n  };\n  newEditor.deleteBackward = unit => {\n    const {\n      selection\n    } = newEditor;\n    if (selection === null) {\n      deleteBackward(unit);\n      return;\n    }\n    const res = (0, _queries.getListItemEntry)(editor, {});\n    if (res && (0, _core.isSelectionAtBlockStart)(editor, {\n      match: node => node.type === _elementTypes.LIST_ITEM\n    })) {\n      const {\n        list,\n        listItem\n      } = res;\n      if ((0, _core.isFirstNode)(list[0], listItem[0]) && !(0, _queries.isListNested)(editor, list[1])) {\n        (0, _transforms.unwrapList)(editor);\n        return;\n      }\n    }\n    // nothing todo\n    deleteBackward(unit);\n  };\n  newEditor.insertText = text => {\n    const isPreventInsert = (0, _shortcut.handleShortcut)(newEditor, text);\n    if (isPreventInsert) return;\n    return insertText(text);\n  };\n  newEditor.onHotKeyDown = event => {\n    const activeListType = (0, _helpers.getActiveListType)(editor);\n    const isListActive = _constant.LIST_TYPES.includes(activeListType);\n    if (isListActive) {\n      if ((0, _isHotkey.default)(['tab', 'shift+tab'], event)) {\n        if ((0, _onTabHandle.handleTab)(newEditor, event)) return true;\n      }\n      if ((0, _isHotkey.default)('shift+enter', event)) {\n        event.preventDefault();\n        return true;\n      }\n    }\n    return onHotKeyDown && onHotKeyDown(event);\n  };\n  newEditor.insertFragment = (0, _insertFragmentList.insertFragmentList)(newEditor);\n  newEditor.normalizeNode = (0, _normalizeList.normalizeList)(newEditor);\n  return newEditor;\n};\nvar _default = exports.default = withList;"],"mappings":"AAAA,YAAY;;AAEZ,IAAIA,sBAAsB,GAAGC,OAAO,CAAC,8CAA8C,CAAC,CAACC,OAAO;AAC5FC,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAC3CC,KAAK,EAAE;AACT,CAAC,CAAC;AACFD,OAAO,CAACH,OAAO,GAAG,KAAK,CAAC;AACxB,IAAIK,SAAS,GAAGP,sBAAsB,CAACC,OAAO,CAAC,WAAW,CAAC,CAAC;AAC5D,IAAIO,QAAQ,GAAGP,OAAO,CAAC,YAAY,CAAC;AACpC,IAAIQ,YAAY,GAAGR,OAAO,CAAC,iBAAiB,CAAC;AAC7C,IAAIS,gBAAgB,GAAGT,OAAO,CAAC,qBAAqB,CAAC;AACrD,IAAIU,mBAAmB,GAAGV,OAAO,CAAC,wBAAwB,CAAC;AAC3D,IAAIW,cAAc,GAAGX,OAAO,CAAC,kBAAkB,CAAC;AAChD,IAAIY,SAAS,GAAGZ,OAAO,CAAC,aAAa,CAAC;AACtC,IAAIa,SAAS,GAAGb,OAAO,CAAC,YAAY,CAAC;AACrC,IAAIc,QAAQ,GAAGd,OAAO,CAAC,YAAY,CAAC;AACpC,IAAIe,KAAK,GAAGf,OAAO,CAAC,eAAe,CAAC;AACpC,IAAIgB,WAAW,GAAGhB,OAAO,CAAC,eAAe,CAAC;AAC1C,IAAIiB,aAAa,GAAGjB,OAAO,CAAC,kCAAkC,CAAC;AAC/D,IAAMkB,QAAQ,GAAG,SAAXA,QAAQA,CAAGC,MAAM,EAAI;EACzB,IACEC,WAAW,GAITD,MAAM,CAJRC,WAAW;IACXC,YAAY,GAGVF,MAAM,CAHRE,YAAY;IACZC,cAAc,GAEZH,MAAM,CAFRG,cAAc;IACdC,UAAU,GACRJ,MAAM,CADRI,UAAU;EAEZ,IAAMC,SAAS,GAAGL,MAAM;EACxBK,SAAS,CAACJ,WAAW,GAAG,YAAM;IAC5B,IAAI,CAAC,CAAC,EAAEX,gBAAgB,CAACgB,eAAe,EAAEN,MAAM,CAAC,EAAE;IACnDC,WAAW,CAAC,CAAC;IACb;EACF,CAAC;EACDI,SAAS,CAACF,cAAc,GAAG,UAAAI,IAAI,EAAI;IACjC,IACEC,SAAS,GACPH,SAAS,CADXG,SAAS;IAEX,IAAIA,SAAS,KAAK,IAAI,EAAE;MACtBL,cAAc,CAACI,IAAI,CAAC;MACpB;IACF;IACA,IAAME,GAAG,GAAG,CAAC,CAAC,EAAEd,QAAQ,CAACe,gBAAgB,EAAEV,MAAM,EAAE,CAAC,CAAC,CAAC;IACtD,IAAIS,GAAG,IAAI,CAAC,CAAC,EAAEb,KAAK,CAACe,uBAAuB,EAAEX,MAAM,EAAE;MACpDY,KAAK,EAAE,SAAAA,MAAAC,IAAI;QAAA,OAAIA,IAAI,CAACC,IAAI,KAAKhB,aAAa,CAACiB,SAAS;MAAA;IACtD,CAAC,CAAC,EAAE;MACF,IACEC,IAAI,GAEFP,GAAG,CAFLO,IAAI;QACJC,QAAQ,GACNR,GAAG,CADLQ,QAAQ;MAEV,IAAI,CAAC,CAAC,EAAErB,KAAK,CAACsB,WAAW,EAAEF,IAAI,CAAC,CAAC,CAAC,EAAEC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAEtB,QAAQ,CAACwB,YAAY,EAAEnB,MAAM,EAAEgB,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE;QAChG,CAAC,CAAC,EAAEnB,WAAW,CAACuB,UAAU,EAAEpB,MAAM,CAAC;QACnC;MACF;IACF;IACA;IACAG,cAAc,CAACI,IAAI,CAAC;EACtB,CAAC;EACDF,SAAS,CAACD,UAAU,GAAG,UAAAiB,IAAI,EAAI;IAC7B,IAAMC,eAAe,GAAG,CAAC,CAAC,EAAE5B,SAAS,CAAC6B,cAAc,EAAElB,SAAS,EAAEgB,IAAI,CAAC;IACtE,IAAIC,eAAe,EAAE;IACrB,OAAOlB,UAAU,CAACiB,IAAI,CAAC;EACzB,CAAC;EACDhB,SAAS,CAACH,YAAY,GAAG,UAAAsB,KAAK,EAAI;IAChC,IAAMC,cAAc,GAAG,CAAC,CAAC,EAAErC,QAAQ,CAACsC,iBAAiB,EAAE1B,MAAM,CAAC;IAC9D,IAAM2B,YAAY,GAAGlC,SAAS,CAACmC,UAAU,CAACC,QAAQ,CAACJ,cAAc,CAAC;IAClE,IAAIE,YAAY,EAAE;MAChB,IAAI,CAAC,CAAC,EAAExC,SAAS,CAACL,OAAO,EAAE,CAAC,KAAK,EAAE,WAAW,CAAC,EAAE0C,KAAK,CAAC,EAAE;QACvD,IAAI,CAAC,CAAC,EAAEnC,YAAY,CAACyC,SAAS,EAAEzB,SAAS,EAAEmB,KAAK,CAAC,EAAE,OAAO,IAAI;MAChE;MACA,IAAI,CAAC,CAAC,EAAErC,SAAS,CAACL,OAAO,EAAE,aAAa,EAAE0C,KAAK,CAAC,EAAE;QAChDA,KAAK,CAACO,cAAc,CAAC,CAAC;QACtB,OAAO,IAAI;MACb;IACF;IACA,OAAO7B,YAAY,IAAIA,YAAY,CAACsB,KAAK,CAAC;EAC5C,CAAC;EACDnB,SAAS,CAAC2B,cAAc,GAAG,CAAC,CAAC,EAAEzC,mBAAmB,CAAC0C,kBAAkB,EAAE5B,SAAS,CAAC;EACjFA,SAAS,CAAC6B,aAAa,GAAG,CAAC,CAAC,EAAE1C,cAAc,CAAC2C,aAAa,EAAE9B,SAAS,CAAC;EACtE,OAAOA,SAAS;AAClB,CAAC;AACD,IAAI+B,QAAQ,GAAGnD,OAAO,CAACH,OAAO,GAAGiB,QAAQ"},"metadata":{},"sourceType":"script","externalDependencies":[]}