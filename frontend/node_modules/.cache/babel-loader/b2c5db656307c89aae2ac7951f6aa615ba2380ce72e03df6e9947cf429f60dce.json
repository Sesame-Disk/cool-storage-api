{"ast":null,"code":"import _regeneratorRuntime from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport { Editor, Transforms, Range, Path } from '@seafile/slate';\nimport { ReactEditor } from '@seafile/slate-react';\nimport slugid from 'slugid';\nimport { CODE_BLOCK, CODE_LINE, ELEMENT_TYPE, INSERT_POSITION, LINK, LIST_ITEM, PARAGRAPH } from '../../constants';\nimport { getNodeType, getSelectedElems, getAboveNode, getEditorString, replaceNodeChildren, generateEmptyElement } from '../../core';\nexport var isMenuDisabled = function isMenuDisabled(editor, readonly) {\n  if (readonly) return true;\n  if (editor.selection == null) return true;\n  var selectedElems = getSelectedElems(editor);\n  var notMatch = selectedElems.some(function (elem) {\n    var type = elem.type;\n    if (editor.isVoid(elem)) return true;\n    if ([CODE_BLOCK, CODE_LINE, LINK].includes(type)) return true;\n    return false;\n  });\n  if (notMatch) return true; // disabled\n  return false; // enable\n};\n\nexport var checkLink = function checkLink(url) {\n  if (url.indexOf('http') !== 0) {\n    return true;\n  }\n  return false;\n};\nexport var genLinkNode = function genLinkNode(url, text) {\n  var linkNode = {\n    id: slugid.nice(),\n    type: 'link',\n    href: url,\n    title: text,\n    children: [{\n      id: slugid.nice(),\n      text: text || ''\n    }]\n  };\n  return linkNode;\n};\nexport var getLinkType = function getLinkType(editor) {\n  var _Editor$nodes = Editor.nodes(editor, {\n      match: function match(n) {\n        return getNodeType(n) === LINK;\n      },\n      universal: true\n    }),\n    _Editor$nodes2 = _slicedToArray(_Editor$nodes, 1),\n    match = _Editor$nodes2[0];\n  if (!match) return PARAGRAPH;\n  var _match = _slicedToArray(match, 1),\n    n = _match[0];\n  return getNodeType(n);\n};\nexport var insertLink = function insertLink(editor, title, url) {\n  var position = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : INSERT_POSITION.CURRENT;\n  var slateNode = arguments.length > 4 ? arguments[4] : undefined;\n  if (position === INSERT_POSITION.CURRENT && isMenuDisabled(editor)) return;\n  if (!title || !url) return;\n  if (position === INSERT_POSITION.AFTER) {\n    var linkNode = genLinkNode(url, title);\n    var path = Editor.path(editor, editor.selection);\n    if (slateNode && (slateNode === null || slateNode === void 0 ? void 0 : slateNode.type) === LIST_ITEM) {\n      path = ReactEditor.findPath(editor, slateNode);\n      var nextPath = Path.next(path);\n      Transforms.insertNodes(editor, linkNode, {\n        at: nextPath\n      });\n      return;\n    }\n    var p = generateEmptyElement(ELEMENT_TYPE.PARAGRAPH);\n    p.children[1] = linkNode;\n    Transforms.insertNodes(editor, p, {\n      at: [path[0] + 1]\n    });\n    return;\n  }\n\n  // Selection folded or not\n  var selection = editor.selection;\n  if (selection == null) return;\n  var isCollapsed = Range.isCollapsed(selection);\n  if (isCollapsed) {\n    var _linkNode = genLinkNode(url, title);\n    Transforms.insertNodes(editor, _linkNode);\n  } else {\n    var selectedText = Editor.string(editor, selection); // Selected text\n    if (selectedText !== title) {\n      // If the selected text is different from the typed text, delete the text and insert the link\n      editor.deleteFragment();\n      var _linkNode2 = genLinkNode(url, title);\n      Transforms.insertNodes(editor, _linkNode2);\n    } else {\n      // If the selected text is the same as the entered text, only the link can be wrapped\n      var _linkNode3 = genLinkNode(url, title);\n      Transforms.wrapNodes(editor, _linkNode3, {\n        split: true\n      });\n      Transforms.collapse(editor, {\n        edge: 'end'\n      });\n    }\n  }\n};\nexport var updateLink = function updateLink(editor, newText, newUrl) {\n  // Update children\n  var linkAbove = getAboveNode(editor, {\n    match: {\n      type: LINK\n    }\n  });\n  if (linkAbove) {\n    var _ref2 = linkAbove[0] || {},\n      oldUrl = _ref2.href,\n      oldText = _ref2.title;\n    if (oldUrl !== newUrl || oldText !== newText) {\n      Transforms.setNodes(editor, {\n        href: newUrl,\n        title: newText\n      }, {\n        at: linkAbove[1]\n      });\n    }\n    upsertLinkText(editor, {\n      text: newText\n    });\n    return true;\n  }\n};\nexport var upsertLinkText = function upsertLinkText(editor, _ref) {\n  var text = _ref.text;\n  var newLink = getAboveNode(editor, {\n    match: {\n      type: LINK\n    }\n  });\n  if (newLink) {\n    var _newLink = _slicedToArray(newLink, 2),\n      newLInkNode = _newLink[0],\n      newLinkPath = _newLink[1];\n    if (text && text.length && text !== getEditorString(editor, newLinkPath)) {\n      var firstText = newLInkNode.children[0];\n      replaceNodeChildren(editor, {\n        at: newLinkPath,\n        nodes: _objectSpread(_objectSpread({}, firstText), {}, {\n          text: text\n        }),\n        insertOptions: {\n          select: true\n        }\n      });\n    }\n  }\n};\nexport var unWrapLinkNode = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(editor) {\n    var _Editor$nodes3, _Editor$nodes4, nodeEntry;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          if (!(editor.selection == null)) {\n            _context.next = 2;\n            break;\n          }\n          return _context.abrupt(\"return\");\n        case 2:\n          _Editor$nodes3 = Editor.nodes(editor, {\n            match: function match(n) {\n              return getNodeType(n) === 'link';\n            },\n            universal: true\n          }), _Editor$nodes4 = _slicedToArray(_Editor$nodes3, 1), nodeEntry = _Editor$nodes4[0]; // If the selection is not in a link node, it is disabled\n          if (!(nodeEntry == null || nodeEntry[0] == null)) {\n            _context.next = 5;\n            break;\n          }\n          return _context.abrupt(\"return\");\n        case 5:\n          // unlink\n          Transforms.unwrapNodes(editor, {\n            match: function match(n) {\n              return getNodeType(n) === 'link';\n            }\n          });\n        case 6:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function unWrapLinkNode(_x) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport var isSdocFile = function isSdocFile(res, url) {\n  var files_info = res.data.files_info;\n  var fileInfo = files_info[url];\n  var _ref4 = fileInfo || {},\n    is_dir = _ref4.is_dir,\n    file_ext = _ref4.file_ext;\n  return !is_dir && file_ext === 'sdoc';\n};\nexport var isWeChat = function isWeChat() {\n  var ua = window.navigator.userAgent.toLowerCase();\n  var isWeChat = ua.match(/MicroMessenger/i) === 'micromessenger';\n  var isEnterpriseWeChat = ua.match(/MicroMessenger/i) === 'micromessenger' && ua.match(/wxwork/i) === 'wxwork';\n  return isEnterpriseWeChat || isWeChat;\n};","map":{"version":3,"names":["_objectSpread","Editor","Transforms","Range","Path","ReactEditor","slugid","CODE_BLOCK","CODE_LINE","ELEMENT_TYPE","INSERT_POSITION","LINK","LIST_ITEM","PARAGRAPH","getNodeType","getSelectedElems","getAboveNode","getEditorString","replaceNodeChildren","generateEmptyElement","isMenuDisabled","editor","readonly","selection","selectedElems","notMatch","some","elem","type","isVoid","includes","checkLink","url","indexOf","genLinkNode","text","linkNode","id","nice","href","title","children","getLinkType","_Editor$nodes","nodes","match","n","universal","_Editor$nodes2","_slicedToArray","_match","insertLink","position","arguments","length","undefined","CURRENT","slateNode","AFTER","path","findPath","nextPath","next","insertNodes","at","p","isCollapsed","selectedText","string","deleteFragment","wrapNodes","split","collapse","edge","updateLink","newText","newUrl","linkAbove","_ref2","oldUrl","oldText","setNodes","upsertLinkText","_ref","newLink","_newLink","newLInkNode","newLinkPath","firstText","insertOptions","select","unWrapLinkNode","_ref3","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_Editor$nodes3","_Editor$nodes4","nodeEntry","wrap","_callee$","_context","prev","abrupt","unwrapNodes","stop","_x","apply","isSdocFile","res","files_info","data","fileInfo","_ref4","is_dir","file_ext","isWeChat","ua","window","navigator","userAgent","toLowerCase","isEnterpriseWeChat"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/plugins/link/helpers.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport { Editor, Transforms, Range, Path } from '@seafile/slate';\nimport { ReactEditor } from '@seafile/slate-react';\nimport slugid from 'slugid';\nimport { CODE_BLOCK, CODE_LINE, ELEMENT_TYPE, INSERT_POSITION, LINK, LIST_ITEM, PARAGRAPH } from '../../constants';\nimport { getNodeType, getSelectedElems, getAboveNode, getEditorString, replaceNodeChildren, generateEmptyElement } from '../../core';\nexport const isMenuDisabled = (editor, readonly) => {\n  if (readonly) return true;\n  if (editor.selection == null) return true;\n  const selectedElems = getSelectedElems(editor);\n  const notMatch = selectedElems.some(elem => {\n    const {\n      type\n    } = elem;\n    if (editor.isVoid(elem)) return true;\n    if ([CODE_BLOCK, CODE_LINE, LINK].includes(type)) return true;\n    return false;\n  });\n  if (notMatch) return true; // disabled\n  return false; // enable\n};\n\nexport const checkLink = url => {\n  if (url.indexOf('http') !== 0) {\n    return true;\n  }\n  return false;\n};\nexport const genLinkNode = (url, text) => {\n  const linkNode = {\n    id: slugid.nice(),\n    type: 'link',\n    href: url,\n    title: text,\n    children: [{\n      id: slugid.nice(),\n      text: text || ''\n    }]\n  };\n  return linkNode;\n};\nexport const getLinkType = editor => {\n  const [match] = Editor.nodes(editor, {\n    match: n => getNodeType(n) === LINK,\n    universal: true\n  });\n  if (!match) return PARAGRAPH;\n  const [n] = match;\n  return getNodeType(n);\n};\nexport const insertLink = function (editor, title, url) {\n  let position = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : INSERT_POSITION.CURRENT;\n  let slateNode = arguments.length > 4 ? arguments[4] : undefined;\n  if (position === INSERT_POSITION.CURRENT && isMenuDisabled(editor)) return;\n  if (!title || !url) return;\n  if (position === INSERT_POSITION.AFTER) {\n    const linkNode = genLinkNode(url, title);\n    let path = Editor.path(editor, editor.selection);\n    if (slateNode && (slateNode === null || slateNode === void 0 ? void 0 : slateNode.type) === LIST_ITEM) {\n      path = ReactEditor.findPath(editor, slateNode);\n      const nextPath = Path.next(path);\n      Transforms.insertNodes(editor, linkNode, {\n        at: nextPath\n      });\n      return;\n    }\n    const p = generateEmptyElement(ELEMENT_TYPE.PARAGRAPH);\n    p.children[1] = linkNode;\n    Transforms.insertNodes(editor, p, {\n      at: [path[0] + 1]\n    });\n    return;\n  }\n\n  // Selection folded or not\n  const {\n    selection\n  } = editor;\n  if (selection == null) return;\n  const isCollapsed = Range.isCollapsed(selection);\n  if (isCollapsed) {\n    const linkNode = genLinkNode(url, title);\n    Transforms.insertNodes(editor, linkNode);\n  } else {\n    const selectedText = Editor.string(editor, selection); // Selected text\n    if (selectedText !== title) {\n      // If the selected text is different from the typed text, delete the text and insert the link\n      editor.deleteFragment();\n      const linkNode = genLinkNode(url, title);\n      Transforms.insertNodes(editor, linkNode);\n    } else {\n      // If the selected text is the same as the entered text, only the link can be wrapped\n      const linkNode = genLinkNode(url, title);\n      Transforms.wrapNodes(editor, linkNode, {\n        split: true\n      });\n      Transforms.collapse(editor, {\n        edge: 'end'\n      });\n    }\n  }\n};\nexport const updateLink = (editor, newText, newUrl) => {\n  // Update children\n  const linkAbove = getAboveNode(editor, {\n    match: {\n      type: LINK\n    }\n  });\n  if (linkAbove) {\n    const {\n      href: oldUrl,\n      title: oldText\n    } = linkAbove[0] || {};\n    if (oldUrl !== newUrl || oldText !== newText) {\n      Transforms.setNodes(editor, {\n        href: newUrl,\n        title: newText\n      }, {\n        at: linkAbove[1]\n      });\n    }\n    upsertLinkText(editor, {\n      text: newText\n    });\n    return true;\n  }\n};\nexport const upsertLinkText = (editor, _ref) => {\n  let {\n    text\n  } = _ref;\n  const newLink = getAboveNode(editor, {\n    match: {\n      type: LINK\n    }\n  });\n  if (newLink) {\n    const [newLInkNode, newLinkPath] = newLink;\n    if (text && text.length && text !== getEditorString(editor, newLinkPath)) {\n      const firstText = newLInkNode.children[0];\n      replaceNodeChildren(editor, {\n        at: newLinkPath,\n        nodes: _objectSpread(_objectSpread({}, firstText), {}, {\n          text\n        }),\n        insertOptions: {\n          select: true\n        }\n      });\n    }\n  }\n};\nexport const unWrapLinkNode = async editor => {\n  if (editor.selection == null) return;\n  const [nodeEntry] = Editor.nodes(editor, {\n    match: n => getNodeType(n) === 'link',\n    universal: true\n  });\n  // If the selection is not in a link node, it is disabled\n  if (nodeEntry == null || nodeEntry[0] == null) return;\n\n  // unlink\n  Transforms.unwrapNodes(editor, {\n    match: n => getNodeType(n) === 'link'\n  });\n};\nexport const isSdocFile = (res, url) => {\n  const {\n    data: {\n      files_info\n    }\n  } = res;\n  const fileInfo = files_info[url];\n  const {\n    is_dir,\n    file_ext\n  } = fileInfo || {};\n  return !is_dir && file_ext === 'sdoc';\n};\nexport const isWeChat = () => {\n  let ua = window.navigator.userAgent.toLowerCase();\n  let isWeChat = ua.match(/MicroMessenger/i) === 'micromessenger';\n  let isEnterpriseWeChat = ua.match(/MicroMessenger/i) === 'micromessenger' && ua.match(/wxwork/i) === 'wxwork';\n  return isEnterpriseWeChat || isWeChat;\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}