{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{Modal,ModalHeader,ModalBody,ModalFooter}from'reactstrap';import CreatableSelect from'react-select/creatable';import{gettext}from'../../utils/constants';import{seafileAPI}from'../../utils/seafile-api';import{Utils}from'../../utils/utils';import Loading from'../loading';import toaster from'../toast';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LabelRepoStateDialog=/*#__PURE__*/function(_React$Component){_inherits(LabelRepoStateDialog,_React$Component);var _super=_createSuper(LabelRepoStateDialog);function LabelRepoStateDialog(props){var _this;_classCallCheck(this,LabelRepoStateDialog);_this=_super.call(this,props);_this.handleInputChange=function(value){_this.setState({inputValue:value});};_this.formSubmit=function(){var inputValue=_this.state.inputValue;if(!inputValue||!inputValue.length){// undefined or []\n_this.setState({formErrorMsg:gettext('It is required.')});return;}_this.setState({submitBtnDisabled:true});var _this$props=_this.props,repoID=_this$props.repoID,repoName=_this$props.repoName;var labels=inputValue.map(function(item,index){return item.value;}).join(',');seafileAPI.addNewRepoLabels(repoID,labels).then(function(res){var msg=gettext('Successfully added label(s) for library {placeholder}').replace('{placeholder}',repoName);toaster.success(msg);_this.props.toggleDialog();}).catch(function(error){var errorMsg=Utils.getErrorMsg(error);_this.setState({formErrorMsg:errorMsg,submitBtnDisabled:false});});};_this.state={isLoading:true,existingLabels:null,errorMsg:'',submitBtnDisabled:false};return _this;}_createClass(LabelRepoStateDialog,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;seafileAPI.getAllRepoSnapshotLabels().then(function(res){_this2.setState({isLoading:false,existingLabels:res.data,errorMsg:''});}).catch(function(error){var errorMsg=Utils.getErrorMsg(error);_this2.setState({isLoading:false,errorMsg:errorMsg});});}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(Modal,{isOpen:true,toggle:this.props.toggleDialog,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:this.props.toggleDialog,children:gettext('Label Current State')}),/*#__PURE__*/_jsx(ModalBody,{children:/*#__PURE__*/_jsx(Content,{data:this.state,handleChange:this.handleInputChange})}),this.state.existingLabels&&/*#__PURE__*/_jsxs(ModalFooter,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:this.props.toggleDialog,children:gettext('Cancel')}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit,children:gettext('Submit')})]})]});}}]);return LabelRepoStateDialog;}(React.Component);var Content=/*#__PURE__*/function(_React$Component2){_inherits(Content,_React$Component2);var _super2=_createSuper(Content);function Content(){_classCallCheck(this,Content);return _super2.apply(this,arguments);}_createClass(Content,[{key:\"render\",value:function render(){var _this$props$data=this.props.data,isLoading=_this$props$data.isLoading,errorMsg=_this$props$data.errorMsg,existingLabels=_this$props$data.existingLabels,formErrorMsg=_this$props$data.formErrorMsg;if(isLoading){return/*#__PURE__*/_jsx(Loading,{});}if(errorMsg){return/*#__PURE__*/_jsx(\"p\",{className:\"error mt-4 text-center\",children:errorMsg});}return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(CreatableSelect,{isMulti:true,onChange:this.props.handleChange,placeholder:\"\",options:existingLabels.map(function(item,index){return{label:item,value:item};})}),formErrorMsg&&/*#__PURE__*/_jsx(\"p\",{className:\"error m-0 mt-2\",children:formErrorMsg})]});}}]);return Content;}(React.Component);export default LabelRepoStateDialog;","map":{"version":3,"names":["React","Modal","ModalHeader","ModalBody","ModalFooter","CreatableSelect","gettext","seafileAPI","Utils","Loading","toaster","jsx","_jsx","jsxs","_jsxs","LabelRepoStateDialog","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","handleInputChange","value","setState","inputValue","formSubmit","state","length","formErrorMsg","submitBtnDisabled","_this$props","repoID","repoName","labels","map","item","index","join","addNewRepoLabels","then","res","msg","replace","success","toggleDialog","catch","error","errorMsg","getErrorMsg","isLoading","existingLabels","_createClass","key","componentDidMount","_this2","getAllRepoSnapshotLabels","data","render","isOpen","toggle","children","Content","handleChange","className","onClick","disabled","Component","_React$Component2","_super2","apply","arguments","_this$props$data","Fragment","isMulti","onChange","placeholder","options","label"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/label-repo-state-dialog.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport CreatableSelect from 'react-select/creatable';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../loading';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass LabelRepoStateDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      existingLabels: null,\n      errorMsg: '',\n      submitBtnDisabled: false\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getAllRepoSnapshotLabels().then((res) => {\n      this.setState({\n        isLoading: false,\n        existingLabels: res.data,\n        errorMsg: ''\n      });\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        isLoading: false,\n        errorMsg: errorMsg\n      });\n    });\n  }\n\n  handleInputChange = (value) => {\n    this.setState({\n      inputValue: value\n    });\n  };\n\n  formSubmit = () => {\n    const inputValue = this.state.inputValue;\n\n    if (!inputValue || !inputValue.length) { // undefined or []\n      this.setState({\n        formErrorMsg: gettext('It is required.')\n      });\n      return;\n    }\n\n    this.setState({\n      submitBtnDisabled: true\n    });\n\n    const {repoID, repoName} = this.props;\n    const labels = inputValue.map((item, index) => item.value).join(',');\n    seafileAPI.addNewRepoLabels(repoID, labels).then((res) => {\n      const msg = gettext('Successfully added label(s) for library {placeholder}').replace('{placeholder}', repoName);\n      toaster.success(msg);\n      this.props.toggleDialog();\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        formErrorMsg: errorMsg,\n        submitBtnDisabled: false\n      });\n    });\n  };\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalHeader toggle={this.props.toggleDialog}>{gettext('Label Current State')}</ModalHeader>\n        <ModalBody>\n          <Content data={this.state} handleChange={this.handleInputChange} />\n        </ModalBody>\n        {this.state.existingLabels && (\n          <ModalFooter>\n            <button className=\"btn btn-secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</button>\n            <button className=\"btn btn-primary\" disabled={this.state.submitBtnDisabled} onClick={this.formSubmit}>{gettext('Submit')}</button>\n          </ModalFooter>\n        )}\n      </Modal>\n    );\n  }\n}\n\nclass Content extends React.Component {\n\n  render() {\n    const { isLoading, errorMsg, existingLabels, formErrorMsg } = this.props.data;\n\n    if (isLoading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error mt-4 text-center\">{errorMsg}</p>;\n    }\n\n    return (\n      <React.Fragment>\n        <CreatableSelect\n          isMulti={true}\n          onChange={this.props.handleChange}\n          placeholder=''\n          options={existingLabels.map((item, index) => { return {label: item, value: item}; })}\n        />\n        {formErrorMsg && <p className=\"error m-0 mt-2\">{formErrorMsg}</p>}\n      </React.Fragment>\n    );\n  }\n}\n\nContent.propTypes = {\n  data: PropTypes.object.isRequired,\n  handleChange: PropTypes.func.isRequired,\n};\n\nLabelRepoStateDialog.propTypes = propTypes;\n\nexport default LabelRepoStateDialog;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}