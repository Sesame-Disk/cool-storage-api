{"ast":null,"code":"\"use strict\";\n\nvar _objectSpread = require(\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/objectSpread2.js\").default;\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.replacePastedDataId = exports.replaceNodeId = exports.decorateOperation = void 0;\nvar _deepCopy = _interopRequireDefault(require(\"deep-copy\"));\nvar _slugid = _interopRequireDefault(require(\"slugid\"));\nvar OPERATION = _interopRequireWildcard(require(\"./constants\"));\nvar _objectUtils = _interopRequireDefault(require(\"../../../utils/object-utils\"));\nvar decorateOperation = function decorateOperation(operation) {\n  var newOperation = (0, _deepCopy.default)(operation);\n  var type = newOperation.type;\n  switch (type) {\n    case OPERATION.INSERT_NODE:\n      {\n        var node = newOperation.node;\n        if (!node.id) node.id = _slugid.default.nice(); // generate an id for insert node\n        break;\n      }\n    case OPERATION.SPLIT_NODE:\n      {\n        // child: split [7, 0] -> [[7, 0],[7, 1]]\n        // parent: split [[7, 0], [7, 1]] -> [[7], [8]]\n        var _newOperation$propert = newOperation.properties,\n          properties = _newOperation$propert === void 0 ? {} : _newOperation$propert;\n        // need generate a new id for new node\n        properties.id = _slugid.default.nice();\n        break;\n      }\n    default:\n      {\n        break;\n      }\n  }\n  return newOperation;\n};\nexports.decorateOperation = decorateOperation;\nvar replaceNodeId = function replaceNodeId(node) {\n  if (!_objectUtils.default.isObject(node)) return node;\n  if (_objectUtils.default.hasProperty(node, 'children')) {\n    return _objectSpread(_objectSpread({}, node), {}, {\n      id: _slugid.default.nice(),\n      children: replacePastedDataId(node.children)\n    });\n  }\n  return _objectSpread(_objectSpread({}, node), {}, {\n    id: _slugid.default.nice()\n  });\n};\nexports.replaceNodeId = replaceNodeId;\nvar replacePastedDataId = function replacePastedDataId(pastedData) {\n  // If children is malformed, return a list of correct child nodes\n  if (_objectUtils.default.isObject(pastedData)) {\n    return replaceNodeId(pastedData);\n  }\n  if (!Array.isArray(pastedData)) return [{\n    id: _slugid.default.nice(),\n    text: ''\n  }];\n  return pastedData.map(function (item) {\n    item.id = _slugid.default.nice();\n    if (item.children) {\n      item.children = replacePastedDataId(item.children);\n    }\n    return item;\n  });\n};\nexports.replacePastedDataId = replacePastedDataId;","map":{"version":3,"names":["_objectSpread","require","default","_interopRequireWildcard","_interopRequireDefault","Object","defineProperty","exports","value","replacePastedDataId","replaceNodeId","decorateOperation","_deepCopy","_slugid","OPERATION","_objectUtils","operation","newOperation","type","INSERT_NODE","node","id","nice","SPLIT_NODE","_newOperation$propert","properties","isObject","hasProperty","children","pastedData","Array","isArray","text","map","item"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/seafile-editor/dist/extension/plugins/node-id/helpers.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.replacePastedDataId = exports.replaceNodeId = exports.decorateOperation = void 0;\nvar _deepCopy = _interopRequireDefault(require(\"deep-copy\"));\nvar _slugid = _interopRequireDefault(require(\"slugid\"));\nvar OPERATION = _interopRequireWildcard(require(\"./constants\"));\nvar _objectUtils = _interopRequireDefault(require(\"../../../utils/object-utils\"));\nconst decorateOperation = operation => {\n  let newOperation = (0, _deepCopy.default)(operation);\n  const {\n    type\n  } = newOperation;\n  switch (type) {\n    case OPERATION.INSERT_NODE:\n      {\n        let {\n          node\n        } = newOperation;\n        if (!node.id) node.id = _slugid.default.nice(); // generate an id for insert node\n        break;\n      }\n    case OPERATION.SPLIT_NODE:\n      {\n        // child: split [7, 0] -> [[7, 0],[7, 1]]\n        // parent: split [[7, 0], [7, 1]] -> [[7], [8]]\n        const {\n          properties = {}\n        } = newOperation;\n        // need generate a new id for new node\n        properties.id = _slugid.default.nice();\n        break;\n      }\n    default:\n      {\n        break;\n      }\n  }\n  return newOperation;\n};\nexports.decorateOperation = decorateOperation;\nconst replaceNodeId = node => {\n  if (!_objectUtils.default.isObject(node)) return node;\n  if (_objectUtils.default.hasProperty(node, 'children')) {\n    return {\n      ...node,\n      id: _slugid.default.nice(),\n      children: replacePastedDataId(node.children)\n    };\n  }\n  return {\n    ...node,\n    id: _slugid.default.nice()\n  };\n};\nexports.replaceNodeId = replaceNodeId;\nconst replacePastedDataId = pastedData => {\n  // If children is malformed, return a list of correct child nodes\n  if (_objectUtils.default.isObject(pastedData)) {\n    return replaceNodeId(pastedData);\n  }\n  if (!Array.isArray(pastedData)) return [{\n    id: _slugid.default.nice(),\n    text: ''\n  }];\n  return pastedData.map(item => {\n    item.id = _slugid.default.nice();\n    if (item.children) {\n      item.children = replacePastedDataId(item.children);\n    }\n    return item;\n  });\n};\nexports.replacePastedDataId = replacePastedDataId;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}