{"ast":null,"code":"import _toConsumableArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { INTERNAL_EVENT } from '../constants';\nimport { useScrollContext } from '../hooks/use-scroll-context';\nimport EventBus from '../utils/event-bus';\nimport { getOutlineSetting } from '../outline';\nexport default function ArticleContainer(_ref) {\n  var editor = _ref.editor,\n    children = _ref.children;\n  var articleRef = useRef(null);\n  useEffect(function () {\n    editor.width = articleRef.current.children[0].clientWidth;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  var scrollRef = useScrollContext();\n  var _useState = useState({}),\n    _useState2 = _slicedToArray(_useState, 2),\n    containerStyle = _useState2[0],\n    setContainerStyle = _useState2[1];\n  var handleWindowResize = useCallback(function () {\n    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref2$scrollIntoArtic = _ref2.scrollIntoArticle,\n      scrollIntoArticle = _ref2$scrollIntoArtic === void 0 ? false : _ref2$scrollIntoArtic;\n    var rect = scrollRef.current.getBoundingClientRect();\n    var articleRect = articleRef.current.getBoundingClientRect();\n    // get state from local storage\n    var isShowOutline = getOutlineSetting();\n    if (isShowOutline && (rect.width - articleRect.width) / 2 < 280) {\n      setContainerStyle({\n        marginLeft: '280px'\n      });\n    } else {\n      setContainerStyle({});\n    }\n    if (scrollIntoArticle) {\n      articleRef.current.scrollIntoView({\n        inline: 'start',\n        block: 'nearest'\n      });\n    }\n  }, [scrollRef]);\n  var handelArticleClick = useCallback(function (event) {\n    if (!articleRef.current.contains(event.target)) return;\n    var eventBus = EventBus.getInstance();\n    eventBus.dispatch(INTERNAL_EVENT.ARTICLE_CLICK, event);\n  }, []);\n  useEffect(function () {\n    var eventBus = EventBus.getInstance();\n    var unsubscribeOutline = eventBus.subscribe(INTERNAL_EVENT.OUTLINE_STATE_CHANGED, handleWindowResize);\n    return unsubscribeOutline;\n  }, [handleWindowResize]);\n  useEffect(function () {\n    handleWindowResize();\n    window.addEventListener('resize', handleWindowResize);\n    return function () {\n      window.removeEventListener('resize', handleWindowResize);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-article-container\",\n    style: containerStyle\n  }, React.Children.count(children) === 1 && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"article\",\n    ref: articleRef,\n    onClick: handelArticleClick\n  }, children), React.Children.count(children) > 1 && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"article\",\n    ref: articleRef,\n    onClick: handelArticleClick\n  }, children[0]), _toConsumableArray(children.slice(1))));\n}","map":{"version":3,"names":["React","useCallback","useEffect","useRef","useState","INTERNAL_EVENT","useScrollContext","EventBus","getOutlineSetting","ArticleContainer","_ref","editor","children","articleRef","width","current","clientWidth","scrollRef","_useState","_useState2","_slicedToArray","containerStyle","setContainerStyle","handleWindowResize","_ref2","arguments","length","undefined","_ref2$scrollIntoArtic","scrollIntoArticle","rect","getBoundingClientRect","articleRect","isShowOutline","marginLeft","scrollIntoView","inline","block","handelArticleClick","event","contains","target","eventBus","getInstance","dispatch","ARTICLE_CLICK","unsubscribeOutline","subscribe","OUTLINE_STATE_CHANGED","window","addEventListener","removeEventListener","createElement","className","style","Children","count","ref","onClick","Fragment","_toConsumableArray","slice"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/layout/article-container.js"],"sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { INTERNAL_EVENT } from '../constants';\nimport { useScrollContext } from '../hooks/use-scroll-context';\nimport EventBus from '../utils/event-bus';\nimport { getOutlineSetting } from '../outline';\nexport default function ArticleContainer(_ref) {\n  let {\n    editor,\n    children\n  } = _ref;\n  const articleRef = useRef(null);\n  useEffect(() => {\n    editor.width = articleRef.current.children[0].clientWidth;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const scrollRef = useScrollContext();\n  const [containerStyle, setContainerStyle] = useState({});\n  const handleWindowResize = useCallback(function () {\n    let {\n      scrollIntoArticle = false\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const rect = scrollRef.current.getBoundingClientRect();\n    const articleRect = articleRef.current.getBoundingClientRect();\n    // get state from local storage\n    const isShowOutline = getOutlineSetting();\n    if (isShowOutline && (rect.width - articleRect.width) / 2 < 280) {\n      setContainerStyle({\n        marginLeft: '280px'\n      });\n    } else {\n      setContainerStyle({});\n    }\n    if (scrollIntoArticle) {\n      articleRef.current.scrollIntoView({\n        inline: 'start',\n        block: 'nearest'\n      });\n    }\n  }, [scrollRef]);\n  const handelArticleClick = useCallback(event => {\n    if (!articleRef.current.contains(event.target)) return;\n    const eventBus = EventBus.getInstance();\n    eventBus.dispatch(INTERNAL_EVENT.ARTICLE_CLICK, event);\n  }, []);\n  useEffect(() => {\n    const eventBus = EventBus.getInstance();\n    const unsubscribeOutline = eventBus.subscribe(INTERNAL_EVENT.OUTLINE_STATE_CHANGED, handleWindowResize);\n    return unsubscribeOutline;\n  }, [handleWindowResize]);\n  useEffect(() => {\n    handleWindowResize();\n    window.addEventListener('resize', handleWindowResize);\n    return () => {\n      window.removeEventListener('resize', handleWindowResize);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sdoc-article-container\",\n    style: containerStyle\n  }, React.Children.count(children) === 1 && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"article\",\n    ref: articleRef,\n    onClick: handelArticleClick\n  }, children), React.Children.count(children) > 1 && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"article\",\n    ref: articleRef,\n    onClick: handelArticleClick\n  }, children[0]), [...children.slice(1)]));\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}