{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{gettext}from'../utils/constants';import{Utils}from'../utils/utils';import toaster from'./toast';import{jsx as _jsx}from\"react/jsx-runtime\";var Rename=/*#__PURE__*/function(_React$Component){_inherits(Rename,_React$Component);var _super=_createSuper(Rename);function Rename(props){var _this;_classCallCheck(this,Rename);_this=_super.call(this,props);_this.onClick=function(e){if(!_this.inputRef.current.contains(e.target)){_this.onRenameConfirm();}};_this.onChange=function(e){_this.setState({name:e.target.value});};_this.onKeyDown=function(e){if(e.keyCode===Utils.keyCodes.enter){_this.onRenameConfirm(e);}else if(e.keyCode===Utils.keyCodes.esc){_this.onRenameCancel(e);}e.nativeEvent.stopImmediatePropagation();};_this.onRenameConfirm=function(e){e&&e.nativeEvent.stopImmediatePropagation();var newName=_this.state.name.trim();if(newName===_this.props.name){_this.props.onRenameCancel();return;}var _this$validateInput=_this.validateInput(),isValid=_this$validateInput.isValid,errMessage=_this$validateInput.errMessage;if(!isValid){toaster.danger(errMessage);_this.props.onRenameCancel();}else{_this.props.onRenameConfirm(newName);}};_this.onRenameCancel=function(e){e.nativeEvent.stopImmediatePropagation();_this.props.onRenameCancel();};_this.validateInput=function(){var newName=_this.state.name.trim();var isValid=true;var errMessage='';if(!newName){isValid=false;errMessage=gettext('Name is required.');return{isValid:isValid,errMessage:errMessage};}if(newName.indexOf('/')>-1){isValid=false;errMessage=gettext('Name should not include '+'\\'/\\''+'.');return{isValid:isValid,errMessage:errMessage};}return{isValid:isValid,errMessage:errMessage};};_this.state={name:props.name};_this.inputRef=/*#__PURE__*/React.createRef();return _this;}_createClass(Rename,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.inputRef.current.focus();if(this.props.hasSuffix){var endIndex=this.props.name.lastIndexOf('.');this.inputRef.current.setSelectionRange(0,endIndex,'forward');}else{this.inputRef.current.setSelectionRange(0,-1);}// ensure real dom has been rendered, then listen the click event\nsetTimeout(function(){document.addEventListener('click',_this2.onClick);},1);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){document.removeEventListener('click',this.onClick);}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsx(\"div\",{className:\"rename-container\",children:/*#__PURE__*/_jsx(\"input\",{ref:this.inputRef,value:this.state.name,onChange:this.onChange,onKeyDown:this.onKeyDown})});}}]);return Rename;}(React.Component);export default Rename;","map":{"version":3,"names":["React","gettext","Utils","toaster","jsx","_jsx","Rename","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","onClick","e","inputRef","current","contains","target","onRenameConfirm","onChange","setState","name","value","onKeyDown","keyCode","keyCodes","enter","esc","onRenameCancel","nativeEvent","stopImmediatePropagation","newName","state","trim","_this$validateInput","validateInput","isValid","errMessage","danger","indexOf","createRef","_createClass","key","componentDidMount","_this2","focus","hasSuffix","endIndex","lastIndexOf","setSelectionRange","setTimeout","document","addEventListener","componentWillUnmount","removeEventListener","render","className","children","ref","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/rename.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../utils/constants';\nimport { Utils } from '../utils/utils';\nimport toaster from './toast';\n\nconst propTypes = {\n  hasSuffix: PropTypes.bool,\n  name: PropTypes.string.isRequired,\n  onRenameConfirm: PropTypes.func.isRequired,\n  onRenameCancel: PropTypes.func.isRequired,\n};\n\nclass Rename extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: props.name\n    };\n    this.inputRef = React.createRef();\n  }\n\n  componentDidMount() {\n    this.inputRef.current.focus();\n    if (this.props.hasSuffix) {\n      var endIndex = this.props.name.lastIndexOf('.');\n      this.inputRef.current.setSelectionRange(0, endIndex, 'forward');\n    } else {\n      this.inputRef.current.setSelectionRange(0, -1);\n    }\n    // ensure real dom has been rendered, then listen the click event\n    setTimeout(() => {\n      document.addEventListener('click', this.onClick);\n    }, 1);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.onClick);\n  }\n\n  onClick = (e) => {\n    if (!this.inputRef.current.contains(e.target)) {\n      this.onRenameConfirm();\n    }\n  };\n\n  onChange = (e) => {\n    this.setState({name: e.target.value});\n  };\n\n  onKeyDown = (e) => {\n    if (e.keyCode === Utils.keyCodes.enter) {\n      this.onRenameConfirm(e);\n    } else if (e.keyCode === Utils.keyCodes.esc) {\n      this.onRenameCancel(e);\n    }\n    e.nativeEvent.stopImmediatePropagation();\n  };\n\n  onRenameConfirm = (e) => {\n    e && e.nativeEvent.stopImmediatePropagation();\n    let newName = this.state.name.trim();\n    if (newName === this.props.name) {\n      this.props.onRenameCancel();\n      return;\n    }\n\n    let { isValid, errMessage } = this.validateInput();\n    if (!isValid) {\n      toaster.danger(errMessage);\n      this.props.onRenameCancel();\n    } else {\n      this.props.onRenameConfirm(newName);\n    }\n  };\n\n  onRenameCancel = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.onRenameCancel();\n  };\n\n  validateInput = () => {\n    let newName = this.state.name.trim();\n    let isValid = true;\n    let errMessage = '';\n    if (!newName) {\n      isValid = false;\n      errMessage = gettext('Name is required.');\n      return { isValid, errMessage };\n    }\n\n    if (newName.indexOf('/') > -1) {\n      isValid = false;\n      errMessage = gettext('Name should not include ' + '\\'/\\'' + '.');\n      return { isValid, errMessage };\n    }\n\n    return { isValid, errMessage };\n  };\n\n  render() {\n    return (\n      <div className=\"rename-container\">\n        <input\n          ref={this.inputRef}\n          value={this.state.name}\n          onChange={this.onChange}\n          onKeyDown={this.onKeyDown}\n        />\n      </div>\n    );\n  }\n}\n\nRename.propTypes = propTypes;\n\nexport default Rename;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}