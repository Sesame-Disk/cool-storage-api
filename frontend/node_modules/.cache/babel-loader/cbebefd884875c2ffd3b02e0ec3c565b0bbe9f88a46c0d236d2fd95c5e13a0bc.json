{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component,Fragment}from'react';import toaster from'./toast';import{Modal,ModalHeader,ModalBody,ModalFooter,InputGroup,InputGroupAddon,InputGroupText,Input,Button}from'reactstrap';import{gettext,serviceURL}from'../utils/constants';import{Utils}from'../utils/utils';import{subscriptionAPI}from'../utils/subscription-api';import Loading from'./loading';import'../css/layout.css';import'../css/subscription.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var isOrgContext=window.app.pageOptions.isOrgContext;var Plans=/*#__PURE__*/function(_Component){_inherits(Plans,_Component);var _super=_createSuper(Plans);function Plans(props){var _this;_classCallCheck(this,Plans);_this=_super.call(this,props);_this.togglePlan=function(plan){_this.setState({currentPlan:plan},function(){});};_this.onPay=function(){var paymentType=_this.props.paymentType;var _this$state=_this.state,currentPlan=_this$state.currentPlan,assetQuotaUnitCount=_this$state.assetQuotaUnitCount,count=_this$state.count;var totalAmount,assetQuota,newUserCount;// parse\nif(paymentType==='paid'){newUserCount=currentPlan.count;totalAmount=currentPlan.total_amount;}else if(paymentType==='extend_time'){newUserCount=currentPlan.count;assetQuota=currentPlan.asset_quota;totalAmount=currentPlan.total_amount;}else if(paymentType==='add_user'){newUserCount=count;totalAmount=count*currentPlan.price_per_user;}else if(paymentType==='buy_quota'){assetQuota=assetQuotaUnitCount*currentPlan.asset_quota_unit;totalAmount=assetQuotaUnitCount*currentPlan.price_per_asset_quota_unit;}else{toaster.danger(gettext('Internal Server Error'));return;}_this.props.onPay(currentPlan.plan_id,newUserCount,assetQuota,totalAmount);};_this.onCountInputChange=function(e){var currentPlan=_this.state.currentPlan;if(!currentPlan.can_custom_count){return;}var count=e.target.value.replace(/^(0+)|[^\\d]+/g,'');if(count<1){count=1;}else if(count>9999){count=9999;}_this.setState({count:count});};_this.onAssetQuotaUnitCountInputChange=function(e){var currentPlan=_this.state.currentPlan;if(!currentPlan.can_custom_asset_quota){return;}var count=e.target.value.replace(/^(0+)|[^\\d]+/g,'');if(count<1){count=1;}else if(count>9999){count=9999;}_this.setState({assetQuotaUnitCount:count});};_this.renderPaidOrExtendTime=function(){var _this$props=_this.props,plans=_this$props.plans,paymentType=_this$props.paymentType;var currentPlan=_this.state.currentPlan;var boughtQuota=0;if(paymentType==='extend_time'){boughtQuota=currentPlan.asset_quota-100;}var totalAmount=currentPlan.total_amount;var originalTotalAmount=totalAmount;return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column subscription-container\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"subscription-subtitle\",children:'选择方案'}),/*#__PURE__*/_jsx(\"dl\",{className:\"items-dl\",children:plans.map(function(item,index){var selectedCss=item.plan_id===currentPlan.plan_id?'plan-selected':'';var countDescription='￥'+item.price_per_user;if(isOrgContext){countDescription+='/每用户';}return/*#__PURE__*/_jsxs(\"dd\",{className:\"plan-description-item \".concat(selectedCss),onClick:_this.togglePlan.bind(_assertThisInitialized(_this),item),children:[/*#__PURE__*/_jsx(\"span\",{className:\"plan-name\",children:item.name}),/*#__PURE__*/_jsx(\"span\",{className:\"plan-description\",children:countDescription})]},index);})}),paymentType==='extend_time'&&boughtQuota>0&&/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"subscription-subtitle\",children:'增加空间'}),/*#__PURE__*/_jsx(\"dl\",{className:\"items-dl\",children:/*#__PURE__*/_jsxs(\"dd\",{className:\"order-item order-item-top order-item-bottom subscription-list\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"order-into\",children:currentPlan.asset_quota_unit+'GB x '+boughtQuota/currentPlan.asset_quota_unit}),/*#__PURE__*/_jsx(\"span\",{className:\"order-value\",children:'￥'+boughtQuota/currentPlan.asset_quota_unit*currentPlan.price_per_asset_quota_unit})]})})]}),/*#__PURE__*/_jsx(\"span\",{className:\"subscription-subtitle\",children:'方案汇总'}),/*#__PURE__*/_jsx(\"dl\",{className:\"items-dl\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"dd\",{className:\"order-item order-item-top\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"order-into\",children:'所选方案'}),/*#__PURE__*/_jsx(\"span\",{className:\"order-value\",children:currentPlan.name})]}),isOrgContext&&/*#__PURE__*/_jsxs(\"dd\",{className:\"order-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"order-into\",children:'成员人数'}),/*#__PURE__*/_jsx(\"span\",{className:\"order-value\",children:currentPlan.count+'人'})]}),/*#__PURE__*/_jsxs(\"dd\",{className:\"order-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"order-into\",children:'可用空间'}),/*#__PURE__*/_jsx(\"span\",{className:\"order-value\",children:'100GB(附赠)'+(boughtQuota>0?'+'+boughtQuota+'GB(扩充)':'')})]}),/*#__PURE__*/_jsxs(\"dd\",{className:\"order-item order-item-bottom rounded-0\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"order-into\",children:'到期时间'}),/*#__PURE__*/_jsx(\"span\",{className:\"order-value\",children:currentPlan.new_term_end})]}),/*#__PURE__*/_jsxs(\"dd\",{className:\"order-item order-item-bottom subscription-list\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"order-into\",children:'实际支付金额'}),/*#__PURE__*/_jsxs(\"span\",{className:\"order-price\",children:[originalTotalAmount!==totalAmount&&/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'small',textDecoration:'line-through',color:'#9a9a9a'},children:'￥'+originalTotalAmount}),/*#__PURE__*/_jsx(\"span\",{children:'￥'+totalAmount+' '})]})]})]})}),/*#__PURE__*/_jsx(Button,{className:\"subscription-submit\",color:\"primary\",onClick:_this.onPay,children:'提交订单'})]});};_this.renderAddUser=function(){var _this$state2=_this.state,currentPlan=_this$state2.currentPlan,count=_this$state2.count;var operationIntro='新增用户';var originalTotalAmount=count*currentPlan.price_per_user;var totalAmount=originalTotalAmount;return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column subscription-container price-version-container-header subscription-add-user\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"price-version-container-top\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"user-quota-plan-name py-5\",children:currentPlan.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"py-2 mb-0 text-orange font-500 text-center\",children:['¥ ',/*#__PURE__*/_jsx(\"span\",{className:\"price-version-plan-price\",children:currentPlan.price}),' '+currentPlan.description]}),/*#__PURE__*/_jsxs(InputGroup,{style:{marginBottom:'5px'},className:\"user-numbers\",children:[/*#__PURE__*/_jsx(InputGroupAddon,{addonType:\"prepend\",children:/*#__PURE__*/_jsx(InputGroupText,{children:operationIntro})}),/*#__PURE__*/_jsx(Input,{className:\"py-2\",placeholder:operationIntro,title:operationIntro,type:\"number\",value:count||1,min:\"1\",max:\"9999\",disabled:!currentPlan.can_custom_count,onChange:_this.onCountInputChange})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"py-2 text-orange mb-0 font-500 price-version-plan-whole-price text-center\",children:['总价 ¥ '+totalAmount,originalTotalAmount!==totalAmount&&/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'small',textDecoration:'line-through',color:'#9a9a9a'},children:' ￥'+originalTotalAmount})]}),/*#__PURE__*/_jsx(\"span\",{className:\"py-2 mb-0 text-lg-size font-500 price-version-plan-valid-day text-center\",children:'有效期至 '+currentPlan.new_term_end}),/*#__PURE__*/_jsx(\"span\",{className:\"subscription-notice text-center py-5\",children:'注：当有效期剩余天数少于计划中的时候，增加用户的价格按天来计算'}),/*#__PURE__*/_jsx(Button,{className:\"subscription-submit\",onClick:_this.onPay,color:\"primary\",children:'立即购买'})]});};_this.renderBuyQuota=function(){var _this$state3=_this.state,currentPlan=_this$state3.currentPlan,assetQuotaUnitCount=_this$state3.assetQuotaUnitCount;var operationIntro='新增空间';var originalTotalAmount=assetQuotaUnitCount*currentPlan.price_per_asset_quota_unit;var totalAmount=originalTotalAmount;return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column subscription-container price-version-container-header subscription-add-space\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"price-version-container-top\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"user-quota-plan-name py-5\",children:currentPlan.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"py-2 mb-0 text-orange font-500 text-center\",children:['¥ ',/*#__PURE__*/_jsx(\"span\",{className:\"price-version-plan-price\",children:currentPlan.asset_quota_price}),' '+currentPlan.asset_quota_description]}),/*#__PURE__*/_jsxs(InputGroup,{style:{marginBottom:'5px'},className:\"space-quota\",children:[/*#__PURE__*/_jsx(InputGroupAddon,{addonType:\"prepend\",children:/*#__PURE__*/_jsx(InputGroupText,{children:/*#__PURE__*/_jsx(\"span\",{className:\"font-500\",children:operationIntro})})}),/*#__PURE__*/_jsx(Input,{className:\"py-2\",placeholder:operationIntro,title:operationIntro,type:\"number\",value:assetQuotaUnitCount||1,min:\"1\",max:\"9999\",disabled:!currentPlan.can_custom_asset_quota,onChange:_this.onAssetQuotaUnitCountInputChange}),/*#__PURE__*/_jsx(InputGroupAddon,{addonType:\"append\",children:/*#__PURE__*/_jsx(InputGroupText,{children:/*#__PURE__*/_jsx(\"span\",{className:\"font-500\",children:' x '+currentPlan.asset_quota_unit+'GB'})})})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"py-4 text-orange mb-0 font-500 price-version-plan-whole-price text-center\",children:['总价 ¥ '+totalAmount,originalTotalAmount!==totalAmount&&/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'small',textDecoration:'line-through',color:'#9a9a9a'},children:' ￥'+originalTotalAmount})]}),/*#__PURE__*/_jsx(\"span\",{className:\"py-2 mb-0 text-lg-size font-500 price-version-plan-valid-day text-center\",children:'有效期至 '+currentPlan.new_term_end}),/*#__PURE__*/_jsx(\"span\",{className:\"subscription-notice text-center py-5\",children:'注：当有效期剩余天数少于计划中的时候，增加空间的价格按天来计算'}),/*#__PURE__*/_jsx(Button,{className:\"subscription-submit\",onClick:_this.onPay,color:\"primary\",children:'立即购买'})]});};_this.state={currentPlan:props.plans[0],assetQuotaUnitCount:1,count:1};return _this;}_createClass(Plans,[{key:\"render\",value:function render(){var paymentType=this.props.paymentType;if(paymentType==='paid'||paymentType==='extend_time'){return this.renderPaidOrExtendTime();}else if(paymentType==='add_user'){return this.renderAddUser();}else if(paymentType==='buy_quota'){return this.renderBuyQuota();}else{toaster.danger(gettext('Internal Server Error'));return;}}}]);return Plans;}(Component);var PlansDialog=/*#__PURE__*/function(_Component2){_inherits(PlansDialog,_Component2);var _super2=_createSuper(PlansDialog);function PlansDialog(props){var _this2;_classCallCheck(this,PlansDialog);_this2=_super2.call(this,props);_this2.getPlans=function(){subscriptionAPI.getSubscriptionPlans(_this2.props.paymentType).then(function(res){_this2.setState({planList:res.data.plan_list,paymentSourceList:res.data.payment_source_list,isLoading:false});}).catch(function(error){var errorMsg=Utils.getErrorMsg(error);_this2.setState({isLoading:false,errorMsg:errorMsg});});};_this2.onPay=function(planID,count,asset_quota,totalAmount){_this2.setState({isWaiting:true});var payUrl=serviceURL+'/subscription/pay/?payment_source='+_this2.state.paymentSourceList[0]+'&payment_type='+_this2.props.paymentType+'&plan_id='+planID+'&total_amount='+totalAmount;if(count){payUrl+='&count='+count;}if(asset_quota){payUrl+='&asset_quota='+asset_quota;}window.open(payUrl);};_this2.onReload=function(){window.location.reload();};_this2.state={isLoading:true,isWaiting:false,planList:[],paymentSourceList:[]};return _this2;}_createClass(PlansDialog,[{key:\"componentDidMount\",value:function componentDidMount(){this.getPlans();}},{key:\"render\",value:function render(){var _this$state4=this.state,isLoading=_this$state4.isLoading,isWaiting=_this$state4.isWaiting,planList=_this$state4.planList;var _this$props2=this.props,toggleDialog=_this$props2.toggleDialog,paymentTypeTrans=_this$props2.paymentTypeTrans,paymentType=_this$props2.paymentType;var modalStyle=paymentType==='paid'||paymentType==='extend_time'?{width:'560px',maxWidth:'560px'}:{width:'560px'};if(isLoading){return/*#__PURE__*/_jsxs(Modal,{isOpen:true,toggle:toggleDialog,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:toggleDialog,children:paymentTypeTrans}),/*#__PURE__*/_jsx(ModalBody,{children:/*#__PURE__*/_jsx(Loading,{})})]});}if(isWaiting){return/*#__PURE__*/_jsxs(Modal,{isOpen:true,toggle:this.onReload,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:this.onReload,children:paymentTypeTrans}),/*#__PURE__*/_jsx(ModalBody,{children:/*#__PURE__*/_jsx(\"div\",{children:'是否完成付款?'})}),/*#__PURE__*/_jsx(ModalFooter,{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-primary\",onClick:this.onReload,children:'是'})})]});}return/*#__PURE__*/_jsxs(Modal,{isOpen:true,toggle:toggleDialog,style:modalStyle,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:toggleDialog,children:paymentTypeTrans}),/*#__PURE__*/_jsx(ModalBody,{children:/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-between\",children:/*#__PURE__*/_jsx(Plans,{plans:planList,onPay:this.onPay,paymentType:this.props.paymentType})})})]});}}]);return PlansDialog;}(Component);var Subscription=/*#__PURE__*/function(_Component3){_inherits(Subscription,_Component3);var _super3=_createSuper(Subscription);function Subscription(props){var _this3;_classCallCheck(this,Subscription);_this3=_super3.call(this,props);_this3.getSubscription=function(){subscriptionAPI.getSubscription().then(function(res){var subscription=res.data.subscription;var paymentTypeList=res.data.payment_type_list;if(!subscription){_this3.setState({isLoading:false,paymentTypeList:paymentTypeList});}else{var isActive=subscription.is_active;var plan=subscription.plan;_this3.setState({isLoading:false,subscription:subscription,planName:plan.name,userLimit:subscription.user_limit,assetQuota:isActive?subscription.asset_quota:plan.asset_quota,termEnd:isActive?subscription.term_end:'已过期',paymentTypeList:paymentTypeList});}}).catch(function(error){var errorMsg=Utils.getErrorMsg(error);_this3.setState({isLoading:false,errorMsg:errorMsg});});};_this3.toggleDialog=function(){_this3.setState({isDialogOpen:!_this3.state.isDialogOpen});};_this3.togglePaymentType=function(paymentType){_this3.setState({currentPaymentType:paymentType});_this3.toggleDialog();};_this3.paymentTypeTransMap={paid:'立即购买',extend_time:'立即续费',add_user:'增加用户',buy_quota:'增加空间'};_this3.state={isLoading:true,errorMsg:'',isDialogOpen:false,planName:_this3.props.isOrgContext?'团队版':'个人版',userLimit:20,assetQuota:1,termEnd:'长期',subscription:null,paymentTypeList:[],currentPaymentType:'',errorMsgCode:''};return _this3;}_createClass(Subscription,[{key:\"componentDidMount\",value:function componentDidMount(){this.getSubscription();}},{key:\"render\",value:function render(){var _this4=this;var _this$state5=this.state,isLoading=_this$state5.isLoading,errorMsg=_this$state5.errorMsg,planName=_this$state5.planName,userLimit=_this$state5.userLimit,assetQuota=_this$state5.assetQuota,termEnd=_this$state5.termEnd,isDialogOpen=_this$state5.isDialogOpen,paymentTypeList=_this$state5.paymentTypeList,currentPaymentType=_this$state5.currentPaymentType;if(isLoading){return/*#__PURE__*/_jsx(Loading,{});}if(errorMsg){return/*#__PURE__*/_jsx(\"p\",{className:\"text-center mt-8 error\",children:errorMsg});}return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"content position-relative\",onScroll:this.props.handleContentScroll,children:[/*#__PURE__*/_jsxs(\"div\",{id:\"current-plan\",className:\"subscription-info\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"subscription-info-heading\",children:'当前版本'}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-2\",children:planName})]}),this.props.isOrgContext&&/*#__PURE__*/_jsxs(\"div\",{id:\"user-limit\",className:\"subscription-info\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"subscription-info-heading\",children:'用户数限制'}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-2\",children:userLimit})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"asset-quota\",className:\"subscription-info\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"subscription-info-heading\",children:'空间'}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-2\",children:assetQuota?assetQuota+'GB':'1GB'})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"current-subscription-period\",className:\"subscription-info\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"subscription-info-heading\",children:'订阅有效期'}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-2\",children:termEnd})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"product-price\",className:\"subscription-info\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"subscription-info-heading\",children:'云服务付费方案'}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-2\",children:/*#__PURE__*/_jsx(\"a\",{rel:\"noopener noreferrer\",target:\"_blank\",href:\"https://www.seafile.com/seafile-docs/home/\",children:'查看详情'})})]}),paymentTypeList.map(function(item,index){var name=_this4.paymentTypeTransMap[item];return/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-primary mr-4\",onClick:_this4.togglePaymentType.bind(_this4,item),children:name},index);}),!this.state.subscription&&/*#__PURE__*/_jsxs(\"div\",{id:\"sales-consultant\",className:\"subscription-info mt-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"subscription-info-heading\",children:'销售咨询'}),/*#__PURE__*/_jsx(\"img\",{className:\"mb-2\",src:\"/media/img/qr-sale.png\",alt:\"\",width:\"112\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-2\",children:'微信扫码联系销售'})]})]}),isDialogOpen&&/*#__PURE__*/_jsx(PlansDialog,{paymentType:currentPaymentType,paymentTypeTrans:this.paymentTypeTransMap[currentPaymentType],isOrgContext:this.props.isOrgContext,toggleDialog:this.toggleDialog})]});}}]);return Subscription;}(Component);export default Subscription;","map":{"version":3,"names":["React","Component","Fragment","toaster","Modal","ModalHeader","ModalBody","ModalFooter","InputGroup","InputGroupAddon","InputGroupText","Input","Button","gettext","serviceURL","Utils","subscriptionAPI","Loading","jsx","_jsx","jsxs","_jsxs","isOrgContext","window","app","pageOptions","Plans","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","togglePlan","plan","setState","currentPlan","onPay","paymentType","_this$state","state","assetQuotaUnitCount","count","totalAmount","assetQuota","newUserCount","total_amount","asset_quota","price_per_user","asset_quota_unit","price_per_asset_quota_unit","danger","plan_id","onCountInputChange","e","can_custom_count","target","value","replace","onAssetQuotaUnitCountInputChange","can_custom_asset_quota","renderPaidOrExtendTime","_this$props","plans","boughtQuota","originalTotalAmount","className","children","map","item","index","selectedCss","countDescription","concat","onClick","bind","_assertThisInitialized","name","new_term_end","style","fontSize","textDecoration","color","renderAddUser","_this$state2","operationIntro","price","description","marginBottom","addonType","placeholder","title","type","min","max","disabled","onChange","renderBuyQuota","_this$state3","asset_quota_price","asset_quota_description","_createClass","key","render","PlansDialog","_Component2","_super2","_this2","getPlans","getSubscriptionPlans","then","res","planList","data","plan_list","paymentSourceList","payment_source_list","isLoading","catch","error","errorMsg","getErrorMsg","planID","isWaiting","payUrl","open","onReload","location","reload","componentDidMount","_this$state4","_this$props2","toggleDialog","paymentTypeTrans","modalStyle","width","maxWidth","isOpen","toggle","Subscription","_Component3","_super3","_this3","getSubscription","subscription","paymentTypeList","payment_type_list","isActive","is_active","planName","userLimit","user_limit","termEnd","term_end","isDialogOpen","togglePaymentType","currentPaymentType","paymentTypeTransMap","paid","extend_time","add_user","buy_quota","errorMsgCode","_this4","_this$state5","onScroll","handleContentScroll","id","rel","href","src","alt"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/subscription.js"],"sourcesContent":["import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport toaster from './toast';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, InputGroup, InputGroupAddon, InputGroupText, Input, Button } from 'reactstrap';\nimport { gettext, serviceURL } from '../utils/constants';\nimport { Utils } from '../utils/utils';\nimport { subscriptionAPI } from '../utils/subscription-api';\nimport Loading from './loading';\n\nimport '../css/layout.css';\nimport '../css/subscription.css';\n\nconst {\n  isOrgContext,\n} = window.app.pageOptions;\n\n\nconst PlansPropTypes = {\n  plans: PropTypes.array.isRequired,\n  onPay: PropTypes.func.isRequired,\n  paymentType: PropTypes.string.isRequired,\n  handleContentScroll: PropTypes.func.isRequired,\n};\n\nclass Plans extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentPlan: props.plans[0],\n      assetQuotaUnitCount: 1,\n      count: 1,\n    };\n  }\n\n  togglePlan = (plan) => {\n    this.setState({currentPlan: plan}, () => {\n    });\n  };\n\n  onPay = () => {\n    let { paymentType } = this.props;\n    let { currentPlan, assetQuotaUnitCount, count } = this.state;\n    let totalAmount, assetQuota, newUserCount;\n\n    // parse\n    if (paymentType === 'paid') {\n      newUserCount = currentPlan.count;\n      totalAmount = currentPlan.total_amount;\n    } else if (paymentType === 'extend_time') {\n      newUserCount = currentPlan.count;\n      assetQuota = currentPlan.asset_quota;\n      totalAmount = currentPlan.total_amount;\n    } else if (paymentType === 'add_user') {\n      newUserCount = count;\n      totalAmount = count * currentPlan.price_per_user;\n    } else if (paymentType === 'buy_quota') {\n      assetQuota = (assetQuotaUnitCount) * currentPlan.asset_quota_unit;\n      totalAmount = assetQuotaUnitCount * currentPlan.price_per_asset_quota_unit;\n    } else {\n      toaster.danger(gettext('Internal Server Error'));\n      return;\n    }\n\n    this.props.onPay(currentPlan.plan_id, newUserCount, assetQuota, totalAmount);\n  };\n\n  onCountInputChange = (e) => {\n    let { currentPlan } = this.state;\n    if (!currentPlan.can_custom_count) {\n      return;\n    }\n    let count = e.target.value.replace(/^(0+)|[^\\d]+/g, '');\n    if (count < 1) {\n      count = 1;\n    } else if (count > 9999) {\n      count = 9999;\n    }\n    this.setState({count: count});\n  };\n\n  onAssetQuotaUnitCountInputChange = (e) => {\n    let { currentPlan } = this.state;\n    if (!currentPlan.can_custom_asset_quota) {\n      return;\n    }\n    let count = e.target.value.replace(/^(0+)|[^\\d]+/g, '');\n    if (count < 1) {\n      count = 1;\n    } else if (count > 9999) {\n      count = 9999;\n    }\n    this.setState({assetQuotaUnitCount: count});\n  };\n\n  renderPaidOrExtendTime = () => {\n    let { plans, paymentType } = this.props;\n    let { currentPlan } = this.state;\n    let boughtQuota = 0;\n    if (paymentType === 'extend_time') {\n      boughtQuota = currentPlan.asset_quota - 100;\n    }\n    let totalAmount = currentPlan.total_amount;\n    let originalTotalAmount = totalAmount;\n    return (\n      <div className='d-flex flex-column subscription-container'>\n        <span className=\"subscription-subtitle\">{'选择方案'}</span>\n        <dl className='items-dl'>\n          {plans.map((item, index) => {\n            let selectedCss = item.plan_id === currentPlan.plan_id ? 'plan-selected' : '';\n            let countDescription = '￥' + item.price_per_user;\n            if (isOrgContext) {\n              countDescription += '/每用户';\n            }\n            return (\n              <dd key={index} className={`plan-description-item ${selectedCss}`} onClick={this.togglePlan.bind(this, item)}>\n                <span className='plan-name'>{item.name}</span>\n                <span className='plan-description'>{countDescription}</span>\n              </dd>\n            );\n          })}\n        </dl>\n\n        {paymentType === 'extend_time' && boughtQuota > 0 &&\n          <Fragment>\n            <span className=\"subscription-subtitle\">{'增加空间'}</span>\n            <dl className='items-dl'>\n              <dd className='order-item order-item-top order-item-bottom subscription-list'>\n                <span className='order-into'>{currentPlan.asset_quota_unit + 'GB x ' + (boughtQuota / currentPlan.asset_quota_unit)}</span>\n                {/* 续费时候需要减去附赠的100GB */}\n                <span className='order-value'>{'￥' + (boughtQuota / currentPlan.asset_quota_unit) * currentPlan.price_per_asset_quota_unit}</span>\n              </dd>\n            </dl>\n          </Fragment>\n        }\n\n        <span className=\"subscription-subtitle\">{'方案汇总'}</span>\n        <dl className='items-dl'>\n          <div>\n            <dd className='order-item order-item-top'>\n              <span className='order-into'>{'所选方案'}</span>\n              <span className='order-value'>{currentPlan.name}</span>\n            </dd>\n            {isOrgContext &&\n              <dd className='order-item'>\n                <span className='order-into'>{'成员人数'}</span>\n                <span className='order-value'>{currentPlan.count + '人'}</span>\n              </dd>\n            }\n            <dd className='order-item'>\n              <span className='order-into'>{'可用空间'}</span>\n              <span className='order-value'>{'100GB(附赠)' + (boughtQuota > 0 ? '+' + boughtQuota + 'GB(扩充)' : '')}</span>\n            </dd>\n            <dd className='order-item order-item-bottom rounded-0'>\n              <span className='order-into'>{'到期时间'}</span>\n              <span className='order-value'>{currentPlan.new_term_end}</span>\n            </dd>\n            <dd className='order-item order-item-bottom subscription-list'>\n              <span className='order-into'>{'实际支付金额'}</span>\n              <span className='order-price'>\n                {originalTotalAmount !== totalAmount &&\n                  <span style={{fontSize: 'small', textDecoration: 'line-through', color: '#9a9a9a'}}>{'￥' + originalTotalAmount}</span>\n                }\n                <span>{'￥' + totalAmount + ' '}</span>\n              </span>\n            </dd>\n          </div>\n        </dl>\n        <Button className='subscription-submit' color=\"primary\" onClick={this.onPay}>{'提交订单'}</Button>\n      </div>\n    );\n  };\n\n  renderAddUser = () => {\n    let { currentPlan, count } = this.state;\n    let operationIntro = '新增用户';\n    let originalTotalAmount = count * currentPlan.price_per_user;\n    let totalAmount = originalTotalAmount;\n    return (\n      <div className='d-flex flex-column subscription-container price-version-container-header subscription-add-user'>\n        <div className=\"price-version-container-top\"></div>\n        <h3 className='user-quota-plan-name py-5'>{currentPlan.name}</h3>\n        <span className='py-2 mb-0 text-orange font-500 text-center'>\n          {'¥ '}<span className=\"price-version-plan-price\">{currentPlan.price}</span>{' ' + currentPlan.description}\n        </span>\n        <InputGroup style={{marginBottom: '5px'}} className='user-numbers'>\n          <InputGroupAddon addonType=\"prepend\">\n            <InputGroupText>{operationIntro}</InputGroupText>\n          </InputGroupAddon>\n          <Input\n            className=\"py-2\"\n            placeholder={operationIntro}\n            title={operationIntro}\n            type=\"number\"\n            value={count || 1}\n            min=\"1\"\n            max=\"9999\"\n            disabled={!currentPlan.can_custom_count}\n            onChange={this.onCountInputChange}\n          />\n        </InputGroup>\n        <span className='py-2 text-orange mb-0 font-500 price-version-plan-whole-price text-center'>\n          {'总价 ¥ ' + totalAmount}\n          {originalTotalAmount !== totalAmount &&\n            <span style={{fontSize: 'small', textDecoration: 'line-through', color: '#9a9a9a'}}>{' ￥' + originalTotalAmount}</span>\n          }\n        </span>\n        <span className='py-2 mb-0 text-lg-size font-500 price-version-plan-valid-day text-center'>{'有效期至 ' + currentPlan.new_term_end}</span>\n        <span className='subscription-notice text-center py-5'>{'注：当有效期剩余天数少于计划中的时候，增加用户的价格按天来计算'}</span>\n        <Button className='subscription-submit' onClick={this.onPay} color=\"primary\">{'立即购买'}</Button>\n      </div>\n    );\n  };\n\n  renderBuyQuota = () => {\n    let { currentPlan, assetQuotaUnitCount } = this.state;\n    let operationIntro = '新增空间';\n    let originalTotalAmount = assetQuotaUnitCount * currentPlan.price_per_asset_quota_unit;\n    let totalAmount = originalTotalAmount;\n    return (\n      <div className='d-flex flex-column subscription-container price-version-container-header subscription-add-space'>\n        <div className=\"price-version-container-top\"></div>\n        <h3 className='user-quota-plan-name py-5'>{currentPlan.name}</h3>\n        <span className='py-2 mb-0 text-orange font-500 text-center'>\n          {'¥ '}<span className=\"price-version-plan-price\">{currentPlan.asset_quota_price}</span>{' ' + currentPlan.asset_quota_description}\n        </span>\n        <InputGroup style={{marginBottom: '5px'}} className='space-quota'>\n          <InputGroupAddon addonType=\"prepend\">\n            <InputGroupText><span className=\"font-500\">{operationIntro}</span></InputGroupText>\n          </InputGroupAddon>\n          <Input\n            className=\"py-2\"\n            placeholder={operationIntro}\n            title={operationIntro}\n            type=\"number\"\n            value={assetQuotaUnitCount || 1}\n            min=\"1\"\n            max=\"9999\"\n            disabled={!currentPlan.can_custom_asset_quota}\n            onChange={this.onAssetQuotaUnitCountInputChange}\n          />\n          <InputGroupAddon addonType='append'>\n            <InputGroupText><span className=\"font-500\">{' x ' + currentPlan.asset_quota_unit + 'GB'}</span></InputGroupText>\n          </InputGroupAddon>\n        </InputGroup>\n        <span className='py-4 text-orange mb-0 font-500 price-version-plan-whole-price text-center'>\n          {'总价 ¥ ' + totalAmount}\n          {originalTotalAmount !== totalAmount &&\n            <span style={{fontSize: 'small', textDecoration: 'line-through', color: '#9a9a9a'}}>{' ￥' + originalTotalAmount}</span>\n          }\n        </span>\n        <span className='py-2 mb-0 text-lg-size font-500 price-version-plan-valid-day text-center'>{'有效期至 ' + currentPlan.new_term_end}</span>\n        <span className='subscription-notice text-center py-5'>{'注：当有效期剩余天数少于计划中的时候，增加空间的价格按天来计算'}</span>\n        <Button className='subscription-submit' onClick={this.onPay} color=\"primary\">{'立即购买'}</Button>\n      </div>\n    );\n  };\n\n  render() {\n    let { paymentType } = this.props;\n    if (paymentType === 'paid' || paymentType === 'extend_time') {\n      return this.renderPaidOrExtendTime();\n    } else if (paymentType === 'add_user') {\n      return this.renderAddUser();\n    } else if (paymentType === 'buy_quota') {\n      return this.renderBuyQuota();\n    } else {\n      toaster.danger(gettext('Internal Server Error'));\n      return;\n    }\n  }\n}\n\nPlans.propTypes = PlansPropTypes;\n\nconst PlansDialogPropTypes = {\n  isOrgContext: PropTypes.bool.isRequired,\n  paymentType: PropTypes.string.isRequired,\n  paymentTypeTrans: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n};\n\nclass PlansDialog extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      isWaiting: false,\n      planList: [],\n      paymentSourceList: [],\n    };\n  }\n\n  getPlans = () => {\n    subscriptionAPI.getSubscriptionPlans(this.props.paymentType).then((res) => {\n      this.setState({\n        planList: res.data.plan_list,\n        paymentSourceList: res.data.payment_source_list,\n        isLoading: false,\n      });\n    }).catch(error => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        isLoading: false,\n        errorMsg: errorMsg,\n      });\n    });\n  };\n\n  onPay = (planID, count, asset_quota, totalAmount) => {\n    this.setState({ isWaiting: true });\n    let payUrl = serviceURL + '/subscription/pay/?payment_source=' + this.state.paymentSourceList[0] +\n      '&payment_type=' + this.props.paymentType + '&plan_id=' + planID +\n      '&total_amount=' + totalAmount;\n    if (count) {\n      payUrl += '&count=' + count;\n    }\n    if (asset_quota) {\n      payUrl += '&asset_quota=' + asset_quota;\n    }\n    window.open(payUrl);\n  };\n\n  onReload = () => {\n    window.location.reload();\n  };\n\n  componentDidMount() {\n    this.getPlans();\n  }\n\n  render() {\n    const { isLoading, isWaiting, planList } = this.state;\n    const { toggleDialog, paymentTypeTrans, paymentType } = this.props;\n    const modalStyle = (paymentType === 'paid' || paymentType === 'extend_time') ?\n      {width: '560px', maxWidth: '560px'} : {width: '560px'};\n\n    if (isLoading) {\n      return (\n        <Modal isOpen={true} toggle={toggleDialog}>\n          <ModalHeader toggle={toggleDialog}>{paymentTypeTrans}</ModalHeader>\n          <ModalBody>\n            <Loading />\n          </ModalBody>\n        </Modal>\n      );\n    }\n    if (isWaiting) {\n      return (\n        <Modal isOpen={true} toggle={this.onReload}>\n          <ModalHeader toggle={this.onReload}>{paymentTypeTrans}</ModalHeader>\n          <ModalBody>\n            <div>{'是否完成付款?'}</div>\n          </ModalBody>\n          <ModalFooter>\n            <button className=\"btn btn-outline-primary\" onClick={this.onReload}>{'是'}</button>\n          </ModalFooter>\n        </Modal>\n      );\n    }\n    return (\n      <Modal isOpen={true} toggle={toggleDialog} style={modalStyle}>\n        <ModalHeader toggle={toggleDialog}>{paymentTypeTrans}</ModalHeader>\n        <ModalBody>\n          <div className=\"d-flex justify-content-between\">\n            <Plans\n              plans={planList}\n              onPay={this.onPay}\n              paymentType={this.props.paymentType}\n            />\n          </div>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nPlansDialog.propTypes = PlansDialogPropTypes;\n\nconst propTypes = {\n  isOrgContext: PropTypes.bool.isRequired,\n  handleContentScroll: PropTypes.func,\n};\n\nclass Subscription extends Component {\n\n  constructor(props) {\n    super(props);\n    this.paymentTypeTransMap = {\n      paid: '立即购买',\n      extend_time: '立即续费',\n      add_user: '增加用户',\n      buy_quota: '增加空间',\n    };\n    this.state = {\n      isLoading: true,\n      errorMsg: '',\n      isDialogOpen: false,\n      planName: this.props.isOrgContext ? '团队版' : '个人版',\n      userLimit: 20,\n      assetQuota: 1,\n      termEnd: '长期',\n      subscription: null,\n      paymentTypeList: [],\n      currentPaymentType: '',\n      errorMsgCode: ''\n    };\n  }\n\n  getSubscription = () => {\n    subscriptionAPI.getSubscription().then((res) => {\n      const subscription = res.data.subscription;\n      const paymentTypeList = res.data.payment_type_list;\n      if (!subscription) {\n        this.setState({\n          isLoading: false,\n          paymentTypeList: paymentTypeList,\n        });\n      } else {\n        let isActive = subscription.is_active;\n        let plan = subscription.plan;\n        this.setState({\n          isLoading: false,\n          subscription,\n          planName: plan.name,\n          userLimit: subscription.user_limit,\n          assetQuota: isActive ? subscription.asset_quota : plan.asset_quota,\n          termEnd: isActive ? subscription.term_end : '已过期',\n          paymentTypeList: paymentTypeList,\n        });\n      }\n    }).catch(error => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        isLoading: false,\n        errorMsg: errorMsg,\n      });\n    });\n  };\n\n  toggleDialog = () => {\n    this.setState({ isDialogOpen: !this.state.isDialogOpen });\n  };\n\n  togglePaymentType = (paymentType) => {\n    this.setState({ currentPaymentType: paymentType });\n    this.toggleDialog();\n  };\n\n  componentDidMount() {\n    this.getSubscription();\n  }\n\n  render() {\n    const { isLoading, errorMsg, planName, userLimit, assetQuota, termEnd,\n      isDialogOpen, paymentTypeList, currentPaymentType } = this.state;\n    if (isLoading) {\n      return <Loading />;\n    }\n    if (errorMsg) {\n      return <p className=\"text-center mt-8 error\">{errorMsg}</p>;\n    }\n    return (\n      <Fragment>\n        <div className=\"content position-relative\" onScroll={this.props.handleContentScroll}>\n          <div id=\"current-plan\" className=\"subscription-info\">\n            <h3 className=\"subscription-info-heading\">{'当前版本'}</h3>\n            <p className=\"mb-2\">{planName}</p>\n          </div>\n          {this.props.isOrgContext &&\n            <div id=\"user-limit\" className=\"subscription-info\">\n              <h3 className=\"subscription-info-heading\">{'用户数限制'}</h3>\n              <p className=\"mb-2\">{userLimit}</p>\n            </div>\n          }\n          <div id=\"asset-quota\" className=\"subscription-info\">\n            <h3 className=\"subscription-info-heading\">{'空间'}</h3>\n            <p className=\"mb-2\">{assetQuota ? assetQuota + 'GB' : '1GB'}</p>\n          </div>\n          <div id=\"current-subscription-period\" className=\"subscription-info\">\n            <h3 className=\"subscription-info-heading\">{'订阅有效期'}</h3>\n            <p className=\"mb-2\">{termEnd}</p>\n          </div>\n          <div id=\"product-price\" className=\"subscription-info\">\n            <h3 className=\"subscription-info-heading\">{'云服务付费方案'}</h3>\n            <p className=\"mb-2\">\n              <a rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://www.seafile.com/seafile-docs/home/\">{'查看详情'}</a>\n            </p>\n          </div>\n          {paymentTypeList.map((item, index) => {\n            let name = this.paymentTypeTransMap[item];\n            return (\n              <button\n                key={index}\n                className=\"btn btn-outline-primary mr-4\"\n                onClick={this.togglePaymentType.bind(this, item)}\n              >{name}</button>\n            );\n          })}\n          {!this.state.subscription &&\n            <div id=\"sales-consultant\" className=\"subscription-info mt-6\">\n              <h3 className=\"subscription-info-heading\">{'销售咨询'}</h3>\n              <img className=\"mb-2\" src=\"/media/img/qr-sale.png\" alt=\"\" width=\"112\"></img>\n              <p className=\"mb-2\">{'微信扫码联系销售'}</p>\n            </div>\n          }\n        </div>\n        {isDialogOpen &&\n          <PlansDialog\n            paymentType={currentPaymentType}\n            paymentTypeTrans={this.paymentTypeTransMap[currentPaymentType]}\n            isOrgContext={this.props.isOrgContext}\n            toggleDialog={this.toggleDialog}\n          />\n        }\n      </Fragment>\n    );\n  }\n}\n\nSubscription.propTypes = propTypes;\n\nexport default Subscription;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}