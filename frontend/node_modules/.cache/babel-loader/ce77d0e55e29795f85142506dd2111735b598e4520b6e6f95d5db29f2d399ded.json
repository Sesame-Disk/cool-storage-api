{"ast":null,"code":"import _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n/* eslint-disable react-hooks/rules-of-hooks */\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { Node } from '@seafile/slate';\nimport ParticipantPopover from './participant-popover';\nimport EventBus from '../../../../utils/event-bus';\nimport { INTERNAL_EVENT } from '../../../../constants';\nimport './index.css';\nvar renderMention = function renderMention(_ref) {\n  var attributes = _ref.attributes,\n    children = _ref.children,\n    element = _ref.element,\n    editor = _ref.editor,\n    readonly = _ref.readonly;\n  return /*#__PURE__*/React.createElement(\"span\", Object.assign({}, attributes, {\n    contentEditable: \"false\",\n    key: element.id\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"sdoc-mention\"\n  }, children));\n};\nvar renderMentionTemporaryInput = function renderMentionTemporaryInput(_ref2, editor) {\n  var attributes = _ref2.attributes,\n    children = _ref2.children,\n    element = _ref2.element,\n    readonly = _ref2.readonly;\n  var _useState = useState(''),\n    _useState2 = _slicedToArray(_useState, 2),\n    searchText = _useState2[0],\n    setSearchText = _useState2[1];\n  var updateSearchText = useCallback(function (_ref3) {\n    var compositionText = _ref3.compositionText;\n    setSearchText(Node.string(element) + compositionText);\n  }, [element]);\n  useEffect(function () {\n    setSearchText(Node.string(element));\n  }, [element]);\n  useEffect(function () {\n    var eventBus = EventBus.getInstance();\n    eventBus.subscribe(INTERNAL_EVENT.UPDATE_MENTION_TEMP_CONTENT, updateSearchText);\n  }, [updateSearchText]);\n  return /*#__PURE__*/React.createElement(\"span\", Object.assign({}, attributes, {\n    className: \"sdoc-mention-temp-ipt\"\n  }), /*#__PURE__*/React.createElement(\"span\", null, \"@\"), /*#__PURE__*/React.createElement(\"span\", null, children), /*#__PURE__*/React.createElement(ParticipantPopover, {\n    searchText: searchText,\n    editor: editor\n  }));\n};\nexport { renderMention, renderMentionTemporaryInput };","map":{"version":3,"names":["React","useCallback","useEffect","useState","Node","ParticipantPopover","EventBus","INTERNAL_EVENT","renderMention","_ref","attributes","children","element","editor","readonly","createElement","Object","assign","contentEditable","key","id","className","renderMentionTemporaryInput","_ref2","_useState","_useState2","_slicedToArray","searchText","setSearchText","updateSearchText","_ref3","compositionText","string","eventBus","getInstance","subscribe","UPDATE_MENTION_TEMP_CONTENT"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/extension/plugins/mention/render-elem/index.js"],"sourcesContent":["/* eslint-disable react-hooks/rules-of-hooks */\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { Node } from '@seafile/slate';\nimport ParticipantPopover from './participant-popover';\nimport EventBus from '../../../../utils/event-bus';\nimport { INTERNAL_EVENT } from '../../../../constants';\nimport './index.css';\nconst renderMention = _ref => {\n  let {\n    attributes,\n    children,\n    element,\n    editor,\n    readonly\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"span\", Object.assign({}, attributes, {\n    contentEditable: \"false\",\n    key: element.id\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"sdoc-mention\"\n  }, children));\n};\nconst renderMentionTemporaryInput = (_ref2, editor) => {\n  let {\n    attributes,\n    children,\n    element,\n    readonly\n  } = _ref2;\n  const [searchText, setSearchText] = useState('');\n  const updateSearchText = useCallback(_ref3 => {\n    let {\n      compositionText\n    } = _ref3;\n    setSearchText(Node.string(element) + compositionText);\n  }, [element]);\n  useEffect(() => {\n    setSearchText(Node.string(element));\n  }, [element]);\n  useEffect(() => {\n    const eventBus = EventBus.getInstance();\n    eventBus.subscribe(INTERNAL_EVENT.UPDATE_MENTION_TEMP_CONTENT, updateSearchText);\n  }, [updateSearchText]);\n  return /*#__PURE__*/React.createElement(\"span\", Object.assign({}, attributes, {\n    className: \"sdoc-mention-temp-ipt\"\n  }), /*#__PURE__*/React.createElement(\"span\", null, \"@\"), /*#__PURE__*/React.createElement(\"span\", null, children), /*#__PURE__*/React.createElement(ParticipantPopover, {\n    searchText: searchText,\n    editor: editor\n  }));\n};\nexport { renderMention, renderMentionTemporaryInput };"],"mappings":";AAAA;AACA,OAAOA,KAAK,IAAIC,WAAW,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC/D,SAASC,IAAI,QAAQ,gBAAgB;AACrC,OAAOC,kBAAkB,MAAM,uBAAuB;AACtD,OAAOC,QAAQ,MAAM,6BAA6B;AAClD,SAASC,cAAc,QAAQ,uBAAuB;AACtD,OAAO,aAAa;AACpB,IAAMC,aAAa,GAAG,SAAhBA,aAAaA,CAAGC,IAAI,EAAI;EAC5B,IACEC,UAAU,GAKRD,IAAI,CALNC,UAAU;IACVC,QAAQ,GAINF,IAAI,CAJNE,QAAQ;IACRC,OAAO,GAGLH,IAAI,CAHNG,OAAO;IACPC,MAAM,GAEJJ,IAAI,CAFNI,MAAM;IACNC,QAAQ,GACNL,IAAI,CADNK,QAAQ;EAEV,OAAO,aAAad,KAAK,CAACe,aAAa,CAAC,MAAM,EAAEC,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,EAAEP,UAAU,EAAE;IAC5EQ,eAAe,EAAE,OAAO;IACxBC,GAAG,EAAEP,OAAO,CAACQ;EACf,CAAC,CAAC,EAAE,aAAapB,KAAK,CAACe,aAAa,CAAC,QAAQ,EAAE;IAC7CM,SAAS,EAAE;EACb,CAAC,EAAEV,QAAQ,CAAC,CAAC;AACf,CAAC;AACD,IAAMW,2BAA2B,GAAG,SAA9BA,2BAA2BA,CAAIC,KAAK,EAAEV,MAAM,EAAK;EACrD,IACEH,UAAU,GAIRa,KAAK,CAJPb,UAAU;IACVC,QAAQ,GAGNY,KAAK,CAHPZ,QAAQ;IACRC,OAAO,GAELW,KAAK,CAFPX,OAAO;IACPE,QAAQ,GACNS,KAAK,CADPT,QAAQ;EAEV,IAAAU,SAAA,GAAoCrB,QAAQ,CAAC,EAAE,CAAC;IAAAsB,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAAzCG,UAAU,GAAAF,UAAA;IAAEG,aAAa,GAAAH,UAAA;EAChC,IAAMI,gBAAgB,GAAG5B,WAAW,CAAC,UAAA6B,KAAK,EAAI;IAC5C,IACEC,eAAe,GACbD,KAAK,CADPC,eAAe;IAEjBH,aAAa,CAACxB,IAAI,CAAC4B,MAAM,CAACpB,OAAO,CAAC,GAAGmB,eAAe,CAAC;EACvD,CAAC,EAAE,CAACnB,OAAO,CAAC,CAAC;EACbV,SAAS,CAAC,YAAM;IACd0B,aAAa,CAACxB,IAAI,CAAC4B,MAAM,CAACpB,OAAO,CAAC,CAAC;EACrC,CAAC,EAAE,CAACA,OAAO,CAAC,CAAC;EACbV,SAAS,CAAC,YAAM;IACd,IAAM+B,QAAQ,GAAG3B,QAAQ,CAAC4B,WAAW,CAAC,CAAC;IACvCD,QAAQ,CAACE,SAAS,CAAC5B,cAAc,CAAC6B,2BAA2B,EAAEP,gBAAgB,CAAC;EAClF,CAAC,EAAE,CAACA,gBAAgB,CAAC,CAAC;EACtB,OAAO,aAAa7B,KAAK,CAACe,aAAa,CAAC,MAAM,EAAEC,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,EAAEP,UAAU,EAAE;IAC5EW,SAAS,EAAE;EACb,CAAC,CAAC,EAAE,aAAarB,KAAK,CAACe,aAAa,CAAC,MAAM,EAAE,IAAI,EAAE,GAAG,CAAC,EAAE,aAAaf,KAAK,CAACe,aAAa,CAAC,MAAM,EAAE,IAAI,EAAEJ,QAAQ,CAAC,EAAE,aAAaX,KAAK,CAACe,aAAa,CAACV,kBAAkB,EAAE;IACtKsB,UAAU,EAAEA,UAAU;IACtBd,MAAM,EAAEA;EACV,CAAC,CAAC,CAAC;AACL,CAAC;AACD,SAASL,aAAa,EAAEc,2BAA2B"},"metadata":{},"sourceType":"module","externalDependencies":[]}