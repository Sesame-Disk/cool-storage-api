{"ast":null,"code":"import _objectSpread from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import AsyncSelect from'react-select/async';import{seafileAPI}from'../utils/seafile-api';import{gettext,enableShowContactEmailWhenSearchUser,enableShowLoginIDWhenSearchUser}from'../utils/constants';import{Utils}from'../utils/utils';import toaster from'./toast';import{UserSelectStyle}from'./common/select';import'../css/user-select.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UserSelect=/*#__PURE__*/function(_React$Component){_inherits(UserSelect,_React$Component);var _super=_createSuper(UserSelect);function UserSelect(props){var _this;_classCallCheck(this,UserSelect);_this=_super.call(this,props);_this.onInputChange=function(searchValue){_this.setState({searchValue:searchValue});};_this.handleSelectChange=function(option){_this.options=[];_this.props.onSelectChange(option);};_this.loadOptions=function(input,callback){var value=input.trim();_this.finalValue=value;setTimeout(function(){if(_this.finalValue===value&&value.length>0){seafileAPI.searchUsers(value).then(function(res){_this.options=[];for(var i=0;i<res.data.users.length;i++){var item=res.data.users[i];var obj={};obj.value=item.name;obj.email=item.email;obj.label=enableShowContactEmailWhenSearchUser||enableShowLoginIDWhenSearchUser?/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",children:[/*#__PURE__*/_jsx(\"img\",{src:item.avatar_url,className:\"avatar\",width:\"24\",alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"user-option-name\",children:item.name}),/*#__PURE__*/_jsx(\"br\",{}),enableShowContactEmailWhenSearchUser&&/*#__PURE__*/_jsx(\"span\",{className:\"user-option-email\",children:item.contact_email}),enableShowLoginIDWhenSearchUser&&/*#__PURE__*/_jsx(\"span\",{className:\"user-option-email\",children:item.login_id})]})]}):/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(\"img\",{src:item.avatar_url,className:\"select-module select-module-icon avatar\",alt:\"\"}),/*#__PURE__*/_jsx(\"span\",{className:\"select-module select-module-name\",children:item.name})]});_this.options.push(obj);}callback(_this.options);}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});}},1000);};_this.clearSelect=function(){_this.refs.userSelect.onChange([],{action:'clear'});};_this.options=[];_this.finalValue='';_this.state={searchValue:''};return _this;}_createClass(UserSelect,[{key:\"render\",value:function render(){var searchValue=this.state.searchValue;var style={margin:'6px 10px',textAlign:'center',color:'hsl(0,0%,50%)'};return/*#__PURE__*/_jsx(AsyncSelect,{isClearable:true,classNamePrefix:true,components:{NoOptionsMessage:function NoOptionsMessage(props){return/*#__PURE__*/_jsx(\"div\",_objectSpread(_objectSpread({},props.innerProps),{},{style:style,children:searchValue?gettext('User not found'):gettext('Enter characters to start searching')}));}},isMulti:this.props.isMulti,loadOptions:this.loadOptions,onChange:this.handleSelectChange,onInputChange:this.onInputChange,placeholder:this.props.placeholder,className:\"user-select \".concat(this.props.className),value:this.props.value,ref:\"userSelect\",styles:UserSelectStyle});}}]);return UserSelect;}(React.Component);export default UserSelect;","map":{"version":3,"names":["React","AsyncSelect","seafileAPI","gettext","enableShowContactEmailWhenSearchUser","enableShowLoginIDWhenSearchUser","Utils","toaster","UserSelectStyle","jsx","_jsx","jsxs","_jsxs","UserSelect","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","onInputChange","searchValue","setState","handleSelectChange","option","options","onSelectChange","loadOptions","input","callback","value","trim","finalValue","setTimeout","length","searchUsers","then","res","i","data","users","item","obj","name","email","label","className","children","src","avatar_url","width","alt","contact_email","login_id","Fragment","push","catch","error","errMessage","getErrorMsg","danger","clearSelect","refs","userSelect","onChange","action","state","_createClass","key","render","style","margin","textAlign","color","isClearable","classNamePrefix","components","NoOptionsMessage","_objectSpread","innerProps","isMulti","placeholder","concat","ref","styles","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/user-select.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport AsyncSelect from 'react-select/async';\nimport { seafileAPI } from '../utils/seafile-api';\nimport { gettext, enableShowContactEmailWhenSearchUser, enableShowLoginIDWhenSearchUser } from '../utils/constants';\nimport { Utils } from '../utils/utils';\nimport toaster from './toast';\nimport { UserSelectStyle } from './common/select';\n\nimport '../css/user-select.css';\n\nconst propTypes = {\n  placeholder: PropTypes.string.isRequired,\n  onSelectChange: PropTypes.func.isRequired,\n  isMulti: PropTypes.bool.isRequired,\n  className: PropTypes.string,\n  value: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n};\n\nclass UserSelect extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.options = [];\n    this.finalValue = '';\n    this.state = {\n      searchValue: ''\n    };\n  }\n\n  onInputChange = (searchValue) => {\n    this.setState({ searchValue });\n  };\n\n  handleSelectChange = (option) => {\n    this.options = [];\n    this.props.onSelectChange(option);\n  };\n\n  loadOptions = (input, callback) => {\n    const value = input.trim();\n    this.finalValue = value;\n    setTimeout(() => {\n      if (this.finalValue === value && value.length > 0) {\n        seafileAPI.searchUsers(value).then((res) => {\n          this.options = [];\n          for (let i = 0 ; i < res.data.users.length; i++) {\n            const item = res.data.users[i];\n            let obj = {};\n            obj.value = item.name;\n            obj.email = item.email;\n            obj.label = (enableShowContactEmailWhenSearchUser || enableShowLoginIDWhenSearchUser) ? (\n              <div className=\"d-flex\">\n                <img src={item.avatar_url} className=\"avatar\" width=\"24\" alt=\"\" />\n                <div className=\"ml-2\">\n                  <span className=\"user-option-name\">{item.name}</span><br />\n                  {enableShowContactEmailWhenSearchUser && <span className=\"user-option-email\">{item.contact_email}</span>}\n                  {enableShowLoginIDWhenSearchUser && <span className=\"user-option-email\">{item.login_id}</span>}\n                </div>\n              </div>\n            ) : (\n              <React.Fragment>\n                <img src={item.avatar_url} className=\"select-module select-module-icon avatar\" alt=\"\"/>\n                <span className='select-module select-module-name'>{item.name}</span>\n              </React.Fragment>\n            );\n            this.options.push(obj);\n          }\n          callback(this.options);\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n    }, 1000);\n  };\n\n  clearSelect = () => {\n    this.refs.userSelect.onChange([], { action: 'clear' });\n  };\n\n  render() {\n    const searchValue = this.state.searchValue;\n    const style = { margin: '6px 10px', textAlign: 'center', color: 'hsl(0,0%,50%)' };\n    return (\n      <AsyncSelect\n        isClearable\n        classNamePrefix\n        components={{\n          NoOptionsMessage: (props) => {\n            return (\n              <div {...props.innerProps} style={style}>{searchValue ? gettext('User not found') : gettext('Enter characters to start searching')}</div>\n            );\n          }\n        }}\n        isMulti={this.props.isMulti}\n        loadOptions={this.loadOptions}\n        onChange={this.handleSelectChange}\n        onInputChange={this.onInputChange}\n        placeholder={this.props.placeholder}\n        className={`user-select ${this.props.className}`}\n        value={this.props.value}\n        ref=\"userSelect\"\n        styles={UserSelectStyle}\n      />\n    );\n  }\n}\n\nUserSelect.propTypes = propTypes;\n\nexport default UserSelect;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}