{"ast":null,"code":"import _slicedToArray from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useCallback, useMemo, Fragment } from 'react';\nimport { Editable, ReactEditor, Slate } from '@seafile/slate-react';\nimport { Editor, Node, Transforms } from '@seafile/slate';\nimport scrollIntoView from 'scroll-into-view-if-needed';\nimport { renderLeaf, renderElement, ContextToolbar, SideToolbar } from '../extension';\nimport { getAboveBlockNode, getNextNode, getPrevNode, isSelectionAtBlockEnd, isSelectionAtBlockStart, getCurrentNode, isCurrentLineEmpty, isCurrentLineHasText } from '../extension/core';\nimport EventProxy from '../utils/event-handler';\nimport { useCursors } from '../cursor/use-cursors';\nimport { INTERNAL_EVENT } from '../constants';\nimport CommentWrapper from '../comment';\nimport { usePipDecorate } from '../decorates';\nimport { getCursorPosition, getDomHeight, getDomMarginTop } from '../utils/dom-utils';\nimport EventBus from '../utils/event-bus';\nimport { ArticleContainer } from '../layout';\nimport { useScrollContext } from '../hooks/use-scroll-context';\nimport { SetNodeToDecorations } from '../highlight';\nimport { IMAGE, IMAGE_BLOCK, CODE_LINE } from '../extension/constants';\nimport { isPreventResetTableSelectedRange } from '../extension/plugins/table/helpers';\nvar EditableArticle = function EditableArticle(_ref) {\n  var showComment = _ref.showComment,\n    editor = _ref.editor,\n    slateValue = _ref.slateValue,\n    updateSlateValue = _ref.updateSlateValue;\n  var _useCursors = useCursors(editor),\n    cursors = _useCursors.cursors;\n  var decorate = usePipDecorate(editor);\n\n  // init eventHandler\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  var eventProxy = useMemo(function () {\n    return new EventProxy(editor);\n  }, []);\n  var onMouseDown = useCallback(function (event) {\n    if (event.button === 0) {\n      var isPreventReset = isPreventResetTableSelectedRange(event);\n      if (!isPreventReset) {\n        editor.reSetTableSelectedRange();\n        var eventBus = EventBus.getInstance();\n        eventBus.dispatch(INTERNAL_EVENT.CANCEL_TABLE_SELECT_RANGE);\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  var scrollRef = useScrollContext();\n  var onKeyDown = useCallback(function (event) {\n    var _scrollRef$current = scrollRef.current,\n      scrollTop = _scrollRef$current.scrollTop,\n      clientHeight = _scrollRef$current.clientHeight;\n    eventProxy.onKeyDown(event);\n    if (event.key === 'ArrowLeft') {\n      if (!isSelectionAtBlockStart(editor)) return;\n    }\n    if (event.key === 'ArrowUp' || event.key === 'ArrowLeft') {\n      if (scrollTop === 0) return;\n      var prevNode = getPrevNode(editor);\n      if (!prevNode) return;\n      var domNode = ReactEditor.toDOMNode(editor, prevNode[0]);\n      var domHeight = getDomHeight(domNode);\n      var isScrollUp = true;\n      var _getCursorPosition = getCursorPosition(isScrollUp),\n        y = _getCursorPosition.y;\n      if (y >= domHeight) return;\n      scrollRef.current.scroll(0, Math.max(0, scrollTop - domHeight));\n      return;\n    }\n    if (event.key === 'ArrowRight') {\n      if (!isSelectionAtBlockEnd(editor)) return;\n    }\n    if (event.key === 'ArrowDown' || event.key === 'ArrowRight') {\n      var nextNode = getNextNode(editor);\n      if (!nextNode) return;\n      var _domNode = ReactEditor.toDOMNode(editor, nextNode[0]);\n      var _domHeight = getDomHeight(_domNode);\n      var _isScrollUp = false;\n      var _getCursorPosition2 = getCursorPosition(_isScrollUp),\n        _y = _getCursorPosition2.y;\n      if (clientHeight - _y >= _domHeight) return;\n      scrollRef.current.scroll(0, Math.max(0, scrollTop + _domHeight));\n      return;\n    }\n    if (event.key === 'Backspace') {\n      var _getCurrentNode = getCurrentNode(editor),\n        _getCurrentNode2 = _slicedToArray(_getCurrentNode, 1),\n        currentNode = _getCurrentNode2[0];\n      var _prevNode = null;\n      var prevPath = null;\n      if (getPrevNode(editor)) {\n        var _getPrevNode = getPrevNode(editor);\n        var _getPrevNode2 = _slicedToArray(_getPrevNode, 2);\n        _prevNode = _getPrevNode2[0];\n        prevPath = _getPrevNode2[1];\n      }\n      // If the cursor is at the beginning, and the current line is not empty, is not a CODE_LINE, and the previous line is a CODE_LINE.\n      if (_prevNode && isSelectionAtBlockStart(editor) && !isCurrentLineEmpty(editor) && _prevNode.type === CODE_LINE && currentNode.type !== CODE_LINE) {\n        if (!isCurrentLineHasText(currentNode)) {\n          var prevNodeText = Node.string(_prevNode);\n          Transforms.removeNodes(editor, {\n            at: prevPath\n          });\n          Transforms.insertText(editor, prevNodeText);\n          event.preventDefault();\n        } else {\n          var path = prevPath;\n          path[path.length] = 0;\n          var end = _prevNode.children[0].text.length;\n          var range = {\n            anchor: {\n              path: path,\n              offset: end\n            },\n            focus: {\n              path: path,\n              offset: end\n            }\n          };\n          Transforms.select(editor, range);\n          event.preventDefault();\n        }\n      }\n      var _getCursorPosition3 = getCursorPosition(),\n        _y2 = _getCursorPosition3.y;\n\n      // above viewport\n      if (_y2 < 0) {\n        var newY = Math.abs(_y2);\n        if (isSelectionAtBlockStart(editor)) {\n          var _prevNode2 = getPrevNode(editor);\n          if (!_prevNode2) return;\n          var _domNode2 = ReactEditor.toDOMNode(editor, _prevNode2[0]);\n          var _domHeight2 = getDomHeight(_domNode2);\n          var node = getAboveBlockNode(editor);\n          if (!node) return;\n          var currentDomNode = ReactEditor.toDOMNode(editor, node[0]);\n          var marginTop = getDomMarginTop(currentDomNode);\n          scrollRef.current.scroll(0, Math.max(0, scrollTop - (newY + _domHeight2 + marginTop)));\n        } else {\n          scrollRef.current.scroll(0, Math.max(0, scrollTop - newY));\n        }\n        return;\n      }\n\n      // insider viewport\n      if (_y2 >= 0 && _y2 <= clientHeight) {\n        if (isSelectionAtBlockStart(editor)) {\n          var _prevNode3 = getPrevNode(editor);\n          if (!_prevNode3) return;\n          var _domNode3 = ReactEditor.toDOMNode(editor, _prevNode3[0]);\n          var _domHeight3 = getDomHeight(_domNode3);\n          if (_y2 >= _domHeight3) return;\n          // Scroll up the height of the previous block\n          scrollRef.current.scroll(0, Math.max(0, scrollTop - _domHeight3));\n          return;\n        }\n      }\n\n      // below viewport\n      if (_y2 > clientHeight) {\n        if (isSelectionAtBlockStart(editor)) {\n          // y: text top border\n          scrollRef.current.scroll(0, Math.max(0, scrollTop + (_y2 - clientHeight)));\n        } else {\n          var marginBottom = 11.2;\n          var _getCursorPosition4 = getCursorPosition(false),\n            _newY = _getCursorPosition4.y;\n          var rectBottom = _newY + marginBottom; // text bottom border\n          scrollRef.current.scroll(0, Math.max(0, scrollTop + (rectBottom - clientHeight)));\n        }\n        return;\n      }\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [scrollRef]);\n  var handleScrollIntoView = useCallback(function (editor, domRange) {\n    try {\n      var selection = editor.selection;\n      // Do not scroll into view, when focus on image\n      var _Editor$nodes = Editor.nodes(editor, {\n          match: function match(n) {\n            return [IMAGE, IMAGE_BLOCK].includes(n.type);\n          },\n          at: selection\n        }),\n        _Editor$nodes2 = _slicedToArray(_Editor$nodes, 1),\n        imageNodeEntry = _Editor$nodes2[0];\n      if (imageNodeEntry) return;\n      var focusedNode = Node.get(editor, selection.focus.path);\n      var domNode = ReactEditor.toDOMNode(editor, focusedNode);\n      if (!domNode) return;\n      scrollIntoView(domNode, {\n        'scrollMode': 'if-needed'\n      });\n    } catch (error) {\n      //\n    }\n  }, []);\n  return /*#__PURE__*/React.createElement(Slate, {\n    editor: editor,\n    value: slateValue,\n    onChange: updateSlateValue\n  }, /*#__PURE__*/React.createElement(ArticleContainer, {\n    editor: editor\n  }, /*#__PURE__*/React.createElement(Fragment, null, /*#__PURE__*/React.createElement(ContextToolbar, null), /*#__PURE__*/React.createElement(SetNodeToDecorations, null), /*#__PURE__*/React.createElement(Editable, {\n    scrollSelectionIntoView: handleScrollIntoView,\n    cursors: cursors,\n    renderElement: renderElement,\n    renderLeaf: renderLeaf,\n    onKeyDown: onKeyDown,\n    onMouseDown: onMouseDown,\n    decorate: decorate,\n    onCut: eventProxy.onCut,\n    onCopy: eventProxy.onCopy,\n    onCompositionStart: eventProxy.onCompositionStart,\n    id: \"sdoc-editor\"\n  })), /*#__PURE__*/React.createElement(SideToolbar, null), showComment && /*#__PURE__*/React.createElement(CommentWrapper, {\n    editor: editor,\n    type: \"editor\"\n  })));\n};\nEditableArticle.defaultProps = {\n  showComment: true\n};\nexport default EditableArticle;","map":{"version":3,"names":["React","useCallback","useMemo","Fragment","Editable","ReactEditor","Slate","Editor","Node","Transforms","scrollIntoView","renderLeaf","renderElement","ContextToolbar","SideToolbar","getAboveBlockNode","getNextNode","getPrevNode","isSelectionAtBlockEnd","isSelectionAtBlockStart","getCurrentNode","isCurrentLineEmpty","isCurrentLineHasText","EventProxy","useCursors","INTERNAL_EVENT","CommentWrapper","usePipDecorate","getCursorPosition","getDomHeight","getDomMarginTop","EventBus","ArticleContainer","useScrollContext","SetNodeToDecorations","IMAGE","IMAGE_BLOCK","CODE_LINE","isPreventResetTableSelectedRange","EditableArticle","_ref","showComment","editor","slateValue","updateSlateValue","_useCursors","cursors","decorate","eventProxy","onMouseDown","event","button","isPreventReset","reSetTableSelectedRange","eventBus","getInstance","dispatch","CANCEL_TABLE_SELECT_RANGE","scrollRef","onKeyDown","_scrollRef$current","current","scrollTop","clientHeight","key","prevNode","domNode","toDOMNode","domHeight","isScrollUp","_getCursorPosition","y","scroll","Math","max","nextNode","_getCursorPosition2","_getCurrentNode","_getCurrentNode2","_slicedToArray","currentNode","prevPath","_getPrevNode","_getPrevNode2","type","prevNodeText","string","removeNodes","at","insertText","preventDefault","path","length","end","children","text","range","anchor","offset","focus","select","_getCursorPosition3","newY","abs","node","currentDomNode","marginTop","marginBottom","_getCursorPosition4","rectBottom","handleScrollIntoView","domRange","selection","_Editor$nodes","nodes","match","n","includes","_Editor$nodes2","imageNodeEntry","focusedNode","get","error","createElement","value","onChange","scrollSelectionIntoView","onCut","onCopy","onCompositionStart","id","defaultProps"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/editor/editable-article.js"],"sourcesContent":["import React, { useCallback, useMemo, Fragment } from 'react';\nimport { Editable, ReactEditor, Slate } from '@seafile/slate-react';\nimport { Editor, Node, Transforms } from '@seafile/slate';\nimport scrollIntoView from 'scroll-into-view-if-needed';\nimport { renderLeaf, renderElement, ContextToolbar, SideToolbar } from '../extension';\nimport { getAboveBlockNode, getNextNode, getPrevNode, isSelectionAtBlockEnd, isSelectionAtBlockStart, getCurrentNode, isCurrentLineEmpty, isCurrentLineHasText } from '../extension/core';\nimport EventProxy from '../utils/event-handler';\nimport { useCursors } from '../cursor/use-cursors';\nimport { INTERNAL_EVENT } from '../constants';\nimport CommentWrapper from '../comment';\nimport { usePipDecorate } from '../decorates';\nimport { getCursorPosition, getDomHeight, getDomMarginTop } from '../utils/dom-utils';\nimport EventBus from '../utils/event-bus';\nimport { ArticleContainer } from '../layout';\nimport { useScrollContext } from '../hooks/use-scroll-context';\nimport { SetNodeToDecorations } from '../highlight';\nimport { IMAGE, IMAGE_BLOCK, CODE_LINE } from '../extension/constants';\nimport { isPreventResetTableSelectedRange } from '../extension/plugins/table/helpers';\nconst EditableArticle = _ref => {\n  let {\n    showComment,\n    editor,\n    slateValue,\n    updateSlateValue\n  } = _ref;\n  const {\n    cursors\n  } = useCursors(editor);\n  const decorate = usePipDecorate(editor);\n\n  // init eventHandler\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const eventProxy = useMemo(() => new EventProxy(editor), []);\n  const onMouseDown = useCallback(event => {\n    if (event.button === 0) {\n      const isPreventReset = isPreventResetTableSelectedRange(event);\n      if (!isPreventReset) {\n        editor.reSetTableSelectedRange();\n        const eventBus = EventBus.getInstance();\n        eventBus.dispatch(INTERNAL_EVENT.CANCEL_TABLE_SELECT_RANGE);\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const scrollRef = useScrollContext();\n  const onKeyDown = useCallback(event => {\n    const {\n      scrollTop,\n      clientHeight\n    } = scrollRef.current;\n    eventProxy.onKeyDown(event);\n    if (event.key === 'ArrowLeft') {\n      if (!isSelectionAtBlockStart(editor)) return;\n    }\n    if (event.key === 'ArrowUp' || event.key === 'ArrowLeft') {\n      if (scrollTop === 0) return;\n      let prevNode = getPrevNode(editor);\n      if (!prevNode) return;\n      const domNode = ReactEditor.toDOMNode(editor, prevNode[0]);\n      const domHeight = getDomHeight(domNode);\n      const isScrollUp = true;\n      const {\n        y\n      } = getCursorPosition(isScrollUp);\n      if (y >= domHeight) return;\n      scrollRef.current.scroll(0, Math.max(0, scrollTop - domHeight));\n      return;\n    }\n    if (event.key === 'ArrowRight') {\n      if (!isSelectionAtBlockEnd(editor)) return;\n    }\n    if (event.key === 'ArrowDown' || event.key === 'ArrowRight') {\n      let nextNode = getNextNode(editor);\n      if (!nextNode) return;\n      const domNode = ReactEditor.toDOMNode(editor, nextNode[0]);\n      const domHeight = getDomHeight(domNode);\n      const isScrollUp = false;\n      const {\n        y\n      } = getCursorPosition(isScrollUp);\n      if (clientHeight - y >= domHeight) return;\n      scrollRef.current.scroll(0, Math.max(0, scrollTop + domHeight));\n      return;\n    }\n    if (event.key === 'Backspace') {\n      const [currentNode] = getCurrentNode(editor);\n      let prevNode = null;\n      let prevPath = null;\n      if (getPrevNode(editor)) {\n        [prevNode, prevPath] = getPrevNode(editor);\n      }\n      // If the cursor is at the beginning, and the current line is not empty, is not a CODE_LINE, and the previous line is a CODE_LINE.\n      if (prevNode && isSelectionAtBlockStart(editor) && !isCurrentLineEmpty(editor) && prevNode.type === CODE_LINE && currentNode.type !== CODE_LINE) {\n        if (!isCurrentLineHasText(currentNode)) {\n          const prevNodeText = Node.string(prevNode);\n          Transforms.removeNodes(editor, {\n            at: prevPath\n          });\n          Transforms.insertText(editor, prevNodeText);\n          event.preventDefault();\n        } else {\n          const path = prevPath;\n          path[path.length] = 0;\n          const end = prevNode.children[0].text.length;\n          const range = {\n            anchor: {\n              path,\n              offset: end\n            },\n            focus: {\n              path,\n              offset: end\n            }\n          };\n          Transforms.select(editor, range);\n          event.preventDefault();\n        }\n      }\n      const {\n        y\n      } = getCursorPosition();\n\n      // above viewport\n      if (y < 0) {\n        const newY = Math.abs(y);\n        if (isSelectionAtBlockStart(editor)) {\n          const prevNode = getPrevNode(editor);\n          if (!prevNode) return;\n          const domNode = ReactEditor.toDOMNode(editor, prevNode[0]);\n          const domHeight = getDomHeight(domNode);\n          const node = getAboveBlockNode(editor);\n          if (!node) return;\n          const currentDomNode = ReactEditor.toDOMNode(editor, node[0]);\n          const marginTop = getDomMarginTop(currentDomNode);\n          scrollRef.current.scroll(0, Math.max(0, scrollTop - (newY + domHeight + marginTop)));\n        } else {\n          scrollRef.current.scroll(0, Math.max(0, scrollTop - newY));\n        }\n        return;\n      }\n\n      // insider viewport\n      if (y >= 0 && y <= clientHeight) {\n        if (isSelectionAtBlockStart(editor)) {\n          const prevNode = getPrevNode(editor);\n          if (!prevNode) return;\n          const domNode = ReactEditor.toDOMNode(editor, prevNode[0]);\n          const domHeight = getDomHeight(domNode);\n          if (y >= domHeight) return;\n          // Scroll up the height of the previous block\n          scrollRef.current.scroll(0, Math.max(0, scrollTop - domHeight));\n          return;\n        }\n      }\n\n      // below viewport\n      if (y > clientHeight) {\n        if (isSelectionAtBlockStart(editor)) {\n          // y: text top border\n          scrollRef.current.scroll(0, Math.max(0, scrollTop + (y - clientHeight)));\n        } else {\n          const marginBottom = 11.2;\n          const {\n            y: newY\n          } = getCursorPosition(false);\n          const rectBottom = newY + marginBottom; // text bottom border\n          scrollRef.current.scroll(0, Math.max(0, scrollTop + (rectBottom - clientHeight)));\n        }\n        return;\n      }\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [scrollRef]);\n  const handleScrollIntoView = useCallback((editor, domRange) => {\n    try {\n      const {\n        selection\n      } = editor;\n      // Do not scroll into view, when focus on image\n      const [imageNodeEntry] = Editor.nodes(editor, {\n        match: n => [IMAGE, IMAGE_BLOCK].includes(n.type),\n        at: selection\n      });\n      if (imageNodeEntry) return;\n      const focusedNode = Node.get(editor, selection.focus.path);\n      const domNode = ReactEditor.toDOMNode(editor, focusedNode);\n      if (!domNode) return;\n      scrollIntoView(domNode, {\n        'scrollMode': 'if-needed'\n      });\n    } catch (error) {\n      //\n    }\n  }, []);\n  return /*#__PURE__*/React.createElement(Slate, {\n    editor: editor,\n    value: slateValue,\n    onChange: updateSlateValue\n  }, /*#__PURE__*/React.createElement(ArticleContainer, {\n    editor: editor\n  }, /*#__PURE__*/React.createElement(Fragment, null, /*#__PURE__*/React.createElement(ContextToolbar, null), /*#__PURE__*/React.createElement(SetNodeToDecorations, null), /*#__PURE__*/React.createElement(Editable, {\n    scrollSelectionIntoView: handleScrollIntoView,\n    cursors: cursors,\n    renderElement: renderElement,\n    renderLeaf: renderLeaf,\n    onKeyDown: onKeyDown,\n    onMouseDown: onMouseDown,\n    decorate: decorate,\n    onCut: eventProxy.onCut,\n    onCopy: eventProxy.onCopy,\n    onCompositionStart: eventProxy.onCompositionStart,\n    id: \"sdoc-editor\"\n  })), /*#__PURE__*/React.createElement(SideToolbar, null), showComment && /*#__PURE__*/React.createElement(CommentWrapper, {\n    editor: editor,\n    type: \"editor\"\n  })));\n};\nEditableArticle.defaultProps = {\n  showComment: true\n};\nexport default EditableArticle;"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,WAAW,EAAEC,OAAO,EAAEC,QAAQ,QAAQ,OAAO;AAC7D,SAASC,QAAQ,EAAEC,WAAW,EAAEC,KAAK,QAAQ,sBAAsB;AACnE,SAASC,MAAM,EAAEC,IAAI,EAAEC,UAAU,QAAQ,gBAAgB;AACzD,OAAOC,cAAc,MAAM,4BAA4B;AACvD,SAASC,UAAU,EAAEC,aAAa,EAAEC,cAAc,EAAEC,WAAW,QAAQ,cAAc;AACrF,SAASC,iBAAiB,EAAEC,WAAW,EAAEC,WAAW,EAAEC,qBAAqB,EAAEC,uBAAuB,EAAEC,cAAc,EAAEC,kBAAkB,EAAEC,oBAAoB,QAAQ,mBAAmB;AACzL,OAAOC,UAAU,MAAM,wBAAwB;AAC/C,SAASC,UAAU,QAAQ,uBAAuB;AAClD,SAASC,cAAc,QAAQ,cAAc;AAC7C,OAAOC,cAAc,MAAM,YAAY;AACvC,SAASC,cAAc,QAAQ,cAAc;AAC7C,SAASC,iBAAiB,EAAEC,YAAY,EAAEC,eAAe,QAAQ,oBAAoB;AACrF,OAAOC,QAAQ,MAAM,oBAAoB;AACzC,SAASC,gBAAgB,QAAQ,WAAW;AAC5C,SAASC,gBAAgB,QAAQ,6BAA6B;AAC9D,SAASC,oBAAoB,QAAQ,cAAc;AACnD,SAASC,KAAK,EAAEC,WAAW,EAAEC,SAAS,QAAQ,wBAAwB;AACtE,SAASC,gCAAgC,QAAQ,oCAAoC;AACrF,IAAMC,eAAe,GAAG,SAAlBA,eAAeA,CAAGC,IAAI,EAAI;EAC9B,IACEC,WAAW,GAITD,IAAI,CAJNC,WAAW;IACXC,MAAM,GAGJF,IAAI,CAHNE,MAAM;IACNC,UAAU,GAERH,IAAI,CAFNG,UAAU;IACVC,gBAAgB,GACdJ,IAAI,CADNI,gBAAgB;EAElB,IAAAC,WAAA,GAEIrB,UAAU,CAACkB,MAAM,CAAC;IADpBI,OAAO,GAAAD,WAAA,CAAPC,OAAO;EAET,IAAMC,QAAQ,GAAGpB,cAAc,CAACe,MAAM,CAAC;;EAEvC;EACA;EACA,IAAMM,UAAU,GAAG9C,OAAO,CAAC;IAAA,OAAM,IAAIqB,UAAU,CAACmB,MAAM,CAAC;EAAA,GAAE,EAAE,CAAC;EAC5D,IAAMO,WAAW,GAAGhD,WAAW,CAAC,UAAAiD,KAAK,EAAI;IACvC,IAAIA,KAAK,CAACC,MAAM,KAAK,CAAC,EAAE;MACtB,IAAMC,cAAc,GAAGd,gCAAgC,CAACY,KAAK,CAAC;MAC9D,IAAI,CAACE,cAAc,EAAE;QACnBV,MAAM,CAACW,uBAAuB,CAAC,CAAC;QAChC,IAAMC,QAAQ,GAAGvB,QAAQ,CAACwB,WAAW,CAAC,CAAC;QACvCD,QAAQ,CAACE,QAAQ,CAAC/B,cAAc,CAACgC,yBAAyB,CAAC;MAC7D;IACF;IACA;EACF,CAAC,EAAE,EAAE,CAAC;EACN,IAAMC,SAAS,GAAGzB,gBAAgB,CAAC,CAAC;EACpC,IAAM0B,SAAS,GAAG1D,WAAW,CAAC,UAAAiD,KAAK,EAAI;IACrC,IAAAU,kBAAA,GAGIF,SAAS,CAACG,OAAO;MAFnBC,SAAS,GAAAF,kBAAA,CAATE,SAAS;MACTC,YAAY,GAAAH,kBAAA,CAAZG,YAAY;IAEdf,UAAU,CAACW,SAAS,CAACT,KAAK,CAAC;IAC3B,IAAIA,KAAK,CAACc,GAAG,KAAK,WAAW,EAAE;MAC7B,IAAI,CAAC7C,uBAAuB,CAACuB,MAAM,CAAC,EAAE;IACxC;IACA,IAAIQ,KAAK,CAACc,GAAG,KAAK,SAAS,IAAId,KAAK,CAACc,GAAG,KAAK,WAAW,EAAE;MACxD,IAAIF,SAAS,KAAK,CAAC,EAAE;MACrB,IAAIG,QAAQ,GAAGhD,WAAW,CAACyB,MAAM,CAAC;MAClC,IAAI,CAACuB,QAAQ,EAAE;MACf,IAAMC,OAAO,GAAG7D,WAAW,CAAC8D,SAAS,CAACzB,MAAM,EAAEuB,QAAQ,CAAC,CAAC,CAAC,CAAC;MAC1D,IAAMG,SAAS,GAAGvC,YAAY,CAACqC,OAAO,CAAC;MACvC,IAAMG,UAAU,GAAG,IAAI;MACvB,IAAAC,kBAAA,GAEI1C,iBAAiB,CAACyC,UAAU,CAAC;QAD/BE,CAAC,GAAAD,kBAAA,CAADC,CAAC;MAEH,IAAIA,CAAC,IAAIH,SAAS,EAAE;MACpBV,SAAS,CAACG,OAAO,CAACW,MAAM,CAAC,CAAC,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEZ,SAAS,GAAGM,SAAS,CAAC,CAAC;MAC/D;IACF;IACA,IAAIlB,KAAK,CAACc,GAAG,KAAK,YAAY,EAAE;MAC9B,IAAI,CAAC9C,qBAAqB,CAACwB,MAAM,CAAC,EAAE;IACtC;IACA,IAAIQ,KAAK,CAACc,GAAG,KAAK,WAAW,IAAId,KAAK,CAACc,GAAG,KAAK,YAAY,EAAE;MAC3D,IAAIW,QAAQ,GAAG3D,WAAW,CAAC0B,MAAM,CAAC;MAClC,IAAI,CAACiC,QAAQ,EAAE;MACf,IAAMT,QAAO,GAAG7D,WAAW,CAAC8D,SAAS,CAACzB,MAAM,EAAEiC,QAAQ,CAAC,CAAC,CAAC,CAAC;MAC1D,IAAMP,UAAS,GAAGvC,YAAY,CAACqC,QAAO,CAAC;MACvC,IAAMG,WAAU,GAAG,KAAK;MACxB,IAAAO,mBAAA,GAEIhD,iBAAiB,CAACyC,WAAU,CAAC;QAD/BE,EAAC,GAAAK,mBAAA,CAADL,CAAC;MAEH,IAAIR,YAAY,GAAGQ,EAAC,IAAIH,UAAS,EAAE;MACnCV,SAAS,CAACG,OAAO,CAACW,MAAM,CAAC,CAAC,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEZ,SAAS,GAAGM,UAAS,CAAC,CAAC;MAC/D;IACF;IACA,IAAIlB,KAAK,CAACc,GAAG,KAAK,WAAW,EAAE;MAC7B,IAAAa,eAAA,GAAsBzD,cAAc,CAACsB,MAAM,CAAC;QAAAoC,gBAAA,GAAAC,cAAA,CAAAF,eAAA;QAArCG,WAAW,GAAAF,gBAAA;MAClB,IAAIb,SAAQ,GAAG,IAAI;MACnB,IAAIgB,QAAQ,GAAG,IAAI;MACnB,IAAIhE,WAAW,CAACyB,MAAM,CAAC,EAAE;QAAA,IAAAwC,YAAA,GACAjE,WAAW,CAACyB,MAAM,CAAC;QAAA,IAAAyC,aAAA,GAAAJ,cAAA,CAAAG,YAAA;QAAzCjB,SAAQ,GAAAkB,aAAA;QAAEF,QAAQ,GAAAE,aAAA;MACrB;MACA;MACA,IAAIlB,SAAQ,IAAI9C,uBAAuB,CAACuB,MAAM,CAAC,IAAI,CAACrB,kBAAkB,CAACqB,MAAM,CAAC,IAAIuB,SAAQ,CAACmB,IAAI,KAAK/C,SAAS,IAAI2C,WAAW,CAACI,IAAI,KAAK/C,SAAS,EAAE;QAC/I,IAAI,CAACf,oBAAoB,CAAC0D,WAAW,CAAC,EAAE;UACtC,IAAMK,YAAY,GAAG7E,IAAI,CAAC8E,MAAM,CAACrB,SAAQ,CAAC;UAC1CxD,UAAU,CAAC8E,WAAW,CAAC7C,MAAM,EAAE;YAC7B8C,EAAE,EAAEP;UACN,CAAC,CAAC;UACFxE,UAAU,CAACgF,UAAU,CAAC/C,MAAM,EAAE2C,YAAY,CAAC;UAC3CnC,KAAK,CAACwC,cAAc,CAAC,CAAC;QACxB,CAAC,MAAM;UACL,IAAMC,IAAI,GAAGV,QAAQ;UACrBU,IAAI,CAACA,IAAI,CAACC,MAAM,CAAC,GAAG,CAAC;UACrB,IAAMC,GAAG,GAAG5B,SAAQ,CAAC6B,QAAQ,CAAC,CAAC,CAAC,CAACC,IAAI,CAACH,MAAM;UAC5C,IAAMI,KAAK,GAAG;YACZC,MAAM,EAAE;cACNN,IAAI,EAAJA,IAAI;cACJO,MAAM,EAAEL;YACV,CAAC;YACDM,KAAK,EAAE;cACLR,IAAI,EAAJA,IAAI;cACJO,MAAM,EAAEL;YACV;UACF,CAAC;UACDpF,UAAU,CAAC2F,MAAM,CAAC1D,MAAM,EAAEsD,KAAK,CAAC;UAChC9C,KAAK,CAACwC,cAAc,CAAC,CAAC;QACxB;MACF;MACA,IAAAW,mBAAA,GAEIzE,iBAAiB,CAAC,CAAC;QADrB2C,GAAC,GAAA8B,mBAAA,CAAD9B,CAAC;;MAGH;MACA,IAAIA,GAAC,GAAG,CAAC,EAAE;QACT,IAAM+B,IAAI,GAAG7B,IAAI,CAAC8B,GAAG,CAAChC,GAAC,CAAC;QACxB,IAAIpD,uBAAuB,CAACuB,MAAM,CAAC,EAAE;UACnC,IAAMuB,UAAQ,GAAGhD,WAAW,CAACyB,MAAM,CAAC;UACpC,IAAI,CAACuB,UAAQ,EAAE;UACf,IAAMC,SAAO,GAAG7D,WAAW,CAAC8D,SAAS,CAACzB,MAAM,EAAEuB,UAAQ,CAAC,CAAC,CAAC,CAAC;UAC1D,IAAMG,WAAS,GAAGvC,YAAY,CAACqC,SAAO,CAAC;UACvC,IAAMsC,IAAI,GAAGzF,iBAAiB,CAAC2B,MAAM,CAAC;UACtC,IAAI,CAAC8D,IAAI,EAAE;UACX,IAAMC,cAAc,GAAGpG,WAAW,CAAC8D,SAAS,CAACzB,MAAM,EAAE8D,IAAI,CAAC,CAAC,CAAC,CAAC;UAC7D,IAAME,SAAS,GAAG5E,eAAe,CAAC2E,cAAc,CAAC;UACjD/C,SAAS,CAACG,OAAO,CAACW,MAAM,CAAC,CAAC,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEZ,SAAS,IAAIwC,IAAI,GAAGlC,WAAS,GAAGsC,SAAS,CAAC,CAAC,CAAC;QACtF,CAAC,MAAM;UACLhD,SAAS,CAACG,OAAO,CAACW,MAAM,CAAC,CAAC,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEZ,SAAS,GAAGwC,IAAI,CAAC,CAAC;QAC5D;QACA;MACF;;MAEA;MACA,IAAI/B,GAAC,IAAI,CAAC,IAAIA,GAAC,IAAIR,YAAY,EAAE;QAC/B,IAAI5C,uBAAuB,CAACuB,MAAM,CAAC,EAAE;UACnC,IAAMuB,UAAQ,GAAGhD,WAAW,CAACyB,MAAM,CAAC;UACpC,IAAI,CAACuB,UAAQ,EAAE;UACf,IAAMC,SAAO,GAAG7D,WAAW,CAAC8D,SAAS,CAACzB,MAAM,EAAEuB,UAAQ,CAAC,CAAC,CAAC,CAAC;UAC1D,IAAMG,WAAS,GAAGvC,YAAY,CAACqC,SAAO,CAAC;UACvC,IAAIK,GAAC,IAAIH,WAAS,EAAE;UACpB;UACAV,SAAS,CAACG,OAAO,CAACW,MAAM,CAAC,CAAC,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEZ,SAAS,GAAGM,WAAS,CAAC,CAAC;UAC/D;QACF;MACF;;MAEA;MACA,IAAIG,GAAC,GAAGR,YAAY,EAAE;QACpB,IAAI5C,uBAAuB,CAACuB,MAAM,CAAC,EAAE;UACnC;UACAgB,SAAS,CAACG,OAAO,CAACW,MAAM,CAAC,CAAC,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEZ,SAAS,IAAIS,GAAC,GAAGR,YAAY,CAAC,CAAC,CAAC;QAC1E,CAAC,MAAM;UACL,IAAM4C,YAAY,GAAG,IAAI;UACzB,IAAAC,mBAAA,GAEIhF,iBAAiB,CAAC,KAAK,CAAC;YADvB0E,KAAI,GAAAM,mBAAA,CAAPrC,CAAC;UAEH,IAAMsC,UAAU,GAAGP,KAAI,GAAGK,YAAY,CAAC,CAAC;UACxCjD,SAAS,CAACG,OAAO,CAACW,MAAM,CAAC,CAAC,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEZ,SAAS,IAAI+C,UAAU,GAAG9C,YAAY,CAAC,CAAC,CAAC;QACnF;QACA;MACF;IACF;;IAEA;EACF,CAAC,EAAE,CAACL,SAAS,CAAC,CAAC;EACf,IAAMoD,oBAAoB,GAAG7G,WAAW,CAAC,UAACyC,MAAM,EAAEqE,QAAQ,EAAK;IAC7D,IAAI;MACF,IACEC,SAAS,GACPtE,MAAM,CADRsE,SAAS;MAEX;MACA,IAAAC,aAAA,GAAyB1G,MAAM,CAAC2G,KAAK,CAACxE,MAAM,EAAE;UAC5CyE,KAAK,EAAE,SAAAA,MAAAC,CAAC;YAAA,OAAI,CAACjF,KAAK,EAAEC,WAAW,CAAC,CAACiF,QAAQ,CAACD,CAAC,CAAChC,IAAI,CAAC;UAAA;UACjDI,EAAE,EAAEwB;QACN,CAAC,CAAC;QAAAM,cAAA,GAAAvC,cAAA,CAAAkC,aAAA;QAHKM,cAAc,GAAAD,cAAA;MAIrB,IAAIC,cAAc,EAAE;MACpB,IAAMC,WAAW,GAAGhH,IAAI,CAACiH,GAAG,CAAC/E,MAAM,EAAEsE,SAAS,CAACb,KAAK,CAACR,IAAI,CAAC;MAC1D,IAAMzB,OAAO,GAAG7D,WAAW,CAAC8D,SAAS,CAACzB,MAAM,EAAE8E,WAAW,CAAC;MAC1D,IAAI,CAACtD,OAAO,EAAE;MACdxD,cAAc,CAACwD,OAAO,EAAE;QACtB,YAAY,EAAE;MAChB,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOwD,KAAK,EAAE;MACd;IAAA;EAEJ,CAAC,EAAE,EAAE,CAAC;EACN,OAAO,aAAa1H,KAAK,CAAC2H,aAAa,CAACrH,KAAK,EAAE;IAC7CoC,MAAM,EAAEA,MAAM;IACdkF,KAAK,EAAEjF,UAAU;IACjBkF,QAAQ,EAAEjF;EACZ,CAAC,EAAE,aAAa5C,KAAK,CAAC2H,aAAa,CAAC3F,gBAAgB,EAAE;IACpDU,MAAM,EAAEA;EACV,CAAC,EAAE,aAAa1C,KAAK,CAAC2H,aAAa,CAACxH,QAAQ,EAAE,IAAI,EAAE,aAAaH,KAAK,CAAC2H,aAAa,CAAC9G,cAAc,EAAE,IAAI,CAAC,EAAE,aAAab,KAAK,CAAC2H,aAAa,CAACzF,oBAAoB,EAAE,IAAI,CAAC,EAAE,aAAalC,KAAK,CAAC2H,aAAa,CAACvH,QAAQ,EAAE;IACnN0H,uBAAuB,EAAEhB,oBAAoB;IAC7ChE,OAAO,EAAEA,OAAO;IAChBlC,aAAa,EAAEA,aAAa;IAC5BD,UAAU,EAAEA,UAAU;IACtBgD,SAAS,EAAEA,SAAS;IACpBV,WAAW,EAAEA,WAAW;IACxBF,QAAQ,EAAEA,QAAQ;IAClBgF,KAAK,EAAE/E,UAAU,CAAC+E,KAAK;IACvBC,MAAM,EAAEhF,UAAU,CAACgF,MAAM;IACzBC,kBAAkB,EAAEjF,UAAU,CAACiF,kBAAkB;IACjDC,EAAE,EAAE;EACN,CAAC,CAAC,CAAC,EAAE,aAAalI,KAAK,CAAC2H,aAAa,CAAC7G,WAAW,EAAE,IAAI,CAAC,EAAE2B,WAAW,IAAI,aAAazC,KAAK,CAAC2H,aAAa,CAACjG,cAAc,EAAE;IACxHgB,MAAM,EAAEA,MAAM;IACd0C,IAAI,EAAE;EACR,CAAC,CAAC,CAAC,CAAC;AACN,CAAC;AACD7C,eAAe,CAAC4F,YAAY,GAAG;EAC7B1F,WAAW,EAAE;AACf,CAAC;AACD,eAAeF,eAAe"},"metadata":{},"sourceType":"module","externalDependencies":[]}