{"ast":null,"code":"var getUint64 = require('../utils/numbers.js').getUint64;\nvar parseSidx = function parseSidx(data) {\n  var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n    result = {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      references: [],\n      referenceId: view.getUint32(4),\n      timescale: view.getUint32(8)\n    },\n    i = 12;\n  if (result.version === 0) {\n    result.earliestPresentationTime = view.getUint32(i);\n    result.firstOffset = view.getUint32(i + 4);\n    i += 8;\n  } else {\n    // read 64 bits\n    result.earliestPresentationTime = getUint64(data.subarray(i));\n    result.firstOffset = getUint64(data.subarray(i + 8));\n    i += 16;\n  }\n  i += 2; // reserved\n\n  var referenceCount = view.getUint16(i);\n  i += 2; // start of references\n\n  for (; referenceCount > 0; i += 12, referenceCount--) {\n    result.references.push({\n      referenceType: (data[i] & 0x80) >>> 7,\n      referencedSize: view.getUint32(i) & 0x7FFFFFFF,\n      subsegmentDuration: view.getUint32(i + 4),\n      startsWithSap: !!(data[i + 8] & 0x80),\n      sapType: (data[i + 8] & 0x70) >>> 4,\n      sapDeltaTime: view.getUint32(i + 8) & 0x0FFFFFFF\n    });\n  }\n  return result;\n};\nmodule.exports = parseSidx;","map":{"version":3,"names":["getUint64","require","parseSidx","data","view","DataView","buffer","byteOffset","byteLength","result","version","flags","Uint8Array","subarray","references","referenceId","getUint32","timescale","i","earliestPresentationTime","firstOffset","referenceCount","getUint16","push","referenceType","referencedSize","subsegmentDuration","startsWithSap","sapType","sapDeltaTime","module","exports"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/mux.js/lib/tools/parse-sidx.js"],"sourcesContent":["var getUint64 = require('../utils/numbers.js').getUint64;\n\nvar parseSidx = function(data) {\n  var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n      result = {\n        version: data[0],\n        flags: new Uint8Array(data.subarray(1, 4)),\n        references: [],\n        referenceId: view.getUint32(4),\n        timescale: view.getUint32(8)\n      },\n    i = 12;\n\n  if (result.version === 0) {\n    result.earliestPresentationTime = view.getUint32(i);\n    result.firstOffset = view.getUint32(i + 4);\n    i += 8;\n  } else {\n    // read 64 bits\n    result.earliestPresentationTime = getUint64(data.subarray(i));\n    result.firstOffset = getUint64(data.subarray(i + 8));\n    i += 16;\n  }\n\n  i += 2; // reserved\n\n  var referenceCount = view.getUint16(i);\n\n  i += 2; // start of references\n\n  for (; referenceCount > 0; i += 12, referenceCount--) {\n    result.references.push({\n      referenceType: (data[i] & 0x80) >>> 7,\n      referencedSize: view.getUint32(i) & 0x7FFFFFFF,\n      subsegmentDuration: view.getUint32(i + 4),\n      startsWithSap: !!(data[i + 8] & 0x80),\n      sapType: (data[i + 8] & 0x70) >>> 4,\n      sapDeltaTime: view.getUint32(i + 8) & 0x0FFFFFFF\n    });\n  }\n\n  return result;\n};\n\n\nmodule.exports = parseSidx;\n"],"mappings":"AAAA,IAAIA,SAAS,GAAGC,OAAO,CAAC,qBAAqB,CAAC,CAACD,SAAS;AAExD,IAAIE,SAAS,GAAG,SAAZA,SAASA,CAAYC,IAAI,EAAE;EAC7B,IAAIC,IAAI,GAAG,IAAIC,QAAQ,CAACF,IAAI,CAACG,MAAM,EAAEH,IAAI,CAACI,UAAU,EAAEJ,IAAI,CAACK,UAAU,CAAC;IAClEC,MAAM,GAAG;MACPC,OAAO,EAAEP,IAAI,CAAC,CAAC,CAAC;MAChBQ,KAAK,EAAE,IAAIC,UAAU,CAACT,IAAI,CAACU,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;MAC1CC,UAAU,EAAE,EAAE;MACdC,WAAW,EAAEX,IAAI,CAACY,SAAS,CAAC,CAAC,CAAC;MAC9BC,SAAS,EAAEb,IAAI,CAACY,SAAS,CAAC,CAAC;IAC7B,CAAC;IACHE,CAAC,GAAG,EAAE;EAER,IAAIT,MAAM,CAACC,OAAO,KAAK,CAAC,EAAE;IACxBD,MAAM,CAACU,wBAAwB,GAAGf,IAAI,CAACY,SAAS,CAACE,CAAC,CAAC;IACnDT,MAAM,CAACW,WAAW,GAAGhB,IAAI,CAACY,SAAS,CAACE,CAAC,GAAG,CAAC,CAAC;IAC1CA,CAAC,IAAI,CAAC;EACR,CAAC,MAAM;IACL;IACAT,MAAM,CAACU,wBAAwB,GAAGnB,SAAS,CAACG,IAAI,CAACU,QAAQ,CAACK,CAAC,CAAC,CAAC;IAC7DT,MAAM,CAACW,WAAW,GAAGpB,SAAS,CAACG,IAAI,CAACU,QAAQ,CAACK,CAAC,GAAG,CAAC,CAAC,CAAC;IACpDA,CAAC,IAAI,EAAE;EACT;EAEAA,CAAC,IAAI,CAAC,CAAC,CAAC;;EAER,IAAIG,cAAc,GAAGjB,IAAI,CAACkB,SAAS,CAACJ,CAAC,CAAC;EAEtCA,CAAC,IAAI,CAAC,CAAC,CAAC;;EAER,OAAOG,cAAc,GAAG,CAAC,EAAEH,CAAC,IAAI,EAAE,EAAEG,cAAc,EAAE,EAAE;IACpDZ,MAAM,CAACK,UAAU,CAACS,IAAI,CAAC;MACrBC,aAAa,EAAE,CAACrB,IAAI,CAACe,CAAC,CAAC,GAAG,IAAI,MAAM,CAAC;MACrCO,cAAc,EAAErB,IAAI,CAACY,SAAS,CAACE,CAAC,CAAC,GAAG,UAAU;MAC9CQ,kBAAkB,EAAEtB,IAAI,CAACY,SAAS,CAACE,CAAC,GAAG,CAAC,CAAC;MACzCS,aAAa,EAAE,CAAC,EAAExB,IAAI,CAACe,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC;MACrCU,OAAO,EAAE,CAACzB,IAAI,CAACe,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,MAAM,CAAC;MACnCW,YAAY,EAAEzB,IAAI,CAACY,SAAS,CAACE,CAAC,GAAG,CAAC,CAAC,GAAG;IACxC,CAAC,CAAC;EACJ;EAEA,OAAOT,MAAM;AACf,CAAC;AAGDqB,MAAM,CAACC,OAAO,GAAG7B,SAAS"},"metadata":{},"sourceType":"script","externalDependencies":[]}