{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import TextTranslation from'../../utils/text-translation';import TreeNodeView from'./tree-node-view';import ContextMenu from'../context-menu/context-menu';import{hideMenu,showMenu}from'../context-menu/actions';import{Utils}from'../../utils/utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PADDING_LEFT=20;var TreeView=/*#__PURE__*/function(_React$Component){_inherits(TreeView,_React$Component);var _super=_createSuper(TreeView);function TreeView(props){var _this;_classCallCheck(this,TreeView);_this=_super.call(this,props);_this.onItemMove=function(repo,dirent,selectedPath,currentPath){_this.props.onItemMove(repo,dirent,selectedPath,currentPath);};_this.onNodeDragStart=function(e,node){if(Utils.isIEBrower()){return false;}var dragStartNodeData={nodeDirent:node.object,nodeParentPath:node.parentNode.path,nodeRootPath:node.path};dragStartNodeData=JSON.stringify(dragStartNodeData);e.dataTransfer.effectAllowed='move';e.dataTransfer.setData('applicaiton/drag-item-info',dragStartNodeData);};_this.onNodeDragEnter=function(e,node){if(Utils.isIEBrower()||!_this.canDrop){return false;}e.persist();if(e.target.className==='tree-view tree '){_this.setState({isTreeViewDropTipShow:true});}};_this.onNodeDragMove=function(e){if(Utils.isIEBrower()||!_this.canDrop){return false;}e.preventDefault();e.dataTransfer.dropEffect='move';};_this.onNodeDragLeave=function(e,node){if(Utils.isIEBrower()||!_this.canDrop){return false;}if(e.target.className==='tree-view tree tree-view-drop'){_this.setState({isTreeViewDropTipShow:false});}};_this.onContainerClick=function(event){hideMenu();};_this.onNodeClick=function(node){hideMenu();_this.props.onNodeClick(node);};_this.onNodeDrop=function(e,node){if(Utils.isIEBrower()||!_this.canDrop){return false;}if(e.dataTransfer.files.length){// uploaded files\nreturn;}var dragStartNodeData=e.dataTransfer.getData('applicaiton/drag-item-info');dragStartNodeData=JSON.parse(dragStartNodeData);var _dragStartNodeData=dragStartNodeData,nodeDirent=_dragStartNodeData.nodeDirent,nodeParentPath=_dragStartNodeData.nodeParentPath,nodeRootPath=_dragStartNodeData.nodeRootPath;var dropNodeData=node;if(Array.isArray(dragStartNodeData)){//move items\nif(!dropNodeData){//move items to root\nif(dragStartNodeData[0].nodeParentPath==='/'){_this.setState({isTreeViewDropTipShow:false});return;}_this.props.onItemsMove(_this.props.currentRepoInfo,'/');_this.setState({isTreeViewDropTipShow:false});return;}_this.onMoveItems(dragStartNodeData,dropNodeData,_this.props.currentRepoInfo,dropNodeData.path);return;}if(!dropNodeData){if(nodeParentPath==='/'){_this.setState({isTreeViewDropTipShow:false});return;}_this.onItemMove(_this.props.currentRepoInfo,nodeDirent,'/',nodeParentPath);_this.setState({isTreeViewDropTipShow:false});return;}if(dropNodeData.object.type!=='dir'){return;}if(nodeParentPath===dropNodeData.path){return;}// copy the dirent to itself. eg: A/B -> A/B\nif(nodeParentPath===dropNodeData.parentNode.path){if(dropNodeData.object.name===nodeDirent.name){return;}}// copy the dirent to it's child. eg: A/B -> A/B/C\nif(dropNodeData.object.type==='dir'&&nodeDirent.type==='dir'){if(dropNodeData.parentNode.path!==nodeParentPath){var paths=Utils.getPaths(dropNodeData.path);if(paths.includes(nodeRootPath)){return;}}}_this.onItemMove(_this.props.currentRepoInfo,nodeDirent,dropNodeData.path,nodeParentPath);};_this.onMoveItems=function(dragStartNodeData,dropNodeData,destRepo,destDirentPath){var direntPaths=[];var paths=Utils.getPaths(destDirentPath);dragStartNodeData.forEach(function(dirent){var path=dirent.nodeRootPath;direntPaths.push(path);});if(dropNodeData.object.type!=='dir'){return;}// move dirents to one of them. eg: A/B, A/C -> A/B\nif(direntPaths.some(function(direntPath){return direntPath===destDirentPath;})){return;}// move dirents to current path\nif(dragStartNodeData[0].nodeParentPath&&dragStartNodeData[0].nodeParentPath===dropNodeData.path){return;}// move dirents to one of their child. eg: A/B, A/D -> A/B/C\nvar isChildPath=direntPaths.some(function(direntPath){return paths.includes(direntPath);});if(isChildPath){return;}_this.props.onItemsMove(destRepo,destDirentPath);};_this.freezeItem=function(){_this.setState({isItemFreezed:true});};_this.unfreezeItem=function(){_this.setState({isItemFreezed:false});};_this.onMenuItemClick=function(operation,node){_this.props.onMenuItemClick(operation,node);hideMenu();};_this.onMouseDown=function(event){event.stopPropagation();if(event.button===2){return;}};_this.onContextMenu=function(event){event.preventDefault();var currentRepoInfo=_this.props.currentRepoInfo;if(currentRepoInfo.permission!=='admin'&&currentRepoInfo.permission!=='rw'){return'';}_this.handleContextClick(event);};_this.handleContextClick=function(event,node){event.preventDefault();event.stopPropagation();if(!_this.props.isNodeMenuShow){return;}var x=event.clientX||event.touches&&event.touches[0].pageX;var y=event.clientY||event.touches&&event.touches[0].pageY;if(_this.props.posX){x-=_this.props.posX;}if(_this.props.posY){y-=_this.props.posY;}hideMenu();var menuList=_this.getMenuList(node);var showMenuConfig={id:'tree-node-contextmenu',position:{x:x,y:y},target:event.target,currentObject:node,menuList:menuList};showMenu(showMenuConfig);};_this.getMenuList=function(node){var menuList=[];var NEW_FOLDER=TextTranslation.NEW_FOLDER,NEW_FILE=TextTranslation.NEW_FILE,COPY=TextTranslation.COPY,MOVE=TextTranslation.MOVE,RENAME=TextTranslation.RENAME,DELETE=TextTranslation.DELETE,OPEN_VIA_CLIENT=TextTranslation.OPEN_VIA_CLIENT;if(!node){return[NEW_FOLDER,NEW_FILE];}if(node.object.type==='dir'){menuList=[NEW_FOLDER,NEW_FILE,COPY,MOVE,RENAME,DELETE];}else{menuList=[RENAME,DELETE,COPY,MOVE,OPEN_VIA_CLIENT];}var userPerm=_this.props.userPerm;var _Utils$getUserPermiss=Utils.getUserPermission(userPerm),isCustomPermission=_Utils$getUserPermiss.isCustomPermission,customPermission=_Utils$getUserPermiss.customPermission;if(!isCustomPermission){return menuList;}menuList=[];var _customPermission$per=customPermission.permission,canCreate=_customPermission$per.create,canModify=_customPermission$per.modify,canDelete=_customPermission$per.delete,canCopy=_customPermission$per.copy;if(!node){canCreate&&menuList.push(NEW_FOLDER,NEW_FILE);return menuList;}if(node.object.type==='dir'){canCreate&&menuList.push(NEW_FOLDER,NEW_FILE);}canCopy&&menuList.push(COPY);canModify&&menuList.push(MOVE,RENAME);canDelete&&menuList.push(DELETE);if(node.object.type!=='dir'){menuList.push(OPEN_VIA_CLIENT);}return menuList;};_this.onShowMenu=function(){_this.freezeItem();};_this.onHideMenu=function(){_this.unfreezeItem();};_this.state={isItemFreezed:false,isTreeViewDropTipShow:false};var _userPerm=props.userPerm;_this.canDrop=_userPerm==='rw';var _Utils$getUserPermiss2=Utils.getUserPermission(_userPerm),_isCustomPermission=_Utils$getUserPermiss2.isCustomPermission,_customPermission=_Utils$getUserPermiss2.customPermission;if(_isCustomPermission){var modify=_customPermission.permission.modify;_this.canDrop=modify;}return _this;}_createClass(TreeView,[{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:\"tree-view tree \".concat(this.state.isTreeViewDropTipShow&&this.canDrop?'tree-view-drop':''),onDrop:this.onNodeDrop,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onMouseDown:this.onMouseDown,onContextMenu:this.onContextMenu,onClick:this.onContainerClick,children:[/*#__PURE__*/_jsx(TreeNodeView,{userPerm:this.props.userPerm,node:this.props.treeData.root,currentPath:this.props.currentPath,paddingLeft:PADDING_LEFT,isNodeMenuShow:this.props.isNodeMenuShow,isItemFreezed:this.state.isItemFreezed,onNodeClick:this.onNodeClick,onMenuItemClick:this.props.onMenuItemClick,onNodeExpanded:this.props.onNodeExpanded,onNodeCollapse:this.props.onNodeCollapse,onNodeDragStart:this.onNodeDragStart,freezeItem:this.freezeItem,unfreezeItem:this.unfreezeItem,onNodeDragMove:this.onNodeDragMove,onNodeDrop:this.onNodeDrop,onNodeDragEnter:this.onNodeDragEnter,onNodeDragLeave:this.onNodeDragLeave,handleContextClick:this.handleContextClick}),/*#__PURE__*/_jsx(ContextMenu,{id:'tree-node-contextmenu',onMenuItemClick:this.onMenuItemClick,onHideMenu:this.onHideMenu,onShowMenu:this.onShowMenu})]});}}]);return TreeView;}(React.Component);export default TreeView;","map":{"version":3,"names":["React","TextTranslation","TreeNodeView","ContextMenu","hideMenu","showMenu","Utils","jsx","_jsx","jsxs","_jsxs","PADDING_LEFT","TreeView","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","onItemMove","repo","dirent","selectedPath","currentPath","onNodeDragStart","e","node","isIEBrower","dragStartNodeData","nodeDirent","object","nodeParentPath","parentNode","path","nodeRootPath","JSON","stringify","dataTransfer","effectAllowed","setData","onNodeDragEnter","canDrop","persist","target","className","setState","isTreeViewDropTipShow","onNodeDragMove","preventDefault","dropEffect","onNodeDragLeave","onContainerClick","event","onNodeClick","onNodeDrop","files","length","getData","parse","_dragStartNodeData","dropNodeData","Array","isArray","onItemsMove","currentRepoInfo","onMoveItems","type","name","paths","getPaths","includes","destRepo","destDirentPath","direntPaths","forEach","push","some","direntPath","isChildPath","freezeItem","isItemFreezed","unfreezeItem","onMenuItemClick","operation","onMouseDown","stopPropagation","button","onContextMenu","permission","handleContextClick","isNodeMenuShow","x","clientX","touches","pageX","y","clientY","pageY","posX","posY","menuList","getMenuList","showMenuConfig","id","position","currentObject","NEW_FOLDER","NEW_FILE","COPY","MOVE","RENAME","DELETE","OPEN_VIA_CLIENT","userPerm","_Utils$getUserPermiss","getUserPermission","isCustomPermission","customPermission","_customPermission$per","canCreate","create","canModify","modify","canDelete","delete","canCopy","copy","onShowMenu","onHideMenu","state","_Utils$getUserPermiss2","_createClass","key","value","render","concat","onDrop","onDragEnter","onDragLeave","onClick","children","treeData","root","paddingLeft","onNodeExpanded","onNodeCollapse","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/tree-view/tree-view.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport TextTranslation from '../../utils/text-translation';\nimport TreeNodeView from './tree-node-view';\nimport ContextMenu from '../context-menu/context-menu';\nimport { hideMenu, showMenu } from '../context-menu/actions';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  userPerm: PropTypes.string,\n  isNodeMenuShow: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  onMenuItemClick: PropTypes.func,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func,\n  currentRepoInfo: PropTypes.object,\n  selectedDirentList: PropTypes.array,\n  onItemsMove: PropTypes.func,\n  posX: PropTypes.number,\n  posY: PropTypes.number,\n};\n\nconst PADDING_LEFT = 20;\n\nclass TreeView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n      isTreeViewDropTipShow: false,\n    };\n    const { userPerm } = props;\n    this.canDrop = userPerm === 'rw';\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (isCustomPermission) {\n      const { modify } = customPermission.permission;\n      this.canDrop = modify;\n    }\n  }\n\n  onItemMove = (repo, dirent, selectedPath, currentPath) => {\n    this.props.onItemMove(repo, dirent, selectedPath, currentPath);\n  };\n\n  onNodeDragStart = (e, node) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    let dragStartNodeData = {nodeDirent: node.object, nodeParentPath: node.parentNode.path, nodeRootPath: node.path};\n    dragStartNodeData = JSON.stringify(dragStartNodeData);\n\n    e.dataTransfer.effectAllowed = 'move';\n    e.dataTransfer.setData('applicaiton/drag-item-info', dragStartNodeData);\n  };\n\n  onNodeDragEnter = (e, node) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    e.persist();\n    if (e.target.className === 'tree-view tree ') {\n      this.setState({\n        isTreeViewDropTipShow: true,\n      });\n    }\n  };\n\n  onNodeDragMove = (e) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  };\n\n  onNodeDragLeave = (e, node) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    if (e.target.className === 'tree-view tree tree-view-drop') {\n      this.setState({\n        isTreeViewDropTipShow: false,\n      });\n    }\n  };\n\n  onContainerClick = (event) => {\n    hideMenu();\n  };\n\n  onNodeClick = (node) => {\n    hideMenu();\n    this.props.onNodeClick(node);\n  };\n\n  onNodeDrop = (e, node) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    if (e.dataTransfer.files.length) { // uploaded files\n      return;\n    }\n    let dragStartNodeData = e.dataTransfer.getData('applicaiton/drag-item-info');\n    dragStartNodeData = JSON.parse(dragStartNodeData);\n\n    let {nodeDirent, nodeParentPath, nodeRootPath} = dragStartNodeData;\n    let dropNodeData = node;\n\n    if (Array.isArray(dragStartNodeData)) { //move items\n      if (!dropNodeData) { //move items to root\n        if (dragStartNodeData[0].nodeParentPath === '/') {\n          this.setState({isTreeViewDropTipShow: false});\n          return;\n        }\n        this.props.onItemsMove(this.props.currentRepoInfo, '/');\n        this.setState({isTreeViewDropTipShow: false});\n        return;\n      }\n      this.onMoveItems(dragStartNodeData, dropNodeData, this.props.currentRepoInfo, dropNodeData.path);\n      return;\n    }\n\n    if (!dropNodeData) {\n      if (nodeParentPath === '/') {\n        this.setState({isTreeViewDropTipShow: false});\n        return;\n      }\n      this.onItemMove(this.props.currentRepoInfo, nodeDirent, '/', nodeParentPath);\n      this.setState({isTreeViewDropTipShow: false});\n      return;\n    }\n\n    if (dropNodeData.object.type !== 'dir') {\n      return;\n    }\n\n    if (nodeParentPath === dropNodeData.path) {\n      return;\n    }\n\n    // copy the dirent to itself. eg: A/B -> A/B\n    if (nodeParentPath === dropNodeData.parentNode.path) {\n      if (dropNodeData.object.name === nodeDirent.name) {\n        return;\n      }\n    }\n\n    // copy the dirent to it's child. eg: A/B -> A/B/C\n    if (dropNodeData.object.type === 'dir' && nodeDirent.type === 'dir') {\n      if (dropNodeData.parentNode.path !== nodeParentPath) {\n        let paths = Utils.getPaths(dropNodeData.path);\n        if (paths.includes(nodeRootPath)) {\n          return;\n        }\n      }\n    }\n\n    this.onItemMove(this.props.currentRepoInfo, nodeDirent, dropNodeData.path, nodeParentPath);\n  };\n\n  onMoveItems = (dragStartNodeData, dropNodeData, destRepo, destDirentPath) => {\n    let direntPaths = [];\n    let paths = Utils.getPaths(destDirentPath);\n    dragStartNodeData.forEach(dirent => {\n      let path = dirent.nodeRootPath;\n      direntPaths.push(path);\n    });\n\n    if (dropNodeData.object.type !== 'dir') {\n      return;\n    }\n\n    // move dirents to one of them. eg: A/B, A/C -> A/B\n    if (direntPaths.some(direntPath => { return direntPath === destDirentPath;})) {\n      return;\n    }\n\n    // move dirents to current path\n    if (dragStartNodeData[0].nodeParentPath && dragStartNodeData[0].nodeParentPath === dropNodeData.path ) {\n      return;\n    }\n\n    // move dirents to one of their child. eg: A/B, A/D -> A/B/C\n    let isChildPath = direntPaths.some(direntPath => {\n      return paths.includes(direntPath);\n    });\n    if (isChildPath) {\n      return;\n    }\n\n    this.props.onItemsMove(destRepo, destDirentPath);\n  };\n\n  freezeItem = () => {\n    this.setState({isItemFreezed: true});\n  };\n\n  unfreezeItem = () => {\n    this.setState({isItemFreezed: false});\n  };\n\n  onMenuItemClick = (operation, node) => {\n    this.props.onMenuItemClick(operation, node);\n    hideMenu();\n  };\n\n  onMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  };\n\n  onContextMenu = (event) => {\n    event.preventDefault();\n\n    let currentRepoInfo = this.props.currentRepoInfo;\n    if (currentRepoInfo.permission !== 'admin' && currentRepoInfo.permission !== 'rw') {\n      return '';\n    }\n    this.handleContextClick(event);\n  };\n\n  handleContextClick = (event, node) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    if (!this.props.isNodeMenuShow) {\n      return;\n    }\n\n    let x = event.clientX || (event.touches && event.touches[0].pageX);\n    let y = event.clientY || (event.touches && event.touches[0].pageY);\n\n    if (this.props.posX) {\n      x -= this.props.posX;\n    }\n    if (this.props.posY) {\n      y -= this.props.posY;\n    }\n\n    hideMenu();\n\n    let menuList = this.getMenuList(node);\n\n    let showMenuConfig = {\n      id: 'tree-node-contextmenu',\n      position: { x, y },\n      target: event.target,\n      currentObject: node,\n      menuList: menuList,\n    };\n\n    showMenu(showMenuConfig);\n  };\n\n  getMenuList = (node) => {\n    let menuList = [];\n\n    let { NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE, OPEN_VIA_CLIENT } = TextTranslation;\n\n    if (!node) {\n      return [NEW_FOLDER, NEW_FILE];\n    }\n\n    if (node.object.type === 'dir') {\n      menuList = [NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE];\n    } else {\n      menuList = [RENAME, DELETE, COPY, MOVE, OPEN_VIA_CLIENT];\n    }\n\n    const { userPerm } = this.props;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (!isCustomPermission) {\n      return menuList;\n    }\n\n    menuList = [];\n\n    const { create: canCreate, modify: canModify, delete: canDelete, copy: canCopy } = customPermission.permission;\n    if (!node) {\n      canCreate && menuList.push(NEW_FOLDER, NEW_FILE);\n      return menuList;\n    }\n\n    if (node.object.type === 'dir') {\n      canCreate && menuList.push(NEW_FOLDER, NEW_FILE);\n    }\n\n    canCopy && menuList.push(COPY);\n    canModify && menuList.push(MOVE, RENAME);\n    canDelete && menuList.push(DELETE);\n\n    if (node.object.type !== 'dir') {\n      menuList.push(OPEN_VIA_CLIENT);\n    }\n\n    return menuList;\n  };\n\n  onShowMenu = () => {\n    this.freezeItem();\n  };\n\n  onHideMenu = () => {\n    this.unfreezeItem();\n  };\n\n  render() {\n    return (\n      <div\n        className={`tree-view tree ${(this.state.isTreeViewDropTipShow && this.canDrop) ? 'tree-view-drop' : ''}`}\n        onDrop={this.onNodeDrop}\n        onDragEnter={this.onNodeDragEnter}\n        onDragLeave={this.onNodeDragLeave}\n        onMouseDown={this.onMouseDown}\n        onContextMenu={this.onContextMenu}\n        onClick={this.onContainerClick}\n      >\n        <TreeNodeView\n          userPerm={this.props.userPerm}\n          node={this.props.treeData.root}\n          currentPath={this.props.currentPath}\n          paddingLeft={PADDING_LEFT}\n          isNodeMenuShow={this.props.isNodeMenuShow}\n          isItemFreezed={this.state.isItemFreezed}\n          onNodeClick={this.onNodeClick}\n          onMenuItemClick={this.props.onMenuItemClick}\n          onNodeExpanded={this.props.onNodeExpanded}\n          onNodeCollapse={this.props.onNodeCollapse}\n          onNodeDragStart={this.onNodeDragStart}\n          freezeItem={this.freezeItem}\n          unfreezeItem={this.unfreezeItem}\n          onNodeDragMove={this.onNodeDragMove}\n          onNodeDrop={this.onNodeDrop}\n          onNodeDragEnter={this.onNodeDragEnter}\n          onNodeDragLeave={this.onNodeDragLeave}\n          handleContextClick={this.handleContextClick}\n        />\n        <ContextMenu\n          id={'tree-node-contextmenu'}\n          onMenuItemClick={this.onMenuItemClick}\n          onHideMenu={this.onHideMenu}\n          onShowMenu={this.onShowMenu}\n        />\n      </div>\n    );\n  }\n}\n\nTreeView.propTypes = propTypes;\n\nexport default TreeView;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}