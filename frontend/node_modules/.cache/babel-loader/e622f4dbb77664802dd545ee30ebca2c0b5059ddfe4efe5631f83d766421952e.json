{"ast":null,"code":"import _createClass from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _classCallCheck from \"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport isHotkey from 'is-hotkey';\nimport EventBus from '../utils/event-bus';\nimport { getSelectedNodeByType } from '../extension/core/queries/';\nimport { setOriginSdocKey } from './document-utils';\nimport { ELEMENT_TYPE } from '../extension/constants';\nimport { INTERNAL_EVENT } from '../constants';\nvar EventProxy = /*#__PURE__*/_createClass(function EventProxy(_editor) {\n  var _this = this;\n  _classCallCheck(this, EventProxy);\n  _defineProperty(this, \"onKeyDown\", function (event) {\n    var editor = _this.editor;\n    if (editor.onHotKeyDown) {\n      var isHandled = editor.onHotKeyDown(event);\n      if (isHandled) return;\n    }\n\n    // bold\n    if (isHotkey('mod+b', event)) {\n      event.preventDefault();\n      editor.toggleTextBold();\n    }\n\n    // italic\n    if (isHotkey('mod+i', event)) {\n      event.preventDefault();\n      editor.toggleTextItalic();\n    }\n\n    // font scale\n    if (isHotkey('opt+.', event)) {\n      event.preventDefault();\n      editor.increaseFontSize();\n    }\n    if (isHotkey('opt+,', event)) {\n      event.preventDefault();\n      editor.reduceFontSize();\n    }\n\n    // disable the default 'save page'\n    if (isHotkey('mod+s', event)) {\n      event.preventDefault();\n    }\n\n    // redo\n    if (isHotkey('mod+y', event)) {\n      event.preventDefault();\n      var history = editor.history;\n      if (history.redos.length === 0) {\n        return false;\n      }\n      editor.redo();\n    }\n\n    // undo\n    if (isHotkey('mod+z', event)) {\n      event.preventDefault();\n      var _history = editor.history;\n      if (_history.undos.length === 0) {\n        return false;\n      }\n      editor.undo();\n    }\n    if (isHotkey('tab', event) || isHotkey('shift+tab', event)) {\n      editor.handleTab && editor.handleTab(event);\n    }\n    if (isHotkey('mod+p', event)) {\n      event.preventDefault();\n      var eventBus = EventBus.getInstance();\n      eventBus.dispatch(INTERNAL_EVENT.ON_PRINT);\n    }\n    var node = getSelectedNodeByType(editor, ELEMENT_TYPE.TABLE);\n    if (node) {\n      _this.editor.tableOnKeyDown(event);\n    }\n    var imageNode = getSelectedNodeByType(editor, ELEMENT_TYPE.IMAGE);\n    if (imageNode) {\n      _this.editor.imageOnKeyDown(event);\n    }\n    if (getSelectedNodeByType(editor, ELEMENT_TYPE.CODE_BLOCK)) {\n      _this.editor.codeBlockOnKeyDown(event);\n      var _eventBus = EventBus.getInstance();\n      _eventBus.dispatch(INTERNAL_EVENT.HIDDEN_CODE_BLOCK_HOVER_MENU);\n    }\n  });\n  _defineProperty(this, \"onCopy\", function (event) {\n    if (_this.editor.onCopy) _this.editor.onCopy(event);\n    setOriginSdocKey(event);\n  });\n  _defineProperty(this, \"onCut\", function (event) {\n    setOriginSdocKey(event);\n    if (_this.editor.cut) {\n      _this.editor.cut(event);\n    }\n  });\n  _defineProperty(this, \"onPaste\", function (event) {});\n  _defineProperty(this, \"onCompositionStart\", function (event) {\n    var editor = _this.editor;\n    if (editor.onCompositionStart) {\n      var isHandled = editor.onCompositionStart(event);\n      if (isHandled) return;\n    }\n  });\n  _defineProperty(this, \"onCompositionUpdate\", function (event) {\n    var editor = _this.editor;\n    if (editor.onCompositionUpdate) {\n      var isHandled = editor.onCompositionUpdate(event);\n      if (isHandled) return;\n    }\n  });\n  _defineProperty(this, \"onCompositionEnd\", function (event) {\n    var editor = _this.editor;\n    if (editor.onCompositionUpdate) {\n      var isHandled = editor.onCompositionEnd(event);\n      if (isHandled) return;\n    }\n  });\n  this.editor = _editor;\n});\nexport default EventProxy;","map":{"version":3,"names":["_defineProperty","isHotkey","EventBus","getSelectedNodeByType","setOriginSdocKey","ELEMENT_TYPE","INTERNAL_EVENT","EventProxy","_createClass","_editor","_this","_classCallCheck","event","editor","onHotKeyDown","isHandled","preventDefault","toggleTextBold","toggleTextItalic","increaseFontSize","reduceFontSize","history","redos","length","redo","undos","undo","handleTab","eventBus","getInstance","dispatch","ON_PRINT","node","TABLE","tableOnKeyDown","imageNode","IMAGE","imageOnKeyDown","CODE_BLOCK","codeBlockOnKeyDown","HIDDEN_CODE_BLOCK_HOVER_MENU","onCopy","cut","onCompositionStart","onCompositionUpdate","onCompositionEnd"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/sdoc-editor/dist/basic-sdk/utils/event-handler.js"],"sourcesContent":["import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport isHotkey from 'is-hotkey';\nimport EventBus from '../utils/event-bus';\nimport { getSelectedNodeByType } from '../extension/core/queries/';\nimport { setOriginSdocKey } from './document-utils';\nimport { ELEMENT_TYPE } from '../extension/constants';\nimport { INTERNAL_EVENT } from '../constants';\nclass EventProxy {\n  constructor(_editor) {\n    _defineProperty(this, \"onKeyDown\", event => {\n      const editor = this.editor;\n      if (editor.onHotKeyDown) {\n        const isHandled = editor.onHotKeyDown(event);\n        if (isHandled) return;\n      }\n\n      // bold\n      if (isHotkey('mod+b', event)) {\n        event.preventDefault();\n        editor.toggleTextBold();\n      }\n\n      // italic\n      if (isHotkey('mod+i', event)) {\n        event.preventDefault();\n        editor.toggleTextItalic();\n      }\n\n      // font scale\n      if (isHotkey('opt+.', event)) {\n        event.preventDefault();\n        editor.increaseFontSize();\n      }\n      if (isHotkey('opt+,', event)) {\n        event.preventDefault();\n        editor.reduceFontSize();\n      }\n\n      // disable the default 'save page'\n      if (isHotkey('mod+s', event)) {\n        event.preventDefault();\n      }\n\n      // redo\n      if (isHotkey('mod+y', event)) {\n        event.preventDefault();\n        const {\n          history\n        } = editor;\n        if (history.redos.length === 0) {\n          return false;\n        }\n        editor.redo();\n      }\n\n      // undo\n      if (isHotkey('mod+z', event)) {\n        event.preventDefault();\n        const {\n          history\n        } = editor;\n        if (history.undos.length === 0) {\n          return false;\n        }\n        editor.undo();\n      }\n      if (isHotkey('tab', event) || isHotkey('shift+tab', event)) {\n        editor.handleTab && editor.handleTab(event);\n      }\n      if (isHotkey('mod+p', event)) {\n        event.preventDefault();\n        const eventBus = EventBus.getInstance();\n        eventBus.dispatch(INTERNAL_EVENT.ON_PRINT);\n      }\n      const node = getSelectedNodeByType(editor, ELEMENT_TYPE.TABLE);\n      if (node) {\n        this.editor.tableOnKeyDown(event);\n      }\n      const imageNode = getSelectedNodeByType(editor, ELEMENT_TYPE.IMAGE);\n      if (imageNode) {\n        this.editor.imageOnKeyDown(event);\n      }\n      if (getSelectedNodeByType(editor, ELEMENT_TYPE.CODE_BLOCK)) {\n        this.editor.codeBlockOnKeyDown(event);\n        const eventBus = EventBus.getInstance();\n        eventBus.dispatch(INTERNAL_EVENT.HIDDEN_CODE_BLOCK_HOVER_MENU);\n      }\n    });\n    _defineProperty(this, \"onCopy\", event => {\n      if (this.editor.onCopy) this.editor.onCopy(event);\n      setOriginSdocKey(event);\n    });\n    _defineProperty(this, \"onCut\", event => {\n      setOriginSdocKey(event);\n      if (this.editor.cut) {\n        this.editor.cut(event);\n      }\n    });\n    _defineProperty(this, \"onPaste\", event => {});\n    _defineProperty(this, \"onCompositionStart\", event => {\n      const editor = this.editor;\n      if (editor.onCompositionStart) {\n        const isHandled = editor.onCompositionStart(event);\n        if (isHandled) return;\n      }\n    });\n    _defineProperty(this, \"onCompositionUpdate\", event => {\n      const editor = this.editor;\n      if (editor.onCompositionUpdate) {\n        const isHandled = editor.onCompositionUpdate(event);\n        if (isHandled) return;\n      }\n    });\n    _defineProperty(this, \"onCompositionEnd\", event => {\n      const editor = this.editor;\n      if (editor.onCompositionUpdate) {\n        const isHandled = editor.onCompositionEnd(event);\n        if (isHandled) return;\n      }\n    });\n    this.editor = _editor;\n  }\n}\nexport default EventProxy;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}