{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{Button,Modal,ModalHeader,ModalBody,ModalFooter,Form,FormGroup,Label,Input,Alert}from'reactstrap';import{gettext}from'../../utils/constants';import{seafileAPI}from'../../utils/seafile-api';import{Utils}from'../../utils/utils';import toaster from'../toast';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LibOldFilesAutoDelDialog=/*#__PURE__*/function(_React$Component){_inherits(LibOldFilesAutoDelDialog,_React$Component);var _super=_createSuper(LibOldFilesAutoDelDialog);function LibOldFilesAutoDelDialog(props){var _this;_classCallCheck(this,LibOldFilesAutoDelDialog);_this=_super.call(this,props);_this.submit=function(){var daysNeedTobeSet;if(_this.state.isAutoDel){daysNeedTobeSet=_this.state.autoDelDays;var reg=/^-?\\d+$/;var isvalid_days=reg.test(daysNeedTobeSet);if(!isvalid_days||daysNeedTobeSet<=0){_this.setState({errorInfo:gettext('Please enter a positive integer')});return;}}else{daysNeedTobeSet=0;// if no auto del, give 0 to server\n}var repoID=_this.props.repoID;seafileAPI.setRepoOldFilesAutoDelDays(repoID,daysNeedTobeSet).then(function(res){_this.props.toggleDialog();toaster.success(gettext('Successfully set it.'));}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});};_this.handleKeyDown=function(e){if(e.key==='Enter'){_this.submit();e.preventDefault();}};_this.onChange=function(e){var days=e.target.value;_this.setState({autoDelDays:days});};_this.updateRadioCheck=function(type){if(type==='noAutoDel'){_this.setState({isAutoDel:false});}else if(type==='autoDel'){_this.setState({isAutoDel:true});}};_this.state={autoDelDays:0,isAutoDel:false,errorInfo:''};return _this;}_createClass(LibOldFilesAutoDelDialog,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;seafileAPI.getRepoOldFilesAutoDelDays(this.props.repoID).then(function(res){_this2.setState({autoDelDays:res.data.auto_delete_days,isAutoDel:res.data.auto_delete_days>0});}).catch(function(error){var errMessage=Utils.getErrorMsg(error);toaster.danger(errMessage);});}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsxs(Modal,{isOpen:true,toggle:this.props.toggleDialog,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:this.props.toggleDialog,children:gettext('Auto deletion')}),/*#__PURE__*/_jsx(ModalBody,{children:/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(FormGroup,{check:true,children:[/*#__PURE__*/_jsx(Input,{type:\"radio\",name:\"radio1\",checked:!this.state.isAutoDel,onChange:function onChange(){_this3.updateRadioCheck('noAutoDel');}}),' ',/*#__PURE__*/_jsx(Label,{children:gettext('Do not automatically delete files')})]}),/*#__PURE__*/_jsxs(FormGroup,{check:true,children:[/*#__PURE__*/_jsx(Input,{type:\"radio\",name:\"radio1\",checked:this.state.isAutoDel,onChange:function onChange(){_this3.updateRadioCheck('autoDel');}}),' ',/*#__PURE__*/_jsx(Label,{children:gettext('Automatically delete files that are not modified within certain days:')}),/*#__PURE__*/_jsx(Input,{type:\"text\",className:\"expire-input\",value:this.state.autoDelDays,disabled:!this.state.isAutoDel,onChange:this.onChange,onKeyDown:this.handleKeyDown}),' ',/*#__PURE__*/_jsx(Label,{children:/*#__PURE__*/_jsx(\"span\",{children:gettext('days')})})]}),this.state.errorInfo&&/*#__PURE__*/_jsx(Alert,{color:\"danger\",children:this.state.errorInfo})]})}),/*#__PURE__*/_jsxs(ModalFooter,{children:[/*#__PURE__*/_jsx(Button,{color:\"secondary\",onClick:this.props.toggleDialog,children:gettext('Cancel')}),/*#__PURE__*/_jsx(Button,{color:\"primary\",onClick:this.submit,children:gettext('Submit')})]})]});}}]);return LibOldFilesAutoDelDialog;}(React.Component);export default LibOldFilesAutoDelDialog;","map":{"version":3,"names":["React","Button","Modal","ModalHeader","ModalBody","ModalFooter","Form","FormGroup","Label","Input","Alert","gettext","seafileAPI","Utils","toaster","jsx","_jsx","jsxs","_jsxs","LibOldFilesAutoDelDialog","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","submit","daysNeedTobeSet","state","isAutoDel","autoDelDays","reg","isvalid_days","test","setState","errorInfo","repoID","setRepoOldFilesAutoDelDays","then","res","toggleDialog","success","catch","error","errMessage","getErrorMsg","danger","handleKeyDown","e","key","preventDefault","onChange","days","target","value","updateRadioCheck","type","_createClass","componentDidMount","_this2","getRepoOldFilesAutoDelDays","data","auto_delete_days","render","_this3","isOpen","toggle","children","check","name","checked","className","disabled","onKeyDown","color","onClick","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/lib-old-files-auto-del-dialog.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Form, FormGroup, Label, Input, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  toggleDialog: PropTypes.func.isRequired,\n  repoID: PropTypes.string.isRequired,\n};\n\nclass LibOldFilesAutoDelDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      autoDelDays: 0,\n      isAutoDel: false,\n      errorInfo: '',\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getRepoOldFilesAutoDelDays(this.props.repoID).then(res => {\n      this.setState({\n        autoDelDays: res.data.auto_delete_days,\n        isAutoDel: res.data.auto_delete_days > 0,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  submit = () => {\n    let daysNeedTobeSet;\n\n    if (this.state.isAutoDel) {\n      daysNeedTobeSet = this.state.autoDelDays;\n\n      let reg = /^-?\\d+$/;\n      let isvalid_days = reg.test(daysNeedTobeSet);\n      if (!isvalid_days || daysNeedTobeSet <= 0) {\n        this.setState({\n          errorInfo: gettext('Please enter a positive integer'),\n        });\n        return;\n      }\n\n    } else {\n      daysNeedTobeSet = 0;    // if no auto del, give 0 to server\n    }\n\n\n    let repoID = this.props.repoID;\n\n    seafileAPI.setRepoOldFilesAutoDelDays(repoID, daysNeedTobeSet).then(res => {\n      this.props.toggleDialog();\n      toaster.success(gettext('Successfully set it.'));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  };\n\n  handleKeyDown = (e) => {\n    if (e.key === 'Enter') {\n      this.submit();\n      e.preventDefault();\n    }\n  };\n\n  onChange = (e) => {\n    let days = e.target.value;\n    this.setState({\n      autoDelDays: days,\n    });\n  };\n\n  updateRadioCheck = (type) => {\n    if (type === 'noAutoDel') {\n      this.setState({\n        isAutoDel: false,\n      });\n    } else if (type === 'autoDel') {\n      this.setState({\n        isAutoDel: true,\n      });\n    }\n  };\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalHeader toggle={this.props.toggleDialog}>\n          {gettext('Auto deletion')}\n        </ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={!this.state.isAutoDel} onChange={() =>{this.updateRadioCheck('noAutoDel');}}/>{' '}\n              <Label>{gettext('Do not automatically delete files')}</Label>\n            </FormGroup>\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={this.state.isAutoDel} onChange={() =>{this.updateRadioCheck('autoDel');}}/>{' '}\n              <Label>{gettext('Automatically delete files that are not modified within certain days:')}</Label>\n              <Input\n                type=\"text\"\n                className=\"expire-input\"\n                value={this.state.autoDelDays}\n                disabled={!this.state.isAutoDel}\n                onChange={this.onChange}\n                onKeyDown={this.handleKeyDown}\n              />{' '}\n              <Label><span>{gettext('days')}</span></Label>\n            </FormGroup>\n            {this.state.errorInfo && <Alert color=\"danger\">{this.state.errorInfo}</Alert>}\n          </Form>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.submit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nLibOldFilesAutoDelDialog.propTypes = propTypes;\n\nexport default LibOldFilesAutoDelDialog;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}