{"ast":null,"code":"import _toConsumableArray from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component,Fragment}from'react';import moment from'moment';import{Link}from'@gatsbyjs/reach-router';import{seafileAPI}from'../../utils/seafile-api';import{gettext,siteRoot,username}from'../../utils/constants';import{Utils}from'../../utils/utils';import Loading from'../../components/loading';import Activity from'../../models/activity';import FileActivitiesContent from'./content';import UserSelector from'./user-selector';import'../../css/files-activities.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";moment.locale(window.app.config.lang);var FilesActivities=/*#__PURE__*/function(_Component){_inherits(FilesActivities,_Component);var _super=_createSuper(FilesActivities);function FilesActivities(props){var _this;_classCallCheck(this,FilesActivities);_this=_super.call(this,props);_this.mergePublishEvents=function(events){events.forEach(function(item){if(item.op_type==='publish'){_this.curPathList.push(item.path);_this.oldPathList.push(item.old_path);}});var actuallyEvents=[];for(var i=0;i<events.length;i++){if(events[i].obj_type==='file'){if(events[i].op_type==='delete'&&_this.oldPathList.includes(events[i].path)){_this.oldPathList.splice(_this.oldPathList.indexOf(events[i].path),1);}else if(events[i].op_type==='edit'&&_this.curPathList.includes(events[i].path)){_this.curPathList.splice(_this.curPathList.indexOf(events[i].path),1);}else if(events[i].op_type==='rename'&&_this.oldPathList.includes(events[i].old_path)){_this.oldPathList.splice(_this.oldPathList.indexOf(events[i].old_path),1);}else{actuallyEvents.push(events[i]);}}else{actuallyEvents.push(events[i]);}}return actuallyEvents;};_this.mergeFileCreateEvents=function(events){var actuallyEvents=[];var multiFilesActivity=null;for(var i=0;i<events.length;i++){var isFulfilCondition=events[i].obj_type==='file'&&events[i].op_type==='create'&&events[i+1]&&events[i+1].obj_type==='file'&&events[i+1].op_type==='create'&&events[i+1].repo_name===events[i].repo_name&&events[i+1].author_email===events[i].author_email;if(multiFilesActivity!=null){multiFilesActivity.createdFilesCount++;multiFilesActivity.createdFilesList.push(events[i]);if(isFulfilCondition){continue;}else{actuallyEvents.push(multiFilesActivity);multiFilesActivity=null;}}else{if(isFulfilCondition){multiFilesActivity=new Activity(events[i]);multiFilesActivity.obj_type='files';multiFilesActivity.createdFilesCount++;multiFilesActivity.createdFilesList.push(events[i]);}else{actuallyEvents.push(events[i]);}}}return actuallyEvents;};_this.filterEvents=function(events){var onlyMine=_this.props.onlyMine;var targetUsers=_this.state.targetUsers;if(onlyMine){return events.filter(function(item){return item.author_email==username;});}else if(targetUsers.length){return events.filter(function(item){return targetUsers.map(function(item){return item.email;}).indexOf(item.author_email)!=-1;});}else{return events;}};_this.setTargetUsers=function(selectedUsers){_this.setState({targetUsers:selectedUsers},function(){var items=_this.filterEvents(_this.state.allItems);_this.setState({items:items},function(){if(items.length<25&&_this.state.hasMore){_this.getMore();}});});};_this.toggleSelectUser=function(user){var availableUsers=_this.state.availableUsers;_this.setState({availableUsers:availableUsers.map(function(item){if(item.email==user.email){item.isSelected=!user.isSelected;}return item;})});};_this.handleScroll=function(event){if(!_this.state.isLoadingMore&&_this.state.hasMore){var clientHeight=event.target.clientHeight;var scrollHeight=event.target.scrollHeight;var scrollTop=event.target.scrollTop;var isBottom=clientHeight+scrollTop+1>=scrollHeight;if(isBottom){// scroll to the bottom\n_this.setState({isLoadingMore:true},function(){_this.getMore();});}}};_this.state={errorMsg:'',isFirstLoading:true,isLoadingMore:false,// only for 'scroll down to the bottom'\ncurrentPage:1,hasMore:true,allItems:[],items:[],availableUsers:[],targetUsers:[]};_this.avatarSize=72;_this.curPathList=[];_this.oldPathList=[];_this.availableUserEmails=new Set();return _this;}_createClass(FilesActivities,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var _this$state=this.state,currentPage=_this$state.currentPage,availableUsers=_this$state.availableUsers;seafileAPI.listActivities(currentPage,this.avatarSize).then(function(res){// {\"events\":[...]}\nvar events=_this2.mergePublishEvents(res.data.events);events=_this2.mergeFileCreateEvents(events);events.forEach(function(item){if(!_this2.availableUserEmails.has(item.author_email)){_this2.availableUserEmails.add(item.author_email);availableUsers.push({email:item.author_email,name:item.author_name,contact_email:item.author_contact_email,avatar_url:item.avatar_url,isSelected:false});}});var curItems=_this2.filterEvents(events);_this2.setState({allItems:events,items:curItems,availableUsers:availableUsers,currentPage:currentPage+1,isFirstLoading:curItems.length==0,hasMore:true});if(_this2.state.items.length<25){_this2.getMore();}}).catch(function(error){_this2.setState({isFirstLoading:false,errorMsg:Utils.getErrorMsg(error,true)// true: show login tip if 403\n});});}},{key:\"getMore\",value:function getMore(){var _this3=this;var _this$state2=this.state,currentPage=_this$state2.currentPage,availableUsers=_this$state2.availableUsers,targetUsers=_this$state2.targetUsers;seafileAPI.listActivities(currentPage,this.avatarSize).then(function(res){// {\"events\":[...]}\nvar events=_this3.mergePublishEvents(res.data.events);events=_this3.mergeFileCreateEvents(events);events.forEach(function(item){if(!_this3.availableUserEmails.has(item.author_email)){_this3.availableUserEmails.add(item.author_email);availableUsers.push({email:item.author_email,name:item.author_name,contact_email:item.author_contact_email,avatar_url:item.avatar_url,isSelected:false});}});var filteredEvents=_this3.filterEvents(events);var curItems=[].concat(_toConsumableArray(_this3.state.items),_toConsumableArray(filteredEvents));_this3.setState({allItems:[].concat(_toConsumableArray(_this3.state.allItems),_toConsumableArray(events)),items:curItems,availableUsers:availableUsers,currentPage:currentPage+1,isFirstLoading:curItems.length==0,isLoadingMore:false,hasMore:res.data.events.length===0?false:true});if(_this3.state.items.length<25&&_this3.state.hasMore){if(!(targetUsers.length&&currentPage==100)){_this3.getMore();}}}).catch(function(error){_this3.setState({isFirstLoading:false,isLoadingMore:false,errorMsg:Utils.getErrorMsg(error,true)// true: show login tip if 403\n});});}},{key:\"render\",value:function render(){var onlyMine=this.props.onlyMine;var _this$state3=this.state,targetUsers=_this$state3.targetUsers,availableUsers=_this$state3.availableUsers;return/*#__PURE__*/_jsx(\"div\",{className:\"main-panel-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"cur-view-container\",id:\"activities\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cur-view-path\",children:/*#__PURE__*/_jsxs(\"ul\",{className:\"nav\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",children:/*#__PURE__*/_jsx(Link,{to:\"\".concat(siteRoot,\"dashboard/\"),className:\"nav-link\".concat(onlyMine?'':' active'),children:gettext('All Activities')})}),/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",children:/*#__PURE__*/_jsx(Link,{to:\"\".concat(siteRoot,\"my-activities/\"),className:\"nav-link\".concat(onlyMine?' active':''),children:gettext('My Activities')})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"cur-view-content d-block\",onScroll:this.handleScroll,children:[this.state.isFirstLoading&&/*#__PURE__*/_jsx(Loading,{}),!this.state.isFirstLoading&&this.state.errorMsg&&/*#__PURE__*/_jsx(\"p\",{className:\"error text-center\",children:this.state.errorMsg}),!this.state.isFirstLoading&&/*#__PURE__*/_jsxs(Fragment,{children:[!onlyMine&&/*#__PURE__*/_jsx(UserSelector,{availableUsers:availableUsers,currentSelectedUsers:targetUsers,setTargetUsers:this.setTargetUsers,toggleSelectUser:this.toggleSelectUser}),/*#__PURE__*/_jsx(FileActivitiesContent,{items:this.state.items,isLoadingMore:this.state.isLoadingMore})]})]})]})});}}]);return FilesActivities;}(Component);export default FilesActivities;","map":{"version":3,"names":["React","Component","Fragment","moment","Link","seafileAPI","gettext","siteRoot","username","Utils","Loading","Activity","FileActivitiesContent","UserSelector","jsx","_jsx","jsxs","_jsxs","locale","window","app","config","lang","FilesActivities","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","mergePublishEvents","events","forEach","item","op_type","curPathList","push","path","oldPathList","old_path","actuallyEvents","i","length","obj_type","includes","splice","indexOf","mergeFileCreateEvents","multiFilesActivity","isFulfilCondition","repo_name","author_email","createdFilesCount","createdFilesList","filterEvents","onlyMine","targetUsers","state","filter","map","email","setTargetUsers","selectedUsers","setState","items","allItems","hasMore","getMore","toggleSelectUser","user","availableUsers","isSelected","handleScroll","event","isLoadingMore","clientHeight","target","scrollHeight","scrollTop","isBottom","errorMsg","isFirstLoading","currentPage","avatarSize","availableUserEmails","Set","_createClass","key","value","componentDidMount","_this2","_this$state","listActivities","then","res","data","has","add","name","author_name","contact_email","author_contact_email","avatar_url","curItems","catch","error","getErrorMsg","_this3","_this$state2","filteredEvents","concat","_toConsumableArray","render","_this$state3","className","children","id","to","onScroll","currentSelectedUsers"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/pages/dashboard/files-activities.js"],"sourcesContent":["import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Link } from '@gatsbyjs/reach-router';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, siteRoot, username } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../../components/loading';\nimport Activity from '../../models/activity';\nimport FileActivitiesContent from './content';\nimport UserSelector from './user-selector';\n\nimport '../../css/files-activities.css';\n\nmoment.locale(window.app.config.lang);\n\nconst propTypes = {\n  onlyMine: PropTypes.bool\n};\n\nclass FilesActivities extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      errorMsg: '',\n      isFirstLoading: true,\n      isLoadingMore: false, // only for 'scroll down to the bottom'\n      currentPage: 1,\n      hasMore: true,\n      allItems: [],\n      items: [],\n      availableUsers: [],\n      targetUsers: []\n    };\n    this.avatarSize = 72;\n    this.curPathList = [];\n    this.oldPathList = [];\n    this.availableUserEmails = new Set();\n  }\n\n  componentDidMount() {\n    let { currentPage, availableUsers } = this.state;\n    seafileAPI.listActivities(currentPage, this.avatarSize).then(res => {\n      // {\"events\":[...]}\n      let events = this.mergePublishEvents(res.data.events);\n      events = this.mergeFileCreateEvents(events);\n      events.forEach(item => {\n        if (!this.availableUserEmails.has(item.author_email)) {\n          this.availableUserEmails.add(item.author_email);\n          availableUsers.push({\n            email: item.author_email,\n            name: item.author_name,\n            contact_email: item.author_contact_email,\n            avatar_url: item.avatar_url,\n            isSelected: false\n          });\n        }\n      });\n\n      const curItems = this.filterEvents(events);\n      this.setState({\n        allItems: events,\n        items: curItems,\n        availableUsers: availableUsers,\n        currentPage: currentPage + 1,\n        isFirstLoading: curItems.length == 0,\n        hasMore: true,\n      });\n      if (this.state.items.length < 25) {\n        this.getMore();\n      }\n    }).catch(error => {\n      this.setState({\n        isFirstLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  mergePublishEvents = (events) => {\n    events.forEach((item) => {\n      if (item.op_type === 'publish') {\n        this.curPathList.push(item.path);\n        this.oldPathList.push(item.old_path);\n      }\n    });\n    let actuallyEvents = [];\n    for (var i = 0; i < events.length; i++) {\n      if (events[i].obj_type === 'file') {\n        if (events[i].op_type === 'delete' && this.oldPathList.includes(events[i].path)) {\n          this.oldPathList.splice(this.oldPathList.indexOf(events[i].path), 1);\n        } else if (events[i].op_type === 'edit' && this.curPathList.includes(events[i].path)) {\n          this.curPathList.splice(this.curPathList.indexOf(events[i].path), 1);\n        } else if (events[i].op_type === 'rename' && this.oldPathList.includes(events[i].old_path)) {\n          this.oldPathList.splice(this.oldPathList.indexOf(events[i].old_path), 1);\n        } else {\n          actuallyEvents.push(events[i]);\n        }\n      } else {\n        actuallyEvents.push(events[i]);\n      }\n    }\n    return actuallyEvents;\n  };\n\n  mergeFileCreateEvents = (events) => {\n    let actuallyEvents = [];\n    let multiFilesActivity = null;\n    for (var i = 0; i < events.length; i++) {\n      let isFulfilCondition = events[i].obj_type === 'file' &&\n                              events[i].op_type === 'create' &&\n                              events[i + 1] &&\n                              events[i + 1].obj_type === 'file' &&\n                              events[i + 1].op_type === 'create' &&\n                              events[i + 1].repo_name === events[i].repo_name &&\n                              events[i + 1].author_email === events[i].author_email;\n      if (multiFilesActivity != null) {\n        multiFilesActivity.createdFilesCount++;\n        multiFilesActivity.createdFilesList.push(events[i]);\n        if (isFulfilCondition) {\n          continue;\n        } else {\n          actuallyEvents.push(multiFilesActivity);\n          multiFilesActivity = null;\n        }\n      } else {\n        if (isFulfilCondition) {\n          multiFilesActivity = new Activity(events[i]);\n          multiFilesActivity.obj_type = 'files';\n          multiFilesActivity.createdFilesCount++;\n          multiFilesActivity.createdFilesList.push(events[i]);\n        } else {\n          actuallyEvents.push(events[i]);\n        }\n      }\n    }\n    return actuallyEvents;\n  };\n\n  getMore() {\n    const { currentPage, availableUsers, targetUsers } = this.state;\n    seafileAPI.listActivities(currentPage, this.avatarSize).then(res => {\n      // {\"events\":[...]}\n      let events = this.mergePublishEvents(res.data.events);\n      events = this.mergeFileCreateEvents(events);\n      events.forEach(item => {\n        if (!this.availableUserEmails.has(item.author_email)) {\n          this.availableUserEmails.add(item.author_email);\n          availableUsers.push({\n            email: item.author_email,\n            name: item.author_name,\n            contact_email: item.author_contact_email,\n            avatar_url: item.avatar_url,\n            isSelected: false\n          });\n        }\n      });\n      const filteredEvents = this.filterEvents(events);\n      const curItems = [...this.state.items, ...filteredEvents];\n      this.setState({\n        allItems: [...this.state.allItems, ...events],\n        items: curItems,\n        availableUsers: availableUsers,\n        currentPage: currentPage + 1,\n        isFirstLoading: curItems.length == 0,\n        isLoadingMore: false,\n        hasMore: res.data.events.length === 0 ? false : true\n      });\n      if (this.state.items.length < 25 && this.state.hasMore) {\n        if (!(targetUsers.length && currentPage == 100)) {\n          this.getMore();\n        }\n      }\n    }).catch(error => {\n      this.setState({\n        isFirstLoading: false,\n        isLoadingMore: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  filterEvents = (events) => {\n    const { onlyMine } = this.props;\n    const { targetUsers } = this.state;\n\n    if (onlyMine) {\n      return events.filter(item => item.author_email == username);\n    } else if (targetUsers.length) {\n      return events.filter(item => targetUsers.map(item => item.email).indexOf(item.author_email) != -1);\n    } else {\n      return events;\n    }\n  };\n\n  setTargetUsers = (selectedUsers) => {\n    this.setState({\n      targetUsers: selectedUsers\n    }, () => {\n      const items = this.filterEvents(this.state.allItems);\n      this.setState({\n        items: items\n      }, () => {\n        if (items.length < 25 && this.state.hasMore) {\n          this.getMore();\n        }\n      });\n    });\n  };\n\n  toggleSelectUser = (user) => {\n    const { availableUsers } = this.state;\n    this.setState({\n      availableUsers: availableUsers.map(item => {\n        if (item.email == user.email) {\n          item.isSelected = !user.isSelected;\n        }\n        return item;\n      })\n    });\n  };\n\n  handleScroll = (event) => {\n    if (!this.state.isLoadingMore && this.state.hasMore) {\n      const clientHeight = event.target.clientHeight;\n      const scrollHeight = event.target.scrollHeight;\n      const scrollTop    = event.target.scrollTop;\n      const isBottom = (clientHeight + scrollTop + 1 >= scrollHeight);\n      if (isBottom) { // scroll to the bottom\n        this.setState({isLoadingMore: true}, () => {\n          this.getMore();\n        });\n      }\n    }\n  };\n\n  render() {\n    const { onlyMine } = this.props;\n    const { targetUsers, availableUsers } = this.state;\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"activities\">\n          <div className=\"cur-view-path\">\n            <ul className=\"nav\">\n              <li className=\"nav-item\">\n                <Link to={`${siteRoot}dashboard/`} className={`nav-link${onlyMine ? '' : ' active'}`}>{gettext('All Activities')}</Link>\n              </li>\n              <li className=\"nav-item\">\n                <Link to={`${siteRoot}my-activities/`} className={`nav-link${onlyMine ? ' active': ''}`}>{gettext('My Activities')}</Link>\n              </li>\n            </ul>\n          </div>\n          <div className=\"cur-view-content d-block\" onScroll={this.handleScroll}>\n            {this.state.isFirstLoading && <Loading />}\n            {(!this.state.isFirstLoading && this.state.errorMsg) &&\n              <p className=\"error text-center\">{this.state.errorMsg}</p>\n            }\n            {!this.state.isFirstLoading && (\n              <Fragment>\n                {!onlyMine && (\n                  <UserSelector\n                    availableUsers={availableUsers}\n                    currentSelectedUsers={targetUsers}\n                    setTargetUsers={this.setTargetUsers}\n                    toggleSelectUser={this.toggleSelectUser}\n                  />\n                )}\n                <FileActivitiesContent items={this.state.items} isLoadingMore={this.state.isLoadingMore} />\n              </Fragment>\n            )\n            }\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nFilesActivities.propTypes = propTypes;\n\nexport default FilesActivities;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}