{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{Utils}from'../../utils/utils';import{gettext,siteRoot}from'../../utils/constants';import'../../css/image-file-view.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var _window$app$pageOptio=window.app.pageOptions,repoID=_window$app$pageOptio.repoID,repoEncrypted=_window$app$pageOptio.repoEncrypted,fileExt=_window$app$pageOptio.fileExt,filePath=_window$app$pageOptio.filePath,fileName=_window$app$pageOptio.fileName,thumbnailSizeForOriginal=_window$app$pageOptio.thumbnailSizeForOriginal,previousImage=_window$app$pageOptio.previousImage,nextImage=_window$app$pageOptio.nextImage,rawPath=_window$app$pageOptio.rawPath,xmindImageSrc=_window$app$pageOptio.xmindImageSrc;var previousImageUrl,nextImageUrl;if(previousImage){previousImageUrl=\"\".concat(siteRoot,\"lib/\").concat(repoID,\"/file\").concat(Utils.encodePath(previousImage));}if(nextImage){nextImageUrl=\"\".concat(siteRoot,\"lib/\").concat(repoID,\"/file\").concat(Utils.encodePath(nextImage));}var FileContent=/*#__PURE__*/function(_React$Component){_inherits(FileContent,_React$Component);var _super=_createSuper(FileContent);function FileContent(props){var _this;_classCallCheck(this,FileContent);_this=_super.call(this,props);_this.handleLoadFailure=function(){_this.setState({loadFailed:true});};_this.state={loadFailed:false};return _this;}_createClass(FileContent,[{key:\"componentDidMount\",value:function componentDidMount(){document.addEventListener('keydown',function(e){if(previousImage&&e.keyCode==37){// press '<-'\nlocation.href=previousImageUrl;}if(nextImage&&e.keyCode==39){// press '->'\nlocation.href=nextImageUrl;}});}},{key:\"render\",value:function render(){if(this.state.loadFailed){return this.props.tip;}// request thumbnails for some files\n// only for 'file view'. not for 'history/trash file view'\nvar thumbnailURL='';var fileExtList=['tif','tiff','psd'];if(!repoEncrypted&&fileExtList.includes(fileExt)){thumbnailURL=\"\".concat(siteRoot,\"thumbnail/\").concat(repoID,\"/\").concat(thumbnailSizeForOriginal).concat(Utils.encodePath(filePath));}// for xmind file\nvar xmindSrc=xmindImageSrc?\"\".concat(siteRoot).concat(xmindImageSrc):'';return/*#__PURE__*/_jsxs(\"div\",{className:\"file-view-content flex-1 image-file-view\",children:[previousImage&&/*#__PURE__*/_jsx(\"a\",{href:previousImageUrl,id:\"img-prev\",title:gettext('you can also press ← '),children:/*#__PURE__*/_jsx(\"span\",{className:\"fas fa-chevron-left\"})}),nextImage&&/*#__PURE__*/_jsx(\"a\",{href:nextImageUrl,id:\"img-next\",title:gettext('you can also press →'),children:/*#__PURE__*/_jsx(\"span\",{className:\"fas fa-chevron-right\"})}),/*#__PURE__*/_jsx(\"img\",{src:xmindSrc||thumbnailURL||rawPath,alt:fileName,id:\"image-view\",onError:this.handleLoadFailure})]});}}]);return FileContent;}(React.Component);export default FileContent;","map":{"version":3,"names":["React","Utils","gettext","siteRoot","jsx","_jsx","jsxs","_jsxs","_window$app$pageOptio","window","app","pageOptions","repoID","repoEncrypted","fileExt","filePath","fileName","thumbnailSizeForOriginal","previousImage","nextImage","rawPath","xmindImageSrc","previousImageUrl","nextImageUrl","concat","encodePath","FileContent","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","handleLoadFailure","setState","loadFailed","state","_createClass","key","value","componentDidMount","document","addEventListener","e","keyCode","location","href","render","tip","thumbnailURL","fileExtList","includes","xmindSrc","className","children","id","title","src","alt","onError","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/file-content-view/image.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Utils } from '../../utils/utils';\nimport { gettext, siteRoot } from '../../utils/constants';\n\nimport '../../css/image-file-view.css';\n\nconst {\n  repoID, repoEncrypted,\n  fileExt, filePath, fileName,\n  thumbnailSizeForOriginal,\n  previousImage, nextImage, rawPath,\n  xmindImageSrc // for xmind file\n} = window.app.pageOptions;\n\nlet previousImageUrl, nextImageUrl;\nif (previousImage) {\n  previousImageUrl = `${siteRoot}lib/${repoID}/file${Utils.encodePath(previousImage)}`;\n}\nif (nextImage) {\n  nextImageUrl = `${siteRoot}lib/${repoID}/file${Utils.encodePath(nextImage)}`;\n}\n\nclass FileContent extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loadFailed: false\n    };\n  }\n\n  componentDidMount() {\n    document.addEventListener('keydown', (e) => {\n      if (previousImage && e.keyCode == 37) { // press '<-'\n        location.href = previousImageUrl;\n      }\n      if (nextImage && e.keyCode == 39) { // press '->'\n        location.href = nextImageUrl;\n      }\n    });\n  }\n\n  handleLoadFailure = () => {\n    this.setState({\n      loadFailed: true\n    });\n  };\n\n  render() {\n    if (this.state.loadFailed) {\n      return this.props.tip;\n    }\n\n    // request thumbnails for some files\n    // only for 'file view'. not for 'history/trash file view'\n    let thumbnailURL = '';\n    const fileExtList = ['tif', 'tiff', 'psd'];\n    if (!repoEncrypted && fileExtList.includes(fileExt)) {\n      thumbnailURL = `${siteRoot}thumbnail/${repoID}/${thumbnailSizeForOriginal}${Utils.encodePath(filePath)}`;\n    }\n\n    // for xmind file\n    const xmindSrc = xmindImageSrc ? `${siteRoot}${xmindImageSrc}` : '';\n\n    return (\n      <div className=\"file-view-content flex-1 image-file-view\">\n        {previousImage && (\n          <a href={previousImageUrl} id=\"img-prev\" title={gettext('you can also press ← ')}><span className=\"fas fa-chevron-left\"></span></a>\n        )}\n        {nextImage && (\n          <a href={nextImageUrl} id=\"img-next\" title={gettext('you can also press →')}><span className=\"fas fa-chevron-right\"></span></a>\n        )}\n        <img src={xmindSrc || thumbnailURL || rawPath} alt={fileName} id=\"image-view\" onError={this.handleLoadFailure} />\n      </div>\n    );\n  }\n}\n\nFileContent.propTypes = {\n  tip: PropTypes.string.isRequired,\n};\n\nexport default FileContent;\n"],"mappings":"wkBAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CAEzB,OAASC,KAAK,KAAQ,mBAAmB,CACzC,OAASC,OAAO,CAAEC,QAAQ,KAAQ,uBAAuB,CAEzD,MAAO,+BAA+B,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEvC,IAAAC,qBAAA,CAMIC,MAAM,CAACC,GAAG,CAACC,WAAW,CALxBC,MAAM,CAAAJ,qBAAA,CAANI,MAAM,CAAEC,aAAa,CAAAL,qBAAA,CAAbK,aAAa,CACrBC,OAAO,CAAAN,qBAAA,CAAPM,OAAO,CAAEC,QAAQ,CAAAP,qBAAA,CAARO,QAAQ,CAAEC,QAAQ,CAAAR,qBAAA,CAARQ,QAAQ,CAC3BC,wBAAwB,CAAAT,qBAAA,CAAxBS,wBAAwB,CACxBC,aAAa,CAAAV,qBAAA,CAAbU,aAAa,CAAEC,SAAS,CAAAX,qBAAA,CAATW,SAAS,CAAEC,OAAO,CAAAZ,qBAAA,CAAPY,OAAO,CACjCC,aAAa,CAAAb,qBAAA,CAAba,aAAa,CAGf,GAAI,CAAAC,gBAAgB,CAAEC,YAAY,CAClC,GAAIL,aAAa,CAAE,CACjBI,gBAAgB,IAAAE,MAAA,CAAMrB,QAAQ,SAAAqB,MAAA,CAAOZ,MAAM,UAAAY,MAAA,CAAQvB,KAAK,CAACwB,UAAU,CAACP,aAAa,CAAC,CAAE,CACtF,CACA,GAAIC,SAAS,CAAE,CACbI,YAAY,IAAAC,MAAA,CAAMrB,QAAQ,SAAAqB,MAAA,CAAOZ,MAAM,UAAAY,MAAA,CAAQvB,KAAK,CAACwB,UAAU,CAACN,SAAS,CAAC,CAAE,CAC9E,CAAC,GAEK,CAAAO,WAAW,uBAAAC,gBAAA,EAAAC,SAAA,CAAAF,WAAA,CAAAC,gBAAA,MAAAE,MAAA,CAAAC,YAAA,CAAAJ,WAAA,EAEf,SAAAA,YAAYK,KAAK,CAAE,KAAAC,KAAA,CAAAC,eAAA,MAAAP,WAAA,EACjBM,KAAA,CAAAH,MAAA,CAAAK,IAAA,MAAMH,KAAK,EAAEC,KAAA,CAiBfG,iBAAiB,CAAG,UAAM,CACxBH,KAAA,CAAKI,QAAQ,CAAC,CACZC,UAAU,CAAE,IACd,CAAC,CAAC,CACJ,CAAC,CApBCL,KAAA,CAAKM,KAAK,CAAG,CACXD,UAAU,CAAE,KACd,CAAC,CAAC,OAAAL,KAAA,CACJ,CAACO,YAAA,CAAAb,WAAA,GAAAc,GAAA,qBAAAC,KAAA,CAED,SAAAC,kBAAA,CAAoB,CAClBC,QAAQ,CAACC,gBAAgB,CAAC,SAAS,CAAE,SAACC,CAAC,CAAK,CAC1C,GAAI3B,aAAa,EAAI2B,CAAC,CAACC,OAAO,EAAI,EAAE,CAAE,CAAE;AACtCC,QAAQ,CAACC,IAAI,CAAG1B,gBAAgB,CAClC,CACA,GAAIH,SAAS,EAAI0B,CAAC,CAACC,OAAO,EAAI,EAAE,CAAE,CAAE;AAClCC,QAAQ,CAACC,IAAI,CAAGzB,YAAY,CAC9B,CACF,CAAC,CAAC,CACJ,CAAC,GAAAiB,GAAA,UAAAC,KAAA,CAQD,SAAAQ,OAAA,CAAS,CACP,GAAI,IAAI,CAACX,KAAK,CAACD,UAAU,CAAE,CACzB,MAAO,KAAI,CAACN,KAAK,CAACmB,GAAG,CACvB,CAEA;AACA;AACA,GAAI,CAAAC,YAAY,CAAG,EAAE,CACrB,GAAM,CAAAC,WAAW,CAAG,CAAC,KAAK,CAAE,MAAM,CAAE,KAAK,CAAC,CAC1C,GAAI,CAACvC,aAAa,EAAIuC,WAAW,CAACC,QAAQ,CAACvC,OAAO,CAAC,CAAE,CACnDqC,YAAY,IAAA3B,MAAA,CAAMrB,QAAQ,eAAAqB,MAAA,CAAaZ,MAAM,MAAAY,MAAA,CAAIP,wBAAwB,EAAAO,MAAA,CAAGvB,KAAK,CAACwB,UAAU,CAACV,QAAQ,CAAC,CAAE,CAC1G,CAEA;AACA,GAAM,CAAAuC,QAAQ,CAAGjC,aAAa,IAAAG,MAAA,CAAMrB,QAAQ,EAAAqB,MAAA,CAAGH,aAAa,EAAK,EAAE,CAEnE,mBACEd,KAAA,QAAKgD,SAAS,CAAC,0CAA0C,CAAAC,QAAA,EACtDtC,aAAa,eACZb,IAAA,MAAG2C,IAAI,CAAE1B,gBAAiB,CAACmC,EAAE,CAAC,UAAU,CAACC,KAAK,CAAExD,OAAO,CAAC,uBAAuB,CAAE,CAAAsD,QAAA,cAACnD,IAAA,SAAMkD,SAAS,CAAC,qBAAqB,CAAO,CAAC,CAAG,CACnI,CACApC,SAAS,eACRd,IAAA,MAAG2C,IAAI,CAAEzB,YAAa,CAACkC,EAAE,CAAC,UAAU,CAACC,KAAK,CAAExD,OAAO,CAAC,sBAAsB,CAAE,CAAAsD,QAAA,cAACnD,IAAA,SAAMkD,SAAS,CAAC,sBAAsB,CAAO,CAAC,CAAG,CAC/H,cACDlD,IAAA,QAAKsD,GAAG,CAAEL,QAAQ,EAAIH,YAAY,EAAI/B,OAAQ,CAACwC,GAAG,CAAE5C,QAAS,CAACyC,EAAE,CAAC,YAAY,CAACI,OAAO,CAAE,IAAI,CAAC1B,iBAAkB,CAAE,CAAC,EAC9G,CAAC,CAEV,CAAC,WAAAT,WAAA,GArDuB1B,KAAK,CAAC8D,SAAS,EA4DzC,cAAe,CAAApC,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}