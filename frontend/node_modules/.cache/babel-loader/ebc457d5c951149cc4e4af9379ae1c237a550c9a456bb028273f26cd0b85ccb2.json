{"ast":null,"code":"\"use strict\";\n\nvar _objectSpread = require(\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/objectSpread2.js\").default;\nvar _slicedToArray = require(\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/slicedToArray.js\").default;\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _slate = require(\"slate\");\nvar _menuItem = _interopRequireDefault(require(\"../../../commons/menu/menu-item\"));\nvar _menusConfig = require(\"../../../constants/menus-config\");\nvar _elementTypes = require(\"../../../constants/element-types\");\nvar _helper = require(\"../helper\");\nvar _eventBus = _interopRequireDefault(require(\"../../../../utils/event-bus\"));\nvar _linkModal = _interopRequireDefault(require(\"./link-modal\"));\nvar _eventTypes = require(\"../../../../constants/event-types\");\nvar menuConfig = _menusConfig.MENUS_CONFIG_MAP[_elementTypes.LINK];\nvar LinkMenu = function LinkMenu(_ref) {\n  var isRichEditor = _ref.isRichEditor,\n    className = _ref.className,\n    readonly = _ref.readonly,\n    editor = _ref.editor;\n  var _ref2 = (0, _react.useState)(false),\n    _ref3 = _slicedToArray(_ref2, 2),\n    isOpenLinkModal = _ref3[0],\n    setIsOpenLinkModal = _ref3[1];\n  var _ref4 = (0, _react.useState)({\n      linkTitle: '',\n      linkUrl: ''\n    }),\n    _ref5 = _slicedToArray(_ref4, 2),\n    linkInfo = _ref5[0],\n    setLinkInfo = _ref5[1];\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  var isLinkActive = (0, _react.useMemo)(function () {\n    return (0, _helper.isLinkType)(editor);\n  }, [editor.selection]);\n  (0, _react.useEffect)(function () {\n    var eventBus = _eventBus.default.getInstance();\n    var unsubscribe = eventBus.subscribe(_eventTypes.INTERNAL_EVENTS.ON_OPEN_LINK_MODAL, handleOpenLinkModal);\n    return function () {\n      return unsubscribe();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  (0, _react.useEffect)(function () {\n    if ((0, _helper.isLinkType)(editor)) {\n      var newTitle = editor.selection && _slate.Editor.string(editor, editor.selection);\n      newTitle && setLinkInfo(_objectSpread(_objectSpread({}, linkInfo), {}, {\n        linkTitle: newTitle\n      }));\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [editor.selection]);\n  var handleOpenLinkModal = (0, _react.useCallback)(function (linkInfo) {\n    Reflect.ownKeys.length && setLinkInfo(linkInfo);\n    setIsOpenLinkModal(true);\n  }, [setIsOpenLinkModal, setLinkInfo]);\n  var onMouseDown = (0, _react.useCallback)(function (event) {\n    event.preventDefault();\n    event.stopPropagation();\n    if (isLinkActive) {\n      isLinkActive && (0, _helper.unWrapLinkNode)(editor);\n      return;\n    }\n    if (editor.selection) {\n      var selectedText = _slate.Editor.string(editor, editor.selection);\n      setLinkInfo(_objectSpread(_objectSpread({}, linkInfo), {}, {\n        linkTitle: selectedText\n      }));\n    }\n    setIsOpenLinkModal(true);\n    document.getElementById(\"seafile_\".concat(_elementTypes.LINK)).blur();\n  }, [editor, isLinkActive, linkInfo]);\n  var onCloseModal = (0, _react.useCallback)(function () {\n    setIsOpenLinkModal(false);\n    setLinkInfo({\n      linkTitle: '',\n      linkUrl: ''\n    });\n  }, []);\n  return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_menuItem.default, Object.assign({\n    isRichEditor: isRichEditor,\n    className: className,\n    disabled: (0, _helper.isMenuDisabled)(editor, readonly),\n    isActive: isLinkActive,\n    onMouseDown: onMouseDown\n  }, menuConfig)), isOpenLinkModal && /*#__PURE__*/_react.default.createElement(_linkModal.default, {\n    onCloseModal: onCloseModal,\n    editor: editor,\n    linkTitle: linkInfo.linkTitle,\n    linkUrl: linkInfo.linkUrl\n  }));\n};\nvar _default = exports.default = LinkMenu;","map":{"version":3,"names":["_objectSpread","require","default","_slicedToArray","_interopRequireDefault","_interopRequireWildcard","Object","defineProperty","exports","value","_react","_slate","_menuItem","_menusConfig","_elementTypes","_helper","_eventBus","_linkModal","_eventTypes","menuConfig","MENUS_CONFIG_MAP","LINK","LinkMenu","_ref","isRichEditor","className","readonly","editor","_ref2","useState","_ref3","isOpenLinkModal","setIsOpenLinkModal","_ref4","linkTitle","linkUrl","_ref5","linkInfo","setLinkInfo","isLinkActive","useMemo","isLinkType","selection","useEffect","eventBus","getInstance","unsubscribe","subscribe","INTERNAL_EVENTS","ON_OPEN_LINK_MODAL","handleOpenLinkModal","newTitle","Editor","string","useCallback","Reflect","ownKeys","length","onMouseDown","event","preventDefault","stopPropagation","unWrapLinkNode","selectedText","document","getElementById","concat","blur","onCloseModal","createElement","Fragment","assign","disabled","isMenuDisabled","isActive","_default"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/seafile-editor/dist/extension/plugins/link/menu/index.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _slate = require(\"slate\");\nvar _menuItem = _interopRequireDefault(require(\"../../../commons/menu/menu-item\"));\nvar _menusConfig = require(\"../../../constants/menus-config\");\nvar _elementTypes = require(\"../../../constants/element-types\");\nvar _helper = require(\"../helper\");\nvar _eventBus = _interopRequireDefault(require(\"../../../../utils/event-bus\"));\nvar _linkModal = _interopRequireDefault(require(\"./link-modal\"));\nvar _eventTypes = require(\"../../../../constants/event-types\");\nconst menuConfig = _menusConfig.MENUS_CONFIG_MAP[_elementTypes.LINK];\nconst LinkMenu = _ref => {\n  let {\n    isRichEditor,\n    className,\n    readonly,\n    editor\n  } = _ref;\n  const [isOpenLinkModal, setIsOpenLinkModal] = (0, _react.useState)(false);\n  const [linkInfo, setLinkInfo] = (0, _react.useState)({\n    linkTitle: '',\n    linkUrl: ''\n  });\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const isLinkActive = (0, _react.useMemo)(() => (0, _helper.isLinkType)(editor), [editor.selection]);\n  (0, _react.useEffect)(() => {\n    const eventBus = _eventBus.default.getInstance();\n    const unsubscribe = eventBus.subscribe(_eventTypes.INTERNAL_EVENTS.ON_OPEN_LINK_MODAL, handleOpenLinkModal);\n    return () => unsubscribe();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  (0, _react.useEffect)(() => {\n    if ((0, _helper.isLinkType)(editor)) {\n      const newTitle = editor.selection && _slate.Editor.string(editor, editor.selection);\n      newTitle && setLinkInfo({\n        ...linkInfo,\n        linkTitle: newTitle\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [editor.selection]);\n  const handleOpenLinkModal = (0, _react.useCallback)(linkInfo => {\n    Reflect.ownKeys.length && setLinkInfo(linkInfo);\n    setIsOpenLinkModal(true);\n  }, [setIsOpenLinkModal, setLinkInfo]);\n  const onMouseDown = (0, _react.useCallback)(event => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (isLinkActive) {\n      isLinkActive && (0, _helper.unWrapLinkNode)(editor);\n      return;\n    }\n    if (editor.selection) {\n      const selectedText = _slate.Editor.string(editor, editor.selection);\n      setLinkInfo({\n        ...linkInfo,\n        linkTitle: selectedText\n      });\n    }\n    setIsOpenLinkModal(true);\n    document.getElementById(\"seafile_\".concat(_elementTypes.LINK)).blur();\n  }, [editor, isLinkActive, linkInfo]);\n  const onCloseModal = (0, _react.useCallback)(() => {\n    setIsOpenLinkModal(false);\n    setLinkInfo({\n      linkTitle: '',\n      linkUrl: ''\n    });\n  }, []);\n  return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_menuItem.default, Object.assign({\n    isRichEditor: isRichEditor,\n    className: className,\n    disabled: (0, _helper.isMenuDisabled)(editor, readonly),\n    isActive: isLinkActive,\n    onMouseDown: onMouseDown\n  }, menuConfig)), isOpenLinkModal && /*#__PURE__*/_react.default.createElement(_linkModal.default, {\n    onCloseModal: onCloseModal,\n    editor: editor,\n    linkTitle: linkInfo.linkTitle,\n    linkUrl: linkInfo.linkUrl\n  }));\n};\nvar _default = exports.default = LinkMenu;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}