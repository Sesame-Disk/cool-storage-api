{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{gettext}from'../../utils/constants';import{Utils}from'../../utils/utils';import{Button,Modal,ModalHeader,Input,ModalBody,ModalFooter,Alert}from'reactstrap';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Rename=/*#__PURE__*/function(_React$Component){_inherits(Rename,_React$Component);var _super=_createSuper(Rename);function Rename(props){var _this;_classCallCheck(this,Rename);_this=_super.call(this,props);_this.handleChange=function(e){if(!e.target.value.trim()){_this.setState({isSubmitBtnActive:false});}else{_this.setState({isSubmitBtnActive:true});}_this.setState({newName:e.target.value});};_this.handleSubmit=function(){var _this$validateInput=_this.validateInput(),isValid=_this$validateInput.isValid,errMessage=_this$validateInput.errMessage;if(!isValid){_this.setState({errMessage:errMessage});}else{var isDuplicated=_this.checkDuplicatedName();if(isDuplicated){var _errMessage=gettext('The name \"{name}\" is already taken. Please choose a different name.');_errMessage=_errMessage.replace('{name}',Utils.HTMLescape(_this.state.newName));_this.setState({errMessage:_errMessage});}else{_this.props.onRename(_this.state.newName);_this.props.toggleCancel();}}};_this.handleKeyDown=function(e){if(e.key==='Enter'){_this.handleSubmit();}};_this.toggle=function(){_this.props.toggleCancel();};_this.changeState=function(dirent){var name=dirent.name;_this.setState({newName:name});};_this.validateInput=function(){var newName=_this.state.newName.trim();var isValid=true;var errMessage='';if(!newName){isValid=false;errMessage=gettext('Name is required.');return{isValid:isValid,errMessage:errMessage};}if(newName.indexOf('/')>-1){isValid=false;errMessage=gettext('Name should not include '+'\\'/\\''+'.');return{isValid:isValid,errMessage:errMessage};}return{isValid:isValid,errMessage:errMessage};};_this.checkDuplicatedName=function(){var isDuplicated=_this.props.checkDuplicatedName(_this.state.newName);return isDuplicated;};_this.onAfterModelOpened=function(){if(!_this.newInput.current)return;_this.newInput.current.focus();var dirent=_this.props.dirent;var type=dirent.type;if(type==='file'){var endIndex=dirent.name.lastIndexOf('.md');_this.newInput.current.setSelectionRange(0,endIndex,'forward');}else{_this.newInput.current.setSelectionRange(0,-1);}};_this.state={newName:'',errMessage:'',isSubmitBtnActive:false};_this.newInput=/*#__PURE__*/React.createRef();return _this;}_createClass(Rename,[{key:\"UNSAFE_componentWillMount\",value:function UNSAFE_componentWillMount(){this.setState({newName:this.props.dirent.name});}},{key:\"componentDidMount\",value:function componentDidMount(){var dirent=this.props.dirent;this.changeState(dirent);}},{key:\"UNSAFE_componentWillReceiveProps\",value:function UNSAFE_componentWillReceiveProps(nextProps){this.changeState(nextProps.dirent);}},{key:\"render\",value:function render(){var type=this.props.dirent.type;return/*#__PURE__*/_jsxs(Modal,{isOpen:true,toggle:this.toggle,onOpened:this.onAfterModelOpened,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:this.toggle,children:type==='file'?gettext('Rename File'):gettext('Rename Folder')}),/*#__PURE__*/_jsxs(ModalBody,{children:[/*#__PURE__*/_jsx(\"p\",{children:type==='file'?gettext('New file name'):gettext('New folder name')}),/*#__PURE__*/_jsx(Input,{onKeyDown:this.handleKeyDown,innerRef:this.newInput,value:this.state.newName,onChange:this.handleChange}),this.state.errMessage&&/*#__PURE__*/_jsx(Alert,{color:\"danger\",className:\"mt-2\",children:this.state.errMessage})]}),/*#__PURE__*/_jsxs(ModalFooter,{children:[/*#__PURE__*/_jsx(Button,{color:\"secondary\",onClick:this.toggle,children:gettext('Cancel')}),/*#__PURE__*/_jsx(Button,{color:\"primary\",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:gettext('Submit')})]})]});}}]);return Rename;}(React.Component);export default Rename;","map":{"version":3,"names":["React","gettext","Utils","Button","Modal","ModalHeader","Input","ModalBody","ModalFooter","Alert","jsx","_jsx","jsxs","_jsxs","Rename","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","handleChange","e","target","value","trim","setState","isSubmitBtnActive","newName","handleSubmit","_this$validateInput","validateInput","isValid","errMessage","isDuplicated","checkDuplicatedName","replace","HTMLescape","state","onRename","toggleCancel","handleKeyDown","key","toggle","changeState","dirent","name","indexOf","onAfterModelOpened","newInput","current","focus","type","endIndex","lastIndexOf","setSelectionRange","createRef","_createClass","UNSAFE_componentWillMount","componentDidMount","UNSAFE_componentWillReceiveProps","nextProps","render","isOpen","onOpened","children","onKeyDown","innerRef","onChange","color","className","onClick","disabled","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/rename-dirent.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Alert } from 'reactstrap';\n\nconst propTypes = {\n  onRename: PropTypes.func.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  checkDuplicatedName: PropTypes.func.isRequired,\n  dirent: PropTypes.object,\n};\n\nclass Rename extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      newName: '',\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  UNSAFE_componentWillMount() {\n    this.setState({newName: this.props.dirent.name});\n  }\n\n  componentDidMount() {\n    let { dirent } = this.props;\n    this.changeState(dirent);\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    this.changeState(nextProps.dirent);\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({newName: e.target.value});\n  };\n\n  handleSubmit = () => {\n    let { isValid, errMessage } = this.validateInput();\n    if (!isValid) {\n      this.setState({errMessage : errMessage});\n    } else {\n      let isDuplicated = this.checkDuplicatedName();\n      if (isDuplicated) {\n        let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n        errMessage = errMessage.replace('{name}', Utils.HTMLescape(this.state.newName));\n        this.setState({errMessage: errMessage});\n      } else {\n        this.props.onRename(this.state.newName);\n        this.props.toggleCancel();\n      }\n    }\n  };\n\n  handleKeyDown = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n    }\n  };\n\n  toggle = () => {\n    this.props.toggleCancel();\n  };\n\n  changeState = (dirent) => {\n    let name = dirent.name;\n    this.setState({newName: name});\n  };\n\n  validateInput = () => {\n    let newName = this.state.newName.trim();\n    let isValid = true;\n    let errMessage = '';\n    if (!newName) {\n      isValid = false;\n      errMessage = gettext('Name is required.');\n      return { isValid, errMessage };\n    }\n\n    if (newName.indexOf('/') > -1) {\n      isValid = false;\n      errMessage = gettext('Name should not include ' + '\\'/\\'' + '.');\n      return { isValid, errMessage };\n    }\n\n    return { isValid, errMessage };\n  };\n\n  checkDuplicatedName = () => {\n    let isDuplicated = this.props.checkDuplicatedName(this.state.newName);\n    return isDuplicated;\n  };\n\n  onAfterModelOpened = () => {\n    if (!this.newInput.current) return;\n    this.newInput.current.focus();\n\n    let { dirent } = this.props;\n    let type = dirent.type;\n    if (type === 'file') {\n      var endIndex = dirent.name.lastIndexOf('.md');\n      this.newInput.current.setSelectionRange(0, endIndex, 'forward');\n    } else {\n      this.newInput.current.setSelectionRange(0, -1);\n    }\n  };\n\n  render() {\n    let type = this.props.dirent.type;\n    return (\n      <Modal isOpen={true} toggle={this.toggle} onOpened={this.onAfterModelOpened}>\n        <ModalHeader toggle={this.toggle}>{type === 'file' ? gettext('Rename File') : gettext('Rename Folder') }</ModalHeader>\n        <ModalBody>\n          <p>{type === 'file' ? gettext('New file name'): gettext('New folder name')}</p>\n          <Input onKeyDown={this.handleKeyDown} innerRef={this.newInput} value={this.state.newName} onChange={this.handleChange} />\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nRename.propTypes = propTypes;\n\nexport default Rename;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}