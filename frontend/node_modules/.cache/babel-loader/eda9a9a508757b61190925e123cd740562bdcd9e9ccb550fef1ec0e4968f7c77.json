{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/slicedToArray.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _slate = require(\"slate\");\nvar _core = require(\"../../core\");\nvar _elementTypes = require(\"../../constants/element-types\");\nvar _helper = require(\"../paragraph/helper\");\nvar _constants = require(\"../../constants\");\nvar withCheckList = function withCheckList(editor) {\n  var insertBreak = editor.insertBreak,\n    deleteBackward = editor.deleteBackward,\n    insertFragment = editor.insertFragment;\n  var newEditor = editor;\n  newEditor.insertBreak = function () {\n    if (!newEditor.selection) {\n      insertBreak();\n      return;\n    }\n    var checkListNode = (0, _core.getSelectedNodeByType)(newEditor, _elementTypes.CHECK_LIST_ITEM);\n    if (!checkListNode) {\n      insertBreak();\n      return;\n    }\n    var nodeText = _slate.Node.string(checkListNode);\n    if (nodeText.length === 0) {\n      (0, _helper.transformToParagraph)(newEditor);\n    } else {\n      _slate.Transforms.splitNodes(newEditor, {\n        always: true\n      });\n    }\n  };\n  newEditor.deleteBackward = function (unit) {\n    var selection = newEditor.selection;\n    if (selection && _slate.Range.isCollapsed(selection)) {\n      var selectedCheckListNode = (0, _core.getSelectedNodeByType)(newEditor, _elementTypes.CHECK_LIST_ITEM);\n      if (selectedCheckListNode && (0, _core.isSelectionAtBlockStart)(editor)) {\n        (0, _helper.transformToParagraph)(newEditor);\n        return;\n      }\n    }\n    deleteBackward(unit);\n  };\n  newEditor.insertFragment = function (fragment) {\n    var match = {\n      type: [_elementTypes.CHECK_LIST_ITEM]\n    };\n    var _ref = (0, _core.getNodeEntries)(newEditor, {\n        match: match\n      }),\n      _ref2 = _slicedToArray(_ref, 1),\n      checkListEntry = _ref2[0];\n    if (!checkListEntry) return insertFragment(fragment);\n    var firstChild = fragment[0];\n    if (fragment.length === 1 && _constants.LIST_TYPE_ARRAY.includes(firstChild.type)) {\n      // insert text\n      if (firstChild.children.length === 1) {\n        var text = _slate.Node.string(fragment[0]);\n        (0, _slate.insertText)(text);\n        return;\n      }\n\n      // insert list at current path\n      if ((0, _core.isSelectionAtBlockStart)(editor)) {\n        _slate.Transforms.insertNodes(newEditor, fragment);\n        return;\n      }\n\n      // insert list at next path\n      var nextPath = _slate.Path.next(checkListEntry[1]);\n      _slate.Transforms.insertNodes(newEditor, fragment, {\n        at: nextPath\n      });\n      return;\n    }\n    if (fragment.length === 1 && firstChild.type === _elementTypes.TABLE) {\n      var _nextPath = _slate.Path.next(checkListEntry[1]);\n      _slate.Transforms.insertNodes(newEditor, fragment, {\n        at: _nextPath\n      });\n      return;\n    }\n    return insertFragment(fragment);\n  };\n  return newEditor;\n};\nvar _default = exports.default = withCheckList;","map":{"version":3,"names":["_slicedToArray","require","default","Object","defineProperty","exports","value","_slate","_core","_elementTypes","_helper","_constants","withCheckList","editor","insertBreak","deleteBackward","insertFragment","newEditor","selection","checkListNode","getSelectedNodeByType","CHECK_LIST_ITEM","nodeText","Node","string","length","transformToParagraph","Transforms","splitNodes","always","unit","Range","isCollapsed","selectedCheckListNode","isSelectionAtBlockStart","fragment","match","type","_ref","getNodeEntries","_ref2","checkListEntry","firstChild","LIST_TYPE_ARRAY","includes","children","text","insertText","insertNodes","nextPath","Path","next","at","TABLE","_default"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/seafile-editor/dist/extension/plugins/check-list/plugin.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _slate = require(\"slate\");\nvar _core = require(\"../../core\");\nvar _elementTypes = require(\"../../constants/element-types\");\nvar _helper = require(\"../paragraph/helper\");\nvar _constants = require(\"../../constants\");\nconst withCheckList = editor => {\n  const {\n    insertBreak,\n    deleteBackward,\n    insertFragment\n  } = editor;\n  const newEditor = editor;\n  newEditor.insertBreak = () => {\n    if (!newEditor.selection) {\n      insertBreak();\n      return;\n    }\n    const checkListNode = (0, _core.getSelectedNodeByType)(newEditor, _elementTypes.CHECK_LIST_ITEM);\n    if (!checkListNode) {\n      insertBreak();\n      return;\n    }\n    const nodeText = _slate.Node.string(checkListNode);\n    if (nodeText.length === 0) {\n      (0, _helper.transformToParagraph)(newEditor);\n    } else {\n      _slate.Transforms.splitNodes(newEditor, {\n        always: true\n      });\n    }\n  };\n  newEditor.deleteBackward = unit => {\n    const {\n      selection\n    } = newEditor;\n    if (selection && _slate.Range.isCollapsed(selection)) {\n      const selectedCheckListNode = (0, _core.getSelectedNodeByType)(newEditor, _elementTypes.CHECK_LIST_ITEM);\n      if (selectedCheckListNode && (0, _core.isSelectionAtBlockStart)(editor)) {\n        (0, _helper.transformToParagraph)(newEditor);\n        return;\n      }\n    }\n    deleteBackward(unit);\n  };\n  newEditor.insertFragment = fragment => {\n    const match = {\n      type: [_elementTypes.CHECK_LIST_ITEM]\n    };\n    const [checkListEntry] = (0, _core.getNodeEntries)(newEditor, {\n      match\n    });\n    if (!checkListEntry) return insertFragment(fragment);\n    const firstChild = fragment[0];\n    if (fragment.length === 1 && _constants.LIST_TYPE_ARRAY.includes(firstChild.type)) {\n      // insert text\n      if (firstChild.children.length === 1) {\n        const text = _slate.Node.string(fragment[0]);\n        (0, _slate.insertText)(text);\n        return;\n      }\n\n      // insert list at current path\n      if ((0, _core.isSelectionAtBlockStart)(editor)) {\n        _slate.Transforms.insertNodes(newEditor, fragment);\n        return;\n      }\n\n      // insert list at next path\n      const nextPath = _slate.Path.next(checkListEntry[1]);\n      _slate.Transforms.insertNodes(newEditor, fragment, {\n        at: nextPath\n      });\n      return;\n    }\n    if (fragment.length === 1 && firstChild.type === _elementTypes.TABLE) {\n      const nextPath = _slate.Path.next(checkListEntry[1]);\n      _slate.Transforms.insertNodes(newEditor, fragment, {\n        at: nextPath\n      });\n      return;\n    }\n    return insertFragment(fragment);\n  };\n  return newEditor;\n};\nvar _default = exports.default = withCheckList;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}