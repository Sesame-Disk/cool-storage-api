{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{Button,Modal,ModalHeader,Input,ModalBody,ModalFooter,Form,FormGroup,Label,Alert}from'reactstrap';import{gettext}from'../../utils/constants';import{Utils,validateName}from'../../utils/utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CreateFile=/*#__PURE__*/function(_React$Component){_inherits(CreateFile,_React$Component);var _super=_createSuper(CreateFile);function CreateFile(props){var _this;_classCallCheck(this,CreateFile);_this=_super.call(this,props);_this.isSdocSuffix=function(name){return name.endsWith('.sdoc');};_this.handleChange=function(e){if(!e.target.value.trim()){_this.setState({isSubmitBtnActive:false});}else{_this.setState({isSubmitBtnActive:true});}_this.setState({childName:e.target.value});};_this.handleSubmit=function(){if(!_this.state.isSubmitBtnActive){return;}var isDuplicated=_this.checkDuplicatedName();var newName=_this.state.childName.trim();var _validateName=validateName(newName),isValid=_validateName.isValid,errMessage=_validateName.errMessage;if(!isValid){_this.setState({errMessage:errMessage});return;}if(isDuplicated){var _errMessage=gettext('The name \"{name}\" is already taken. Please choose a different name.');_errMessage=_errMessage.replace('{name}',Utils.HTMLescape(newName));_this.setState({errMessage:_errMessage});}else{var path=_this.state.parentPath+newName;_this.props.onAddFile(path);_this.props.toggleDialog();}};_this.handleKeyDown=function(e){if(e.key==='Enter'){_this.handleSubmit();e.preventDefault();}};_this.checkDuplicatedName=function(){var isDuplicated=_this.props.checkDuplicatedName(_this.state.childName);return isDuplicated;};_this.onAfterModelOpened=function(){if(!_this.newInput.current)return;_this.newInput.current.focus();_this.newInput.current.setSelectionRange(0,0);};var _props$fileType=props.fileType,fileType=_props$fileType===void 0?'':_props$fileType;_this.state={parentPath:'',childName:fileType,errMessage:'',isSubmitBtnActive:_this.isSdocSuffix(fileType)?true:false};_this.newInput=/*#__PURE__*/React.createRef();return _this;}_createClass(CreateFile,[{key:\"componentDidMount\",value:function componentDidMount(){var parentPath=this.props.parentPath;if(parentPath[parentPath.length-1]==='/'){// mainPanel\nthis.setState({parentPath:parentPath});}else{this.setState({parentPath:parentPath+'/'});// sidePanel\n}}},{key:\"render\",value:function render(){var toggleDialog=this.props.toggleDialog;return/*#__PURE__*/_jsxs(Modal,{isOpen:true,toggle:toggleDialog,onOpened:this.onAfterModelOpened,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:toggleDialog,children:gettext('New File')}),/*#__PURE__*/_jsxs(ModalBody,{children:[/*#__PURE__*/_jsx(Form,{children:/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(Label,{for:\"fileName\",children:gettext('Name')}),/*#__PURE__*/_jsx(Input,{id:\"fileName\",onKeyDown:this.handleKeyDown,innerRef:this.newInput,value:this.state.childName,onChange:this.handleChange})]})}),this.state.errMessage&&/*#__PURE__*/_jsx(Alert,{color:\"danger\",className:\"mt-2\",children:this.state.errMessage})]}),/*#__PURE__*/_jsxs(ModalFooter,{children:[/*#__PURE__*/_jsx(Button,{color:\"secondary\",onClick:toggleDialog,children:gettext('Cancel')}),/*#__PURE__*/_jsx(Button,{color:\"primary\",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:gettext('Submit')})]})]});}}]);return CreateFile;}(React.Component);export default CreateFile;","map":{"version":3,"names":["React","Button","Modal","ModalHeader","Input","ModalBody","ModalFooter","Form","FormGroup","Label","Alert","gettext","Utils","validateName","jsx","_jsx","jsxs","_jsxs","CreateFile","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","isSdocSuffix","name","endsWith","handleChange","e","target","value","trim","setState","isSubmitBtnActive","childName","handleSubmit","state","isDuplicated","checkDuplicatedName","newName","_validateName","isValid","errMessage","replace","HTMLescape","path","parentPath","onAddFile","toggleDialog","handleKeyDown","key","preventDefault","onAfterModelOpened","newInput","current","focus","setSelectionRange","_props$fileType","fileType","createRef","_createClass","componentDidMount","length","render","isOpen","toggle","onOpened","children","for","id","onKeyDown","innerRef","onChange","color","className","onClick","disabled","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/create-file-dialog.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Form, FormGroup, Label, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils, validateName } from '../../utils/utils';\n\nconst propTypes = {\n  fileType: PropTypes.string,\n  parentPath: PropTypes.string.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  checkDuplicatedName: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n};\n\nclass CreateFile extends React.Component {\n  constructor(props) {\n    super(props);\n    const { fileType = '' } = props;\n    this.state = {\n      parentPath: '',\n      childName: fileType,\n      errMessage: '',\n      isSubmitBtnActive: this.isSdocSuffix(fileType) ? true : false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentDidMount() {\n    let parentPath = this.props.parentPath;\n    if (parentPath[parentPath.length - 1] === '/') {  // mainPanel\n      this.setState({parentPath: parentPath});\n    } else {\n      this.setState({parentPath: parentPath + '/'}); // sidePanel\n    }\n  }\n\n  isSdocSuffix = (name) => {\n    return name.endsWith('.sdoc');\n  };\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({\n      childName: e.target.value,\n    }) ;\n  };\n\n  handleSubmit = () => {\n    if (!this.state.isSubmitBtnActive) {\n      return;\n    }\n    let isDuplicated = this.checkDuplicatedName();\n    let newName = this.state.childName.trim();\n    let { isValid, errMessage } = validateName(newName);\n    if (!isValid) {\n      this.setState({ errMessage });\n      return;\n    }\n\n    if (isDuplicated) {\n      let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n      errMessage = errMessage.replace('{name}', Utils.HTMLescape(newName));\n      this.setState({errMessage: errMessage});\n    } else {\n      let path = this.state.parentPath + newName;\n      this.props.onAddFile(path);\n      this.props.toggleDialog();\n    }\n  };\n\n  handleKeyDown = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n      e.preventDefault();\n    }\n  };\n\n  checkDuplicatedName = () => {\n    let isDuplicated = this.props.checkDuplicatedName(this.state.childName);\n    return isDuplicated;\n  };\n\n  onAfterModelOpened = () => {\n    if (!this.newInput.current) return;\n    this.newInput.current.focus();\n    this.newInput.current.setSelectionRange(0,0);\n  };\n\n  render() {\n    const { toggleDialog } = this.props;\n    return (\n      <Modal isOpen={true} toggle={toggleDialog} onOpened={this.onAfterModelOpened}>\n        <ModalHeader toggle={toggleDialog}>{gettext('New File')}</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <Label for=\"fileName\">{gettext('Name')}</Label>\n              <Input\n                id=\"fileName\"\n                onKeyDown={this.handleKeyDown}\n                innerRef={this.newInput}\n                value={this.state.childName}\n                onChange={this.handleChange}\n              />\n            </FormGroup>\n          </Form>\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={toggleDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCreateFile.propTypes = propTypes;\n\nexport default CreateFile;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}