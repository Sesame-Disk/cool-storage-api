{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/slicedToArray.js\").default;\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _isHotkey = _interopRequireDefault(require(\"is-hotkey\"));\nvar _clickOutside = _interopRequireDefault(require(\"./click-outside\"));\nvar _fallbackEditor = _interopRequireDefault(require(\"./fallback-editor\"));\nvar _normalEditor = _interopRequireDefault(require(\"./normal-editor\"));\nvar _getBrowserInfo = _interopRequireDefault(require(\"../../utils/get-browser-Info\"));\nvar _constants = require(\"../../constants\");\nrequire(\"./index.css\");\nvar LongTextInlineEditor = /*#__PURE__*/(0, _react.forwardRef)(function (_ref, ref) {\n  var autoSave = _ref.autoSave,\n    isCheckBrowser = _ref.isCheckBrowser,\n    saveDelay = _ref.saveDelay,\n    value = _ref.value,\n    lang = _ref.lang,\n    headerName = _ref.headerName,\n    onClick = _ref.onClick,\n    onSaveEditorValue = _ref.onSaveEditorValue,\n    editorApi = _ref.editorApi;\n  var _ref2 = (0, _react.useState)(false),\n    _ref3 = _slicedToArray(_ref2, 2),\n    enableEdit = _ref3[0],\n    setEnableEdit = _ref3[1];\n  var valueRef = (0, _react.useRef)(typeof value === 'string' ? {\n    text: value\n  } : value);\n  var longTextValueChangedRef = (0, _react.useRef)(false);\n  var _ref4 = (0, _react.useMemo)(function () {\n      return (0, _getBrowserInfo.default)(isCheckBrowser);\n    }, [isCheckBrowser]),\n    isWindowsWechat = _ref4.isWindowsWechat;\n  var openEditor = (0, _react.useCallback)(function () {\n    setEnableEdit(true);\n  }, []);\n  var closeEditor = (0, _react.useCallback)(function () {\n    if (longTextValueChangedRef.current) {\n      onSaveEditorValue(valueRef.current);\n    }\n    setEnableEdit(false);\n  }, [longTextValueChangedRef, valueRef, onSaveEditorValue]);\n  var onEditorValueChanged = (0, _react.useCallback)(function (value) {\n    valueRef.current = value;\n    longTextValueChangedRef.current = true;\n  }, []);\n  var onHotKey = (0, _react.useCallback)(function (event) {\n    if (!enableEdit) return;\n    var keyCode = event.keyCode;\n    var isModP = (0, _isHotkey.default)('mod+p', event);\n    if (keyCode === _constants.KeyCodes.Esc || isModP) {\n      event.preventDefault();\n      !isModP && event.stopPropagation();\n      closeEditor();\n      return;\n    }\n  }, [enableEdit, closeEditor]);\n  (0, _react.useImperativeHandle)(ref, function () {\n    return {\n      openEditor: openEditor,\n      closeEditor: closeEditor\n    };\n  }, [openEditor, closeEditor]);\n  var handelEnableEdit = (0, _react.useCallback)(function () {\n    onClick && onClick();\n    openEditor();\n  }, [openEditor, onClick]);\n  return /*#__PURE__*/_react.default.createElement(_clickOutside.default, {\n    onClickOutside: closeEditor\n  }, /*#__PURE__*/_react.default.createElement(\"div\", {\n    className: \"w-100\",\n    onKeyDown: onHotKey\n  }, isWindowsWechat ? /*#__PURE__*/_react.default.createElement(_fallbackEditor.default, {\n    enableEdit: enableEdit,\n    value: valueRef.current.text,\n    onChange: onEditorValueChanged,\n    closeEditor: closeEditor\n  }) : /*#__PURE__*/_react.default.createElement(_normalEditor.default, {\n    enableEdit: enableEdit,\n    handelEnableEdit: handelEnableEdit,\n    lang: lang,\n    headerName: headerName,\n    value: valueRef.current.text,\n    autoSave: autoSave,\n    saveDelay: saveDelay,\n    isCheckBrowser: isCheckBrowser,\n    editorApi: editorApi,\n    onSaveEditorValue: onSaveEditorValue,\n    onEditorValueChanged: onEditorValueChanged\n  })));\n});\nvar _default = exports.default = LongTextInlineEditor;","map":{"version":3,"names":["_slicedToArray","require","default","_interopRequireDefault","_interopRequireWildcard","Object","defineProperty","exports","value","_react","_isHotkey","_clickOutside","_fallbackEditor","_normalEditor","_getBrowserInfo","_constants","LongTextInlineEditor","forwardRef","_ref","ref","autoSave","isCheckBrowser","saveDelay","lang","headerName","onClick","onSaveEditorValue","editorApi","_ref2","useState","_ref3","enableEdit","setEnableEdit","valueRef","useRef","text","longTextValueChangedRef","_ref4","useMemo","isWindowsWechat","openEditor","useCallback","closeEditor","current","onEditorValueChanged","onHotKey","event","keyCode","isModP","KeyCodes","Esc","preventDefault","stopPropagation","useImperativeHandle","handelEnableEdit","createElement","onClickOutside","className","onKeyDown","onChange","_default"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/seafile-editor/dist/pages/longtext-inline-editor/index.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _isHotkey = _interopRequireDefault(require(\"is-hotkey\"));\nvar _clickOutside = _interopRequireDefault(require(\"./click-outside\"));\nvar _fallbackEditor = _interopRequireDefault(require(\"./fallback-editor\"));\nvar _normalEditor = _interopRequireDefault(require(\"./normal-editor\"));\nvar _getBrowserInfo = _interopRequireDefault(require(\"../../utils/get-browser-Info\"));\nvar _constants = require(\"../../constants\");\nrequire(\"./index.css\");\nconst LongTextInlineEditor = /*#__PURE__*/(0, _react.forwardRef)((_ref, ref) => {\n  let {\n    autoSave,\n    isCheckBrowser,\n    saveDelay,\n    value,\n    lang,\n    headerName,\n    onClick,\n    onSaveEditorValue,\n    editorApi\n  } = _ref;\n  const [enableEdit, setEnableEdit] = (0, _react.useState)(false);\n  const valueRef = (0, _react.useRef)(typeof value === 'string' ? {\n    text: value\n  } : value);\n  const longTextValueChangedRef = (0, _react.useRef)(false);\n  const {\n    isWindowsWechat\n  } = (0, _react.useMemo)(() => {\n    return (0, _getBrowserInfo.default)(isCheckBrowser);\n  }, [isCheckBrowser]);\n  const openEditor = (0, _react.useCallback)(() => {\n    setEnableEdit(true);\n  }, []);\n  const closeEditor = (0, _react.useCallback)(() => {\n    if (longTextValueChangedRef.current) {\n      onSaveEditorValue(valueRef.current);\n    }\n    setEnableEdit(false);\n  }, [longTextValueChangedRef, valueRef, onSaveEditorValue]);\n  const onEditorValueChanged = (0, _react.useCallback)(value => {\n    valueRef.current = value;\n    longTextValueChangedRef.current = true;\n  }, []);\n  const onHotKey = (0, _react.useCallback)(event => {\n    if (!enableEdit) return;\n    const keyCode = event.keyCode;\n    const isModP = (0, _isHotkey.default)('mod+p', event);\n    if (keyCode === _constants.KeyCodes.Esc || isModP) {\n      event.preventDefault();\n      !isModP && event.stopPropagation();\n      closeEditor();\n      return;\n    }\n  }, [enableEdit, closeEditor]);\n  (0, _react.useImperativeHandle)(ref, () => {\n    return {\n      openEditor: openEditor,\n      closeEditor: closeEditor\n    };\n  }, [openEditor, closeEditor]);\n  const handelEnableEdit = (0, _react.useCallback)(() => {\n    onClick && onClick();\n    openEditor();\n  }, [openEditor, onClick]);\n  return /*#__PURE__*/_react.default.createElement(_clickOutside.default, {\n    onClickOutside: closeEditor\n  }, /*#__PURE__*/_react.default.createElement(\"div\", {\n    className: \"w-100\",\n    onKeyDown: onHotKey\n  }, isWindowsWechat ? /*#__PURE__*/_react.default.createElement(_fallbackEditor.default, {\n    enableEdit: enableEdit,\n    value: valueRef.current.text,\n    onChange: onEditorValueChanged,\n    closeEditor: closeEditor\n  }) : /*#__PURE__*/_react.default.createElement(_normalEditor.default, {\n    enableEdit: enableEdit,\n    handelEnableEdit: handelEnableEdit,\n    lang: lang,\n    headerName: headerName,\n    value: valueRef.current.text,\n    autoSave: autoSave,\n    saveDelay: saveDelay,\n    isCheckBrowser: isCheckBrowser,\n    editorApi: editorApi,\n    onSaveEditorValue: onSaveEditorValue,\n    onEditorValueChanged: onEditorValueChanged\n  })));\n});\nvar _default = exports.default = LongTextInlineEditor;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}