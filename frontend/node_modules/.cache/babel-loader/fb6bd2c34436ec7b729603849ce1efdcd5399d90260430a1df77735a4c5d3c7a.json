{"ast":null,"code":"import _classCallCheck from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{gettext}from'../../utils/constants';import{Button,Modal,ModalHeader,ModalBody,ModalFooter}from'reactstrap';import{seafileAPI}from'../../utils/seafile-api';import moment from'moment';import Repo from'../../models/repo';import{Utils}from'../../utils/utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var WikiSelectDialog=/*#__PURE__*/function(_React$Component){_inherits(WikiSelectDialog,_React$Component);var _super=_createSuper(WikiSelectDialog);function WikiSelectDialog(props){var _this;_classCallCheck(this,WikiSelectDialog);_this=_super.call(this,props);_this.onChange=function(repo){_this.setState({repoID:repo.repo_id});};_this.handleSubmit=function(){var repoID=_this.state.repoID;_this.props.addWiki(repoID);_this.props.toggleCancel();};_this.toggle=function(){_this.props.toggleCancel();};_this.state={repos:[],repoID:''};return _this;}_createClass(WikiSelectDialog,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;seafileAPI.listRepos().then(function(res){var repoList=res.data.repos.filter(function(item){switch(item.type){case'mine':// my libraries\nreturn!item.encrypted;case'shared':// libraries shared with me\n// 'is_admin': the library is shared with 'admin' permission\nreturn!item.encrypted&&item.is_admin;case'group':default:return!item.encrypted&&!res.data.repos.some(function(repo){// just remove the duplicated libraries\nreturn repo.type!=item.type&&repo.repo_id==item.repo_id;});}}).map(function(item){var repo=new Repo(item);return repo;});repoList=Utils.sortRepos(repoList,'name','asc');_this2.setState({repos:repoList});});}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsxs(Modal,{isOpen:true,toggle:this.toggle,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:this.toggle,children:gettext('Publish a Library')}),/*#__PURE__*/_jsx(ModalBody,{className:\"dialog-list-container\",children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{width:\"6%\"}),/*#__PURE__*/_jsx(\"th\",{width:\"9%\"}),/*#__PURE__*/_jsx(\"th\",{width:\"55%\",children:gettext('Name')}),/*#__PURE__*/_jsx(\"th\",{width:\"30%\",children:gettext('Last Update')})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:this.state.repos.map(function(repo,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:/*#__PURE__*/_jsx(\"input\",{type:\"radio\",className:\"vam\",name:\"repo\",value:repo.repo_id,onChange:_this3.onChange.bind(_this3,repo)})}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:/*#__PURE__*/_jsx(\"img\",{src:Utils.getLibIconUrl(repo,false),width:\"24\",title:Utils.getLibIconTitle(repo),alt:Utils.getLibIconTitle(repo)})}),/*#__PURE__*/_jsx(\"td\",{children:repo.repo_name}),/*#__PURE__*/_jsx(\"td\",{children:moment(repo.last_modified).fromNow()})]},index);})})]})}),/*#__PURE__*/_jsxs(ModalFooter,{children:[/*#__PURE__*/_jsx(Button,{color:\"secondary\",onClick:this.toggle,children:gettext('Cancel')}),this.state.repoID?/*#__PURE__*/_jsx(Button,{color:\"primary\",onClick:this.handleSubmit,children:gettext('Submit')}):/*#__PURE__*/_jsx(Button,{color:\"primary\",disabled:true,children:gettext('Submit')})]})]});}}]);return WikiSelectDialog;}(React.Component);export default WikiSelectDialog;","map":{"version":3,"names":["React","gettext","Button","Modal","ModalHeader","ModalBody","ModalFooter","seafileAPI","moment","Repo","Utils","jsx","_jsx","jsxs","_jsxs","WikiSelectDialog","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","onChange","repo","setState","repoID","repo_id","handleSubmit","state","addWiki","toggleCancel","toggle","repos","_createClass","key","value","componentDidMount","_this2","listRepos","then","res","repoList","data","filter","item","type","encrypted","is_admin","some","map","sortRepos","render","_this3","isOpen","children","className","width","index","name","bind","src","getLibIconUrl","title","getLibIconTitle","alt","repo_name","last_modified","fromNow","color","onClick","disabled","Component"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/src/components/dialog/wiki-select-dialog.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport moment from 'moment';\nimport Repo from '../../models/repo';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  toggleCancel: PropTypes.func.isRequired,\n  addWiki: PropTypes.func.isRequired\n};\n\nclass WikiSelectDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repos: [],\n      repoID: '',\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos().then(res => {\n      let repoList = res.data.repos\n        .filter(item => {\n          switch (item.type) {\n            case 'mine': // my libraries\n              return !item.encrypted;\n            case 'shared': // libraries shared with me\n              // 'is_admin': the library is shared with 'admin' permission\n              return !item.encrypted && item.is_admin;\n            case 'group':\n            default:\n              return !item.encrypted && !res.data.repos.some(repo => {\n                // just remove the duplicated libraries\n                return repo.type != item.type && repo.repo_id == item.repo_id;\n              });\n          }\n        })\n        .map(item => {\n          let repo = new Repo(item);\n          return repo;\n        });\n      repoList = Utils.sortRepos(repoList, 'name', 'asc');\n      this.setState({repos: repoList});\n    });\n  }\n\n  onChange = (repo) => {\n    this.setState({\n      repoID: repo.repo_id,\n    });\n  };\n\n  handleSubmit = () => {\n    let { repoID } = this.state;\n    this.props.addWiki(repoID);\n    this.props.toggleCancel();\n  };\n\n  toggle = () => {\n    this.props.toggleCancel();\n  };\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('Publish a Library')}</ModalHeader>\n        <ModalBody className=\"dialog-list-container\">\n          <table>\n            <thead>\n              <tr>\n                <th width='6%'>{/* select */}</th>\n                <th width='9%'>{/* icon */}</th>\n                <th width='55%'>{gettext('Name')}</th>\n                <th width='30%'>{gettext('Last Update')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.state.repos.map((repo, index) => {\n                return (\n                  <tr key={index}>\n                    <td className=\"text-center\"><input type=\"radio\" className=\"vam\" name=\"repo\" value={repo.repo_id} onChange={this.onChange.bind(this, repo)} /></td>\n                    <td className=\"text-center\"><img src={Utils.getLibIconUrl(repo, false)} width=\"24\" title={Utils.getLibIconTitle(repo)} alt={Utils.getLibIconTitle(repo)} /></td>\n                    <td>{repo.repo_name}</td>\n                    <td>{moment(repo.last_modified).fromNow()}</td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          {this.state.repoID ?\n            <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>:\n            <Button color=\"primary\" disabled>{gettext('Submit')}</Button>\n          }\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nWikiSelectDialog.propTypes = propTypes;\n\nexport default WikiSelectDialog;\n"],"mappings":"wkBAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CAEzB,OAASC,OAAO,KAAQ,uBAAuB,CAC/C,OAASC,MAAM,CAAEC,KAAK,CAAEC,WAAW,CAAEC,SAAS,CAAEC,WAAW,KAAQ,YAAY,CAC/E,OAASC,UAAU,KAAQ,yBAAyB,CACpD,MAAO,CAAAC,MAAM,KAAM,QAAQ,CAC3B,MAAO,CAAAC,IAAI,KAAM,mBAAmB,CACpC,OAASC,KAAK,KAAQ,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,4BAOpC,CAAAC,gBAAgB,uBAAAC,gBAAA,EAAAC,SAAA,CAAAF,gBAAA,CAAAC,gBAAA,MAAAE,MAAA,CAAAC,YAAA,CAAAJ,gBAAA,EAEpB,SAAAA,iBAAYK,KAAK,CAAE,KAAAC,KAAA,CAAAC,eAAA,MAAAP,gBAAA,EACjBM,KAAA,CAAAH,MAAA,CAAAK,IAAA,MAAMH,KAAK,EAAEC,KAAA,CAkCfG,QAAQ,CAAG,SAACC,IAAI,CAAK,CACnBJ,KAAA,CAAKK,QAAQ,CAAC,CACZC,MAAM,CAAEF,IAAI,CAACG,OACf,CAAC,CAAC,CACJ,CAAC,CAAAP,KAAA,CAEDQ,YAAY,CAAG,UAAM,CACnB,GAAM,CAAAF,MAAM,CAAKN,KAAA,CAAKS,KAAK,CAArBH,MAAM,CACZN,KAAA,CAAKD,KAAK,CAACW,OAAO,CAACJ,MAAM,CAAC,CAC1BN,KAAA,CAAKD,KAAK,CAACY,YAAY,CAAC,CAAC,CAC3B,CAAC,CAAAX,KAAA,CAEDY,MAAM,CAAG,UAAM,CACbZ,KAAA,CAAKD,KAAK,CAACY,YAAY,CAAC,CAAC,CAC3B,CAAC,CA/CCX,KAAA,CAAKS,KAAK,CAAG,CACXI,KAAK,CAAE,EAAE,CACTP,MAAM,CAAE,EACV,CAAC,CAAC,OAAAN,KAAA,CACJ,CAACc,YAAA,CAAApB,gBAAA,GAAAqB,GAAA,qBAAAC,KAAA,CAED,SAAAC,kBAAA,CAAoB,KAAAC,MAAA,MAClBhC,UAAU,CAACiC,SAAS,CAAC,CAAC,CAACC,IAAI,CAAC,SAAAC,GAAG,CAAI,CACjC,GAAI,CAAAC,QAAQ,CAAGD,GAAG,CAACE,IAAI,CAACV,KAAK,CAC1BW,MAAM,CAAC,SAAAC,IAAI,CAAI,CACd,OAAQA,IAAI,CAACC,IAAI,EACf,IAAK,MAAM,CAAE;AACX,MAAO,CAACD,IAAI,CAACE,SAAS,CACxB,IAAK,QAAQ,CAAE;AACb;AACA,MAAO,CAACF,IAAI,CAACE,SAAS,EAAIF,IAAI,CAACG,QAAQ,CACzC,IAAK,OAAO,CACZ,QACE,MAAO,CAACH,IAAI,CAACE,SAAS,EAAI,CAACN,GAAG,CAACE,IAAI,CAACV,KAAK,CAACgB,IAAI,CAAC,SAAAzB,IAAI,CAAI,CACrD;AACA,MAAO,CAAAA,IAAI,CAACsB,IAAI,EAAID,IAAI,CAACC,IAAI,EAAItB,IAAI,CAACG,OAAO,EAAIkB,IAAI,CAAClB,OAAO,CAC/D,CAAC,CAAC,CACN,CACF,CAAC,CAAC,CACDuB,GAAG,CAAC,SAAAL,IAAI,CAAI,CACX,GAAI,CAAArB,IAAI,CAAG,GAAI,CAAAhB,IAAI,CAACqC,IAAI,CAAC,CACzB,MAAO,CAAArB,IAAI,CACb,CAAC,CAAC,CACJkB,QAAQ,CAAGjC,KAAK,CAAC0C,SAAS,CAACT,QAAQ,CAAE,MAAM,CAAE,KAAK,CAAC,CACnDJ,MAAI,CAACb,QAAQ,CAAC,CAACQ,KAAK,CAAES,QAAQ,CAAC,CAAC,CAClC,CAAC,CAAC,CACJ,CAAC,GAAAP,GAAA,UAAAC,KAAA,CAkBD,SAAAgB,OAAA,CAAS,KAAAC,MAAA,MACP,mBACExC,KAAA,CAACX,KAAK,EAACoD,MAAM,CAAE,IAAK,CAACtB,MAAM,CAAE,IAAI,CAACA,MAAO,CAAAuB,QAAA,eACvC5C,IAAA,CAACR,WAAW,EAAC6B,MAAM,CAAE,IAAI,CAACA,MAAO,CAAAuB,QAAA,CAAEvD,OAAO,CAAC,mBAAmB,CAAC,CAAc,CAAC,cAC9EW,IAAA,CAACP,SAAS,EAACoD,SAAS,CAAC,uBAAuB,CAAAD,QAAA,cAC1C1C,KAAA,UAAA0C,QAAA,eACE5C,IAAA,UAAA4C,QAAA,cACE1C,KAAA,OAAA0C,QAAA,eACE5C,IAAA,OAAI8C,KAAK,CAAC,IAAI,CAAmB,CAAC,cAClC9C,IAAA,OAAI8C,KAAK,CAAC,IAAI,CAAiB,CAAC,cAChC9C,IAAA,OAAI8C,KAAK,CAAC,KAAK,CAAAF,QAAA,CAAEvD,OAAO,CAAC,MAAM,CAAC,CAAK,CAAC,cACtCW,IAAA,OAAI8C,KAAK,CAAC,KAAK,CAAAF,QAAA,CAAEvD,OAAO,CAAC,aAAa,CAAC,CAAK,CAAC,EAC3C,CAAC,CACA,CAAC,cACRW,IAAA,UAAA4C,QAAA,CACG,IAAI,CAAC1B,KAAK,CAACI,KAAK,CAACiB,GAAG,CAAC,SAAC1B,IAAI,CAAEkC,KAAK,CAAK,CACrC,mBACE7C,KAAA,OAAA0C,QAAA,eACE5C,IAAA,OAAI6C,SAAS,CAAC,aAAa,CAAAD,QAAA,cAAC5C,IAAA,UAAOmC,IAAI,CAAC,OAAO,CAACU,SAAS,CAAC,KAAK,CAACG,IAAI,CAAC,MAAM,CAACvB,KAAK,CAAEZ,IAAI,CAACG,OAAQ,CAACJ,QAAQ,CAAE8B,MAAI,CAAC9B,QAAQ,CAACqC,IAAI,CAACP,MAAI,CAAE7B,IAAI,CAAE,CAAE,CAAC,CAAI,CAAC,cAClJb,IAAA,OAAI6C,SAAS,CAAC,aAAa,CAAAD,QAAA,cAAC5C,IAAA,QAAKkD,GAAG,CAAEpD,KAAK,CAACqD,aAAa,CAACtC,IAAI,CAAE,KAAK,CAAE,CAACiC,KAAK,CAAC,IAAI,CAACM,KAAK,CAAEtD,KAAK,CAACuD,eAAe,CAACxC,IAAI,CAAE,CAACyC,GAAG,CAAExD,KAAK,CAACuD,eAAe,CAACxC,IAAI,CAAE,CAAE,CAAC,CAAI,CAAC,cAChKb,IAAA,OAAA4C,QAAA,CAAK/B,IAAI,CAAC0C,SAAS,CAAK,CAAC,cACzBvD,IAAA,OAAA4C,QAAA,CAAKhD,MAAM,CAACiB,IAAI,CAAC2C,aAAa,CAAC,CAACC,OAAO,CAAC,CAAC,CAAK,CAAC,GAJxCV,KAKL,CAAC,CAET,CAAC,CAAC,CACG,CAAC,EACH,CAAC,CACC,CAAC,cACZ7C,KAAA,CAACR,WAAW,EAAAkD,QAAA,eACV5C,IAAA,CAACV,MAAM,EAACoE,KAAK,CAAC,WAAW,CAACC,OAAO,CAAE,IAAI,CAACtC,MAAO,CAAAuB,QAAA,CAAEvD,OAAO,CAAC,QAAQ,CAAC,CAAS,CAAC,CAC3E,IAAI,CAAC6B,KAAK,CAACH,MAAM,cAChBf,IAAA,CAACV,MAAM,EAACoE,KAAK,CAAC,SAAS,CAACC,OAAO,CAAE,IAAI,CAAC1C,YAAa,CAAA2B,QAAA,CAAEvD,OAAO,CAAC,QAAQ,CAAC,CAAS,CAAC,cAChFW,IAAA,CAACV,MAAM,EAACoE,KAAK,CAAC,SAAS,CAACE,QAAQ,MAAAhB,QAAA,CAAEvD,OAAO,CAAC,QAAQ,CAAC,CAAS,CAAC,EAEpD,CAAC,EACT,CAAC,CAEZ,CAAC,WAAAc,gBAAA,GA1F4Bf,KAAK,CAACyE,SAAS,EA+F9C,cAAe,CAAA1D,gBAAgB"},"metadata":{},"sourceType":"module","externalDependencies":[]}