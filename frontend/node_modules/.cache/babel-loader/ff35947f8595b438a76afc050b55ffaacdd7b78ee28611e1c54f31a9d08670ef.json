{"ast":null,"code":"/*\n* MIT Licensed\n* http://www.23developer.com/opensource\n* http://github.com/23/resumable.js\n* Steffen Tiedemann Christensen, steffen@23company.com\n*/\n\n(function () {\n  \"use strict\";\n\n  var Resumable = function Resumable(opts) {\n    if (!(this instanceof Resumable)) {\n      return new Resumable(opts);\n    }\n    this.version = 1.0;\n    // SUPPORTED BY BROWSER?\n    // Check if these features are support by the browser:\n    // - File object type\n    // - Blob object type\n    // - FileList object type\n    // - slicing files\n    this.support = typeof File !== 'undefined' && typeof Blob !== 'undefined' && typeof FileList !== 'undefined' && (!!Blob.prototype.webkitSlice || !!Blob.prototype.mozSlice || !!Blob.prototype.slice || false);\n    if (!this.support) return false;\n\n    // PROPERTIES\n    var $ = this;\n    $.files = [];\n    $.defaults = {\n      chunkSize: 1 * 1024 * 1024,\n      forceChunkSize: false,\n      simultaneousUploads: 3,\n      fileParameterName: 'file',\n      chunkNumberParameterName: 'resumableChunkNumber',\n      chunkSizeParameterName: 'resumableChunkSize',\n      currentChunkSizeParameterName: 'resumableCurrentChunkSize',\n      totalSizeParameterName: 'resumableTotalSize',\n      typeParameterName: 'resumableType',\n      identifierParameterName: 'resumableIdentifier',\n      fileNameParameterName: 'resumableFilename',\n      relativePathParameterName: 'resumableRelativePath',\n      totalChunksParameterName: 'resumableTotalChunks',\n      dragOverClass: 'dragover',\n      throttleProgressCallbacks: 0.5,\n      query: {},\n      headers: {},\n      preprocess: null,\n      preprocessFile: null,\n      method: 'multipart',\n      uploadMethod: 'POST',\n      testMethod: 'GET',\n      prioritizeFirstAndLastChunk: false,\n      target: '/',\n      testTarget: null,\n      parameterNamespace: '',\n      testChunks: true,\n      generateUniqueIdentifier: null,\n      getTarget: null,\n      maxChunkRetries: 100,\n      chunkRetryInterval: undefined,\n      permanentErrors: [400, 401, 403, 404, 409, 415, 440, 441, 442, 443, 500, 501],\n      maxFiles: undefined,\n      withCredentials: false,\n      xhrTimeout: 0,\n      clearInput: true,\n      chunkFormat: 'blob',\n      setChunkTypeFromFile: false,\n      maxFilesErrorCallback: function maxFilesErrorCallback(files, errorCount) {\n        var maxFiles = $.getOpt('maxFiles');\n        alert('Please upload no more than ' + maxFiles + ' file' + (maxFiles === 1 ? '' : 's') + ' at a time.');\n      },\n      minFileSize: 1,\n      minFileSizeErrorCallback: function minFileSizeErrorCallback(file, errorCount) {\n        alert(file.fileName || file.name + ' is too small, please upload files larger than ' + $h.formatSize($.getOpt('minFileSize')) + '.');\n      },\n      maxFileSize: undefined,\n      maxFileSizeErrorCallback: function maxFileSizeErrorCallback(file, errorCount) {\n        alert(file.fileName || file.name + ' is too large, please upload files less than ' + $h.formatSize($.getOpt('maxFileSize')) + '.');\n      },\n      fileType: [],\n      fileTypeErrorCallback: function fileTypeErrorCallback(file, errorCount) {\n        alert(file.fileName || file.name + ' has type not allowed, please upload files of type ' + $.getOpt('fileType') + '.');\n      }\n    };\n    $.opts = opts || {};\n    $.getOpt = function (o) {\n      var $opt = this;\n      // Get multiple option if passed an array\n      if (o instanceof Array) {\n        var options = {};\n        $h.each(o, function (option) {\n          options[option] = $opt.getOpt(option);\n        });\n        return options;\n      }\n      // Otherwise, just return a simple option\n      if ($opt instanceof ResumableChunk) {\n        if (typeof $opt.opts[o] !== 'undefined') {\n          return $opt.opts[o];\n        } else {\n          $opt = $opt.fileObj;\n        }\n      }\n      if ($opt instanceof ResumableFile) {\n        if (typeof $opt.opts[o] !== 'undefined') {\n          return $opt.opts[o];\n        } else {\n          $opt = $opt.resumableObj;\n        }\n      }\n      if ($opt instanceof Resumable) {\n        if (typeof $opt.opts[o] !== 'undefined') {\n          return $opt.opts[o];\n        } else {\n          return $opt.defaults[o];\n        }\n      }\n    };\n    $.indexOf = function (array, obj) {\n      if (array.indexOf) {\n        return array.indexOf(obj);\n      }\n      for (var i = 0; i < array.length; i++) {\n        if (array[i] === obj) {\n          return i;\n        }\n      }\n      return -1;\n    };\n\n    // EVENTS\n    // catchAll(event, ...)\n    // fileSuccess(file), fileProgress(file), fileAdded(file, event), filesAdded(files, filesSkipped), fileRetry(file),\n    // fileError(file, message), complete(), progress(), error(message, file), pause()\n    $.events = [];\n    $.on = function (event, callback) {\n      $.events.push(event.toLowerCase(), callback);\n    };\n    $.fire = function () {\n      // `arguments` is an object, not array, in FF, so:\n      var args = [];\n      for (var i = 0; i < arguments.length; i++) args.push(arguments[i]);\n      // Find event listeners, and support pseudo-event `catchAll`\n      var event = args[0].toLowerCase();\n      for (var i = 0; i <= $.events.length; i += 2) {\n        if ($.events[i] == event) $.events[i + 1].apply($, args.slice(1));\n        if ($.events[i] == 'catchall') $.events[i + 1].apply(null, args);\n      }\n      if (event == 'fileerror') $.fire('error', args[2], args[1]);\n      if (event == 'fileprogress') $.fire('progress');\n    };\n\n    // INTERNAL HELPER METHODS (handy, but ultimately not part of uploading)\n    var $h = {\n      stopEvent: function stopEvent(e) {\n        e.stopPropagation();\n        e.preventDefault();\n      },\n      each: function each(o, callback) {\n        if (typeof o.length !== 'undefined') {\n          for (var i = 0; i < o.length; i++) {\n            // Array or FileList\n            if (callback(o[i]) === false) return;\n          }\n        } else {\n          for (i in o) {\n            // Object\n            if (callback(i, o[i]) === false) return;\n          }\n        }\n      },\n      generateUniqueIdentifier: function generateUniqueIdentifier(file, event) {\n        var custom = $.getOpt('generateUniqueIdentifier');\n        if (typeof custom === 'function') {\n          return custom(file, event);\n        }\n        var relativePath = file.webkitRelativePath || file.relativePath || file.fileName || file.name; // Some confusion in different versions of Firefox\n        var size = file.size;\n        return size + '-' + relativePath.replace(/[^0-9a-zA-Z_-]/img, '');\n      },\n      contains: function contains(array, test) {\n        var result = false;\n        $h.each(array, function (value) {\n          if (value == test) {\n            result = true;\n            return false;\n          }\n          return true;\n        });\n        return result;\n      },\n      formatSize: function formatSize(size) {\n        if (size < 1024) {\n          return size + ' bytes';\n        } else if (size < 1024 * 1024) {\n          return (size / 1024.0).toFixed(0) + ' KB';\n        } else if (size < 1024 * 1024 * 1024) {\n          return (size / 1024.0 / 1024.0).toFixed(1) + ' MB';\n        } else {\n          return (size / 1024.0 / 1024.0 / 1024.0).toFixed(1) + ' GB';\n        }\n      },\n      getTarget: function getTarget(request, params) {\n        var target = $.getOpt('target');\n        if (request === 'test' && $.getOpt('testTarget')) {\n          target = $.getOpt('testTarget') === '/' ? $.getOpt('target') : $.getOpt('testTarget');\n        }\n        if (typeof target === 'function') {\n          return target(params);\n        }\n        var separator = target.indexOf('?') < 0 ? '?' : '&';\n        var joinedParams = params.join('&');\n        if (joinedParams) target = target + separator + joinedParams;\n        return target;\n      }\n    };\n    var onDrop = function onDrop(e) {\n      // e.currentTarget.classList.remove($.getOpt('dragOverClass'));\n      $h.stopEvent(e);\n      var dt = e.dataTransfer;\n      if ($.indexOf(dt.types, \"Files\") < 0) {\n        return;\n      }\n\n      //handle dropped things as items if we can (this lets us deal with folders nicer in some cases)\n      if (e.dataTransfer && e.dataTransfer.items) {\n        loadFiles(e.dataTransfer.items, e);\n      }\n      //else handle them as files\n      else if (e.dataTransfer && e.dataTransfer.files) {\n        loadFiles(e.dataTransfer.files, e);\n      }\n      $.dragstart = false;\n    };\n    var onDragLeave = function onDragLeave(e) {\n      // e.currentTarget.classList.remove($.getOpt('dragOverClass'));\n    };\n    var onDragOverEnter = function onDragOverEnter(e) {\n      e.preventDefault();\n      var dt = e.dataTransfer;\n      if ($.indexOf(dt.types, \"Files\") >= 0) {\n        // only for file drop\n        e.stopPropagation();\n        dt.dropEffect = \"copy\";\n        dt.effectAllowed = \"copy\";\n        if (!$.dragstart) {\n          $.fire('dragstart', $);\n          $.dragstart = true;\n        }\n      }\n      // e.currentTarget.classList.add($.getOpt('dragOverClass'));\n      // } else { // not work on IE/Edge....\n      //   dt.dropEffect = \"none\";\n      //   dt.effectAllowed = \"none\";\n      // }\n    };\n\n    /**\n     * processes a single upload item (file or directory)\n     * @param {Object} item item to upload, may be file or directory entry\n     * @param {string} path current file path\n     * @param {File[]} items list of files to append new items to\n     * @param {Function} cb callback invoked when item is processed\n     */\n    function processItem(item, path, items, cb) {\n      var entry;\n      if (item.isFile) {\n        // file provided\n        return item.file(function (file) {\n          file.relativePath = path + file.name;\n          items.push(file);\n          cb();\n        });\n      } else if (item.isDirectory) {\n        // item is already a directory entry, just assign\n        entry = item;\n      } else if (item instanceof File) {\n        items.push(item);\n      }\n      if ('function' === typeof item.webkitGetAsEntry) {\n        // get entry from file object\n        entry = item.webkitGetAsEntry();\n      }\n      if (entry && entry.isDirectory) {\n        // directory provided, process it\n        return processDirectory(entry, path + entry.name + '/', items, cb);\n      }\n      if ('function' === typeof item.getAsFile) {\n        // item represents a File object, convert it\n        item = item.getAsFile();\n        if (item instanceof File) {\n          item.relativePath = path + item.name;\n          items.push(item);\n        }\n      }\n      cb(); // indicate processing is done\n    }\n\n    /**\n     * cps-style list iteration.\n     * invokes all functions in list and waits for their callback to be\n     * triggered.\n     * @param  {Function[]}   items list of functions expecting callback parameter\n     * @param  {Function} cb    callback to trigger after the last callback has been invoked\n     */\n    function processCallbacks(items, cb) {\n      if (!items || items.length === 0) {\n        // empty or no list, invoke callback\n        return cb();\n      }\n      // invoke current function, pass the next part as continuation\n      items[0](function () {\n        processCallbacks(items.slice(1), cb);\n      });\n    }\n\n    /**\n     * recursively traverse directory and collect files to upload\n     * @param  {Object}   directory directory to process\n     * @param  {string}   path      current path\n     * @param  {File[]}   items     target list of items\n     * @param  {Function} cb        callback invoked after traversing directory\n     */\n    function processDirectory(directory, path, items, cb) {\n      var dirReader = directory.createReader();\n      var allEntries = [];\n      function readEntries() {\n        dirReader.readEntries(function (entries) {\n          if (entries.length) {\n            allEntries = allEntries.concat(entries);\n            return readEntries();\n          }\n\n          // process all conversion callbacks, finally invoke own one\n          processCallbacks(allEntries.map(function (entry) {\n            // bind all properties except for callback\n            return processItem.bind(null, entry, path, items);\n          }), cb);\n        });\n      }\n      readEntries();\n    }\n\n    /**\n     * process items to extract files to be uploaded\n     * @param  {File[]} items items to process\n     * @param  {Event} event event that led to upload\n     */\n    function loadFiles(items, event) {\n      if (!items.length) {\n        return; // nothing to do\n      }\n\n      $.fire('beforeAdd');\n      var files = [];\n      processCallbacks(Array.prototype.map.call(items, function (item) {\n        // bind all properties except for callback\n        var entry = item;\n        if ('function' === typeof item.webkitGetAsEntry) {\n          entry = item.webkitGetAsEntry();\n        }\n        return processItem.bind(null, entry, \"\", files);\n      }), function () {\n        if (files.length) {\n          // at least one file found\n          appendFilesFromFileList(files, event);\n        }\n      });\n    }\n    ;\n    var appendFilesFromFileList = function appendFilesFromFileList(fileList, event) {\n      // check for uploading too many files\n      var errorCount = 0;\n      var o = $.getOpt(['maxFiles', 'minFileSize', 'maxFileSize', 'maxFilesErrorCallback', 'minFileSizeErrorCallback', 'maxFileSizeErrorCallback', 'fileType', 'fileTypeErrorCallback']);\n      if (typeof o.maxFiles !== 'undefined' && o.maxFiles < fileList.length + $.files.length) {\n        // if single-file upload, file is already added, and trying to add 1 new file, simply replace the already-added file\n        if (o.maxFiles === 1 && $.files.length === 1 && fileList.length === 1) {\n          $.removeFile($.files[0]);\n        } else {\n          o.maxFilesErrorCallback(fileList, errorCount++);\n          return false;\n        }\n      }\n      var files = [],\n        filesSkipped = [],\n        remaining = fileList.length;\n      var decreaseReamining = function decreaseReamining() {\n        if (! --remaining) {\n          // all files processed, trigger event\n          if (!files.length && !filesSkipped.length) {\n            // no succeeded files, just skip\n            return;\n          }\n          window.setTimeout(function () {\n            $.fire('filesAdded', files, filesSkipped);\n          }, 0);\n        }\n      };\n      $h.each(fileList, function (file) {\n        var fileName = file.name;\n        var fileType = file.type; // e.g video/mp4\n        if (o.fileType.length > 0) {\n          var fileTypeFound = false;\n          for (var index in o.fileType) {\n            // For good behaviour we do some inital sanitizing. Remove spaces and lowercase all\n            o.fileType[index] = o.fileType[index].replace(/\\s/g, '').toLowerCase();\n\n            // Allowing for both [extension, .extension, mime/type, mime/*]\n            var extension = (o.fileType[index].match(/^[^.][^/]+$/) ? '.' : '') + o.fileType[index];\n            if (fileName.substr(-1 * extension.length).toLowerCase() === extension ||\n            //If MIME type, check for wildcard or if extension matches the files tiletype\n            extension.indexOf('/') !== -1 && (extension.indexOf('*') !== -1 && fileType.substr(0, extension.indexOf('*')) === extension.substr(0, extension.indexOf('*')) || fileType === extension)) {\n              fileTypeFound = true;\n              break;\n            }\n          }\n          if (!fileTypeFound) {\n            o.fileTypeErrorCallback(file, errorCount++);\n            return true;\n          }\n        }\n        if (typeof o.minFileSize !== 'undefined' && file.size < o.minFileSize) {\n          o.minFileSizeErrorCallback(file, errorCount++);\n          return true;\n        }\n        if (typeof o.maxFileSize !== 'undefined' && file.size > o.maxFileSize) {\n          o.maxFileSizeErrorCallback(file, errorCount++);\n          return true;\n        }\n        function addFile(uniqueIdentifier) {\n          if (!$.getFromUniqueIdentifier(uniqueIdentifier)) {\n            (function () {\n              file.uniqueIdentifier = uniqueIdentifier;\n              var f = new ResumableFile($, file, uniqueIdentifier);\n              $.files.push(f);\n              files.push(f);\n              f.container = typeof event != 'undefined' ? event.srcElement : null;\n              window.setTimeout(function () {\n                $.fire('fileAdded', f, files);\n              }, 0);\n            })();\n          } else {\n            filesSkipped.push(file);\n          }\n          ;\n          decreaseReamining();\n        }\n        // directories have size == 0\n        var uniqueIdentifier = $h.generateUniqueIdentifier(file, event);\n        if (uniqueIdentifier && typeof uniqueIdentifier.then === 'function') {\n          // Promise or Promise-like object provided as unique identifier\n          uniqueIdentifier.then(function (uniqueIdentifier) {\n            // unique identifier generation succeeded\n            addFile(uniqueIdentifier);\n          }, function () {\n            // unique identifier generation failed\n            // skip further processing, only decrease file count\n            decreaseReamining();\n          });\n        } else {\n          // non-Promise provided as unique identifier, process synchronously\n          addFile(uniqueIdentifier);\n        }\n      });\n      window.setTimeout(function () {\n        $.fire('filesAddedComplete', $, files);\n      }, 0);\n    };\n\n    // INTERNAL OBJECT TYPES\n    function ResumableFile(resumableObj, file, uniqueIdentifier) {\n      var $ = this;\n      $.opts = {};\n      $.getOpt = resumableObj.getOpt;\n      $._prevProgress = 0;\n      $.resumableObj = resumableObj;\n      $.file = file;\n      $.fileName = file.fileName || file.name; // Some confusion in different versions of Firefox\n      $.size = file.size;\n      $.relativePath = file.relativePath || file.webkitRelativePath || $.fileName;\n      $.uniqueIdentifier = uniqueIdentifier;\n      $._pause = false;\n      $.container = '';\n      $.preprocessState = 0; // 0 = unprocessed, 1 = processing, 2 = finished\n      $.error = null; // error = null : success, error != null : error\n      $.remainingTime = -1; // remainingTime = -1 : preparing, remainingTime != 0 : uploading, remainingTime = 0; uploaded\n      $.isSaved = false;\n      $.newFileName = $.fileName; // need a default name\n      var _error = uniqueIdentifier !== undefined;\n\n      // Callback when something happens within the chunk\n      var chunkEvent = function chunkEvent(event, message) {\n        // event can be 'progress', 'success', 'error' or 'retry'\n        switch (event) {\n          case 'progress':\n            $.resumableObj.fire('fileProgress', $, message);\n            break;\n          case 'error':\n            $.abort();\n            _error = true;\n            $.chunks = [];\n            $.resumableObj.fire('fileError', $, message);\n            break;\n          case 'success':\n            if (_error) return;\n            $.resumableObj.fire('fileProgress', $, message); // it's at least progress\n            if ($.isComplete()) {\n              $.resumableObj.fire('fileSuccess', $, message);\n            }\n            break;\n          case 'retry':\n            $.resumableObj.fire('fileRetry', $);\n            break;\n        }\n      };\n\n      // Main code to set up a file object with chunks,\n      // packaged to be able to handle retries if needed.\n      $.chunks = [];\n      $.abort = function () {\n        // Stop current uploads\n        var abortCount = 0;\n        $h.each($.chunks, function (c) {\n          if (c.status() == 'uploading') {\n            c.abort();\n            abortCount++;\n          }\n        });\n        if (abortCount > 0) $.resumableObj.fire('fileProgress', $);\n      };\n      $.cancel = function () {\n        // Reset this file to be void\n        var _chunks = $.chunks;\n        $.chunks = [];\n        // Stop current uploads\n        $h.each(_chunks, function (c) {\n          if (c.status() == 'uploading') {\n            c.abort();\n            $.resumableObj.uploadNextChunk();\n          }\n        });\n        $.resumableObj.removeFile($);\n        $.resumableObj.fire('fileProgress', $);\n      };\n      $.retry = function () {\n        $.bootstrap();\n        var firedRetry = false;\n        $.resumableObj.on('chunkingComplete', function () {\n          if (!firedRetry) $.resumableObj.upload();\n          firedRetry = true;\n        });\n      };\n      $.bootstrap = function () {\n        $.abort();\n        _error = false;\n        // Rebuild stack of chunks from file\n        $.chunks = [];\n        $._prevProgress = 0;\n        var round = $.getOpt('forceChunkSize') ? Math.ceil : Math.floor;\n        var maxOffset = Math.max(round($.file.size / $.getOpt('chunkSize')), 1);\n        for (var offset = 0; offset < maxOffset; offset++) {\n          (function (offset) {\n            window.setTimeout(function () {\n              $.chunks.push(new ResumableChunk($.resumableObj, $, offset, chunkEvent));\n              $.resumableObj.fire('chunkingProgress', $, offset / maxOffset);\n            }, 0);\n          })(offset);\n        }\n        window.setTimeout(function () {\n          $.resumableObj.fire('chunkingComplete', $);\n        }, 0);\n      };\n      $.progress = function () {\n        if (_error) return 1;\n        // Sum up progress across everything\n        var ret = 0;\n        var error = false;\n        $h.each($.chunks, function (c) {\n          if (c.status() == 'error') error = true;\n          ret += c.progress(true); // get chunk progress relative to entire file\n        });\n\n        ret = error ? 1 : ret > 0.99999 ? 1 : ret;\n        ret = Math.max($._prevProgress, ret); // We don't want to lose percentages when an upload is paused\n        $._prevProgress = ret;\n        return ret;\n      };\n      $.isUploading = function () {\n        var uploading = false;\n        $h.each($.chunks, function (chunk) {\n          if (chunk.status() == 'uploading') {\n            uploading = true;\n            return false;\n          }\n        });\n        return uploading;\n      };\n      $.isComplete = function () {\n        var outstanding = false;\n        if ($.preprocessState === 1) {\n          return false;\n        }\n        $h.each($.chunks, function (chunk) {\n          var status = chunk.status();\n          if (status == 'pending' || status == 'uploading' || chunk.preprocessState === 1) {\n            outstanding = true;\n            return false;\n          }\n        });\n        return !outstanding;\n      };\n      $.pause = function (pause) {\n        if (typeof pause === 'undefined') {\n          $._pause = $._pause ? false : true;\n        } else {\n          $._pause = pause;\n        }\n      };\n      $.isPaused = function () {\n        return $._pause;\n      };\n      $.preprocessFinished = function () {\n        $.preprocessState = 2;\n        $.upload();\n      };\n      $.upload = function () {\n        var found = false;\n        if ($.isPaused() === false) {\n          var preprocess = $.getOpt('preprocessFile');\n          if (typeof preprocess === 'function') {\n            switch ($.preprocessState) {\n              case 0:\n                $.preprocessState = 1;\n                preprocess($);\n                return true;\n              case 1:\n                return true;\n              case 2:\n                break;\n            }\n          }\n          $h.each($.chunks, function (chunk) {\n            if (chunk.status() == 'pending' && chunk.preprocessState !== 1) {\n              chunk.send();\n              found = true;\n              return false;\n            }\n          });\n        }\n        return found;\n      };\n      $.markChunksCompleted = function (chunkNumber) {\n        if (!$.chunks || $.chunks.length <= chunkNumber) {\n          return;\n        }\n        for (var num = 0; num < chunkNumber; num++) {\n          $.chunks[num].markComplete = true;\n        }\n      };\n\n      // Bootstrap and return\n      $.resumableObj.fire('chunkingStart', $);\n      $.bootstrap();\n      return this;\n    }\n    function ResumableChunk(resumableObj, fileObj, offset, callback) {\n      var $ = this;\n      $.opts = {};\n      $.getOpt = resumableObj.getOpt;\n      $.resumableObj = resumableObj;\n      $.fileObj = fileObj;\n      $.fileObjSize = fileObj.size;\n      $.fileObjType = fileObj.file.type;\n      $.offset = offset;\n      $.callback = callback;\n      $.lastProgressCallback = new Date();\n      $.tested = false;\n      $.retries = 0;\n      $.pendingRetry = false;\n      $.preprocessState = 0; // 0 = unprocessed, 1 = processing, 2 = finished\n      $.markComplete = false;\n\n      // Computed properties\n      var chunkSize = $.getOpt('chunkSize');\n      $.loaded = 0;\n      $.startByte = $.offset * chunkSize;\n      $.endByte = Math.min($.fileObjSize, ($.offset + 1) * chunkSize);\n      if ($.fileObjSize - $.endByte < chunkSize && !$.getOpt('forceChunkSize')) {\n        // The last chunk will be bigger than the chunk size, but less than 2*chunkSize\n        $.endByte = $.fileObjSize;\n      }\n      $.xhr = null;\n\n      // test() makes a GET request without any data to see if the chunk has already been uploaded in a previous session\n      $.test = function () {\n        // Set up request and listen for event\n        $.xhr = new XMLHttpRequest();\n        var testHandler = function testHandler(e) {\n          $.tested = true;\n          var status = $.status();\n          if (status == 'success') {\n            $.callback(status, $.message());\n            $.resumableObj.uploadNextChunk();\n          } else {\n            $.send();\n          }\n        };\n        $.xhr.addEventListener('load', testHandler, false);\n        $.xhr.addEventListener('error', testHandler, false);\n        $.xhr.addEventListener('timeout', testHandler, false);\n\n        // Add data from the query options\n        var params = [];\n        var parameterNamespace = $.getOpt('parameterNamespace');\n        var customQuery = $.getOpt('query');\n        if (typeof customQuery == 'function') customQuery = customQuery($.fileObj, $);\n        $h.each(customQuery, function (k, v) {\n          params.push([encodeURIComponent(parameterNamespace + k), encodeURIComponent(v)].join('='));\n        });\n        // Add extra data to identify chunk\n        params = params.concat([\n        // define key/value pairs for additional parameters\n        ['chunkNumberParameterName', $.offset + 1], ['chunkSizeParameterName', $.getOpt('chunkSize')], ['currentChunkSizeParameterName', $.endByte - $.startByte], ['totalSizeParameterName', $.fileObjSize], ['typeParameterName', $.fileObjType], ['identifierParameterName', $.fileObj.uniqueIdentifier], ['fileNameParameterName', $.fileObj.fileName], ['relativePathParameterName', $.fileObj.relativePath], ['totalChunksParameterName', $.fileObj.chunks.length]].filter(function (pair) {\n          // include items that resolve to truthy values\n          // i.e. exclude false, null, undefined and empty strings\n          return $.getOpt(pair[0]);\n        }).map(function (pair) {\n          // map each key/value pair to its final form\n          return [parameterNamespace + $.getOpt(pair[0]), encodeURIComponent(pair[1])].join('=');\n        }));\n        // Append the relevant chunk and send it\n        $.xhr.open($.getOpt('testMethod'), $h.getTarget('test', params));\n        $.xhr.timeout = $.getOpt('xhrTimeout');\n        $.xhr.withCredentials = $.getOpt('withCredentials');\n        // Add data from header options\n        var customHeaders = $.getOpt('headers');\n        if (typeof customHeaders === 'function') {\n          customHeaders = customHeaders($.fileObj, $);\n        }\n        $h.each(customHeaders, function (k, v) {\n          $.xhr.setRequestHeader(k, v);\n        });\n        $.xhr.send(null);\n      };\n      $.preprocessFinished = function () {\n        $.preprocessState = 2;\n        $.send();\n      };\n\n      // send() uploads the actual data in a POST call\n      $.send = function () {\n        var preprocess = $.getOpt('preprocess');\n        if (typeof preprocess === 'function') {\n          switch ($.preprocessState) {\n            case 0:\n              $.preprocessState = 1;\n              preprocess($);\n              return;\n            case 1:\n              return;\n            case 2:\n              break;\n          }\n        }\n        if ($.getOpt('testChunks') && !$.tested) {\n          $.test();\n          return;\n        }\n\n        // Set up request and listen for event\n        $.xhr = new XMLHttpRequest();\n\n        // Progress\n        $.xhr.upload.addEventListener('progress', function (e) {\n          if (new Date() - $.lastProgressCallback > $.getOpt('throttleProgressCallbacks') * 1000) {\n            $.callback('progress');\n            $.lastProgressCallback = new Date();\n          }\n          $.loaded = e.loaded || 0;\n        }, false);\n        $.loaded = 0;\n        $.pendingRetry = false;\n        $.callback('progress');\n\n        // Done (either done, failed or retry)\n        var doneHandler = function doneHandler(e) {\n          var status = $.status();\n          if (status == 'success' || status == 'error') {\n            $.callback(status, $.message());\n            $.resumableObj.uploadNextChunk();\n          } else {\n            $.callback('retry', $.message());\n            $.abort();\n            $.retries++;\n            var retryInterval = $.getOpt('chunkRetryInterval');\n            if (retryInterval !== undefined) {\n              $.pendingRetry = true;\n              setTimeout($.send, retryInterval);\n            } else {\n              $.send();\n            }\n          }\n        };\n        $.xhr.addEventListener('load', doneHandler, false);\n        $.xhr.addEventListener('error', doneHandler, false);\n        $.xhr.addEventListener('timeout', doneHandler, false);\n\n        // Set up the basic query data from Resumable\n        var query = [['chunkNumberParameterName', $.offset + 1], ['chunkSizeParameterName', $.getOpt('chunkSize')], ['currentChunkSizeParameterName', $.endByte - $.startByte], ['totalSizeParameterName', $.fileObjSize], ['typeParameterName', $.fileObjType], ['identifierParameterName', $.fileObj.uniqueIdentifier], ['fileNameParameterName', $.fileObj.fileName], ['relativePathParameterName', $.fileObj.relativePath], ['totalChunksParameterName', $.fileObj.chunks.length]].filter(function (pair) {\n          // include items that resolve to truthy values\n          // i.e. exclude false, null, undefined and empty strings\n          return $.getOpt(pair[0]);\n        }).reduce(function (query, pair) {\n          // assign query key/value\n          query[$.getOpt(pair[0])] = pair[1];\n          return query;\n        }, {});\n        // Mix in custom data\n        var customQuery = $.getOpt('query');\n        if (typeof customQuery == 'function') customQuery = customQuery($.fileObj, $);\n        $h.each(customQuery, function (k, v) {\n          query[k] = v;\n        });\n        var func = $.fileObj.file.slice ? 'slice' : $.fileObj.file.mozSlice ? 'mozSlice' : $.fileObj.file.webkitSlice ? 'webkitSlice' : 'slice';\n        var bytes = $.fileObj.file[func]($.startByte, $.endByte, $.getOpt('setChunkTypeFromFile') ? $.fileObj.file.type : \"\");\n        var data = null;\n        var params = [];\n        var parameterNamespace = $.getOpt('parameterNamespace');\n        if ($.getOpt('method') === 'octet') {\n          // Add data from the query options\n          data = bytes;\n          $h.each(query, function (k, v) {\n            params.push([encodeURIComponent(parameterNamespace + k), encodeURIComponent(v)].join('='));\n          });\n        } else {\n          // Add data from the query options\n          data = new FormData();\n          $h.each(query, function (k, v) {\n            data.append(parameterNamespace + k, v);\n            params.push([encodeURIComponent(parameterNamespace + k), encodeURIComponent(v)].join('='));\n          });\n          if ($.getOpt('chunkFormat') == 'blob') {\n            data.append(parameterNamespace + $.getOpt('fileParameterName'), bytes, $.fileObj.fileName);\n          } else if ($.getOpt('chunkFormat') == 'base64') {\n            var fr = new FileReader();\n            fr.onload = function (e) {\n              data.append(parameterNamespace + $.getOpt('fileParameterName'), fr.result);\n              $.xhr.send(data);\n            };\n            fr.readAsDataURL(bytes);\n          }\n        }\n        var target = $h.getTarget('upload', params);\n        var method = $.getOpt('uploadMethod');\n        if (method.toLowerCase() === 'post') {\n          target = $h.getTarget('upload', []);\n        }\n        $.xhr.open(method, target);\n        if ($.getOpt('method') === 'octet') {\n          $.xhr.setRequestHeader('Content-Type', 'application/octet-stream');\n        }\n        $.xhr.timeout = $.getOpt('xhrTimeout');\n        $.xhr.withCredentials = $.getOpt('withCredentials');\n        // Add data from header options\n        var customHeaders = $.getOpt('headers');\n        if (typeof customHeaders === 'function') {\n          customHeaders = customHeaders($.fileObj, $);\n        }\n        $h.each(customHeaders, function (k, v) {\n          $.xhr.setRequestHeader(k, v);\n        });\n        if ($.getOpt('chunkFormat') == 'blob') {\n          $.xhr.send(data);\n        }\n      };\n      $.abort = function () {\n        // Abort and reset\n        if ($.xhr) $.xhr.abort();\n        $.xhr = null;\n      };\n      $.status = function () {\n        // Returns: 'pending', 'uploading', 'success', 'error'\n        if ($.pendingRetry) {\n          // if pending retry then that's effectively the same as actively uploading,\n          // there might just be a slight delay before the retry starts\n          return 'uploading';\n        } else if ($.markComplete) {\n          return 'success';\n        } else if (!$.xhr) {\n          return 'pending';\n        } else if ($.xhr.readyState < 4) {\n          // Status is really 'OPENED', 'HEADERS_RECEIVED' or 'LOADING' - meaning that stuff is happening\n          return 'uploading';\n        } else {\n          if ($.xhr.status == 200 || $.xhr.status == 201) {\n            // HTTP 200, 201 (created)\n            return 'success';\n          } else if ($h.contains($.getOpt('permanentErrors'), $.xhr.status) || $.retries >= $.getOpt('maxChunkRetries')) {\n            // HTTP 400, 404, 409, 415, 500, 501 (permanent error)\n            return 'error';\n          } else {\n            // this should never happen, but we'll reset and queue a retry\n            // a likely case for this would be 503 service unavailable\n            $.abort();\n            return 'pending';\n          }\n        }\n      };\n      $.message = function () {\n        return $.xhr ? $.xhr.responseText : '';\n      };\n      $.progress = function (relative) {\n        if (typeof relative === 'undefined') relative = false;\n        if ($.fileObjSize === 0) return 1;\n        var factor = relative ? ($.endByte - $.startByte) / $.fileObjSize : 1;\n        if ($.pendingRetry) return 0;\n        if ((!$.xhr || !$.xhr.status) && !$.markComplete) factor *= .95;\n        var s = $.status();\n        switch (s) {\n          case 'success':\n          case 'error':\n            return 1 * factor;\n          case 'pending':\n            return 0 * factor;\n          default:\n            return $.loaded / ($.endByte - $.startByte) * factor;\n        }\n      };\n      return this;\n    }\n\n    // QUEUE\n    $.uploadNextChunk = function () {\n      var found = false;\n\n      // In some cases (such as videos) it's really handy to upload the first\n      // and last chunk of a file quickly; this let's the server check the file's\n      // metadata and determine if there's even a point in continuing.\n      if ($.getOpt('prioritizeFirstAndLastChunk')) {\n        $h.each($.files, function (file) {\n          if (file.chunks.length && file.chunks[0].status() == 'pending' && file.chunks[0].preprocessState === 0) {\n            file.chunks[0].send();\n            found = true;\n            return false;\n          }\n          if (file.chunks.length > 1 && file.chunks[file.chunks.length - 1].status() == 'pending' && file.chunks[file.chunks.length - 1].preprocessState === 0) {\n            file.chunks[file.chunks.length - 1].send();\n            found = true;\n            return false;\n          }\n        });\n        if (found) return true;\n      }\n\n      // Now, simply look for the next, best thing to upload\n      $h.each($.files, function (file) {\n        found = file.upload();\n        if (found) return false;\n      });\n      if (found) return true;\n\n      // The are no more outstanding chunks to upload, check is everything is done\n      var outstanding = false;\n      $h.each($.files, function (file) {\n        if (!file.isComplete()) {\n          outstanding = true;\n          return false;\n        }\n      });\n      if (!outstanding) {\n        // All chunks have been uploaded, complete\n        $.fire('complete');\n      }\n      return false;\n    };\n\n    // PUBLIC METHODS FOR RESUMABLE.JS\n    $.assignBrowse = function (domNodes, isDirectory) {\n      if (typeof domNodes.length == 'undefined') domNodes = [domNodes];\n      $h.each(domNodes, function (domNode) {\n        var input;\n        if (domNode.tagName === 'INPUT' && domNode.type === 'file') {\n          input = domNode;\n        } else {\n          input = document.createElement('input');\n          input.setAttribute('type', 'file');\n          input.style.display = 'none';\n          domNode.addEventListener('click', function () {\n            input.style.opacity = 0;\n            input.style.display = 'block';\n            input.focus();\n            input.click();\n            input.style.display = 'none';\n          }, false);\n          domNode.appendChild(input);\n        }\n        var maxFiles = $.getOpt('maxFiles');\n        if (typeof maxFiles === 'undefined' || maxFiles != 1) {\n          input.setAttribute('multiple', 'multiple');\n        } else {\n          input.removeAttribute('multiple');\n        }\n        if (isDirectory) {\n          input.setAttribute('webkitdirectory', 'webkitdirectory');\n        } else {\n          input.removeAttribute('webkitdirectory');\n        }\n        var fileTypes = $.getOpt('fileType');\n        if (typeof fileTypes !== 'undefined' && fileTypes.length >= 1) {\n          input.setAttribute('accept', fileTypes.map(function (e) {\n            e = e.replace(/\\s/g, '').toLowerCase();\n            if (e.match(/^[^.][^/]+$/)) {\n              e = '.' + e;\n            }\n            return e;\n          }).join(','));\n        } else {\n          input.removeAttribute('accept');\n        }\n        // When new files are added, simply append them to the overall list\n        input.addEventListener('change', function (e) {\n          appendFilesFromFileList(e.target.files, e);\n          var clearInput = $.getOpt('clearInput');\n          if (clearInput) {\n            e.target.value = '';\n          }\n        }, false);\n      });\n    };\n    $.assignDrop = function (domNodes) {\n      if (typeof domNodes.length == 'undefined') domNodes = [domNodes];\n      $h.each(domNodes, function (domNode) {\n        domNode.addEventListener('dragover', onDragOverEnter, false);\n        domNode.addEventListener('dragenter', onDragOverEnter, false);\n        domNode.addEventListener('dragleave', onDragLeave, false);\n        domNode.addEventListener('drop', onDrop, false);\n      });\n    };\n    $.unAssignDrop = function (domNodes) {\n      if (typeof domNodes.length == 'undefined') domNodes = [domNodes];\n      $h.each(domNodes, function (domNode) {\n        domNode.removeEventListener('dragover', onDragOverEnter);\n        domNode.removeEventListener('dragenter', onDragOverEnter);\n        domNode.removeEventListener('dragleave', onDragLeave);\n        domNode.removeEventListener('drop', onDrop);\n      });\n    };\n    $.enableDropOnDocument = function () {\n      document.addEventListener('dragover', onDragOverEnter, false);\n      document.addEventListener('dragenter', onDragOverEnter, false);\n      document.addEventListener('dragleave', onDragLeave, false);\n      document.addEventListener('drop', onDrop, false);\n    };\n    $.disableDropOnDocument = function () {\n      document.removeEventListener('dragover', onDragOverEnter);\n      document.removeEventListener('dragenter', onDragOverEnter);\n      document.removeEventListener('dragleave', onDragLeave);\n      document.removeEventListener('drop', onDrop);\n    };\n    $.isUploading = function () {\n      var uploading = false;\n      $h.each($.files, function (file) {\n        if (file.isUploading()) {\n          uploading = true;\n          return false;\n        }\n      });\n      return uploading;\n    };\n    $.upload = function () {\n      // Make sure we don't start too many uploads at once\n      if ($.isUploading()) return;\n      // Kick off the queue\n      $.fire('uploadStart');\n      for (var num = 1; num <= $.getOpt('simultaneousUploads'); num++) {\n        $.uploadNextChunk();\n      }\n    };\n    $.pause = function () {\n      // Resume all chunks currently being uploaded\n      $h.each($.files, function (file) {\n        file.abort();\n      });\n      $.fire('pause');\n    };\n    $.cancel = function () {\n      $.fire('beforeCancel');\n      for (var i = $.files.length - 1; i >= 0; i--) {\n        $.files[i].cancel();\n      }\n      $.fire('cancel');\n    };\n    $.progress = function () {\n      var totalDone = 0;\n      var totalSize = 0;\n      // Resume all chunks currently being uploaded\n      $h.each($.files, function (file) {\n        totalDone += file.progress() * file.size;\n        totalSize += file.size;\n      });\n      return totalSize > 0 ? totalDone / totalSize : 0;\n    };\n    $.addFile = function (file, event) {\n      appendFilesFromFileList([file], event);\n    };\n    $.addFiles = function (files, event) {\n      appendFilesFromFileList(files, event);\n    };\n    $.removeFile = function (file) {\n      for (var i = $.files.length - 1; i >= 0; i--) {\n        if ($.files[i] === file) {\n          $.files.splice(i, 1);\n        }\n      }\n    };\n    $.getFromUniqueIdentifier = function (uniqueIdentifier) {\n      var ret = false;\n      $h.each($.files, function (f) {\n        if (f.uniqueIdentifier == uniqueIdentifier) ret = f;\n      });\n      return ret;\n    };\n    $.getSize = function () {\n      var totalSize = 0;\n      $h.each($.files, function (file) {\n        totalSize += file.size;\n      });\n      return totalSize;\n    };\n    $.handleDropEvent = function (e) {\n      onDrop(e);\n    };\n    $.handleChangeEvent = function (e) {\n      appendFilesFromFileList(e.target.files, e);\n      e.target.value = '';\n    };\n    $.updateQuery = function (query) {\n      $.opts.query = query;\n    };\n    return this;\n  };\n\n  // Node.js-style export for Node and Component\n  if (typeof module != 'undefined') {\n    // left here for backwards compatibility\n    module.exports = Resumable;\n    module.exports.Resumable = Resumable;\n  } else if (typeof define === \"function\" && define.amd) {\n    // AMD/requirejs: Define the module\n    define(function () {\n      return Resumable;\n    });\n  } else {\n    // Browser: Expose to window\n    window.Resumable = Resumable;\n  }\n})();","map":{"version":3,"names":["Resumable","opts","version","support","File","Blob","FileList","prototype","webkitSlice","mozSlice","slice","$","files","defaults","chunkSize","forceChunkSize","simultaneousUploads","fileParameterName","chunkNumberParameterName","chunkSizeParameterName","currentChunkSizeParameterName","totalSizeParameterName","typeParameterName","identifierParameterName","fileNameParameterName","relativePathParameterName","totalChunksParameterName","dragOverClass","throttleProgressCallbacks","query","headers","preprocess","preprocessFile","method","uploadMethod","testMethod","prioritizeFirstAndLastChunk","target","testTarget","parameterNamespace","testChunks","generateUniqueIdentifier","getTarget","maxChunkRetries","chunkRetryInterval","undefined","permanentErrors","maxFiles","withCredentials","xhrTimeout","clearInput","chunkFormat","setChunkTypeFromFile","maxFilesErrorCallback","errorCount","getOpt","alert","minFileSize","minFileSizeErrorCallback","file","fileName","name","$h","formatSize","maxFileSize","maxFileSizeErrorCallback","fileType","fileTypeErrorCallback","o","$opt","Array","options","each","option","ResumableChunk","fileObj","ResumableFile","resumableObj","indexOf","array","obj","i","length","events","on","event","callback","push","toLowerCase","fire","args","arguments","apply","stopEvent","e","stopPropagation","preventDefault","custom","relativePath","webkitRelativePath","size","replace","contains","test","result","value","toFixed","request","params","separator","joinedParams","join","onDrop","dt","dataTransfer","types","items","loadFiles","dragstart","onDragLeave","onDragOverEnter","dropEffect","effectAllowed","processItem","item","path","cb","entry","isFile","isDirectory","webkitGetAsEntry","processDirectory","getAsFile","processCallbacks","directory","dirReader","createReader","allEntries","readEntries","entries","concat","map","bind","call","appendFilesFromFileList","fileList","removeFile","filesSkipped","remaining","decreaseReamining","window","setTimeout","type","fileTypeFound","index","extension","match","substr","addFile","uniqueIdentifier","getFromUniqueIdentifier","f","container","srcElement","then","_prevProgress","_pause","preprocessState","error","remainingTime","isSaved","newFileName","_error","chunkEvent","message","abort","chunks","isComplete","abortCount","c","status","cancel","_chunks","uploadNextChunk","retry","bootstrap","firedRetry","upload","round","Math","ceil","floor","maxOffset","max","offset","progress","ret","isUploading","uploading","chunk","outstanding","pause","isPaused","preprocessFinished","found","send","markChunksCompleted","chunkNumber","num","markComplete","fileObjSize","fileObjType","lastProgressCallback","Date","tested","retries","pendingRetry","loaded","startByte","endByte","min","xhr","XMLHttpRequest","testHandler","addEventListener","customQuery","k","v","encodeURIComponent","filter","pair","open","timeout","customHeaders","setRequestHeader","doneHandler","retryInterval","reduce","func","bytes","data","FormData","append","fr","FileReader","onload","readAsDataURL","readyState","responseText","relative","factor","s","assignBrowse","domNodes","domNode","input","tagName","document","createElement","setAttribute","style","display","opacity","focus","click","appendChild","removeAttribute","fileTypes","assignDrop","unAssignDrop","removeEventListener","enableDropOnDocument","disableDropOnDocument","totalDone","totalSize","addFiles","splice","getSize","handleDropEvent","handleChangeEvent","updateQuery","module","exports","define","amd"],"sources":["/Users/abel/Documents/Code-Experiments/cool-storage-api/frontend/node_modules/@seafile/resumablejs/resumable.js"],"sourcesContent":["/*\n* MIT Licensed\n* http://www.23developer.com/opensource\n* http://github.com/23/resumable.js\n* Steffen Tiedemann Christensen, steffen@23company.com\n*/\n\n(function(){\n\"use strict\";\n\n  var Resumable = function(opts){\n    if ( !(this instanceof Resumable) ) {\n      return new Resumable(opts);\n    }\n    this.version = 1.0;\n    // SUPPORTED BY BROWSER?\n    // Check if these features are support by the browser:\n    // - File object type\n    // - Blob object type\n    // - FileList object type\n    // - slicing files\n    this.support = (\n                   (typeof(File)!=='undefined')\n                   &&\n                   (typeof(Blob)!=='undefined')\n                   &&\n                   (typeof(FileList)!=='undefined')\n                   &&\n                   (!!Blob.prototype.webkitSlice||!!Blob.prototype.mozSlice||!!Blob.prototype.slice||false)\n                   );\n    if(!this.support) return(false);\n\n\n    // PROPERTIES\n    var $ = this;\n    $.files = [];\n    $.defaults = {\n      chunkSize:1*1024*1024,\n      forceChunkSize:false,\n      simultaneousUploads:3,\n      fileParameterName:'file',\n      chunkNumberParameterName: 'resumableChunkNumber',\n      chunkSizeParameterName: 'resumableChunkSize',\n      currentChunkSizeParameterName: 'resumableCurrentChunkSize',\n      totalSizeParameterName: 'resumableTotalSize',\n      typeParameterName: 'resumableType',\n      identifierParameterName: 'resumableIdentifier',\n      fileNameParameterName: 'resumableFilename',\n      relativePathParameterName: 'resumableRelativePath',\n      totalChunksParameterName: 'resumableTotalChunks',\n      dragOverClass: 'dragover',\n      throttleProgressCallbacks: 0.5,\n      query:{},\n      headers:{},\n      preprocess:null,\n      preprocessFile:null,\n      method:'multipart',\n      uploadMethod: 'POST',\n      testMethod: 'GET',\n      prioritizeFirstAndLastChunk:false,\n      target:'/',\n      testTarget: null,\n      parameterNamespace:'',\n      testChunks:true,\n      generateUniqueIdentifier:null,\n      getTarget:null,\n      maxChunkRetries:100,\n      chunkRetryInterval:undefined,\n      permanentErrors:[400, 401, 403, 404, 409, 415, 440, 441, 442, 443, 500, 501],\n      maxFiles:undefined,\n      withCredentials:false,\n      xhrTimeout:0,\n      clearInput:true,\n      chunkFormat:'blob',\n      setChunkTypeFromFile:false,\n      maxFilesErrorCallback:function (files, errorCount) {\n        var maxFiles = $.getOpt('maxFiles');\n        alert('Please upload no more than ' + maxFiles + ' file' + (maxFiles === 1 ? '' : 's') + ' at a time.');\n      },\n      minFileSize:1,\n      minFileSizeErrorCallback:function(file, errorCount) {\n        alert(file.fileName||file.name +' is too small, please upload files larger than ' + $h.formatSize($.getOpt('minFileSize')) + '.');\n      },\n      maxFileSize:undefined,\n      maxFileSizeErrorCallback:function(file, errorCount) {\n        alert(file.fileName||file.name +' is too large, please upload files less than ' + $h.formatSize($.getOpt('maxFileSize')) + '.');\n      },\n      fileType: [],\n      fileTypeErrorCallback: function(file, errorCount) {\n        alert(file.fileName||file.name +' has type not allowed, please upload files of type ' + $.getOpt('fileType') + '.');\n      }\n    };\n    $.opts = opts||{};\n    $.getOpt = function(o) {\n      var $opt = this;\n      // Get multiple option if passed an array\n      if(o instanceof Array) {\n        var options = {};\n        $h.each(o, function(option){\n          options[option] = $opt.getOpt(option);\n        });\n        return options;\n      }\n      // Otherwise, just return a simple option\n      if ($opt instanceof ResumableChunk) {\n        if (typeof $opt.opts[o] !== 'undefined') { return $opt.opts[o]; }\n        else { $opt = $opt.fileObj; }\n      }\n      if ($opt instanceof ResumableFile) {\n        if (typeof $opt.opts[o] !== 'undefined') { return $opt.opts[o]; }\n        else { $opt = $opt.resumableObj; }\n      }\n      if ($opt instanceof Resumable) {\n        if (typeof $opt.opts[o] !== 'undefined') { return $opt.opts[o]; }\n        else { return $opt.defaults[o]; }\n      }\n    };\n    $.indexOf = function(array, obj) {\n    \tif (array.indexOf) { return array.indexOf(obj); }\n    \tfor (var i = 0; i < array.length; i++) {\n            if (array[i] === obj) { return i; }\n        }\n        return -1;\n    }\n\n    // EVENTS\n    // catchAll(event, ...)\n    // fileSuccess(file), fileProgress(file), fileAdded(file, event), filesAdded(files, filesSkipped), fileRetry(file),\n    // fileError(file, message), complete(), progress(), error(message, file), pause()\n    $.events = [];\n    $.on = function(event,callback){\n      $.events.push(event.toLowerCase(), callback);\n    };\n    $.fire = function(){\n      // `arguments` is an object, not array, in FF, so:\n      var args = [];\n      for (var i=0; i<arguments.length; i++) args.push(arguments[i]);\n      // Find event listeners, and support pseudo-event `catchAll`\n      var event = args[0].toLowerCase();\n      for (var i=0; i<=$.events.length; i+=2) {\n        if($.events[i]==event) $.events[i+1].apply($,args.slice(1));\n        if($.events[i]=='catchall') $.events[i+1].apply(null,args);\n      }\n      if(event=='fileerror') $.fire('error', args[2], args[1]);\n      if(event=='fileprogress') $.fire('progress');\n    };\n\n\n    // INTERNAL HELPER METHODS (handy, but ultimately not part of uploading)\n    var $h = {\n      stopEvent: function(e){\n        e.stopPropagation();\n        e.preventDefault();\n      },\n      each: function(o,callback){\n        if(typeof(o.length)!=='undefined') {\n          for (var i=0; i<o.length; i++) {\n            // Array or FileList\n            if(callback(o[i])===false) return;\n          }\n        } else {\n          for (i in o) {\n            // Object\n            if(callback(i,o[i])===false) return;\n          }\n        }\n      },\n      generateUniqueIdentifier:function(file, event){\n        var custom = $.getOpt('generateUniqueIdentifier');\n        if(typeof custom === 'function') {\n          return custom(file, event);\n        }\n        var relativePath = file.webkitRelativePath||file.relativePath||file.fileName||file.name; // Some confusion in different versions of Firefox\n        var size = file.size;\n        return(size + '-' + relativePath.replace(/[^0-9a-zA-Z_-]/img, ''));\n      },\n      contains:function(array,test) {\n        var result = false;\n\n        $h.each(array, function(value) {\n          if (value == test) {\n            result = true;\n            return false;\n          }\n          return true;\n        });\n\n        return result;\n      },\n      formatSize:function(size){\n        if(size<1024) {\n          return size + ' bytes';\n        } else if(size<1024*1024) {\n          return (size/1024.0).toFixed(0) + ' KB';\n        } else if(size<1024*1024*1024) {\n          return (size/1024.0/1024.0).toFixed(1) + ' MB';\n        } else {\n          return (size/1024.0/1024.0/1024.0).toFixed(1) + ' GB';\n        }\n      },\n      getTarget:function(request, params){\n        var target = $.getOpt('target');\n\n        if (request === 'test' && $.getOpt('testTarget')) {\n          target = $.getOpt('testTarget') === '/' ? $.getOpt('target') : $.getOpt('testTarget');\n        }\n\n        if (typeof target === 'function') {\n          return target(params);\n        }\n\n        var separator = target.indexOf('?') < 0 ? '?' : '&';\n        var joinedParams = params.join('&');\n\n        if (joinedParams) target = target + separator + joinedParams;\n\n        return target;\n      }\n    };\n\n    var onDrop = function(e){\n      // e.currentTarget.classList.remove($.getOpt('dragOverClass'));\n      $h.stopEvent(e);\n\n      var dt = e.dataTransfer;\n      if ($.indexOf(dt.types, \"Files\") < 0) {\n        return;\n      }\n\n      //handle dropped things as items if we can (this lets us deal with folders nicer in some cases)\n      if (e.dataTransfer && e.dataTransfer.items) {\n        loadFiles(e.dataTransfer.items, e);\n      }\n      //else handle them as files\n      else if (e.dataTransfer && e.dataTransfer.files) {\n        loadFiles(e.dataTransfer.files, e);\n      }\n      $.dragstart = false;\n    };\n    var onDragLeave = function(e){\n      // e.currentTarget.classList.remove($.getOpt('dragOverClass'));\n    };\n    var onDragOverEnter = function(e) {\n      e.preventDefault();\n      var dt = e.dataTransfer;\n      if ($.indexOf(dt.types, \"Files\") >= 0) { // only for file drop\n        e.stopPropagation();\n        dt.dropEffect = \"copy\";\n        dt.effectAllowed = \"copy\";\n        if (!$.dragstart) {\n          $.fire('dragstart', $);\n          $.dragstart = true;\n        }\n      }\n      // e.currentTarget.classList.add($.getOpt('dragOverClass'));\n      // } else { // not work on IE/Edge....\n      //   dt.dropEffect = \"none\";\n      //   dt.effectAllowed = \"none\";\n      // }\n    };\n\n    /**\n     * processes a single upload item (file or directory)\n     * @param {Object} item item to upload, may be file or directory entry\n     * @param {string} path current file path\n     * @param {File[]} items list of files to append new items to\n     * @param {Function} cb callback invoked when item is processed\n     */\n    function processItem(item, path, items, cb) {\n      var entry;\n      if(item.isFile){\n        // file provided\n        return item.file(function(file){\n          file.relativePath = path + file.name;\n          items.push(file);\n          cb();\n        });\n      }else if(item.isDirectory){\n        // item is already a directory entry, just assign\n        entry = item;\n      }else if(item instanceof File) {\n        items.push(item);\n      }\n      if('function' === typeof item.webkitGetAsEntry){\n        // get entry from file object\n        entry = item.webkitGetAsEntry();\n      }\n      if(entry && entry.isDirectory){\n        // directory provided, process it\n        return processDirectory(entry, path + entry.name + '/', items, cb);\n      }\n      if('function' === typeof item.getAsFile){\n        // item represents a File object, convert it\n        item = item.getAsFile();\n        if(item instanceof File) {\n          item.relativePath = path + item.name;\n          items.push(item);\n        }\n      }\n      cb(); // indicate processing is done\n    }\n\n\n    /**\n     * cps-style list iteration.\n     * invokes all functions in list and waits for their callback to be\n     * triggered.\n     * @param  {Function[]}   items list of functions expecting callback parameter\n     * @param  {Function} cb    callback to trigger after the last callback has been invoked\n     */\n    function processCallbacks(items, cb){\n      if(!items || items.length === 0){\n        // empty or no list, invoke callback\n        return cb();\n      }\n      // invoke current function, pass the next part as continuation\n      items[0](function(){\n        processCallbacks(items.slice(1), cb);\n      });\n    }\n\n    /**\n     * recursively traverse directory and collect files to upload\n     * @param  {Object}   directory directory to process\n     * @param  {string}   path      current path\n     * @param  {File[]}   items     target list of items\n     * @param  {Function} cb        callback invoked after traversing directory\n     */\n    function processDirectory (directory, path, items, cb) {\n      var dirReader = directory.createReader();\n      var allEntries = [];\n\n      function readEntries () {\n        dirReader.readEntries(function(entries){\n          if (entries.length) {\n            allEntries = allEntries.concat(entries);\n            return readEntries();\n          }\n\n          // process all conversion callbacks, finally invoke own one\n          processCallbacks(\n            allEntries.map(function(entry){\n              // bind all properties except for callback\n              return processItem.bind(null, entry, path, items);\n            }),\n            cb\n          );\n        });\n      }\n\n      readEntries();\n    }\n\n    /**\n     * process items to extract files to be uploaded\n     * @param  {File[]} items items to process\n     * @param  {Event} event event that led to upload\n     */\n    function loadFiles(items, event) {\n      if(!items.length){\n        return; // nothing to do\n      }\n      $.fire('beforeAdd');\n      var files = [];\n      processCallbacks(\n          Array.prototype.map.call(items, function(item){\n            // bind all properties except for callback\n            var entry = item;\n            if('function' === typeof item.webkitGetAsEntry){\n              entry = item.webkitGetAsEntry();\n            }\n            return processItem.bind(null, entry, \"\", files);\n          }),\n          function(){\n            if(files.length){\n              // at least one file found\n              appendFilesFromFileList(files, event);\n            }\n          }\n      );\n    };\n\n    var appendFilesFromFileList = function(fileList, event){\n      // check for uploading too many files\n      var errorCount = 0;\n      var o = $.getOpt(['maxFiles', 'minFileSize', 'maxFileSize', 'maxFilesErrorCallback', 'minFileSizeErrorCallback', 'maxFileSizeErrorCallback', 'fileType', 'fileTypeErrorCallback']);\n      if (typeof(o.maxFiles)!=='undefined' && o.maxFiles<(fileList.length+$.files.length)) {\n        // if single-file upload, file is already added, and trying to add 1 new file, simply replace the already-added file\n        if (o.maxFiles===1 && $.files.length===1 && fileList.length===1) {\n          $.removeFile($.files[0]);\n        } else {\n          o.maxFilesErrorCallback(fileList, errorCount++);\n          return false;\n        }\n      }\n      var files = [], filesSkipped = [], remaining = fileList.length;\n      var decreaseReamining = function(){\n        if(!--remaining){\n          // all files processed, trigger event\n          if(!files.length && !filesSkipped.length){\n            // no succeeded files, just skip\n            return;\n          }\n          window.setTimeout(function(){\n            $.fire('filesAdded', files, filesSkipped);\n          },0);\n        }\n      };\n      $h.each(fileList, function(file){\n        var fileName = file.name;\n        var fileType = file.type; // e.g video/mp4\n        if(o.fileType.length > 0){\n          var fileTypeFound = false;\n          for(var index in o.fileType){\n            // For good behaviour we do some inital sanitizing. Remove spaces and lowercase all\n            o.fileType[index] = o.fileType[index].replace(/\\s/g, '').toLowerCase();\n\n            // Allowing for both [extension, .extension, mime/type, mime/*]\n            var extension = ((o.fileType[index].match(/^[^.][^/]+$/)) ? '.' : '') + o.fileType[index];\n\n            if ((fileName.substr(-1 * extension.length).toLowerCase() === extension) ||\n              //If MIME type, check for wildcard or if extension matches the files tiletype\n              (extension.indexOf('/') !== -1 && (\n                (extension.indexOf('*') !== -1 && fileType.substr(0, extension.indexOf('*')) === extension.substr(0, extension.indexOf('*'))) ||\n                fileType === extension\n              ))\n            ){\n              fileTypeFound = true;\n              break;\n            }\n          }\n          if (!fileTypeFound) {\n            o.fileTypeErrorCallback(file, errorCount++);\n            return true;\n          }\n        }\n\n        if (typeof(o.minFileSize)!=='undefined' && file.size<o.minFileSize) {\n          o.minFileSizeErrorCallback(file, errorCount++);\n          return true;\n        }\n        if (typeof(o.maxFileSize)!=='undefined' && file.size>o.maxFileSize) {\n          o.maxFileSizeErrorCallback(file, errorCount++);\n          return true;\n        }\n\n        function addFile(uniqueIdentifier){\n          if (!$.getFromUniqueIdentifier(uniqueIdentifier)) {(function(){\n            file.uniqueIdentifier = uniqueIdentifier;\n            var f = new ResumableFile($, file, uniqueIdentifier);\n            $.files.push(f);\n            files.push(f);\n            f.container = (typeof event != 'undefined' ? event.srcElement : null);\n            window.setTimeout(function(){\n              $.fire('fileAdded', f, files)\n            },0);\n          })()} else {\n            filesSkipped.push(file);\n          };\n          decreaseReamining();\n        }\n        // directories have size == 0\n        var uniqueIdentifier = $h.generateUniqueIdentifier(file, event);\n        if(uniqueIdentifier && typeof uniqueIdentifier.then === 'function'){\n          // Promise or Promise-like object provided as unique identifier\n          uniqueIdentifier\n          .then(\n            function(uniqueIdentifier){\n              // unique identifier generation succeeded\n              addFile(uniqueIdentifier);\n            },\n           function(){\n              // unique identifier generation failed\n              // skip further processing, only decrease file count\n              decreaseReamining();\n            }\n          );\n        }else{\n          // non-Promise provided as unique identifier, process synchronously\n          addFile(uniqueIdentifier);\n        }\n      });\n      window.setTimeout(function(){\n        $.fire('filesAddedComplete', $, files);\n      },0);\n    };\n\n    // INTERNAL OBJECT TYPES\n    function ResumableFile(resumableObj, file, uniqueIdentifier){\n      var $ = this;\n      $.opts = {};\n      $.getOpt = resumableObj.getOpt;\n      $._prevProgress = 0;\n      $.resumableObj = resumableObj;\n      $.file = file;\n      $.fileName = file.fileName||file.name; // Some confusion in different versions of Firefox\n      $.size = file.size;\n      $.relativePath = file.relativePath || file.webkitRelativePath || $.fileName;\n      $.uniqueIdentifier = uniqueIdentifier;\n      $._pause = false;\n      $.container = '';\n      $.preprocessState = 0; // 0 = unprocessed, 1 = processing, 2 = finished\n      $.error = null ; // error = null : success, error != null : error\n      $.remainingTime = -1; // remainingTime = -1 : preparing, remainingTime != 0 : uploading, remainingTime = 0; uploaded\n      $.isSaved = false;\n      $.newFileName = $.fileName; // need a default name\n      var _error = uniqueIdentifier !== undefined;\n\n      // Callback when something happens within the chunk\n      var chunkEvent = function(event, message){\n        // event can be 'progress', 'success', 'error' or 'retry'\n        switch(event){\n        case 'progress':\n          $.resumableObj.fire('fileProgress', $, message);\n          break;\n        case 'error':\n          $.abort();\n          _error = true;\n          $.chunks = [];\n          $.resumableObj.fire('fileError', $, message);\n          break;\n        case 'success':\n          if(_error) return;\n          $.resumableObj.fire('fileProgress', $, message); // it's at least progress\n          if($.isComplete()) {\n            $.resumableObj.fire('fileSuccess', $, message);\n          }\n          break;\n        case 'retry':\n          $.resumableObj.fire('fileRetry', $);\n          break;\n        }\n      };\n\n      // Main code to set up a file object with chunks,\n      // packaged to be able to handle retries if needed.\n      $.chunks = [];\n      $.abort = function(){\n        // Stop current uploads\n        var abortCount = 0;\n        $h.each($.chunks, function(c){\n          if(c.status()=='uploading') {\n            c.abort();\n            abortCount++;\n          }\n        });\n        if(abortCount>0) $.resumableObj.fire('fileProgress', $);\n      };\n      $.cancel = function(){\n        // Reset this file to be void\n        var _chunks = $.chunks;\n        $.chunks = [];\n        // Stop current uploads\n        $h.each(_chunks, function(c){\n          if(c.status()=='uploading')  {\n            c.abort();\n            $.resumableObj.uploadNextChunk();\n          }\n        });\n        $.resumableObj.removeFile($);\n        $.resumableObj.fire('fileProgress', $);\n      };\n      $.retry = function(){\n        $.bootstrap();\n        var firedRetry = false;\n        $.resumableObj.on('chunkingComplete', function(){\n          if(!firedRetry) $.resumableObj.upload();\n          firedRetry = true;\n        });\n      };\n      $.bootstrap = function(){\n        $.abort();\n        _error = false;\n        // Rebuild stack of chunks from file\n        $.chunks = [];\n        $._prevProgress = 0;\n        var round = $.getOpt('forceChunkSize') ? Math.ceil : Math.floor;\n        var maxOffset = Math.max(round($.file.size/$.getOpt('chunkSize')),1);\n        for (var offset=0; offset<maxOffset; offset++) {(function(offset){\n            window.setTimeout(function(){\n                $.chunks.push(new ResumableChunk($.resumableObj, $, offset, chunkEvent));\n                $.resumableObj.fire('chunkingProgress',$,offset/maxOffset);\n            },0);\n        })(offset)}\n        window.setTimeout(function(){\n            $.resumableObj.fire('chunkingComplete',$);\n        },0);\n      };\n      $.progress = function(){\n        if(_error) return(1);\n        // Sum up progress across everything\n        var ret = 0;\n        var error = false;\n        $h.each($.chunks, function(c){\n          if(c.status()=='error') error = true;\n          ret += c.progress(true); // get chunk progress relative to entire file\n        });\n        ret = (error ? 1 : (ret>0.99999 ? 1 : ret));\n        ret = Math.max($._prevProgress, ret); // We don't want to lose percentages when an upload is paused\n        $._prevProgress = ret;\n        return(ret);\n      };\n      $.isUploading = function(){\n        var uploading = false;\n        $h.each($.chunks, function(chunk){\n          if(chunk.status()=='uploading') {\n            uploading = true;\n            return(false);\n          }\n        });\n        return(uploading);\n      };\n      $.isComplete = function(){\n        var outstanding = false;\n        if ($.preprocessState === 1) {\n          return(false);\n        }\n        $h.each($.chunks, function(chunk){\n          var status = chunk.status();\n          if(status=='pending' || status=='uploading' || chunk.preprocessState === 1) {\n            outstanding = true;\n            return(false);\n          }\n        });\n        return(!outstanding);\n      };\n      $.pause = function(pause){\n          if(typeof(pause)==='undefined'){\n              $._pause = ($._pause ? false : true);\n          }else{\n              $._pause = pause;\n          }\n      };\n      $.isPaused = function() {\n        return $._pause;\n      };\n      $.preprocessFinished = function(){\n        $.preprocessState = 2;\n        $.upload();\n      };\n      $.upload = function () {\n        var found = false;\n        if ($.isPaused() === false) {\n          var preprocess = $.getOpt('preprocessFile');\n          if(typeof preprocess === 'function') {\n            switch($.preprocessState) {\n            case 0: $.preprocessState = 1; preprocess($); return(true);\n            case 1: return(true);\n            case 2: break;\n            }\n          }\n          $h.each($.chunks, function (chunk) {\n            if (chunk.status() == 'pending' && chunk.preprocessState !== 1) {\n              chunk.send();\n              found = true;\n              return(false);\n            }\n          });\n        }\n        return(found);\n      }\n      $.markChunksCompleted = function (chunkNumber) {\n        if (!$.chunks || $.chunks.length <= chunkNumber) {\n            return;\n        }\n        for (var num = 0; num < chunkNumber; num++) {\n            $.chunks[num].markComplete = true;\n        }\n      };\n\n      // Bootstrap and return\n      $.resumableObj.fire('chunkingStart', $);\n      $.bootstrap();\n      return(this);\n    }\n\n\n    function ResumableChunk(resumableObj, fileObj, offset, callback){\n      var $ = this;\n      $.opts = {};\n      $.getOpt = resumableObj.getOpt;\n      $.resumableObj = resumableObj;\n      $.fileObj = fileObj;\n      $.fileObjSize = fileObj.size;\n      $.fileObjType = fileObj.file.type;\n      $.offset = offset;\n      $.callback = callback;\n      $.lastProgressCallback = (new Date);\n      $.tested = false;\n      $.retries = 0;\n      $.pendingRetry = false;\n      $.preprocessState = 0; // 0 = unprocessed, 1 = processing, 2 = finished\n      $.markComplete = false;\n\n      // Computed properties\n      var chunkSize = $.getOpt('chunkSize');\n      $.loaded = 0;\n      $.startByte = $.offset*chunkSize;\n      $.endByte = Math.min($.fileObjSize, ($.offset+1)*chunkSize);\n      if ($.fileObjSize-$.endByte < chunkSize && !$.getOpt('forceChunkSize')) {\n        // The last chunk will be bigger than the chunk size, but less than 2*chunkSize\n        $.endByte = $.fileObjSize;\n      }\n      $.xhr = null;\n\n      // test() makes a GET request without any data to see if the chunk has already been uploaded in a previous session\n      $.test = function(){\n        // Set up request and listen for event\n        $.xhr = new XMLHttpRequest();\n\n        var testHandler = function(e){\n          $.tested = true;\n          var status = $.status();\n          if(status=='success') {\n            $.callback(status, $.message());\n            $.resumableObj.uploadNextChunk();\n          } else {\n            $.send();\n          }\n        };\n        $.xhr.addEventListener('load', testHandler, false);\n        $.xhr.addEventListener('error', testHandler, false);\n        $.xhr.addEventListener('timeout', testHandler, false);\n\n        // Add data from the query options\n        var params = [];\n        var parameterNamespace = $.getOpt('parameterNamespace');\n        var customQuery = $.getOpt('query');\n        if(typeof customQuery == 'function') customQuery = customQuery($.fileObj, $);\n        $h.each(customQuery, function(k,v){\n          params.push([encodeURIComponent(parameterNamespace+k), encodeURIComponent(v)].join('='));\n        });\n        // Add extra data to identify chunk\n        params = params.concat(\n          [\n            // define key/value pairs for additional parameters\n            ['chunkNumberParameterName', $.offset + 1],\n            ['chunkSizeParameterName', $.getOpt('chunkSize')],\n            ['currentChunkSizeParameterName', $.endByte - $.startByte],\n            ['totalSizeParameterName', $.fileObjSize],\n            ['typeParameterName', $.fileObjType],\n            ['identifierParameterName', $.fileObj.uniqueIdentifier],\n            ['fileNameParameterName', $.fileObj.fileName],\n            ['relativePathParameterName', $.fileObj.relativePath],\n            ['totalChunksParameterName', $.fileObj.chunks.length]\n          ].filter(function(pair){\n            // include items that resolve to truthy values\n            // i.e. exclude false, null, undefined and empty strings\n            return $.getOpt(pair[0]);\n          })\n          .map(function(pair){\n            // map each key/value pair to its final form\n            return [\n              parameterNamespace + $.getOpt(pair[0]),\n              encodeURIComponent(pair[1])\n            ].join('=');\n          })\n        );\n        // Append the relevant chunk and send it\n        $.xhr.open($.getOpt('testMethod'), $h.getTarget('test', params));\n        $.xhr.timeout = $.getOpt('xhrTimeout');\n        $.xhr.withCredentials = $.getOpt('withCredentials');\n        // Add data from header options\n        var customHeaders = $.getOpt('headers');\n        if(typeof customHeaders === 'function') {\n          customHeaders = customHeaders($.fileObj, $);\n        }\n        $h.each(customHeaders, function(k,v) {\n          $.xhr.setRequestHeader(k, v);\n        });\n        $.xhr.send(null);\n      };\n\n      $.preprocessFinished = function(){\n        $.preprocessState = 2;\n        $.send();\n      };\n\n      // send() uploads the actual data in a POST call\n      $.send = function(){\n        var preprocess = $.getOpt('preprocess');\n        if(typeof preprocess === 'function') {\n          switch($.preprocessState) {\n          case 0: $.preprocessState = 1; preprocess($); return;\n          case 1: return;\n          case 2: break;\n          }\n        }\n        if($.getOpt('testChunks') && !$.tested) {\n          $.test();\n          return;\n        }\n\n        // Set up request and listen for event\n        $.xhr = new XMLHttpRequest();\n\n        // Progress\n        $.xhr.upload.addEventListener('progress', function(e){\n          if( (new Date) - $.lastProgressCallback > $.getOpt('throttleProgressCallbacks') * 1000 ) {\n            $.callback('progress');\n            $.lastProgressCallback = (new Date);\n          }\n          $.loaded=e.loaded||0;\n        }, false);\n        $.loaded = 0;\n        $.pendingRetry = false;\n        $.callback('progress');\n\n        // Done (either done, failed or retry)\n        var doneHandler = function(e){\n          var status = $.status();\n          if(status=='success'||status=='error') {\n            $.callback(status, $.message());\n            $.resumableObj.uploadNextChunk();\n          } else {\n            $.callback('retry', $.message());\n            $.abort();\n            $.retries++;\n            var retryInterval = $.getOpt('chunkRetryInterval');\n            if(retryInterval !== undefined) {\n              $.pendingRetry = true;\n              setTimeout($.send, retryInterval);\n            } else {\n              $.send();\n            }\n          }\n        };\n        $.xhr.addEventListener('load', doneHandler, false);\n        $.xhr.addEventListener('error', doneHandler, false);\n        $.xhr.addEventListener('timeout', doneHandler, false);\n\n        // Set up the basic query data from Resumable\n        var query = [\n          ['chunkNumberParameterName', $.offset + 1],\n          ['chunkSizeParameterName', $.getOpt('chunkSize')],\n          ['currentChunkSizeParameterName', $.endByte - $.startByte],\n          ['totalSizeParameterName', $.fileObjSize],\n          ['typeParameterName', $.fileObjType],\n          ['identifierParameterName', $.fileObj.uniqueIdentifier],\n          ['fileNameParameterName', $.fileObj.fileName],\n          ['relativePathParameterName', $.fileObj.relativePath],\n          ['totalChunksParameterName', $.fileObj.chunks.length],\n        ].filter(function(pair){\n          // include items that resolve to truthy values\n          // i.e. exclude false, null, undefined and empty strings\n          return $.getOpt(pair[0]);\n        })\n        .reduce(function(query, pair){\n          // assign query key/value\n          query[$.getOpt(pair[0])] = pair[1];\n          return query;\n        }, {});\n        // Mix in custom data\n        var customQuery = $.getOpt('query');\n        if(typeof customQuery == 'function') customQuery = customQuery($.fileObj, $);\n        $h.each(customQuery, function(k,v){\n          query[k] = v;\n        });\n\n        var func = ($.fileObj.file.slice ? 'slice' : ($.fileObj.file.mozSlice ? 'mozSlice' : ($.fileObj.file.webkitSlice ? 'webkitSlice' : 'slice')));\n        var bytes = $.fileObj.file[func]($.startByte, $.endByte, $.getOpt('setChunkTypeFromFile') ? $.fileObj.file.type : \"\");\n        var data = null;\n        var params = [];\n\n        var parameterNamespace = $.getOpt('parameterNamespace');\n                if ($.getOpt('method') === 'octet') {\n                    // Add data from the query options\n                    data = bytes;\n                    $h.each(query, function (k, v) {\n                        params.push([encodeURIComponent(parameterNamespace + k), encodeURIComponent(v)].join('='));\n                    });\n                } else {\n                    // Add data from the query options\n                    data = new FormData();\n                    $h.each(query, function (k, v) {\n                        data.append(parameterNamespace + k, v);\n                        params.push([encodeURIComponent(parameterNamespace + k), encodeURIComponent(v)].join('='));\n                    });\n                    if ($.getOpt('chunkFormat') == 'blob') {\n                        data.append(parameterNamespace + $.getOpt('fileParameterName'), bytes, $.fileObj.fileName);\n                    }\n                    else if ($.getOpt('chunkFormat') == 'base64') {\n                        var fr = new FileReader();\n                        fr.onload = function (e) {\n                            data.append(parameterNamespace + $.getOpt('fileParameterName'), fr.result);\n                            $.xhr.send(data);\n                        }\n                        fr.readAsDataURL(bytes);\n                    }\n                }\n\n        var target = $h.getTarget('upload', params);\n        var method = $.getOpt('uploadMethod');\n        if (method.toLowerCase() === 'post') {\n          target = $h.getTarget('upload', []);\n        }\n\n        $.xhr.open(method, target);\n        if ($.getOpt('method') === 'octet') {\n          $.xhr.setRequestHeader('Content-Type', 'application/octet-stream');\n        }\n        $.xhr.timeout = $.getOpt('xhrTimeout');\n        $.xhr.withCredentials = $.getOpt('withCredentials');\n        // Add data from header options\n        var customHeaders = $.getOpt('headers');\n        if(typeof customHeaders === 'function') {\n          customHeaders = customHeaders($.fileObj, $);\n        }\n\n        $h.each(customHeaders, function(k,v) {\n          $.xhr.setRequestHeader(k, v);\n        });\n\n        if ($.getOpt('chunkFormat') == 'blob') {\n            $.xhr.send(data);\n        }\n      };\n      $.abort = function(){\n        // Abort and reset\n        if($.xhr) $.xhr.abort();\n        $.xhr = null;\n      };\n      $.status = function(){\n        // Returns: 'pending', 'uploading', 'success', 'error'\n        if($.pendingRetry) {\n          // if pending retry then that's effectively the same as actively uploading,\n          // there might just be a slight delay before the retry starts\n          return('uploading');\n        } else if($.markComplete) {\n          return 'success';\n        } else if(!$.xhr) {\n          return('pending');\n        } else if($.xhr.readyState<4) {\n          // Status is really 'OPENED', 'HEADERS_RECEIVED' or 'LOADING' - meaning that stuff is happening\n          return('uploading');\n        } else {\n          if($.xhr.status == 200 || $.xhr.status == 201) {\n            // HTTP 200, 201 (created)\n            return('success');\n          } else if($h.contains($.getOpt('permanentErrors'), $.xhr.status) || $.retries >= $.getOpt('maxChunkRetries')) {\n            // HTTP 400, 404, 409, 415, 500, 501 (permanent error)\n            return('error');\n          } else {\n            // this should never happen, but we'll reset and queue a retry\n            // a likely case for this would be 503 service unavailable\n            $.abort();\n            return('pending');\n          }\n        }\n      };\n      $.message = function(){\n        return($.xhr ? $.xhr.responseText : '');\n      };\n      $.progress = function(relative){\n        if(typeof(relative)==='undefined') relative = false;\n        if($.fileObjSize === 0) return 1;\n        var factor = (relative ? ($.endByte-$.startByte)/$.fileObjSize : 1);\n        if($.pendingRetry) return(0);\n        if((!$.xhr || !$.xhr.status) && !$.markComplete) factor*=.95;\n        var s = $.status();\n        switch(s){\n        case 'success':\n        case 'error':\n          return(1*factor);\n        case 'pending':\n          return(0*factor);\n        default:\n          return($.loaded/($.endByte-$.startByte)*factor);\n        }\n      };\n      return(this);\n    }\n\n    // QUEUE\n    $.uploadNextChunk = function(){\n      var found = false;\n\n      // In some cases (such as videos) it's really handy to upload the first\n      // and last chunk of a file quickly; this let's the server check the file's\n      // metadata and determine if there's even a point in continuing.\n      if ($.getOpt('prioritizeFirstAndLastChunk')) {\n        $h.each($.files, function(file){\n          if(file.chunks.length && file.chunks[0].status()=='pending' && file.chunks[0].preprocessState === 0) {\n            file.chunks[0].send();\n            found = true;\n            return(false);\n          }\n          if(file.chunks.length>1 && file.chunks[file.chunks.length-1].status()=='pending' && file.chunks[file.chunks.length-1].preprocessState === 0) {\n            file.chunks[file.chunks.length-1].send();\n            found = true;\n            return(false);\n          }\n        });\n        if(found) return(true);\n      }\n\n      // Now, simply look for the next, best thing to upload\n      $h.each($.files, function(file){\n        found = file.upload();\n        if(found) return(false);\n      });\n      if(found) return(true);\n\n      // The are no more outstanding chunks to upload, check is everything is done\n      var outstanding = false;\n      $h.each($.files, function(file){\n        if(!file.isComplete()) {\n          outstanding = true;\n          return(false);\n        }\n      });\n      if(!outstanding) {\n        // All chunks have been uploaded, complete\n        $.fire('complete');\n      }\n      return(false);\n    };\n\n\n    // PUBLIC METHODS FOR RESUMABLE.JS\n    $.assignBrowse = function(domNodes, isDirectory){\n      if(typeof(domNodes.length)=='undefined') domNodes = [domNodes];\n      $h.each(domNodes, function(domNode) {\n        var input;\n        if(domNode.tagName==='INPUT' && domNode.type==='file'){\n          input = domNode;\n        } else {\n          input = document.createElement('input');\n          input.setAttribute('type', 'file');\n          input.style.display = 'none';\n          domNode.addEventListener('click', function(){\n            input.style.opacity = 0;\n            input.style.display='block';\n            input.focus();\n            input.click();\n            input.style.display='none';\n          }, false);\n          domNode.appendChild(input);\n        }\n        var maxFiles = $.getOpt('maxFiles');\n        if (typeof(maxFiles)==='undefined'||maxFiles!=1){\n          input.setAttribute('multiple', 'multiple');\n        } else {\n          input.removeAttribute('multiple');\n        }\n        if(isDirectory){\n          input.setAttribute('webkitdirectory', 'webkitdirectory');\n        } else {\n          input.removeAttribute('webkitdirectory');\n        }\n        var fileTypes = $.getOpt('fileType');\n        if (typeof (fileTypes) !== 'undefined' && fileTypes.length >= 1) {\n          input.setAttribute('accept', fileTypes.map(function (e) {\n            e = e.replace(/\\s/g, '').toLowerCase();\n            if(e.match(/^[^.][^/]+$/)){\n              e = '.' + e;\n            }\n            return e;\n          }).join(','));\n        }\n        else {\n          input.removeAttribute('accept');\n        }\n        // When new files are added, simply append them to the overall list\n        input.addEventListener('change', function(e){\n          appendFilesFromFileList(e.target.files,e);\n          var clearInput = $.getOpt('clearInput');\n          if (clearInput) {\n            e.target.value = '';\n          }\n        }, false);\n      });\n    };\n    $.assignDrop = function(domNodes){\n      if(typeof(domNodes.length)=='undefined') domNodes = [domNodes];\n\n      $h.each(domNodes, function(domNode) {\n        domNode.addEventListener('dragover', onDragOverEnter, false);\n        domNode.addEventListener('dragenter', onDragOverEnter, false);\n        domNode.addEventListener('dragleave', onDragLeave, false);\n        domNode.addEventListener('drop', onDrop, false);\n      });\n    };\n    $.unAssignDrop = function(domNodes) {\n      if (typeof(domNodes.length) == 'undefined') domNodes = [domNodes];\n\n      $h.each(domNodes, function(domNode) {\n        domNode.removeEventListener('dragover', onDragOverEnter);\n        domNode.removeEventListener('dragenter', onDragOverEnter);\n        domNode.removeEventListener('dragleave', onDragLeave);\n        domNode.removeEventListener('drop', onDrop);\n      });\n    };\n    $.enableDropOnDocument = function() {\n      document.addEventListener('dragover', onDragOverEnter, false);\n      document.addEventListener('dragenter', onDragOverEnter, false);\n      document.addEventListener('dragleave', onDragLeave, false);\n      document.addEventListener('drop', onDrop, false);\n    }\n    $.disableDropOnDocument = function() {\n      document.removeEventListener('dragover', onDragOverEnter);\n      document.removeEventListener('dragenter', onDragOverEnter);\n      document.removeEventListener('dragleave', onDragLeave);\n      document.removeEventListener('drop', onDrop);\n    }\n    $.isUploading = function(){\n      var uploading = false;\n      $h.each($.files, function(file){\n        if (file.isUploading()) {\n          uploading = true;\n          return(false);\n        }\n      });\n      return(uploading);\n    };\n    $.upload = function(){\n      // Make sure we don't start too many uploads at once\n      if($.isUploading()) return;\n      // Kick off the queue\n      $.fire('uploadStart');\n      for (var num=1; num<=$.getOpt('simultaneousUploads'); num++) {\n        $.uploadNextChunk();\n      }\n    };\n    $.pause = function(){\n      // Resume all chunks currently being uploaded\n      $h.each($.files, function(file){\n        file.abort();\n      });\n      $.fire('pause');\n    };\n    $.cancel = function(){\n      $.fire('beforeCancel');\n      for(var i = $.files.length - 1; i >= 0; i--) {\n        $.files[i].cancel();\n      }\n      $.fire('cancel');\n    };\n    $.progress = function(){\n      var totalDone = 0;\n      var totalSize = 0;\n      // Resume all chunks currently being uploaded\n      $h.each($.files, function(file){\n        totalDone += file.progress()*file.size;\n        totalSize += file.size;\n      });\n      return(totalSize>0 ? totalDone/totalSize : 0);\n    };\n    $.addFile = function(file, event){\n      appendFilesFromFileList([file], event);\n    };\n    $.addFiles = function(files, event){\n      appendFilesFromFileList(files, event);\n    };\n    $.removeFile = function(file){\n      for(var i = $.files.length - 1; i >= 0; i--) {\n        if($.files[i] === file) {\n          $.files.splice(i, 1);\n        }\n      }\n    };\n    $.getFromUniqueIdentifier = function(uniqueIdentifier){\n      var ret = false;\n      $h.each($.files, function(f){\n        if(f.uniqueIdentifier==uniqueIdentifier) ret = f;\n      });\n      return(ret);\n    };\n    $.getSize = function(){\n      var totalSize = 0;\n      $h.each($.files, function(file){\n        totalSize += file.size;\n      });\n      return(totalSize);\n    };\n    $.handleDropEvent = function (e) {\n      onDrop(e);\n    };\n    $.handleChangeEvent = function (e) {\n      appendFilesFromFileList(e.target.files, e);\n      e.target.value = '';\n    };\n    $.updateQuery = function(query){\n        $.opts.query = query;\n    };\n\n    return(this);\n  };\n\n\n  // Node.js-style export for Node and Component\n  if (typeof module != 'undefined') {\n    // left here for backwards compatibility\n    module.exports = Resumable;\n    module.exports.Resumable = Resumable;\n  } else if (typeof define === \"function\" && define.amd) {\n    // AMD/requirejs: Define the module\n    define(function(){\n      return Resumable;\n    });\n  } else {\n    // Browser: Expose to window\n    window.Resumable = Resumable;\n  }\n\n})();\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}